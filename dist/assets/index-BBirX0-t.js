var kk=Object.defineProperty;var Ek=(e,t,r)=>t in e?kk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var gg=(e,t,r)=>Ek(e,typeof t!="symbol"?t+"":t,r);import{r as C,a as xj,u as Ho,L as Ae,b as bx,c as pj,g as bt,d as Bn,R as Q,B as Ak,e as Tk,f as ct,N as Qs}from"./react-BFDv3ESv.js";import{i as Ck,g as Ok,a as Pk,b as Fk,e as Ik,d as Dk,c as Me,s as Ve,f as Aa,h as Je,j as qa,k as Re,u as Ht,l as fr,q as et,w as We,T as an,m as gi,o as Fi,n as Rk,p as Mk,G as $k,r as Lk,t as vg,v as Bk,x as Uk,y as Wk,z as Ah,A as Hk,B as zk,C as gj,D as _s,E as Vk}from"./firebase-DPatElGj.js";import{M as Gk,S as ft,G as tc,m as te,B as ei,U as xr,H as vj,L as ga,F as yr,a as Hr,b as zt,c as Il,d as ti,e as Nt,f as Ka,C as Dl,g as Rl,h as dt,i as Zn,j as vi,k as tt,l as at,n as Th,o as vo,p as Ta,q as rc,E as wx,r as nr,P as Pr,s as Ts,t as Sn,A as ar,D as lu,T as yi,u as ac,v as _t,w as vt,x as ze,X as Br,R as yj,y as qk,z as Ef,I as Kk,J as bn,K as Cn,N as Wr,O as jx,Q as Ot,V as wr,W as ri,Y as ca,Z as yt,_ as Af,$ as Ca,a0 as Qn,a1 as Ml,a2 as nc,a3 as nu,a4 as bi,a5 as Xk,a6 as Cr,a7 as sr,a8 as es,a9 as zo,aa as yg,ab as wi,ac as cd,ad as Yk,ae as bg,af as dd,ag as bj,ah as sc,ai as F0,aj as Ss,ak as cu,al as ud,am as Jk,an as ha,ao as Tf,ap as ic,aq as wj,ar as I0,as as D0,at as Zk,au as Qk,av as e3,aw as t3,ax as r3,ay as wg,az as jg,aA as Ng,aB as a3,aC as n3,aD as su,aE as jj,aF as s3}from"./ui-B44VrYmg.js";function i3(e,t){for(var r=0;r<t.length;r++){const a=t[r];if(typeof a!="string"&&!Array.isArray(a)){for(const s in a)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(a,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>a[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var Nj={exports:{}},Cf={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o3=C,l3=Symbol.for("react.element"),c3=Symbol.for("react.fragment"),d3=Object.prototype.hasOwnProperty,u3=o3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,f3={key:!0,ref:!0,__self:!0,__source:!0};function _j(e,t,r){var a,s={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(a in t)d3.call(t,a)&&!f3.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)s[a]===void 0&&(s[a]=t[a]);return{$$typeof:l3,type:e,key:i,ref:o,props:s,_owner:u3.current}}Cf.Fragment=c3;Cf.jsx=_j;Cf.jsxs=_j;Nj.exports=Cf;var n=Nj.exports,Sj,_g=xj;Sj=_g.createRoot,_g.hydrateRoot;const h3={apiKey:"AIzaSyCKlDIhgAIPif3q2J4TAyVSBpdrUQ2P1G8",authDomain:"my-project-plateform-react.firebaseapp.com",projectId:"my-project-plateform-react",storageBucket:"my-project-plateform-react.firebasestorage.app",messagingSenderId:"1092300975970",appId:"1:1092300975970:web:76e0d3717dbf899c7b463b",measurementId:"G-S28HDNJNMH"},Nx=Ck(h3),dl=Ok(Nx),pe=Pk(Nx),Ch=Fk(Nx);console.log("Using production Firebase services");let du=navigator.onLine;const m3=async()=>{if(!du){du=!0;try{await Ik(pe),console.log("Firestore network enabled - back online")}catch(e){console.warn("Failed to enable Firestore network:",e)}}},kj=async()=>{if(du){du=!1;try{await Dk(pe),console.log("Firestore network disabled - operating offline")}catch(e){console.warn("Failed to disable Firestore network:",e)}}};window.addEventListener("online",m3);window.addEventListener("offline",kj);navigator.onLine||kj();const Qr=async(e,t)=>{try{return await e()}catch(r){return console.warn("Firestore operation failed:",r.message),r.code==="unavailable"&&console.warn("Firestore unavailable - check your internet connection or Firebase configuration"),t}},x3=async()=>Qr(async()=>{const e=et(Me(pe,"users"),We("role","==","school"),We("status","==","active"));return(await Je(e)).docs.map(r=>({id:r.id,name:r.data().name||"مدرسة بدون اسم",...r.data()}))},[]),p3=async()=>Qr(async()=>{const e=et(Me(pe,"users"),We("role","==","teacher"),We("status","==","active"));return(await Je(e)).docs.map(r=>({id:r.id,name:r.data().name||"معلم بدون اسم",subject:r.data().subject,school_id:r.data().school_id,...r.data()}))},[]),g3=async e=>Qr(async()=>{const t=et(Me(pe,"users"),We("role","==","teacher"),We("school_id","==",e),We("status","==","active"));return(await Je(t)).docs.map(a=>({id:a.id,name:a.data().name||"معلم بدون اسم",subject:a.data().subject,...a.data()}))},[]),v3=async e=>Qr(async()=>{const t=et(Me(pe,"users"),We("role","==","school"),We("email","==",e)),r=await Je(t);if(r.empty)return{found:!1,message:"لم يتم العثور على مدرسة بهذا البريد الإلكتروني",count:0};const a=r.docs[0],s=a.id,i=a.data(),o=et(Me(pe,"projects"),We("school_id","==",s)),l=await Je(o);return{found:!0,school:{id:s,name:i.name||"مدرسة",email:i.email},count:l.size,projects:l.docs.map(c=>({id:c.id,...c.data()}))}},{found:!1,message:"حدث خطأ أثناء البحث عن المدرسة",count:0}),y3=async()=>Qr(async()=>{const e=et(Me(pe,"users"),We("role","==","consultant")),t=await Je(e);return console.log("Raw consultants data from Firestore:",t.docs.map(a=>({id:a.id,...a.data()}))),t.docs.map(a=>{const s=a.data(),i={id:a.id,name:s.name||"مستشار",title:s.subject||"مستشار",specialties:s.specializations||[],rating:s.rating||5,reviews:s.reviews_count||0,experience:s.experience_years?`${s.experience_years} سنوات`:"5+ سنوات",avatar:s.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:s.hourly_rate||150,availability:"متاح",languages:s.languages||["العربية"],location:s.location||"الرياض، السعودية"};return console.log("Processed consultant object:",i),i})},[]),b3=async()=>Qr(async()=>(await Je(Me(pe,"projects"))).docs.map(t=>{const r=t.data();return{id:t.id,...r,due_date:r.due_date?r.due_date.toDate().toISOString():null,created_at:r.created_at?r.created_at.toDate().toISOString():new Date().toISOString(),updated_at:r.updated_at?r.updated_at.toDate().toISOString():new Date().toISOString()}}),[]),Ej=async e=>Qr(async()=>{const t=await fr(Re(pe,"projects",e));if(t.exists()){const r=t.data();return{id:t.id,...r,due_date:r.due_date?r.due_date.toDate().toISOString():null,created_at:r.created_at?r.created_at.toDate().toISOString():new Date().toISOString(),updated_at:r.updated_at?r.updated_at.toDate().toISOString():new Date().toISOString()}}return null},null),w3=async e=>Qr(async()=>{const t=await fr(Re(pe,"users",e));if(!t.exists())return console.error("Teacher document not found"),[];const a=t.data().school_id;if(!a)return console.error("Teacher has no school_id"),[];const s=et(Me(pe,"projects"),We("teacher_id","==",e)),o=(await Je(s)).docs.map(f=>{const h=f.data();return{id:f.id,...h,due_date:h.due_date?h.due_date.toDate().toISOString():null,created_at:h.created_at?h.created_at.toDate().toISOString():new Date().toISOString(),updated_at:h.updated_at?h.updated_at.toDate().toISOString():new Date().toISOString()}}),l=et(Me(pe,"projects"),We("school_id","==",a),We("status","==","draft")),d=(await Je(l)).docs.map(f=>{const h=f.data();return{id:f.id,...h,due_date:h.due_date?h.due_date.toDate().toISOString():null,created_at:h.created_at?h.created_at.toDate().toISOString():new Date().toISOString(),updated_at:h.updated_at?h.updated_at.toDate().toISOString():new Date().toISOString()}}),u=new Map;return o.forEach(f=>{u.set(f.id,f)}),d.forEach(f=>{u.has(f.id)||u.set(f.id,f)}),Array.from(u.values())},[]),j3=async e=>Qr(async()=>{const t=et(Me(pe,"projects"),We("school_id","==",e));return(await Je(t)).docs.map(a=>{const s=a.data();return{id:a.id,...s,due_date:s.due_date?s.due_date.toDate().toISOString():null,created_at:s.created_at?s.created_at.toDate().toISOString():new Date().toISOString(),updated_at:s.updated_at?s.updated_at.toDate().toISOString():new Date().toISOString()}})},[]),N3=async e=>Qr(async()=>{const t=et(Me(pe,"project_students"),We("student_id","==",e)),a=(await Je(t)).docs.map(i=>i.data().project_id);if(a.length===0)return[];const s=[];for(const i of a){const o=await fr(Re(pe,"projects",i));if(o.exists()){const l=o.data();s.push({id:o.id,...l,due_date:l.due_date?l.due_date.toDate().toISOString():null,created_at:l.created_at?l.created_at.toDate().toISOString():new Date().toISOString(),updated_at:l.updated_at?l.updated_at.toDate().toISOString():new Date().toISOString()})}}return s},[]),_3=async e=>{try{const t=e.dueDate||e.due_date?an.fromDate(new Date(e.dueDate||e.due_date)):null;return{id:(await Aa(Me(pe,"projects"),{...e,due_date:t,created_at:Ve(),updated_at:Ve(),status:e.status||"active",progress:e.progress||0})).id,...e,due_date:t?t.toDate().toISOString():null}}catch(t){throw console.error("Error creating project:",t),t}},Sg=async(e,t)=>{try{const r=Re(pe,"projects",e),a={...t};(t.dueDate||t.due_date)&&(a.due_date=an.fromDate(new Date(t.dueDate||t.due_date)),"dueDate"in a&&delete a.dueDate),a.updated_at=Ve(),await Ht(r,a)}catch(r){throw console.error("Error updating project:",r),r}},S3=async e=>{try{await qa(Re(pe,"projects",e))}catch(t){throw console.error("Error deleting project:",t),t}},oc=async e=>Qr(async()=>{console.log("Fetching students for project:",e);const t=et(Me(pe,"project_students"),We("project_id","==",e)),r=await Je(t);console.log("projectStudentsSnapshot.empty:",r.empty),console.log("Number of project_students documents found:",r.docs.length);const a=[];for(const s of r.docs){const i=s.data();console.log("Processing project_student document:",i);const o=await fr(Re(pe,"users",i.student_id)),l=o.exists()?o.data():null;console.log("Fetched user document for student_id",i.student_id,"exists:",o.exists()),o.exists()||console.warn("User document not found for student_id:",i.student_id),a.push({id:s.id,...i,student:l})}return console.log("Final students array from getProjectStudents:",a),a},[]),Oh=async({project_id:e,student_id:t,role:r,created_at:a,status:s})=>{try{return(await Aa(Me(pe,"project_students"),{project_id:e,student_id:t,role:r,created_at:a?an.fromDate(new Date(a)):Ve(),status:s||"active"})).id}catch(i){throw console.error("Error adding student to project:",i),i}},k3=async(e,t)=>{try{const r=et(Me(pe,"project_students"),We("project_id","==",e),We("student_id","==",t)),a=await Je(r);for(const s of a.docs)await qa(s.ref)}catch(r){throw console.error("Error removing student from project:",r),r}},Ph=async e=>Qr(async()=>{const t=et(Me(pe,"project_tasks"),We("project_id","==",e),Fi("created_at","desc"));return(await Je(t)).docs.map(a=>{const s=a.data();return{id:a.id,...s,due_date:s.due_date?s.due_date.toDate().toISOString():null,created_at:s.created_at?s.created_at.toDate().toISOString():new Date().toISOString(),updated_at:s.updated_at?s.updated_at.toDate().toISOString():new Date().toISOString()}})},[]),E3=async e=>{try{const t=e.due_date?an.fromDate(new Date(e.due_date)):null;return{id:(await Aa(Me(pe,"project_tasks"),{...e,due_date:t,created_at:Ve(),updated_at:Ve()})).id,...e,due_date:t?t.toDate().toISOString():null}}catch(t){throw console.error("Error creating project task:",t),t}},A3=async()=>Qr(async()=>{const e=et(Me(pe,"project_ideas"),We("status","==","approved"));return(await Je(e)).docs.map(a=>({id:a.id,views:0,downloads:0,rating:4.5,...a.data()})).sort((a,s)=>{var l,c,d,u;const i=((c=(l=a.created_at)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(a.created_at||0);return(((u=(d=s.created_at)==null?void 0:d.toDate)==null?void 0:u.call(d))||new Date(s.created_at||0)).getTime()-i.getTime()})},[]),T3=async()=>Qr(async()=>{const e=et(Me(pe,"project_ideas"));return(await Je(e)).docs.map(a=>({id:a.id,views:0,downloads:0,rating:4.5,...a.data()})).sort((a,s)=>{var l,c,d,u;const i=((c=(l=a.created_at)==null?void 0:l.toDate)==null?void 0:c.call(l))||new Date(a.created_at||0);return(((u=(d=s.created_at)==null?void 0:d.toDate)==null?void 0:u.call(d))||new Date(s.created_at||0)).getTime()-i.getTime()})},[]),C3=async e=>{try{const t={...e,views:e.views||0,downloads:e.downloads||0,rating:e.rating||4.5,status:e.status||"pending",created_at:Ve(),updated_at:Ve()};return{id:(await Aa(Me(pe,"project_ideas"),t)).id,...t,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}}catch(t){throw console.error("Error creating project idea:",t),t}},O3=async(e,t)=>{try{const r=Re(pe,"project_ideas",e),a={...t,updated_at:Ve()};return await Ht(r,a),!0}catch(r){throw console.error("Error updating project idea:",r),r}},P3=async e=>{try{return await qa(Re(pe,"project_ideas",e)),!0}catch(t){throw console.error("Error deleting project idea:",t),t}},F3=async e=>{try{const t=Re(pe,"project_ideas",e);await Ht(t,{views:gi(1)})}catch(t){throw console.error("Error incrementing project idea views:",t),t}},I3=async e=>{try{const t=Re(pe,"project_ideas",e);await Ht(t,{downloads:gi(1)})}catch(t){throw console.error("Error incrementing project idea downloads:",t),t}},D3=async()=>{try{console.log("Starting cleanup of duplicate project ideas...");const e=Me(pe,"project_ideas"),t=await Je(e);if(t.empty)return console.log("No project ideas found to clean up"),0;const r=new Map,a=[];t.docs.forEach(i=>{const o=i.data(),l=`${o.title}-${o.description}`;r.has(l)?a.push(i.id):r.set(l,i.id)}),console.log(`Found ${a.length} duplicate project ideas to delete`);let s=0;for(const i of a)await qa(Re(pe,"project_ideas",i)),s++;return console.log(`Successfully deleted ${s} duplicate project ideas`),s}catch(e){throw console.error("Error deleting duplicate project ideas:",e),e}},R3=async()=>{try{console.log("Starting cleanup of duplicate learning resources...");const e=Me(pe,"learning_resources"),t=await Je(e);if(t.empty)return console.log("No learning resources found to clean up"),0;const r=new Map,a=[];t.docs.forEach(i=>{const o=i.data(),l=`${o.title}-${o.type}`;r.has(l)?a.push(i.id):r.set(l,i.id)}),console.log(`Found ${a.length} duplicate learning resources to delete`);let s=0;for(const i of a)await qa(Re(pe,"learning_resources",i)),s++;return console.log(`Successfully deleted ${s} duplicate learning resources`),s}catch(e){throw console.error("Error deleting duplicate learning resources:",e),e}},M3=async(e,t)=>{try{const r=Re(pe,"users",e);await Ht(r,{...t,updated_at:Ve()})}catch(r){throw console.error("Error updating user:",r),r}},$3=async e=>Qr(async()=>{const t=et(Me(pe,"users"),We("role","==","student"),We("school_id","==",e));return(await Je(t)).docs.map(a=>({id:a.id,...a.data()}))},[]),L3=async()=>Qr(async()=>{const e=Me(pe,"summer_program_registrations"),t=et(e,Fi("createdAt","desc"));return(await Je(t)).docs.map(a=>{const s=a.data();return{id:a.id,fullName:s.fullName,email:s.email,phone:s.phone,parentPhone:s.parentPhone,city:s.city,idNumber:s.idNumber,school:s.school,grade:s.grade,educationAdministration:s.educationAdministration,hasParticipatedBefore:s.hasParticipatedBefore,previousProjects:s.previousProjects,interests:s.interests||[],howDidYouHear:s.howDidYouHear,notes:s.notes,status:s.status||"pending",createdAt:s.createdAt?s.createdAt.toDate():new Date,updatedAt:s.updatedAt?s.updatedAt.toDate():new Date}})},[]),B3=async e=>{try{const t=Me(pe,"summer_program_registrations"),r={...e,status:"pending",createdAt:Ve(),updatedAt:Ve()};return(await Aa(t,r)).id}catch(t){throw console.error("Error adding summer program registration:",t),t}},kg=async(e,t)=>{try{const r=Re(pe,"summer_program_registrations",e);await Ht(r,{...t,updatedAt:Ve()})}catch(r){throw console.error("Error updating summer program registration:",r),r}},U3=async e=>{try{const t=Re(pe,"summer_program_registrations",e);await qa(t)}catch(t){throw console.error("Error deleting summer program registration:",t),t}},Aj=C.createContext(void 0),wt=()=>{const e=C.useContext(Aj);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},W3=({children:e})=>{const[t,r]=C.useState(null),[a,s]=C.useState(!0),[i,o]=C.useState(!navigator.onLine);C.useEffect(()=>{const h=()=>o(!1),m=()=>o(!0);return window.addEventListener("online",h),window.addEventListener("offline",m),()=>{window.removeEventListener("online",h),window.removeEventListener("offline",m)}},[]),C.useEffect(()=>{const h=Rk(dl,async m=>{var x,p,g,y,b,v,w;if(m)try{const j=await fr(Re(pe,"users",m.uid));if(j.exists()){const N=j.data();r({id:m.uid,email:m.email||"",name:N.name||m.displayName||"",role:N.role||"student",avatar:N.avatar||m.photoURL,phone:N.phone,bio:N.bio,createdAt:((g=(p=(x=N.createdAt)==null?void 0:x.toDate)==null?void 0:p.call(x))==null?void 0:g.toISOString())||new Date().toISOString(),school_id:N.school_id,grade:N.grade,subject:N.subject,languages:N.languages,status:N.status||"active",specializations:N.specializations,experience_years:N.experience_years,hourly_rate:N.hourly_rate,rating:N.rating,reviews_count:N.reviews_count})}else{const N={id:m.uid,email:m.email||"",name:m.displayName||"مستخدم جديد",role:"student",avatar:m.photoURL,createdAt:new Date().toISOString(),status:"active"};r(N)}}catch(j){j.code==="unavailable"||j.code==="auth/network-request-failed"||j.code==="firestore/unavailable"||((y=j.message)==null?void 0:y.includes("offline"))||((b=j.message)==null?void 0:b.includes("client is offline"))||((v=j.message)==null?void 0:v.includes("network"))||((w=j.message)==null?void 0:w.includes("Could not reach Cloud Firestore backend"))?(console.warn("Operating in offline mode - using basic user profile:",j.message),o(!0)):console.error("Error fetching user profile:",j);const _={id:m.uid,email:m.email||"",name:m.displayName||"مستخدم جديد",role:"student",avatar:m.photoURL,createdAt:new Date().toISOString(),status:"active"};r(_)}else r(null);s(!1)});return()=>h()},[]);const f={user:t,loading:a,isOffline:i,login:async(h,m)=>{var x,p,g;try{const{user:y}=await Uk(dl,h,m),b=await fr(Re(pe,"users",y.uid));if(b.exists()){const v=b.data();r({id:y.uid,email:y.email||"",name:v.name||y.displayName||"",role:v.role||"student",avatar:v.avatar||y.photoURL,phone:v.phone,bio:v.bio,createdAt:((g=(p=(x=v.createdAt)==null?void 0:x.toDate)==null?void 0:p.call(x))==null?void 0:g.toISOString())||new Date().toISOString(),school_id:v.school_id,grade:v.grade,subject:v.subject,languages:v.languages,status:v.status||"active",specializations:v.specializations,experience_years:v.experience_years,hourly_rate:v.hourly_rate,rating:v.rating,reviews_count:v.reviews_count})}}catch(y){throw y.code==="auth/network-request-failed"||y.code==="unavailable"?(console.warn("Network request failed during login:",y.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Login error:",y),y)}},register:async(h,m,x)=>{try{const{user:p}=await Bk(dl,h,m);let g="active";(x.role==="school"||x.role==="consultant")&&(g="pending"),console.log(`Registering new ${x.role} with initial status: ${g}`);let b={...{name:x.name,email:p.email,role:x.role||"student",phone:x.phone,bio:x.bio||"",createdAt:Ve(),updatedAt:Ve(),school_id:x.school_id,grade:x.grade,subject:x.subject,languages:x.languages||["العربية"],status:g}};x.role==="consultant"&&(b={...b,specializations:x.specializations||[],experience_years:x.experience_years||0,hourly_rate:x.hourly_rate||0,rating:5,reviews_count:0}),await vg(Re(pe,"users",p.uid),b),r({id:p.uid,email:p.email||"",name:x.name||"",role:x.role||"student",avatar:p.photoURL,phone:x.phone,bio:x.bio||"",createdAt:new Date().toISOString(),school_id:x.school_id,grade:x.grade,subject:x.subject,languages:x.languages||["العربية"],status:g,specializations:x.role==="consultant"?x.specializations:void 0,experience_years:x.role==="consultant"?x.experience_years:void 0,hourly_rate:x.role==="consultant"?x.hourly_rate:void 0,rating:x.role==="consultant"?5:void 0,reviews_count:x.role==="consultant"?0:void 0})}catch(p){throw p.code==="auth/network-request-failed"||p.code==="unavailable"?(console.warn("Network request failed during registration:",p.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Registration error:",p),p)}},loginWithGoogle:async()=>{var h,m,x;try{const p=new $k,{user:g}=await Lk(dl,p);(await fr(Re(pe,"users",g.uid))).exists()||await vg(Re(pe,"users",g.uid),{name:g.displayName||"",email:g.email,role:"student",avatar:g.photoURL,createdAt:Ve(),updatedAt:Ve(),status:"active"});const b=await fr(Re(pe,"users",g.uid));if(b.exists()){const v=b.data();r({id:g.uid,email:g.email||"",name:v.name||g.displayName||"",role:v.role||"student",avatar:v.avatar||g.photoURL,phone:v.phone,bio:v.bio,createdAt:((x=(m=(h=v.createdAt)==null?void 0:h.toDate)==null?void 0:m.call(h))==null?void 0:x.toISOString())||new Date().toISOString(),school_id:v.school_id,grade:v.grade,subject:v.subject,languages:v.languages,status:v.status||"active",specializations:v.specializations,experience_years:v.experience_years,hourly_rate:v.hourly_rate,rating:v.rating,reviews_count:v.reviews_count})}}catch(p){throw p.code==="auth/network-request-failed"||p.code==="unavailable"?(console.warn("Network request failed during Google login:",p.message),o(!0),new Error("فشل في الاتصال بالشبكة. يرجى التحقق من اتصال الإنترنت والمحاولة مرة أخرى.")):(console.error("Google login error:",p),p)}},logout:async()=>{try{await Mk(dl)}catch(h){console.error("Logout error:",h),r(null)}}};return n.jsx(Aj.Provider,{value:f,children:e})},Tj=C.createContext(void 0),_x=()=>{const e=C.useContext(Tj);if(e===void 0)throw new Error("useCart must be used within a CartProvider");return e},H3=({children:e})=>{const[t,r]=C.useState({}),[a,s]=C.useState([]);C.useEffect(()=>{const m=localStorage.getItem("cart"),x=localStorage.getItem("wishlist");if(m)try{r(JSON.parse(m))}catch(p){console.error("Error parsing saved cart:",p)}if(x)try{s(JSON.parse(x))}catch(p){console.error("Error parsing saved wishlist:",p)}},[]),C.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(t))},[t]),C.useEffect(()=>{localStorage.setItem("wishlist",JSON.stringify(a))},[a]);const h={cart:t,wishlist:a,addToCart:m=>{r(x=>({...x,[m]:(x[m]||0)+1}))},removeFromCart:m=>{r(x=>{const p={...x};return p[m]>1?p[m]--:delete p[m],p})},updateQuantity:(m,x)=>{x<=0?r(p=>{const g={...p};return delete g[m],g}):r(p=>({...p,[m]:x}))},clearCart:()=>{r({})},toggleWishlist:m=>{s(x=>x.includes(m)?x.filter(p=>p!==m):[...x,m])},getTotalItems:()=>Object.values(t).reduce((m,x)=>m+x,0),getTotalPrice:m=>Object.entries(t).reduce((x,[p,g])=>{const y=m.find(b=>b.id===p);return x+(y?y.price*g:0)},0)};return n.jsx(Tj.Provider,{value:h,children:e})};function z3(){if(console&&console.warn){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ci(t[0])&&(t[0]=`react-i18next:: ${t[0]}`),console.warn(...t)}}const Eg={};function Fh(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];ci(t[0])&&Eg[t[0]]||(ci(t[0])&&(Eg[t[0]]=new Date),z3(...t))}const Cj=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},Ag=(e,t,r)=>{e.loadNamespaces(t,Cj(e,r))},Tg=(e,t,r,a)=>{ci(r)&&(r=[r]),r.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,Cj(e,a))},V3=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=t.languages[0],s=t.options?t.options.fallbackLng:!1,i=t.languages[t.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const d=t.services.backendConnector.state[`${l}|${c}`];return d===-1||d===2};return r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!o(t.isLanguageChangingTo,e)?!1:!!(t.hasResourceBundle(a,e)||!t.services.backendConnector.backend||t.options.resources&&!t.options.partialBundledLanguages||o(a,e)&&(!s||o(i,e)))},G3=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!t.languages||!t.languages.length?(Fh("i18n.languages were undefined or empty",t.languages),!0):t.options.ignoreJSONStructure!==void 0?t.hasLoadedNamespace(e,{lng:r.lng,precheck:(s,i)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!i(s.isLanguageChangingTo,e))return!1}}):V3(e,t,r)},ci=e=>typeof e=="string",q3=e=>typeof e=="object"&&e!==null,K3=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,X3={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},Y3=e=>X3[e],J3=e=>e.replace(K3,Y3);let Ih={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:J3};const Z3=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ih={...Ih,...e}},Q3=()=>Ih;let Oj;const e6=e=>{Oj=e},t6=()=>Oj,r6={type:"3rdParty",init(e){Z3(e.options.react),e6(e)}},a6=C.createContext();class n6{constructor(){gg(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}}const s6=(e,t)=>{const r=C.useRef();return C.useEffect(()=>{r.current=e},[e,t]),r.current},Pj=(e,t,r,a)=>e.getFixedT(t,r,a),i6=(e,t,r,a)=>C.useCallback(Pj(e,t,r,a),[e,t,r,a]),jt=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:r}=t,{i18n:a,defaultNS:s}=C.useContext(a6)||{},i=r||a||t6();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new n6),!i){Fh("You will need to pass in an i18next instance by using initReactI18next");const w=(N,_)=>ci(_)?_:q3(_)&&ci(_.defaultValue)?_.defaultValue:Array.isArray(N)?N[N.length-1]:N,j=[w,{},!1];return j.t=w,j.i18n={},j.ready=!1,j}i.options.react&&i.options.react.wait!==void 0&&Fh("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...Q3(),...i.options.react,...t},{useSuspense:l,keyPrefix:c}=o;let d=s||i.options&&i.options.defaultNS;d=ci(d)?[d]:d||["translation"],i.reportNamespaces.addUsedNamespaces&&i.reportNamespaces.addUsedNamespaces(d);const u=(i.isInitialized||i.initializedStoreOnce)&&d.every(w=>G3(w,i,o)),f=i6(i,t.lng||null,o.nsMode==="fallback"?d:d[0],c),h=()=>f,m=()=>Pj(i,t.lng||null,o.nsMode==="fallback"?d:d[0],c),[x,p]=C.useState(h);let g=d.join();t.lng&&(g=`${t.lng}${g}`);const y=s6(g),b=C.useRef(!0);C.useEffect(()=>{const{bindI18n:w,bindI18nStore:j}=o;b.current=!0,!u&&!l&&(t.lng?Tg(i,t.lng,d,()=>{b.current&&p(m)}):Ag(i,d,()=>{b.current&&p(m)})),u&&y&&y!==g&&b.current&&p(m);const N=()=>{b.current&&p(m)};return w&&i&&i.on(w,N),j&&i&&i.store.on(j,N),()=>{b.current=!1,w&&i&&w.split(" ").forEach(_=>i.off(_,N)),j&&i&&j.split(" ").forEach(_=>i.store.off(_,N))}},[i,g]),C.useEffect(()=>{b.current&&u&&p(h)},[i,c,u]);const v=[x,i,u];if(v.t=x,v.i18n=i,v.ready=u,u||!u&&!l)return v;throw new Promise(w=>{t.lng?Tg(i,t.lng,d,()=>w()):Ag(i,d,()=>w())})},o6=({onMenuClick:e})=>{const{user:t,logout:r}=wt(),{t:a,i18n:s}=jt(),[i,o]=C.useState(!1),[l,c]=C.useState(""),d=Ho(),u=m=>{s.changeLanguage(m),o(!1)},f=m=>a(`roles.${m}`),h=()=>{l.trim()&&d(`/search-results?q=${encodeURIComponent(l.trim())}`)};return n.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Gk,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"relative hidden md:block",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:a("header.searchProjects"),className:"w-80 pl-4 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:l,onChange:m=>c(m.target.value),onKeyPress:m=>{m.key==="Enter"&&h()}})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"relative",children:[n.jsxs("button",{onClick:()=>o(!i),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-1",children:[n.jsx(tc,{className:"w-5 h-5 text-gray-600"}),n.jsx("span",{className:"text-sm",children:s.language==="ar"?"العربية":"English"})]}),i&&n.jsxs("div",{className:"absolute top-full right-0 mt-1 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[n.jsx("button",{onClick:()=>u("ar"),className:`block w-full text-right px-4 py-2 text-sm hover:bg-gray-50 ${s.language==="ar"?"font-bold text-blue-600":""}`,children:"العربية"}),n.jsx("button",{onClick:()=>u("en"),className:`block w-full text-left px-4 py-2 text-sm hover:bg-gray-50 ${s.language==="en"?"font-bold text-blue-600":""}`,children:"English"})]})]}),n.jsxs(te.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"relative p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[n.jsx(ei,{className:"w-6 h-6 text-gray-600"}),n.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:"3"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:t==null?void 0:t.name}),n.jsx("p",{className:"text-xs text-gray-500",children:t!=null&&t.role?f(t.role):a("common.user")})]}),n.jsxs("div",{className:"relative group",children:[n.jsx("button",{className:"w-10 h-10 rounded-full overflow-hidden border-2 border-gray-200 hover:border-blue-500 transition-colors",children:t!=null&&t.avatar?n.jsx("img",{src:t.avatar,alt:t.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:n.jsx(xr,{className:"w-5 h-5 text-white"})})}),n.jsx("div",{className:"absolute left-0 top-12 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50",children:n.jsxs("div",{className:"p-2",children:[n.jsx(Ae,{to:"/settings",className:"w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md block",children:a("header.profile")}),n.jsx(Ae,{to:"/settings",className:"w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md block",children:a("header.settings")}),n.jsx("hr",{className:"my-1"}),n.jsx("button",{onClick:r,className:"w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:a("header.logout")})]})})]})]})]})]})})},l6=({isOpen:e,onClose:t,isMinimized:r,onToggleMinimize:a})=>{const s=bx(),{user:i}=wt(),{t:o,i18n:l}=jt(),c=l.language==="ar",d=[{id:"home",icon:vj,label:o("sidebar.home"),path:"/"},{id:"project-ideas",icon:ga,label:o("sidebar.projectIdeas"),path:"/project-ideas"},{id:"projects",icon:yr,label:o("sidebar.projects"),path:"/projects"},{id:"store",icon:Hr,label:o("sidebar.store"),path:"/store"},{id:"consultations",icon:zt,label:o("sidebar.consultations"),path:"/consultations"},{id:"gallery",icon:Il,label:o("sidebar.gallery"),path:"/gallery"},{id:"ai-assistant",icon:ti,label:o("sidebar.aiAssistant"),path:"/ai-assistant"},{id:"resources",icon:Nt,label:o("sidebar.resources"),path:"/resources"},{id:"intellectual-property",icon:Ka,label:o("sidebar.intellectualProperty"),path:"/intellectual-property"}],f=(()=>{let h=[...d];return(i==null?void 0:i.role)==="teacher"?h.push({id:"students",icon:dt,label:o("sidebar.students"),path:"/students"},{id:"reports",icon:Zn,label:o("sidebar.reports"),path:"/reports"}):(i==null?void 0:i.role)==="consultant"?h.push({id:"consultant-dashboard",icon:vi,label:o("sidebar.consultantDashboard"),path:"/consultant-dashboard"},{id:"consultation-requests",icon:zt,label:o("sidebar.consultationRequests"),path:"/consultation-requests"},{id:"consultant-schedule",icon:tt,label:o("sidebar.consultantSchedule"),path:"/consultant-schedule"},{id:"consultant-profile",icon:xr,label:o("sidebar.consultantProfile"),path:"/consultant-profile"},{id:"reviews",icon:at,label:o("sidebar.reviews"),path:"/reviews"}):(i==null?void 0:i.role)==="school"?h.push({id:"users",icon:dt,label:o("sidebar.teachersAndStudents"),path:"/users"},{id:"reports",icon:Zn,label:o("sidebar.reports"),path:"/reports"}):(i==null?void 0:i.role)==="admin"&&h.push({id:"admin-dashboard",icon:Th,label:o("sidebar.adminDashboard"),path:"/admin-dashboard"},{id:"users",icon:dt,label:o("sidebar.users"),path:"/users"}),h.push({id:"settings",icon:vo,label:o("sidebar.settings"),path:"/settings"}),h})();return n.jsxs(n.Fragment,{children:[e&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:t}),n.jsxs(te.div,{initial:!1,animate:{width:r?80:320},transition:{duration:.3,ease:"easeInOut"},className:`
          bg-white shadow-lg border-gray-200 z-50 flex-shrink-0
          ${e?"fixed inset-y-0 lg:relative":"hidden lg:flex lg:flex-col"}
          ${r?"w-20":"w-80"}
          ${c?"border-l":"border-r"}
          ${c?e?"right-0":"":e?"left-0":""}
        `,children:[n.jsx("div",{className:`p-6 border-gray-200 ${r?"px-4":""} border-b`,children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:`flex items-center gap-3 ${r?"justify-center":""}`,children:[n.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center overflow-hidden",children:n.jsx("img",{src:"/logo-primary-backup.png",alt:o("appName"),className:"w-full h-full object-contain"})}),!r&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:o("appName")}),n.jsx("p",{className:"text-sm text-gray-500",children:o("appTagline")})]})]}),n.jsx("button",{onClick:a,className:"hidden lg:flex p-2 rounded-lg hover:bg-gray-100 transition-colors",children:r?c?n.jsx(Dl,{className:"w-5 h-5 text-gray-600"}):n.jsx(Rl,{className:"w-5 h-5 text-gray-600"}):c?n.jsx(Rl,{className:"w-5 h-5 text-gray-600"}):n.jsx(Dl,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors",children:c?n.jsx(Rl,{className:"w-5 h-5 text-gray-600"}):n.jsx(Dl,{className:"w-5 h-5 text-gray-600"})})]})}),n.jsx("nav",{className:`p-4 space-y-2 overflow-y-auto flex-1 ${r?"px-2":""}`,children:f.map(h=>{const m=s.pathname===h.path;return n.jsxs("div",{className:"relative",children:[n.jsxs(Ae,{to:h.path,onClick:t,className:`flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group ${m?"bg-gradient-to-r from-blue-500 via-purple-600 to-pink-600 text-white shadow-lg":"text-gray-600 hover:bg-gray-50 hover:text-gray-800"} ${r?"justify-center px-2":""}`,children:[n.jsx(h.icon,{className:"w-5 h-5 flex-shrink-0"}),!r&&n.jsx("span",{className:"font-medium",children:h.label})]}),r&&n.jsx("div",{className:`absolute ${c?"right-full":"left-full"} top-1/2 transform -translate-y-1/2 ${c?"mr-2":"ml-2"} bg-gray-800 text-white px-2 py-1 rounded text-sm opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10`,children:h.label})]},h.path)})})]})]})},c6=({children:e})=>{const[t,r]=C.useState(!1),[a,s]=C.useState(!1),{i18n:i}=jt(),o=i.language==="ar";return n.jsxs("div",{className:`min-h-screen bg-gray-50 flex ${o?"flex-row-reverse":"flex-row"}`,children:[n.jsx(l6,{isOpen:t,onClose:()=>r(!1),isMinimized:a,onToggleMinimize:()=>s(!a)}),n.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[n.jsx(o6,{onMenuClick:()=>r(!0)}),n.jsx("main",{className:"flex-1 p-6 overflow-auto",children:e})]})]})},d6=()=>{const{t:e}=jt(),[t,r]=C.useState(""),[a,s]=C.useState(""),[i,o]=C.useState(!1),[l,c]=C.useState(!1),[d,u]=C.useState(""),{login:f}=wt(),h=async m=>{m.preventDefault(),u(""),c(!0);try{await f(t,a)}catch(x){console.error("Auth error:",x);let p=e("auth.loginError");if(x instanceof Error){const g=x.message.toLowerCase();g.includes("invalid login credentials")||g.includes("invalid_credentials")||g.includes("user-not-found")||g.includes("wrong-password")?p=e("auth.loginError"):g.includes("email not confirmed")?p=e("auth.emailNotConfirmed"):g.includes("too many requests")?p=e("auth.tooManyRequests"):g.includes("network")||g.includes("fetch")?p=e("auth.networkError"):p=x.message}u(p)}finally{c(!1)}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-md w-full",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx(te.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-4 overflow-hidden",children:n.jsx("img",{src:"/logo-primary-backup.png",alt:e("appName"),className:"w-full h-full object-contain"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("appName")}),n.jsx("p",{className:"text-gray-600",children:e("appTagline")})]}),d&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:d}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.email")}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t,onChange:m=>r(m.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:e("auth.enterEmail"),required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.password")}),n.jsxs("div",{className:"relative",children:[n.jsx(rc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:i?"text":"password",value:a,onChange:m=>s(m.target.value),className:"w-full pr-12 pl-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:e("auth.enterPassword"),required:!0}),n.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?n.jsx(wx,{className:"w-5 h-5"}):n.jsx(nr,{className:"w-5 h-5"})})]})]}),n.jsx(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-medium hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed",children:l?n.jsxs("span",{className:"flex items-center justify-center",children:[n.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[n.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),n.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e("common.loading")]}):e("auth.login")})]}),n.jsxs("div",{className:"mt-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx("div",{className:"w-full border-t border-gray-300"})}),n.jsx("div",{className:"relative flex justify-center text-sm",children:n.jsx("span",{className:"px-2 bg-white text-gray-500",children:e("auth.or")})})]}),n.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-3",children:[n.jsxs(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"button",className:"w-full inline-flex justify-center py-3 px-4 border border-gray-300 rounded-xl bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors",children:[n.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[n.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),n.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),n.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),n.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),n.jsx("span",{className:"mr-2",children:"Google"})]}),n.jsxs(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"button",className:"w-full inline-flex justify-center py-3 px-4 border border-gray-300 rounded-xl bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 transition-colors",children:[n.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:n.jsx("path",{fill:"currentColor",d:"M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.097.118.112.221.083.343-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001.012.001z"})}),n.jsx("span",{className:"mr-2",children:"Apple"})]})]})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsx(Ae,{to:"/summer-program-enrollment",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:'طلب الانضمام للبرنامج الصيفي "صيفي تك"'})}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ae,{to:"/register",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:[e("auth.noAccount")," ",e("auth.createAccount")]})})]})})})},u6=()=>{const{register:e}=wt(),[t,r]=C.useState({name:"",email:"",password:"",confirmPassword:"",phone:"",role:"student",bio:"",school_id:"",grade:"",subject:"",specializations:[],experience_years:0,hourly_rate:150,languages:["العربية"]}),[a,s]=C.useState(!1),[i,o]=C.useState(!1),[l,c]=C.useState(""),[d,u]=C.useState([]),[f,h]=C.useState(!1),m=["الذكاء الاصطناعي","تعلم الآلة","الروبوتات","تطوير التطبيقات","تطوير الويب","قواعد البيانات","الأمن السيبراني","الشبكات","التصميم الجرافيكي","تجربة المستخدم","التسويق الرقمي","ريادة الأعمال","إدارة المشاريع","العلوم","الرياضيات","الفيزياء","الكيمياء","الأحياء","الهندسة الميكانيكية","الهندسة الكهربائية","الهندسة المدنية"],x=["العربية","الإنجليزية","الفرنسية","الإسبانية","الألمانية","الصينية","اليابانية","الروسية","الهندية","البرتغالية"];C.useEffect(()=>{(async()=>{try{h(!0),console.log("Fetching schools...");const w=await x3();if(console.log("Schools data received:",w),w&&Array.isArray(w)){const j=w.map(N=>({id:N.id,name:N.name||"مدرسة بدون اسم"}));console.log("Mapped schools:",j),u(j)}else console.log("No schools data or invalid format:",w),u([])}catch(w){console.error("Error fetching schools:",w),u([])}finally{h(!1)}})()},[]);const p=(v,w)=>{r(j=>({...j,[v]:w}))},g=v=>{r(w=>({...w,specializations:w.specializations.includes(v)?w.specializations.filter(j=>j!==v):[...w.specializations,v]}))},y=v=>{r(w=>({...w,languages:w.languages.includes(v)?w.languages.filter(j=>j!==v):[...w.languages,v]}))},b=async v=>{if(v.preventDefault(),c(""),t.password!==t.confirmPassword){c("كلمات المرور غير متطابقة");return}if(t.password.length<6){c("يجب أن تكون كلمة المرور 6 أحرف على الأقل");return}o(!0);try{await e(t.email,t.password,{name:t.name,role:t.role,phone:t.phone,bio:t.bio,school_id:t.school_id,grade:t.grade,subject:t.subject,specializations:t.specializations,experience_years:t.experience_years,hourly_rate:t.hourly_rate,languages:t.languages})}catch{c("حدث خطأ في إنشاء الحساب")}finally{o(!1)}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsx("div",{className:"max-w-2xl w-full",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx(te.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4 overflow-hidden",children:n.jsx("img",{src:"/logo-primary-backup.png",alt:"مشروعي",className:"w-full h-full object-contain"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"إنشاء حساب جديد"}),n.jsx("p",{className:"text-gray-600",children:"انضم إلى منصة مشروعي"})]}),l&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:l}),n.jsxs("form",{onSubmit:b,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.name,onChange:v=>p("name",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل اسمك الكامل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t.email,onChange:v=>p("email",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل بريدك الإلكتروني",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كلمة المرور"}),n.jsxs("div",{className:"relative",children:[n.jsx(rc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:a?"text":"password",value:t.password,onChange:v=>p("password",v.target.value),className:"w-full pr-12 pl-12 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل كلمة المرور",required:!0}),n.jsx("button",{type:"button",onClick:()=>s(!a),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?n.jsx(wx,{className:"w-5 h-5"}):n.jsx(nr,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تأكيد كلمة المرور"}),n.jsxs("div",{className:"relative",children:[n.jsx(rc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:a?"text":"password",value:t.confirmPassword,onChange:v=>p("confirmPassword",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أعد إدخال كلمة المرور",required:!0})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:t.phone,onChange:v=>p("phone",v.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"05xxxxxxxx"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الحساب"}),n.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="student"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"student",checked:t.role==="student",onChange:()=>p("role","student"),className:"sr-only"}),n.jsx(Ts,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"طالب"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="teacher"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"teacher",checked:t.role==="teacher",onChange:()=>p("role","teacher"),className:"sr-only"}),n.jsx(Nt,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"معلم"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="consultant"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"consultant",checked:t.role==="consultant",onChange:()=>p("role","consultant"),className:"sr-only"}),n.jsx(vi,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"مستشار"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-4 border rounded-xl cursor-pointer transition-colors ${t.role==="school"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"role",value:"school",checked:t.role==="school",onChange:()=>p("role","school"),className:"sr-only"}),n.jsx(Sn,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:"مدرسة"})]})]})]}),t.role==="student"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة"}),n.jsxs("div",{className:"relative",children:[n.jsx(Sn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:t.school_id,onChange:v=>p("school_id",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"اختر المدرسة"}),f?n.jsx("option",{disabled:!0,children:"جاري تحميل المدارس..."}):d.map(v=>n.jsx("option",{value:v.id,children:v.name},v.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الصف الدراسي"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ts,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.grade,onChange:v=>p("grade",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الصف الثالث الثانوي"})]})]})]}),t.role==="teacher"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدرسة"}),n.jsxs("div",{className:"relative",children:[n.jsx(Sn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:t.school_id,onChange:v=>p("school_id",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"اختر المدرسة"}),f?n.jsx("option",{disabled:!0,children:"جاري تحميل المدارس..."}):d.map(v=>n.jsx("option",{value:v.id,children:v.name},v.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصص"}),n.jsxs("div",{className:"relative",children:[n.jsx(Nt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:t.subject,onChange:v=>p("subject",v.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الرياضيات، العلوم، اللغة العربية"})]})]})]}),t.role==="consultant"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نبذة مهنية"}),n.jsx("textarea",{value:t.bio,onChange:v=>p("bio",v.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن خبرتك المهنية..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصصات"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:m.map(v=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${t.specializations.includes(v)?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:t.specializations.includes(v),onChange:()=>g(v),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:v})]},v))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سنوات الخبرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(ar,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:t.experience_years,onChange:v=>p("experience_years",parseInt(v.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"عدد سنوات الخبرة",min:"0"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سعر الساعة (ريال سعودي)"}),n.jsxs("div",{className:"relative",children:[n.jsx(lu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:t.hourly_rate,onChange:v=>p("hourly_rate",parseInt(v.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"سعر الساعة",min:"0"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اللغات"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:x.map(v=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${t.languages.includes(v)?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:t.languages.includes(v),onChange:()=>y(v),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:v})]},v))})]})]}),t.role==="school"&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"معلومات المدرسة"}),n.jsx("textarea",{value:t.bio,onChange:v=>p("bio",v.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن المدرسة..."})]}),n.jsx(te.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:i,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 rounded-xl font-medium hover:shadow-lg transition-all duration-200 disabled:opacity-70 disabled:cursor-not-allowed",children:i?"جاري إنشاء الحساب...":"إنشاء حساب"})]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx(Ae,{to:"/login",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:"لديك حساب بالفعل؟ تسجيل الدخول"})})]})})})},f6=()=>{const{t:e}=jt(),t=[{icon:dt,label:e("home.stats.activeUsers"),value:"147",color:"from-blue-500 to-blue-600"},{icon:Nt,label:e("home.stats.activeProjects"),value:"14",color:"from-green-500 to-green-600"},{icon:ar,label:e("home.stats.completedProjects"),value:"14",color:"from-purple-500 to-purple-600"},{icon:yi,label:e("home.stats.successRate"),value:"100%",color:"from-orange-500 to-orange-600"}],r=[{icon:Nt,title:e("sidebar.projectIdeas"),description:e("home.featuresSection.description"),link:"/project-ideas",color:"from-yellow-400 to-orange-500"},{icon:dt,title:e("sidebar.projects"),description:e("home.featuresSection.description"),link:"/projects",color:"from-blue-500 to-purple-600"},{icon:zt,title:e("sidebar.consultations"),description:e("home.featuresSection.description"),link:"/consultations",color:"from-green-500 to-teal-600"},{icon:Hr,title:e("sidebar.store"),description:e("home.featuresSection.description"),link:"/store",color:"from-pink-500 to-rose-600"},{icon:ti,title:e("sidebar.aiAssistant"),description:e("home.featuresSection.description"),link:"/ai-assistant",color:"from-indigo-500 to-blue-600"},{icon:Il,title:e("sidebar.gallery"),description:e("home.featuresSection.description"),link:"/gallery",color:"from-purple-500 to-pink-600"}],a=[{name:"سارة أحمد",role:"معلمة علوم",content:"منصة مشروعي غيرت طريقة تدريسي تماماً. الطلاب أصبحوا أكثر تفاعلاً وإبداعاً.",avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5},{name:"محمد علي",role:"طالب ثانوي",content:"تمكنت من تطوير مشروع روبوت متقدم بفضل الإرشادات والدعم المتاح في المنصة.",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5},{name:"فاطمة خالد",role:"مديرة مدرسة",content:"المنصة ساعدتنا في تنظيم وإدارة مشاريع الطلاب بكفاءة عالية ومتابعة تقدمهم.",avatar:"https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg?auto=compress&cs=tinysrgb&w=150",rating:5}];return n.jsxs("div",{className:"space-y-8",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600 rounded-3xl p-8 text-white relative overflow-hidden",children:[n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 rounded-3xl"}),n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-2xl flex items-center justify-center backdrop-blur-sm overflow-hidden",children:n.jsx("img",{src:"/mashroui-logo.png",alt:e("appName"),className:"w-full h-full object-contain"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-4xl font-bold mb-2",children:e("home.welcome")}),n.jsx("p",{className:"text-xl opacity-90",children:e("home.tagline")})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-center",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-lg mb-6 opacity-90 leading-relaxed",children:e("home.description")}),n.jsxs("div",{className:"flex flex-wrap gap-4",children:[n.jsxs(Ae,{to:"/project-ideas",className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5"}),e("home.exploreIdeas")]}),n.jsxs(Ae,{to:"/projects",className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5"}),e("home.manageProjects")]})]})]}),n.jsx("div",{className:"hidden md:block",children:n.jsx("div",{className:"rounded-2xl overflow-hidden shadow-2xl",children:n.jsx("img",{src:"https://alandalus.edu.sa/photos/1/makka%20(4).jpg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"طلاب يعملون على مشروع متقدم",className:"w-full h-full object-cover"})})})]})]})]}),n.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:t.map((s,i)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:i*.1},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300",children:[n.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${s.color} rounded-xl flex items-center justify-center mb-4`,children:n.jsx(s.icon,{className:"w-6 h-6 text-white"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:s.value}),n.jsx("p",{className:"text-gray-600 text-sm",children:s.label})]},s.label))}),n.jsxs("div",{children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-8",children:[n.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:e("home.featuresSection.title")}),n.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:e("home.featuresSection.description")})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((s,i)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:i*.1},whileHover:{y:-5},className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 group",children:[n.jsx("div",{className:`w-14 h-14 bg-gradient-to-r ${s.color} rounded-2xl flex items-center justify-center mb-4 group-hover:scale-110 transition-transform duration-300`,children:n.jsx(s.icon,{className:"w-7 h-7 text-white"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-3",children:s.title}),n.jsx("p",{className:"text-gray-600 mb-4 leading-relaxed",children:s.description}),n.jsxs(Ae,{to:s.link,className:"inline-flex items-center gap-2 text-blue-600 font-medium hover:text-blue-800 transition-colors",children:[e("home.featuresSection.exploreMore"),n.jsx(ac,{className:"w-4 h-4"})]})]},s.title))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gray-50 rounded-3xl p-8",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-4",children:e("home.testimonials.title")}),n.jsx("p",{className:"text-gray-600",children:e("home.testimonials.subtitle")})]}),n.jsx("div",{className:"grid md:grid-cols-3 gap-6",children:a.map((s,i)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:i*.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex items-center gap-1 mb-4",children:[...Array(s.rating)].map((o,l)=>n.jsx(at,{className:"w-5 h-5 text-yellow-400 fill-current"},l))}),n.jsxs("p",{className:"text-gray-700 mb-4 leading-relaxed",children:['"',s.content,'"']}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:s.avatar,alt:s.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:s.name}),n.jsx("p",{className:"text-sm text-gray-600",children:s.role})]})]})]},s.name))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-500 to-teal-600 rounded-3xl p-8 text-white text-center",children:[n.jsx("h2",{className:"text-3xl font-bold mb-4",children:e("home.cta.title")}),n.jsx("p",{className:"text-xl mb-6 opacity-90",children:e("home.cta.description")}),n.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[n.jsx(Ae,{to:"/project-ideas",className:"bg-white text-green-600 px-8 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200",children:e("home.cta.exploreIdeas")}),n.jsx(Ae,{to:"/projects",className:"bg-white bg-opacity-20 text-white px-8 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm",children:e("home.cta.createProject")})]})]})]})},h6=()=>{const{user:e,logout:t}=wt(),{t:r}=jt(),a=(e==null?void 0:e.role)==="school",s=(e==null?void 0:e.role)==="consultant";return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8 max-w-2xl w-full",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(_t,{className:"w-10 h-10 text-yellow-600"})}),n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:r("pendingActivation.title")}),n.jsx("p",{className:"text-gray-600 text-lg",children:r(a?"pendingActivation.description.school":s?"pendingActivation.description.consultant":"pendingActivation.description.default")})]}),n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(vt,{className:"w-6 h-6 text-blue-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-blue-800 mb-2",children:r("pendingActivation.whatHappensNext")}),n.jsxs("ul",{className:"space-y-2 text-blue-700",children:[n.jsxs("li",{children:["• ",r("pendingActivation.steps.review")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.verify")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.email")]}),n.jsxs("li",{children:["• ",r("pendingActivation.steps.timeframe")]})]})]})]})}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 mb-6",children:[n.jsx("h2",{className:"font-semibold text-gray-800 mb-4",children:r("pendingActivation.contactInfo")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:r("common.email")}),n.jsx("p",{className:"font-medium",children:e==null?void 0:e.email})]})]}),(e==null?void 0:e.phone)&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:r("common.phone")}),n.jsx("p",{className:"font-medium",children:e.phone})]})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:r("pendingActivation.approvalStates.approved")}),n.jsx("p",{className:"text-sm text-gray-600",children:r("pendingActivation.approvalStates.approvedDesc")})]})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:n.jsx(Br,{className:"w-5 h-5 text-red-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:r("pendingActivation.approvalStates.rejected")}),n.jsx("p",{className:"text-sm text-gray-600",children:r("pendingActivation.approvalStates.rejectedDesc")})]})]})]}),n.jsx("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Ka,{className:"w-6 h-6 text-gray-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h2",{className:"font-semibold text-gray-800 mb-2",children:r("pendingActivation.needHelp")}),n.jsxs("p",{className:"text-gray-600 mb-4",children:[r("pendingActivation.helpText"),n.jsx("a",{href:"mailto:support@mashroui.com",className:"text-blue-600 hover:underline mx-1",children:"support@mashroui.com"})]})]})]})}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsxs("button",{onClick:()=>window.location.reload(),className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[n.jsx(yj,{className:"w-5 h-5"}),r("pendingActivation.refreshPage")]}),n.jsxs("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[n.jsx(qk,{className:"w-5 h-5"}),r("pendingActivation.logout")]})]})]})})},m6=()=>{const{t:e,i18n:t}=jt();Ho();const[r,a]=C.useState({fullName:"",email:"",phone:"",parentPhone:"",city:"",idNumber:"",school:"",grade:"",educationAdministration:"",hasParticipatedBefore:!1,previousProjects:"",interests:[],howDidYouHear:"",notes:""}),[s,i]=C.useState(!1),[o,l]=C.useState(null),[c,d]=C.useState(!1),u=(x,p)=>{a(g=>({...g,[x]:p}))},f=x=>{a(p=>{const g=[...p.interests];return g.includes(x)?{...p,interests:g.filter(y=>y!==x)}:{...p,interests:[...g,x]}})},h=()=>{if(!r.fullName||!r.email||!r.phone||!r.parentPhone||!r.city||!r.idNumber||!r.school||!r.grade||!r.educationAdministration||!r.howDidYouHear||r.interests.length===0)return l(e("summerProgram.enrollmentForm.requiredField")),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email))return l(e("summerProgram.enrollmentForm.invalidEmail")),!1;const p=/^\d{9,15}$/;return!p.test(r.phone.replace(/\D/g,""))||!p.test(r.parentPhone.replace(/\D/g,""))?(l(e("summerProgram.enrollmentForm.invalidPhone")),!1):r.idNumber.length<5?(l(e("summerProgram.enrollmentForm.invalidIdNumber")),!1):!0},m=async x=>{if(x.preventDefault(),!!h()){i(!0),l(null);try{await B3(r),d(!0),a({fullName:"",email:"",phone:"",parentPhone:"",city:"",idNumber:"",school:"",grade:"",educationAdministration:"",hasParticipatedBefore:!1,previousProjects:"",interests:[],howDidYouHear:"",notes:""}),window.scrollTo(0,0)}catch(p){console.error("Error submitting summer program registration:",p),l(e("summerProgram.enrollmentForm.errorMessage"))}finally{i(!1)}}};return n.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 py-12 px-4",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"mb-8 text-center",children:[n.jsx(Ae,{to:"/",className:"inline-block mb-6",children:n.jsx("img",{src:"/logo-primary-backup.png",alt:e("appName"),className:"h-16 w-auto"})}),n.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-800 mb-2",children:e("summerProgram.title")}),n.jsx("p",{className:"text-lg text-gray-600",children:e("summerProgram.subtitle")})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-xl p-8",children:c?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:n.jsx(ze,{className:"w-10 h-10 text-green-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:e("summerProgram.enrollmentForm.successMessage")}),n.jsx("p",{className:"text-gray-600 mb-8",children:"سيتم التواصل معك قريباً بخصوص البرنامج الصيفي. يمكنك العودة إلى الصفحة الرئيسية أو تسجيل الدخول إلى حسابك."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(Ae,{to:"/",className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة للصفحة الرئيسية"}),n.jsx(Ae,{to:"/login",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"تسجيل الدخول"})]})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("summerProgram.enrollmentForm.title")}),n.jsx("p",{className:"text-gray-600",children:e("summerProgram.enrollmentForm.subtitle")})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>t.changeLanguage("ar"),className:`px-3 py-1 rounded-lg ${t.language==="ar"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"العربية"}),n.jsx("button",{onClick:()=>t.changeLanguage("en"),className:`px-3 py-1 rounded-lg ${t.language==="en"?"bg-blue-500 text-white":"bg-gray-100"}`,children:"English"})]})]}),o&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:o})]}),n.jsxs("form",{onSubmit:m,className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-4 flex items-center gap-2",children:[n.jsx(xr,{className:"w-5 h-5"}),t.language==="ar"?"المعلومات الشخصية":"Personal Information"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.fullName")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.fullName,onChange:x=>u("fullName",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.fullNamePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.email")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:r.email,onChange:x=>u("email",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.emailPlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.phone")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:r.phone,onChange:x=>u("phone",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.phonePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.parentPhone")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:r.parentPhone,onChange:x=>u("parentPhone",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.parentPhonePlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.city")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Ef,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.city,onChange:x=>u("city",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.cityPlaceholder")}),e("summerProgram.cities",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.idNumber")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Kk,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.idNumber,onChange:x=>u("idNumber",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.idNumberPlaceholder"),required:!0})]})]})]})]}),n.jsxs("div",{className:"bg-green-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-green-800 mb-4 flex items-center gap-2",children:[n.jsx(bn,{className:"w-5 h-5"}),t.language==="ar"?"المعلومات التعليمية":"Educational Information"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.school")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(bn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:r.school,onChange:x=>u("school",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.schoolPlaceholder"),required:!0})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.grade")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Ts,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.grade,onChange:x=>u("grade",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.gradePlaceholder")}),e("summerProgram.grades",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.educationAdministration")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Sn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.educationAdministration,onChange:x=>u("educationAdministration",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.educationAdministrationPlaceholder")}),e("summerProgram.educationAdministrations",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.hasParticipatedBefore")," *"]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",checked:r.hasParticipatedBefore===!0,onChange:()=>u("hasParticipatedBefore",!0),className:"w-4 h-4 text-blue-600"}),n.jsx("span",{children:e("summerProgram.enrollmentForm.yes")})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",checked:r.hasParticipatedBefore===!1,onChange:()=>u("hasParticipatedBefore",!1),className:"w-4 h-4 text-blue-600"}),n.jsx("span",{children:e("summerProgram.enrollmentForm.no")})]})]})]}),r.hasParticipatedBefore&&n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.previousProjects")," *"]}),n.jsx("textarea",{value:r.previousProjects,onChange:x=>u("previousProjects",x.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.previousProjectsPlaceholder"),required:r.hasParticipatedBefore})]})]})]}),n.jsxs("div",{className:"bg-purple-50 rounded-xl p-4 mb-6",children:[n.jsxs("h3",{className:"text-lg font-semibold text-purple-800 mb-4 flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5"}),t.language==="ar"?"الاهتمامات والتفضيلات":"Interests and Preferences"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.interests")," *"]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:e("summerProgram.interests",{returnObjects:!0}).map(x=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${r.interests.includes(x)?"bg-purple-100 border-purple-500 text-purple-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:r.interests.includes(x),onChange:()=>f(x),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:x})]},x))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("summerProgram.enrollmentForm.howDidYouHear")," *"]}),n.jsxs("div",{className:"relative",children:[n.jsx(Cn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:r.howDidYouHear,onChange:x=>u("howDidYouHear",x.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:e("summerProgram.enrollmentForm.howDidYouHearPlaceholder")}),e("summerProgram.hearAboutUs",{returnObjects:!0}).map(x=>n.jsx("option",{value:x,children:x},x))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.enrollmentForm.notes")}),n.jsxs("div",{className:"relative",children:[n.jsx(Wr,{className:"absolute right-3 top-3 w-5 h-5 text-gray-400"}),n.jsx("textarea",{value:r.notes,onChange:x=>u("notes",x.target.value),rows:4,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("summerProgram.enrollmentForm.notesPlaceholder")})]})]})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Cn,{className:"w-6 h-6 text-yellow-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-yellow-800 mb-2",children:t.language==="ar"?"معلومات مهمة":"Important Information"}),n.jsxs("ul",{className:"space-y-1 text-yellow-700 text-sm",children:[n.jsxs("li",{children:["• ",t.language==="ar"?"سيتم مراجعة طلبك والرد عليك في أقرب وقت ممكن.":"Your application will be reviewed and we will respond as soon as possible."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"يرجى التأكد من صحة جميع المعلومات المقدمة.":"Please ensure all provided information is accurate."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"سيتم التواصل معك عبر البريد الإلكتروني أو الهاتف المقدم.":"You will be contacted via the provided email or phone number."]}),n.jsxs("li",{children:["• ",t.language==="ar"?"البرنامج مخصص للطلاب في المرحلة المتوسطة والثانوية.":"The program is designed for middle and high school students."]})]})]})]})}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:s,className:"px-8 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("summerProgram.enrollmentForm.submitting")]}):n.jsxs(n.Fragment,{children:[n.jsx(jx,{className:"w-5 h-5"}),e("summerProgram.enrollmentForm.submit")]})})})]})]})}),n.jsxs("div",{className:"mt-8 text-center text-gray-600 text-sm",children:[n.jsxs("p",{children:["© 2025 ",e("appName")," - ",e("appTagline")]}),n.jsxs("div",{className:"mt-2 flex justify-center gap-4",children:[n.jsx(Ae,{to:"/",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"الصفحة الرئيسية":"Home"}),n.jsx(Ae,{to:"/login",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"تسجيل الدخول":"Login"}),n.jsx(Ae,{to:"/register",className:"hover:text-blue-600 transition-colors",children:t.language==="ar"?"إنشاء حساب":"Register"})]})]})]})})},Ds=()=>{const[e,t]=C.useState([]),[r,a]=C.useState([]),[s,i]=C.useState(!0),[o,l]=C.useState(null),{user:c}=wt(),d=async()=>{try{i(!0),console.log("Fetching consultants...");const x=await y3();console.log("Consultants data received:",x),a(x||[])}catch(x){console.error("Error fetching consultants:",x),l(x instanceof Error?x.message:"حدث خطأ في تحميل المستشارين")}finally{i(!1)}},u=async()=>{if(c)try{i(!0),l(null);const x=Me(pe,"consultations");let p;if(c.role==="student")p=et(x,We("student_id","==",c.id));else if(c.role==="teacher"||c.role==="consultant"){const b=et(x,We("mentor_id","==",c.id)),v=await Je(b),w=et(x,We("mentor_id","==",null)),j=await Je(w),N=[...v.docs,...j.docs];if(N.length===0){t([]),i(!1);return}const _=await Promise.all(N.map(async E=>{const S=E.data();let k=null;if(S.mentor_id)try{const O=Re(pe,"users",S.mentor_id),P=await fr(O);P.exists()&&(k=P.data().name)}catch(O){console.error("Error fetching mentor data:",O)}return{id:E.id,mentor_id:S.mentor_id||null,mentor_name:k,student_id:S.student_id,project_id:S.project_id||null,topic:S.topic,description:S.description,type:S.type,status:S.status,method:S.method||"video",duration:S.duration||60,scheduledDate:S.scheduled_at?new Date(S.scheduled_at.toDate()).toISOString():void 0,preferredDate:S.preferred_date?new Date(S.preferred_date.toDate()).toISOString():void 0,completedAt:S.completed_at?new Date(S.completed_at.toDate()).toISOString():void 0,rating:S.rating,feedback:S.feedback,createdAt:S.created_at?new Date(S.created_at.toDate()).toISOString():new Date().toISOString()}}));t(_),i(!1);return}else p=x;const g=await Je(p);if(g.empty){t([]),i(!1);return}const y=await Promise.all(g.docs.map(async b=>{const v=b.data();let w=null;if(v.mentor_id)try{const j=Re(pe,"users",v.mentor_id),N=await fr(j);N.exists()&&(w=N.data().name)}catch(j){console.error("Error fetching mentor data:",j)}return{id:b.id,mentor_id:v.mentor_id||null,mentor_name:w,student_id:v.student_id,project_id:v.project_id||null,topic:v.topic,description:v.description,type:v.type,status:v.status,method:v.method||"video",duration:v.duration||60,scheduledDate:v.scheduled_at?new Date(v.scheduled_at.toDate()).toISOString():void 0,preferredDate:v.preferred_date?new Date(v.preferred_date.toDate()).toISOString():void 0,completedAt:v.completed_at?new Date(v.completed_at.toDate()).toISOString():void 0,rating:v.rating,feedback:v.feedback,createdAt:v.created_at?new Date(v.created_at.toDate()).toISOString():new Date().toISOString()}}));t(y)}catch(x){console.error("Error fetching consultations:",x),l(x instanceof Error?x.message:"حدث خطأ في تحميل الاستشارات")}finally{i(!1)}},f=async x=>{if(!c)throw new Error("يجب تسجيل الدخول أولاً");try{const p=Me(pe,"consultations"),g={student_id:c.id,mentor_id:x.mentor_id||null,project_id:x.project_id||null,topic:x.topic,description:x.description,type:x.type,status:x.status||"pending",method:x.method||"video",duration:x.duration||60,scheduled_at:x.scheduledDate?an.fromDate(new Date(x.scheduledDate)):null,preferred_date:x.preferredDate?an.fromDate(new Date(x.preferredDate)):null,created_at:Ve()},y=await Aa(p,g);return await u(),{id:y.id,...g}}catch(p){throw console.error("Error creating consultation:",p),p}},h=async(x,p)=>{try{const g=Re(pe,"consultations",x),y={};p.status&&(y.status=p.status),p.mentor_id&&(y.mentor_id=p.mentor_id),p.scheduledDate&&(y.scheduled_at=an.fromDate(new Date(p.scheduledDate))),p.completedAt&&(y.completed_at=an.fromDate(new Date(p.completedAt))),p.rating!==void 0&&(y.rating=p.rating),p.feedback&&(y.feedback=p.feedback),y.updated_at=Ve(),await Ht(g,y),await u()}catch(g){throw console.error("Error updating consultation:",g),g}},m=async(x,p)=>{if(!c)throw new Error("يجب تسجيل الدخول أولاً");try{const g=Re(pe,"consultations",x),y={mentor_id:c.id,status:"scheduled",updated_at:Ve()};p&&(y.scheduled_at=an.fromDate(new Date(p))),await Ht(g,y),await u()}catch(g){throw console.error("Error accepting consultation:",g),g}};return C.useEffect(()=>{c&&(u(),d())},[c]),{consultations:e,consultants:r,loading:s,error:o,fetchConsultations:u,fetchConsultants:d,createConsultation:f,updateConsultation:h,acceptConsultation:m}},Of=e=>{if(!e)return null;try{if(e instanceof an)return e.toDate();if(e instanceof Date)return e;if(typeof e=="string"){if(!isNaN(Number(e)))return new Date(Number(e));const t=new Date(e);return isNaN(t.getTime())?null:t}return null}catch(t){return console.error("Error converting to Date object:",t),null}},Ze=(e,t)=>{const r=Of(e);if(!r)return"غير محدد";const a={year:"numeric",month:"long",day:"numeric",calendar:"gregory"};return r.toLocaleDateString("ar-SA",{...a,...t})},El=e=>{const t=Of(e);if(!t)return null;try{const r=new Date;r.setHours(0,0,0,0);const a=new Date(t);a.setHours(0,0,0,0);const s=a.getTime()-r.getTime();return Math.ceil(s/(1e3*60*60*24))}catch(r){return console.error("Error calculating days remaining:",r),null}},R0=e=>{const t=Of(e);return t?t.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",calendar:"gregory"}):""},x6=e=>{const t=Of(e);if(!t)return"";const a=Math.floor((new Date().getTime()-t.getTime())/1e3);if(a<60)return"الآن";const s=Math.floor(a/60);if(s<60)return`منذ ${s} دقيقة`;const i=Math.floor(s/60);if(i<24)return`منذ ${i} ساعة`;const o=Math.floor(i/24);if(o<30)return`منذ ${o} يوم`;const l=Math.floor(o/30);return l<12?`منذ ${l} شهر`:`منذ ${Math.floor(l/12)} سنة`},Ii=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=wt(),l=async()=>{if(!o){console.log("No user found, skipping project fetch");return}try{a(!0),i(null),console.log("Fetching projects for user:",{id:o.id,role:o.role,school_id:o.school_id});let h=[];if(o.role==="teacher"){console.log("Fetching projects for teacher with ID:",o.id);const x=await w3(o.id);console.log("Teacher assigned projects fetched:",x.length);const p=et(Me(pe,"projects"),We("school_id","==",o.school_id),We("status","==","draft")),y=(await Je(p)).docs.map(v=>{const w=v.data();return{id:v.id,...w,due_date:w.due_date?w.due_date.toDate().toISOString():null,created_at:w.created_at?w.created_at.toDate().toISOString():new Date().toISOString(),updated_at:w.updated_at?w.updated_at.toDate().toISOString():new Date().toISOString()}});console.log("School draft projects fetched:",y.length);const b=new Map;x.forEach(v=>{b.set(v.id,v)}),y.forEach(v=>{b.has(v.id)||b.set(v.id,v)}),h=Array.from(b.values()),console.log("Combined unique projects:",h.length)}else o.role==="student"?(console.log("Fetching projects for student with ID:",o.id),h=await N3(o.id),console.log("Student projects fetched:",h.length)):o.role==="school"?(console.log("Fetching projects for school user with Firebase UID:",o.id),h=await j3(o.id),console.log("School projects fetched:",h.length)):o.role==="admin"&&(console.log("Fetching all projects for admin user"),h=await b3(),console.log("All projects fetched:",h.length));console.log("Raw projects data:",h);const m=await Promise.all(h.map(async x=>{try{const p=await oc(x.id),g=await Ph(x.id);let y=0;try{const b=Me(pe,"project_evaluations"),v=et(b,We("projectId","==",x.id)),w=await Je(v);if(w.empty)console.log(`No evaluation found for project ${x.id}, using default progress:`,y);else{const N=w.docs[0].data();N.criteria&&N.criteria.length>0&&(y=N.criteria[0].score||0,console.log(`Found evaluation for project ${x.id}, completion score:`,y))}}catch(b){console.error(`Error fetching evaluation for project ${x.id}:`,b)}return{...x,progress:y,students:p,tasks:g}}catch(p){return console.error("Error enhancing project:",x.id,p),{...x,progress:0,students:[],tasks:[]}}}));console.log("Enhanced projects:",m),t(m)}catch(h){console.error("Error fetching projects:",h),i(h instanceof Error?h.message:"حدث خطأ في تحميل المشاريع")}finally{a(!1)}},c=async h=>{if(!o)throw new Error("يجب تسجيل الدخول أولاً");try{const m=o.role==="school"?o.id:o.school_id,x=await _3({...h,teacher_id:o.role==="teacher"?o.id:null,school_id:m,progress:0});if(h.selectedStudentIds&&h.selectedStudentIds.length>0)for(let p=0;p<h.selectedStudentIds.length;p++){const g=h.selectedStudentIds[p];await Oh({project_id:x.id,student_id:g,role:p===0?"leader":"member"})}return await l(),x}catch(m){throw m}},d=async(h,m)=>{try{if(await Sg(h,m),m.selectedStudentIds){const x=await oc(h);for(const p of x)m.selectedStudentIds.includes(p.student_id)||await k3(h,p.student_id);for(let p=0;p<m.selectedStudentIds.length;p++){const g=m.selectedStudentIds[p];x.find(b=>b.student_id===g)||await Oh({project_id:h,student_id:g,role:p===0?"leader":"member"})}}await l()}catch(x){throw x}},u=async h=>{try{await Sg(h,{status:"archived"}),await l()}catch(m){throw m}},f=async h=>{try{await S3(h),await l()}catch(m){throw m}};return C.useEffect(()=>{o&&l()},[o]),{projects:e,loading:r,error:s,fetchProjects:l,createProject:c,updateProject:d,archiveProject:u,deleteProject:f}},p6=({onClose:e,onSubmit:t})=>{const{user:r}=wt(),{projects:a}=Ii(),[s,i]=C.useState({topic:"",description:"",type:"technical",method:"video",duration:60,project_id:"",preferredDate:""}),[o,l]=C.useState(!1),[c,d]=C.useState(null),u=[{id:"technical",name:"استشارة تقنية",description:"استشارة في مجال التقنية والبرمجة"},{id:"academic",name:"استشارة أكاديمية",description:"استشارة في المجالات الأكاديمية والتعليمية"},{id:"career",name:"استشارة مهنية",description:"استشارة في التطوير المهني والوظيفي"},{id:"project",name:"استشارة مشروع",description:"استشارة متعلقة بمشروع محدد"}],f=[{id:"video",name:"مكالمة فيديو",icon:wr},{id:"phone",name:"مكالمة صوتية",icon:Pr},{id:"chat",name:"محادثة نصية",icon:Wr}],h=[{value:30,label:"30 دقيقة"},{value:60,label:"ساعة واحدة"},{value:90,label:"ساعة ونصف"},{value:120,label:"ساعتان"}],m=(g,y)=>{i(b=>({...b,[g]:y}))},x=async g=>{if(g.preventDefault(),!s.topic||!s.description){d("يرجى ملء جميع الحقول المطلوبة");return}l(!0),d(null);try{await t(s)}catch(y){console.error("Error submitting consultation request:",y),d(y instanceof Error?y.message:"حدث خطأ في إرسال طلب الاستشارة")}finally{l(!1)}},p=a.filter(g=>g.status==="active");return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(zt,{className:"w-6 h-6 text-blue-600"}),"طلب استشارة جديدة"]}),n.jsx("button",{onClick:e,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الاستشارة *"}),n.jsx("input",{type:"text",value:s.topic,onChange:g=>m("topic",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان الاستشارة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الاستشارة *"}),n.jsx("textarea",{value:s.description,onChange:g=>m("description",g.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اشرح تفاصيل الاستشارة واحتياجاتك بوضوح",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.type===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"type",value:g.id,checked:s.type===g.id,onChange:()=>m("type",g.id),className:"sr-only"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:g.name}),n.jsx("p",{className:"text-xs text-gray-500",children:g.description})]})]},g.id))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الاستشارة *"}),n.jsx("div",{className:"space-y-2",children:f.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:g.id,checked:s.method===g.id,onChange:()=>m("method",g.id),className:"sr-only"}),n.jsx(g.icon,{className:"w-5 h-5"}),n.jsx("span",{children:g.name})]},g.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مدة الاستشارة *"}),n.jsx("div",{className:"space-y-2",children:h.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===g.value?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:g.value,checked:s.duration===g.value,onChange:()=>m("duration",g.value),className:"sr-only"}),n.jsx(_t,{className:"w-5 h-5"}),n.jsx("span",{children:g.label})]},g.value))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المشروع المرتبط (اختياري)"}),n.jsxs("select",{value:s.project_id,onChange:g=>m("project_id",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"بدون مشروع"}),p.map(g=>n.jsx("option",{value:g.id,children:g.title},g.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التاريخ المفضل (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx(tt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"datetime-local",value:s.preferredDate,onChange:g=>m("preferredDate",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(Cn,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات مهمة"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• سيتم مراجعة طلبك وتعيين معلم مناسب في أقرب وقت"}),n.jsx("li",{children:"• سيتم إرسال رابط الاستشارة قبل الموعد بـ 15 دقيقة"}),n.jsx("li",{children:"• يمكنك إلغاء الاستشارة قبل 24 ساعة من الموعد"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:e,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإرسال..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),"إرسال الطلب"]})})]})]})]})})},g6=({consultation:e,onClose:t,onUpdate:r})=>{const[a,s]=C.useState(e.rating||0),[i,o]=C.useState(e.feedback||""),[l,c]=C.useState(!1),[d,u]=C.useState(null),[f,h]=C.useState(!1),m=v=>{switch(v){case"video":return n.jsx(wr,{className:"w-5 h-5"});case"phone":return n.jsx(Pr,{className:"w-5 h-5"});case"chat":return n.jsx(Wr,{className:"w-5 h-5"});default:return n.jsx(zt,{className:"w-5 h-5"})}},x=v=>{switch(v){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";case"screen_share":return"مشاركة الشاشة";default:return v}},p=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=v=>{switch(v){case"pending":return"في الانتظار";case"scheduled":return"مجدولة";case"completed":return"مكتملة";case"cancelled":return"ملغية";default:return v}},y=async()=>{if(a===0){u("يرجى اختيار تقييم");return}c(!0),u(null);try{await r(e.id,{rating:a,feedback:i,status:"completed"})}catch(v){console.error("Error submitting rating:",v),u(v instanceof Error?v.message:"حدث خطأ في إرسال التقييم")}finally{c(!1)}},b=async()=>{if(confirm("هل أنت متأكد من إلغاء هذه الاستشارة؟")){c(!0);try{await r(e.id,{status:"cancelled"})}catch(v){console.error("Error cancelling consultation:",v),u(v instanceof Error?v.message:"حدث خطأ في إلغاء الاستشارة")}finally{c(!1)}}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(zt,{className:"w-6 h-6 text-blue-600"}),"تفاصيل الاستشارة"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(AlertTriangle,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:d})]}),n.jsx("div",{className:"flex items-center gap-4 p-4 bg-blue-50 rounded-xl mb-6",children:n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:e.mentor_name||"معلم غير معين"}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${p(e.status)}`,children:g(e.status)})]}),n.jsx("p",{className:"text-gray-600 text-sm",children:"معلم"})]})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(zt,{className:"w-5 h-5 text-blue-600"}),"موضوع الاستشارة"]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h5",{className:"font-semibold text-gray-800 mb-2",children:e.topic}),n.jsx("p",{className:"text-gray-700",children:e.description})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تفاصيل الاستشارة"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[m(e.method),n.jsxs("span",{children:["طريقة الاستشارة: ",x(e.method)]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(_t,{className:"w-5 h-5"}),n.jsxs("span",{children:["المدة: ",e.duration," دقيقة"]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5"}),n.jsxs("span",{children:["تاريخ الإنشاء: ",Ze(e.createdAt)]})]})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"معلومات الموعد"}),n.jsxs("div",{className:"space-y-3",children:[e.scheduledDate?n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5 text-blue-600"}),n.jsxs("span",{children:["موعد الاستشارة: ",Ze(e.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})]})]}):e.preferredDate?n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5 text-yellow-600"}),n.jsxs("span",{children:["الموعد المفضل: ",Ze(e.preferredDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})]})]}):n.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[n.jsx(tt,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{children:"لم يتم تحديد موعد بعد"})]}),e.status==="scheduled"&&n.jsx("div",{className:"mt-2",children:n.jsxs("a",{href:"https://meet.google.com/new",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[n.jsx(wr,{className:"w-4 h-4"}),"انضمام للاستشارة"]})})]})]})]}),e.status==="completed"&&e.rating?n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تقييمك للاستشارة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[[1,2,3,4,5].map(v=>n.jsx(at,{className:`w-6 h-6 ${v<=e.rating?"text-yellow-400 fill-current":"text-gray-300"}`},v)),n.jsxs("span",{className:"text-gray-700 mr-2",children:[e.rating,"/5"]})]}),e.feedback&&n.jsx("p",{className:"text-gray-700",children:e.feedback})]})]}):e.status==="completed"&&!f?n.jsx("div",{className:"text-center py-4",children:n.jsx("button",{onClick:()=>h(!0),className:"px-6 py-3 bg-yellow-500 text-white rounded-xl hover:bg-yellow-600 transition-colors",children:"تقييم الاستشارة"})}):f&&n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تقييم الاستشارة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("div",{className:"flex items-center justify-center gap-2 mb-4",children:[1,2,3,4,5].map(v=>n.jsx("button",{type:"button",onClick:()=>s(v),className:"focus:outline-none",children:n.jsx(at,{className:`w-8 h-8 ${v<=a?"text-yellow-400 fill-current":"text-gray-300"}`})},v))}),n.jsx("textarea",{value:i,onChange:v=>o(v.target.value),placeholder:"اكتب تعليقك حول الاستشارة...",rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n.jsx("div",{className:"flex justify-end mt-3",children:n.jsx("button",{type:"button",onClick:y,disabled:l,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"جاري الإرسال...":"إرسال التقييم"})})]})]}),n.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[n.jsx("div",{children:(e.status==="pending"||e.status==="scheduled")&&n.jsx("button",{type:"button",onClick:b,disabled:l,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"جاري الإلغاء...":"إلغاء الاستشارة"})}),n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 bg-gray-200 text-gray-800 rounded-xl hover:bg-gray-300 transition-colors",children:"إغلاق"})]})]})]})})},Fj=({consultant:e,onClose:t,onSubmit:r})=>{const{t:a}=jt(),[s,i]=C.useState({topic:"",description:"",type:"technical",method:"video",duration:60,scheduledDate:""}),[o,l]=C.useState(!1),[c,d]=C.useState(null),u=[{id:"technical",name:"استشارة تقنية"},{id:"academic",name:"استشارة أكاديمية"},{id:"career",name:"استشارة مهنية"},{id:"project",name:"استشارة مشروع"}],f=[{id:"video",name:"مكالمة فيديو",icon:wr},{id:"phone",name:"مكالمة صوتية",icon:Pr},{id:"chat",name:"محادثة نصية",icon:Wr}],h=[{value:30,label:"30 دقيقة",price:e.hourlyRate/2},{value:60,label:"ساعة واحدة",price:e.hourlyRate},{value:90,label:"ساعة ونصف",price:e.hourlyRate*1.5},{value:120,label:"ساعتان",price:e.hourlyRate*2}],x=(()=>{const v=[],w=new Date;for(let j=1;j<=7;j++){const N=new Date(w);N.setDate(N.getDate()+j);const _=new Date(N);_.setHours(10,0,0,0),v.push(_);const E=new Date(N);E.setHours(14,0,0,0),v.push(E);const S=new Date(N);S.setHours(18,0,0,0),v.push(S)}return v})(),p=(v,w)=>{i(j=>({...j,[v]:w}))},g=async v=>{if(v.preventDefault(),!s.topic||!s.description||!s.scheduledDate){d("يرجى ملء جميع الحقول المطلوبة");return}l(!0),d(null);try{await r({...s,mentor_id:e.id,status:"scheduled"})}catch(w){console.error("Error booking consultation:",w),d(w instanceof Error?w.message:"حدث خطأ في حجز الاستشارة")}finally{l(!1)}},y=h.find(v=>v.value===s.duration),b=y?y.price:e.hourlyRate;return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-6 h-6 text-indigo-600"}),"حجز استشارة مع ",e.name]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-indigo-50 rounded-xl mb-6",children:[n.jsx("img",{src:e.avatar,alt:e.name,className:"w-16 h-16 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:e.name}),n.jsx("p",{className:"text-gray-600",children:e.title}),n.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsxs("span",{className:"text-sm",children:[e.rating," (",e.reviews," تقييم)"]})]})]})]}),n.jsxs("form",{onSubmit:g,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الاستشارة *"}),n.jsx("input",{type:"text",value:s.topic,onChange:v=>p("topic",v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"أدخل عنوان الاستشارة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الاستشارة *"}),n.jsx("textarea",{value:s.description,onChange:v=>p("description",v.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"اشرح تفاصيل الاستشارة واحتياجاتك بوضوح",required:!0})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نوع الاستشارة *"}),n.jsx("select",{value:s.type,onChange:v=>p("type",v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:u.map(v=>n.jsx("option",{value:v.id,children:v.name},v.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"طريقة الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-3 gap-2",children:f.map(v=>n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===v.id?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:v.id,checked:s.method===v.id,onChange:()=>p("method",v.id),className:"sr-only"}),n.jsx(v.icon,{className:"w-5 h-5"}),n.jsx("span",{children:v.name})]},v.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مدة الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:h.map(v=>n.jsxs("label",{className:`flex flex-col items-center p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===v.value?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:v.value,checked:s.duration===v.value,onChange:()=>p("duration",v.value),className:"sr-only"}),n.jsx(_t,{className:"w-5 h-5 mb-1"}),n.jsx("span",{children:v.label}),n.jsxs("span",{className:"text-xs mt-1",children:[v.price," ر.س"]})]},v.value))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اختر موعد الاستشارة *"}),n.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-48 overflow-y-auto p-2",children:x.map((v,w)=>n.jsxs("label",{className:`flex flex-col items-center p-3 border rounded-xl cursor-pointer transition-colors ${s.scheduledDate===v.toISOString()?"bg-indigo-50 border-indigo-500 text-indigo-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"scheduledDate",value:v.toISOString(),checked:s.scheduledDate===v.toISOString(),onChange:()=>p("scheduledDate",v.toISOString()),className:"sr-only"}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-medium",children:v.toLocaleDateString("ar-SA",{weekday:"short",day:"numeric",month:"short"})}),n.jsx("div",{className:"text-sm",children:v.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"})})]})]},w))})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"ملخص الحجز"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:["سعر الاستشارة (",y==null?void 0:y.label,")"]}),n.jsxs("span",{children:[b," ر.س"]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{children:[(b*.15).toFixed(2)," ر.س"]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-2 mt-2",children:n.jsxs("div",{className:"flex justify-between font-bold",children:[n.jsx("span",{children:"المجموع"}),n.jsxs("span",{children:[(b*1.15).toFixed(2)," ر.س"]})]})})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(Cn,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات مهمة"}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsx("li",{children:"• سيتم إرسال رابط الاستشارة قبل الموعد بـ 15 دقيقة"}),n.jsx("li",{children:"• يمكنك إلغاء الاستشارة قبل 24 ساعة من الموعد"}),n.jsx("li",{children:"• سيتم خصم المبلغ عند تأكيد الحجز"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحجز..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ri,{className:"w-5 h-5"}),"تأكيد الحجز"]})})]})]})]})})},v6=()=>{const{t:e,i18n:t}=jt(),[r,a]=C.useState("my-consultations"),[s,i]=C.useState("all"),[o,l]=C.useState("all"),[c,d]=C.useState(""),[u,f]=C.useState(!1),[h,m]=C.useState(null),[x,p]=C.useState(null),[g,y]=C.useState(!1),{consultations:b,consultants:v,loading:w,error:j,fetchConsultations:N,fetchConsultants:_,createConsultation:E,updateConsultation:S}=Ds();C.useEffect(()=>{console.log("i18n initialization status:",{language:t.language,isInitialized:t.isInitialized,availableLanguages:t.languages})},[t.language,t.isInitialized]),C.useEffect(()=>{_()},[]);const k=[{id:"all",name:e("consultations.types.all")},{id:"technical",name:e("consultations.types.technical")},{id:"academic",name:e("consultations.types.academic")},{id:"career",name:e("consultations.types.career")},{id:"project",name:e("consultations.types.project")}],O=[{id:"all",name:e("consultations.statuses.all"),color:"bg-yellow-100 text-yellow-800",icon:_t},{id:"pending",name:e("consultations.statuses.pending"),color:"bg-yellow-100 text-yellow-800",icon:_t},{id:"scheduled",name:e("consultations.statuses.scheduled"),color:"bg-blue-100 text-blue-800",icon:tt},{id:"completed",name:e("consultations.statuses.completed"),color:"bg-green-100 text-green-800",icon:ze},{id:"cancelled",name:e("consultations.statuses.cancelled"),color:"bg-red-100 text-red-800",icon:Br}],P=b.filter(K=>{const B=s==="all"||K.type===s,L=o==="all"||K.status===o,ee=K.topic.toLowerCase().includes(c.toLowerCase())||K.description.toLowerCase().includes(c.toLowerCase());return B&&L&&ee}),A=K=>O.find(L=>L.id===K)||{name:K,color:"bg-gray-100 text-gray-800",icon:ca},R=K=>{switch(K){case"video":return n.jsx(wr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Wr,{className:"w-4 h-4"});default:return n.jsx(zt,{className:"w-4 h-4"})}},T=K=>{switch(K){case"video":return e("consultations.methods.video");case"phone":return e("consultations.methods.phone");case"chat":return e("consultations.methods.chat");case"screen_share":return e("consultations.methods.screenShare");default:return K}},F=async K=>{try{await E(K),f(!1),y(!1),N()}catch(B){console.error("Error creating consultation:",B)}},W=async(K,B)=>{try{await S(K,B),m(null),N()}catch(L){console.error("Error updating consultation:",L)}};return w?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):j?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:j})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(zt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("consultations.title")}),n.jsx("p",{className:"opacity-90",children:e("consultations.subtitle")})]})]}),n.jsxs("button",{onClick:()=>f(!0),className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),e("consultations.requestConsultation")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.filter(K=>K.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.scheduled")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.filter(K=>K.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.completed")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:b.filter(K=>K.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("consultations.stats.pending")})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex",children:[n.jsx("button",{onClick:()=>a("my-consultations"),className:`px-4 py-4 font-medium text-sm border-b-2 ${r==="my-consultations"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e("consultations.tabs.myConsultations")}),n.jsx("button",{onClick:()=>a("search-consultants"),className:`px-4 py-4 font-medium text-sm border-b-2 ${r==="search-consultants"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e("consultations.tabs.searchConsultants")})]})}),r==="my-consultations"&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("consultations.searchPlaceholder"),value:c,onChange:K=>d(K.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsx("select",{value:s,onChange:K=>i(K.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:k.map(K=>n.jsx("option",{value:K.id,children:K.name},K.id))}),n.jsx("select",{value:o,onChange:K=>l(K.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:O.map(K=>n.jsx("option",{value:K.id,children:K.name},K.id))})]}),n.jsx("div",{className:"space-y-4",children:P.map((K,B)=>{const L=A(K.status);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:B*.1},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:K.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${L.color}`,children:L.name})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:K.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{children:[e("consultations.consultant"),": ",K.mentor_name||e("consultations.unassigned")]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[R(K.method),T(K.method)]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),K.duration," ",e("consultations.minutes")]})]})]}),n.jsxs("div",{className:"text-right",children:[K.status==="scheduled"&&K.scheduledDate&&n.jsxs("div",{className:"text-sm",children:[n.jsx("div",{className:"font-medium text-gray-800",children:e("consultations.appointmentTime")}),n.jsx("div",{className:"text-gray-600",children:Ze(K.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})})]}),K.status==="completed"&&K.rating&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:K.rating})]})]})]}),K.status==="completed"&&K.feedback&&n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mt-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("consultations.yourFeedback"),":"]}),n.jsx("p",{className:"text-gray-700 text-sm",children:K.feedback})]}),n.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[e("consultations.created"),": ",Ze(K.createdAt)]}),n.jsxs("div",{className:"flex gap-2",children:[K.status==="scheduled"&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm flex items-center gap-2",children:[n.jsx(wr,{className:"w-4 h-4"}),e("consultations.joinConsultation")]}),n.jsx("button",{onClick:()=>m(K.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.reschedule")})]}),K.status==="pending"&&n.jsx("button",{onClick:()=>m(K.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.editRequest")}),K.status==="completed"&&!K.rating&&n.jsx("button",{onClick:()=>m(K.id),className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm",children:e("consultations.rateConsultation")}),n.jsx("button",{onClick:()=>m(K.id),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("consultations.viewDetails")})]})]})]},K.id)})}),P.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(zt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("consultations.noConsultations")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("consultations.startByRequesting")}),n.jsx("button",{onClick:()=>f(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("consultations.requestNewConsultation")})]})]}),r==="search-consultants"&&n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("consultations.searchConsultantPlaceholder"),value:c,onChange:K=>d(K.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),!1,t.isInitialized?n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((K,B)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:B*.1},className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("img",{src:K.avatar,alt:K.name,className:"w-20 h-20 rounded-full object-cover mx-auto mb-3"}),n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-1",children:K.name}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:K.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:K.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",K.reviews," ",e("search.reviews"),")"]})]})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-1",children:[e("search.specialties"),":"]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[(K.specialties||[]).slice(0,3).map((L,ee)=>n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-lg",children:L},ee)),(K.specialties||[]).length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",(K.specialties||[]).length-3]})]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.price"),":"]}),n.jsxs("span",{className:"font-medium text-blue-600",children:[K.hourlyRate," ",e("search.pricePerHour")]})]})]}),n.jsx("button",{onClick:()=>{p(K.id),y(!0)},className:"w-full bg-blue-500 text-white py-2 rounded-xl hover:bg-blue-600 transition-colors font-medium",children:e("search.bookConsultation")})]},K.id))}):n.jsx("div",{className:"flex justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),v.length===0&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(xr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("consultations.noConsultants")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("consultations.noConsultantsAvailable")}),n.jsx(Ae,{to:"/search",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("consultations.advancedSearch")})]})]})]}),u&&n.jsx(p6,{onClose:()=>f(!1),onSubmit:F}),h&&n.jsx(g6,{consultation:b.find(K=>K.id===h),onClose:()=>m(null),onUpdate:W}),g&&x&&n.jsx(Fj,{consultant:v.find(K=>K.id===x),onClose:()=>{p(null),y(!1)},onSubmit:F}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:n.jsx(Cn,{className:"w-5 h-5 text-indigo-600"})}),n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:e("consultations.howToUse.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"1"}),e("consultations.howToUse.step1.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step1.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"2"}),e("consultations.howToUse.step2.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step2.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-5 shadow-sm",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx("span",{className:"w-6 h-6 bg-indigo-100 rounded-full flex items-center justify-center text-sm text-indigo-600",children:"3"}),e("consultations.howToUse.step3.title")]}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("consultations.howToUse.step3.description")})]})]})]})]})},y6=()=>{const{t:e}=jt(),{consultations:t,loading:r,error:a}=Ds(),[s,i]=C.useState("all"),[o,l]=C.useState(""),c=t.filter(m=>{const x=s==="all"||m.status===s,p=m.topic.toLowerCase().includes(o.toLowerCase())||m.description.toLowerCase().includes(o.toLowerCase());return x&&p}),d=m=>{switch(m){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},u=m=>{switch(m){case"pending":return e("consultations.statuses.pending");case"scheduled":return e("consultations.statuses.scheduled");case"completed":return e("consultations.statuses.completed");case"cancelled":return e("consultations.statuses.cancelled");default:return m}},f=m=>{switch(m){case"video":return n.jsx(wr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Wr,{className:"w-4 h-4"});default:return n.jsx(zt,{className:"w-4 h-4"})}},h=m=>{switch(m){case"video":return e("consultations.methods.video");case"phone":return e("consultations.methods.phone");case"chat":return e("consultations.methods.chat");default:return m}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(yr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("myConsultations.title")}),n.jsx("p",{className:"opacity-90",children:e("myConsultations.subtitle")})]})]}),n.jsxs(Ae,{to:"/consultations",className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),e("myConsultations.newRequest")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(m=>m.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.pending")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(m=>m.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.scheduled")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(m=>m.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("myConsultations.stats.completed")})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("myConsultations.searchPlaceholder"),value:o,onChange:m=>l(m.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("select",{value:s,onChange:m=>i(m.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("myConsultations.filters.allStatuses")}),n.jsx("option",{value:"pending",children:e("consultations.statuses.pending")}),n.jsx("option",{value:"scheduled",children:e("consultations.statuses.scheduled")}),n.jsx("option",{value:"completed",children:e("consultations.statuses.completed")}),n.jsx("option",{value:"cancelled",children:e("consultations.statuses.cancelled")})]})]})}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("myConsultations.showing")," ",c.length," ",e("myConsultations.of")," ",t.length," ",e("myConsultations.request")]})}),n.jsx("div",{className:"space-y-4",children:c.map((m,x)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:x*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:m.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${d(m.status)}`,children:u(m.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:m.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{children:[e("consultations.consultant"),": ",m.mentor_name||e("consultations.unassigned")]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[f(m.method),h(m.method)]}),n.jsx("span",{children:"•"}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),m.duration," ",e("consultations.minutes")]})]})]}),n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Af,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(nr,{className:"w-4 h-4"}),e("myConsultations.actions.viewDetails")]}),m.status==="pending"&&n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ca,{className:"w-4 h-4"}),e("myConsultations.actions.editRequest")]}),m.status!=="completed"&&m.status!=="cancelled"&&n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(Br,{className:"w-4 h-4"}),e("myConsultations.actions.cancelRequest")]})]})})]})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[e("myConsultations.createdAt"),": ",Ze(m.createdAt)]}),n.jsxs("div",{className:"flex gap-2",children:[m.status==="scheduled"&&m.scheduledDate&&n.jsxs("div",{className:"text-sm",children:[n.jsxs("span",{className:"font-medium text-gray-800",children:[e("consultations.appointmentTime"),":"]})," ",n.jsx("span",{className:"text-blue-600",children:Ze(m.scheduledDate,{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",calendar:"gregory"})})]}),m.status==="scheduled"&&n.jsxs("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm flex items-center gap-2",children:[n.jsx(wr,{className:"w-4 h-4"}),e("consultations.joinConsultation")]}),m.status==="completed"&&!m.rating&&n.jsx("button",{className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-sm",children:e("consultations.rateConsultation")})]})]})]},m.id))}),c.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(yr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("myConsultations.noRequests")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("myConsultations.noRequestsMatch")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs(Ae,{to:"/create-request",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(yt,{className:"w-4 h-4"}),e("myConsultations.newRequest")]}),n.jsx("button",{onClick:()=>{i("all"),l("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},b6=()=>{const{t:e}=jt(),t=Ho(),{createConsultation:r}=Ds(),{projects:a}=Ii(),[s,i]=C.useState({topic:"",description:"",type:"technical",method:"video",duration:60,project_id:"",preferredDate:""}),[o,l]=C.useState(!1),[c,d]=C.useState(null),u=[{id:"technical",name:e("consultations.types.technical"),description:e("consultations.typeDescriptions.technical")},{id:"academic",name:e("consultations.types.academic"),description:e("consultations.typeDescriptions.academic")},{id:"career",name:e("consultations.types.career"),description:e("consultations.typeDescriptions.career")},{id:"project",name:e("consultations.types.project"),description:e("consultations.typeDescriptions.project")}],f=[{id:"video",name:e("consultations.methods.video"),icon:wr},{id:"phone",name:e("consultations.methods.phone"),icon:Pr},{id:"chat",name:e("consultations.methods.chat"),icon:Wr}],h=[{value:30,label:e("consultations.durations.30min")},{value:60,label:e("consultations.durations.60min")},{value:90,label:e("consultations.durations.90min")},{value:120,label:e("consultations.durations.120min")}],m=(g,y)=>{i(b=>({...b,[g]:y}))},x=async g=>{if(g.preventDefault(),!s.topic||!s.description){d(e("consultations.errors.requiredFields"));return}l(!0),d(null);try{await r({...s,status:"pending"}),t("/my-consultations")}catch(y){console.error("Error submitting consultation request:",y),d(y instanceof Error?y.message:e("consultations.errors.submissionFailed"))}finally{l(!1)}},p=a.filter(g=>g.status==="active");return n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ae,{to:"/my-consultations",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("consultations.createRequest.title")}),n.jsx("p",{className:"text-gray-600",children:e("consultations.createRequest.subtitle")})]})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),n.jsxs("form",{onSubmit:x,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.topic")," *"]}),n.jsx("input",{type:"text",value:s.topic,onChange:g=>m("topic",g.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("consultations.form.topicPlaceholder"),required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.description")," *"]}),n.jsx("textarea",{value:s.description,onChange:g=>m("description",g.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("consultations.form.descriptionPlaceholder"),required:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.type")," *"]}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:u.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.type===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"type",value:g.id,checked:s.type===g.id,onChange:()=>m("type",g.id),className:"sr-only"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:g.name}),n.jsx("p",{className:"text-xs text-gray-500",children:g.description})]})]},g.id))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.method")," *"]}),n.jsx("div",{className:"space-y-2",children:f.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.method===g.id?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"method",value:g.id,checked:s.method===g.id,onChange:()=>m("method",g.id),className:"sr-only"}),n.jsx(g.icon,{className:"w-5 h-5"}),n.jsx("span",{children:g.name})]},g.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("consultations.form.duration")," *"]}),n.jsx("div",{className:"space-y-2",children:h.map(g=>n.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-xl cursor-pointer transition-colors ${s.duration===g.value?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"duration",value:g.value,checked:s.duration===g.value,onChange:()=>m("duration",g.value),className:"sr-only"}),n.jsx(_t,{className:"w-5 h-5"}),n.jsx("span",{children:g.label})]},g.value))})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("consultations.form.relatedProject")}),n.jsxs("div",{className:"relative",children:[n.jsx(Ml,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:s.project_id,onChange:g=>m("project_id",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:e("consultations.form.noProject")}),p.map(g=>n.jsx("option",{value:g.id,children:g.title},g.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("consultations.form.preferredDate")}),n.jsxs("div",{className:"relative",children:[n.jsx(tt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"datetime-local",value:s.preferredDate,onChange:g=>m("preferredDate",g.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx("div",{className:"text-blue-500 mt-1",children:n.jsx(Cn,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:e("consultations.importantInfo.title")}),n.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[n.jsxs("li",{children:["• ",e("consultations.importantInfo.review")]}),n.jsxs("li",{children:["• ",e("consultations.importantInfo.link")]}),n.jsxs("li",{children:["• ",e("consultations.importantInfo.cancel")]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx(Ae,{to:"/my-consultations",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),n.jsx("button",{type:"submit",disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e("consultations.submitting")]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),e("consultations.submitRequest")]})})]})]})]})]})},w6=()=>{const{t:e}=jt(),{user:t}=wt(),r=(t==null?void 0:t.role)==="student",a=(t==null?void 0:t.role)==="admin",[s,i]=C.useState("profile"),[o,l]=C.useState(!1),[c,d]=C.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",bio:(t==null?void 0:t.bio)||"",currentPassword:"",newPassword:"",confirmPassword:""}),[u,f]=C.useState({emailNotifications:!0,pushNotifications:!0,projectUpdates:!0,weeklyReports:!1,marketingEmails:!1}),[h,m]=C.useState({theme:"light",language:"ar",fontSize:"medium",animations:!0}),[x,p]=C.useState(!1),[g,y]=C.useState(null),[b,v]=C.useState(!1),w=[{id:"profile",name:e("settings.sections.profile"),icon:xr},{id:"notifications",name:e("settings.sections.notifications"),icon:ei},{id:"security",name:e("settings.sections.security"),icon:Ka},{id:"appearance",name:e("settings.sections.appearance"),icon:nc},{id:"language",name:e("settings.sections.language"),icon:tc},{id:"data",name:e("settings.sections.data"),icon:nu}],j=(_,E)=>{if(_.startsWith("notifications.")){const S=_.split(".")[1];f(k=>({...k,[S]:E}))}else if(_.startsWith("appearance.")){const S=_.split(".")[1];m(k=>({...k,[S]:E}))}else d(S=>({...S,[_]:E}))},N=async()=>{if(!t){y(e("settings.errors.loginRequired"));return}p(!0),y(null),v(!1);try{const _={name:c.name,phone:c.phone,bio:c.bio,notifications_settings:u,appearance_settings:h};await M3(t.id,_),v(!0),setTimeout(()=>{v(!1)},3e3)}catch(_){console.error("Error saving settings:",_),y(_ instanceof Error?_.message:e("settings.errors.saveFailed"))}finally{p(!1)}};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-gray-600 to-gray-800 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(vo,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("settings.title")}),n.jsx("p",{className:"opacity-90",children:e("settings.subtitle")})]})]})}),n.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[n.jsx(te.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},className:"lg:col-span-1",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("settings.settingsSections")}),n.jsx("nav",{className:"space-y-2",children:w.map(_=>n.jsxs("button",{onClick:()=>i(_.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${s===_.id?"bg-blue-500 text-white shadow-lg":"text-gray-700 hover:bg-gray-50"}`,children:[n.jsx(_.icon,{className:"w-5 h-5"}),n.jsx("span",{className:"font-medium",children:_.name})]},_.id))})]})}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"lg:col-span-3",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[b&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5"}),n.jsx("span",{children:e("settings.saveSuccess")})]}),g&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(vt,{className:"w-5 h-5"}),n.jsx("span",{children:g})]}),s==="profile"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(xr,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.profile.title")})]}),n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:(t==null?void 0:t.avatar)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:"Profile",className:"w-24 h-24 rounded-full object-cover"}),n.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors",children:n.jsx(bi,{className:"w-4 h-4"})})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:e("settings.profile.profilePicture")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("settings.profile.pictureRequirements")}),n.jsxs("div",{className:"flex gap-2 mt-2",children:[n.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:e("settings.profile.changePicture")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:e("settings.profile.remove")})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.fullName")}),n.jsx("input",{type:"text",value:c.name,onChange:_=>j("name",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.email")}),n.jsx("input",{type:"email",value:c.email,onChange:_=>j("email",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("common.phone")}),n.jsx("input",{type:"tel",value:c.phone,onChange:_=>j("phone",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.timezone")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.profile.timezones.riyadh")}),n.jsx("option",{children:e("settings.profile.timezones.cairo")}),n.jsx("option",{children:e("settings.profile.timezones.dubai")})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.profile.bio")}),n.jsx("textarea",{value:c.bio,onChange:_=>j("bio",_.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("settings.profile.bioPlaceholder")})]})]}),s==="notifications"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(ei,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.notifications.title")})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.emailNotifications")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.emailNotificationsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.emailNotifications,onChange:_=>j("notifications.emailNotifications",_.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Xk,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.pushNotifications")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.pushNotificationsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.pushNotifications,onChange:_=>j("notifications.pushNotifications",_.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(yj,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.projectUpdates")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.projectUpdatesDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.projectUpdates,onChange:_=>j("notifications.projectUpdates",_.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Cr,{className:"w-5 h-5 text-gray-600"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.notifications.weeklyReports")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.notifications.weeklyReportsDesc")})]})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u.weeklyReports,onChange:_=>j("notifications.weeklyReports",_.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),s==="security"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ka,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.security.title")})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.security.changePassword")}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.currentPassword")}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:o?"text":"password",value:c.currentPassword,onChange:_=>j("currentPassword",_.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),n.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?n.jsx(wx,{className:"w-5 h-5"}):n.jsx(nr,{className:"w-5 h-5"})})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.newPassword")}),n.jsx("input",{type:"password",value:c.newPassword,onChange:_=>j("newPassword",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("settings.security.confirmNewPassword")}),n.jsx("input",{type:"password",value:c.confirmPassword,onChange:_=>j("confirmPassword",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsx("button",{className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("settings.security.updatePassword")})]})]}),n.jsx("div",{className:"border border-gray-200 rounded-xl p-6",children:n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:e("settings.security.twoFactorAuth")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("settings.security.twoFactorAuthDesc")})]}),n.jsx("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:e("settings.security.enable")})]})}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.security.loginSessions")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:e("settings.security.chromeWindows")}),n.jsxs("p",{className:"text-sm text-gray-600",children:[e("settings.security.riyadhSaudiArabia")," - ",e("settings.security.activeNow")]})]}),n.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:e("settings.security.currentSession")})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:e("settings.security.safariIphone")}),n.jsxs("p",{className:"text-sm text-gray-600",children:[e("settings.security.jeddahSaudiArabia")," - ",e("settings.security.twoDaysAgo")]})]}),n.jsx("button",{className:"text-red-600 hover:text-red-800 text-sm",children:e("settings.security.endSession")})]})]})]})]}),s==="appearance"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(nc,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.appearance.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.appearance.theme")}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"light",checked:h.theme==="light",onChange:_=>j("appearance.theme",_.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.lightTheme")})]}),n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"dark",checked:h.theme==="dark",onChange:_=>j("appearance.theme",_.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.darkTheme")})]}),n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"theme",value:"auto",checked:h.theme==="auto",onChange:_=>j("appearance.theme",_.target.value),className:"text-blue-600"}),n.jsx("span",{children:e("settings.appearance.autoTheme")})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.appearance.fontSize")}),n.jsxs("select",{value:h.fontSize,onChange:_=>j("appearance.fontSize",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"small",children:e("settings.appearance.small")}),n.jsx("option",{value:"medium",children:e("settings.appearance.medium")}),n.jsx("option",{value:"large",children:e("settings.appearance.large")})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-xl",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-800",children:e("settings.appearance.animations")}),n.jsx("p",{className:"text-sm text-gray-600",children:e("settings.appearance.animationsDesc")})]}),n.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:h.animations,onChange:_=>j("appearance.animations",_.target.checked),className:"sr-only peer"}),n.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),s==="language"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(tc,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.language.title")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.interfaceLanguage")}),n.jsxs("select",{value:h.language,onChange:_=>j("appearance.language",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"ar",children:e("settings.language.arabic")}),n.jsx("option",{value:"en",children:e("settings.language.english")}),n.jsx("option",{value:"fr",children:e("settings.language.french")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.timezone")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.language.timezones.riyadh")}),n.jsx("option",{children:e("settings.language.timezones.cairo")}),n.jsx("option",{children:e("settings.language.timezones.dubai")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.dateFormat")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:"DD/MM/YYYY"}),n.jsx("option",{children:"MM/DD/YYYY"}),n.jsx("option",{children:"YYYY-MM-DD"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:e("settings.language.timeFormat")}),n.jsxs("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{children:e("settings.language.timeFormats.24hour")}),n.jsx("option",{children:e("settings.language.timeFormats.12hour")})]})]})]})]}),s==="data"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(nu,{className:"w-6 h-6 text-blue-600"}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:e("settings.data.title")})]}),!r&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.data.exportData")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("settings.data.exportDataDesc")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(Cr,{className:"w-5 h-5"}),e("settings.data.exportData")]})]}),n.jsxs("div",{className:"border border-gray-200 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:e("settings.data.importData")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("settings.data.importDataDesc")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors",children:[n.jsx(bi,{className:"w-5 h-5"}),e("settings.data.importData")]})]}),a&&n.jsx("div",{className:"border border-red-200 rounded-xl p-6 bg-red-50",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(vt,{className:"w-6 h-6 text-red-600 mt-1"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:e("settings.data.deleteAccount")}),n.jsx("p",{className:"text-red-700 mb-4",children:e("settings.data.deleteAccountWarning")}),n.jsxs("button",{className:"flex items-center gap-2 px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors",children:[n.jsx(sr,{className:"w-5 h-5"}),e("settings.data.permanentlyDeleteAccount")]})]})]})})]}),r&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(nu,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"إدارة البيانات"}),n.jsx("p",{className:"text-gray-600",children:"لا تتوفر خيارات إدارة البيانات للطلاب. يرجى التواصل مع المعلم أو مدير المدرسة للمساعدة."})]})]}),n.jsx("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:n.jsx("button",{onClick:N,disabled:x,className:"flex items-center gap-2 px-8 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:x?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("settings.saving")]}):n.jsxs(n.Fragment,{children:[n.jsx(es,{className:"w-5 h-5"}),e("settings.saveChanges")]})})})]})})]})]})},j6=()=>{const{t:e}=jt(),{user:t}=wt(),r=(t==null?void 0:t.role)==="student",a=(t==null?void 0:t.role)==="teacher",s=(t==null?void 0:t.role)==="school",i=(t==null?void 0:t.role)==="admin",o=bx(),c=new URLSearchParams(o.search).get("search")||"",[d,u]=C.useState("all"),[f,h]=C.useState(c),[m,x]=C.useState(!1),{projects:p,loading:g,error:y,archiveProject:b,deleteProject:v}=Ii();C.useEffect(()=>{const R=new URLSearchParams(o.search).get("search")||"";h(R)},[o.search]);const w=[{id:"all",name:e("projects.statuses.all"),color:"bg-gray-500"},{id:"draft",name:e("projects.statuses.draft"),color:"bg-gray-500"},{id:"active",name:e("projects.statuses.active"),color:"bg-blue-500"},{id:"completed",name:e("projects.statuses.completed"),color:"bg-green-500"},{id:"archived",name:e("projects.statuses.archived"),color:"bg-purple-500"}],j=p.filter(A=>{const R=d==="all"||A.status===d,T=A.title.toLowerCase().includes(f.toLowerCase())||A.description.toLowerCase().includes(f.toLowerCase());return R&&T}),N=A=>{switch(A){case"draft":return n.jsx(Ca,{className:"w-4 h-4"});case"active":return n.jsx(wi,{className:"w-4 h-4"});case"completed":return n.jsx(ze,{className:"w-4 h-4"});case"archived":return n.jsx(yg,{className:"w-4 h-4"});default:return n.jsx(Ml,{className:"w-4 h-4"})}},_=A=>{switch(A){case"draft":return e("projects.statuses.draft");case"active":return e("projects.statuses.active");case"completed":return e("projects.statuses.completed");case"archived":return e("projects.statuses.archived");default:return A}},E=A=>{switch(A){case"draft":return"bg-gray-100 text-gray-800";case"active":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"archived":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},S=A=>{switch(A){case"stem":return e("projects.categories.stem");case"entrepreneurship":return e("projects.categories.entrepreneurship");case"volunteer":return e("projects.categories.volunteer");case"ethics":return e("projects.categories.ethics");default:return A}},k=async A=>{if(window.confirm("هل أنت متأكد من أرشفة هذا المشروع؟"))try{await b(A)}catch(R){console.error("Error archiving project:",R),alert("حدث خطأ أثناء أرشفة المشروع")}},O=async A=>{if(window.confirm("هل أنت متأكد من حذف هذا المشروع؟ هذا الإجراء لا يمكن التراجع عنه."))try{await v(A)}catch(R){console.error("Error deleting project:",R),alert("حدث خطأ أثناء حذف المشروع")}},P=A=>{var R;return!!(i||s||a&&A.teacher_id===(t==null?void 0:t.id)||a&&A.status==="draft"&&A.school_id===(t==null?void 0:t.school_id)||r&&A.status==="draft"&&((R=A.students)!=null&&R.some(T=>T.student_id===(t==null?void 0:t.id))))};return g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):y?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:y})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ml,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("projects.title")}),n.jsx("p",{className:"opacity-90",children:e("projects.subtitle")})]})]}),n.jsxs(Ae,{to:"/projects/new",className:"bg-white text-green-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),e("projects.newProject")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.total")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.filter(A=>A.status==="active").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.active")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.filter(A=>A.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.completed")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.length>0?(Math.round(p.reduce((A,R)=>A+(R.progress||0),0)/p.length*10)/10).toFixed(1):0}),n.jsx("div",{className:"text-sm opacity-80",children:e("projects.stats.averageProgress")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("projects.searchPlaceholder"),value:f,onChange:A=>h(A.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>x(!m),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(zo,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 ${m?"block":"hidden lg:block"}`,children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projects.projectStatus")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(A=>n.jsxs("button",{onClick:()=>u(A.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${d===A.id?`${A.color} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[N(A.id),A.name]},A.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("projects.showing")," ",j.length," ",e("projects.of")," ",p.length," ",e("projects.project")]})}),n.jsx("div",{className:"grid lg:grid-cols-2 gap-6",children:j.map((A,R)=>{var T,F,W,K;return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:R*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${E(A.status)}`,children:[N(A.status),_(A.status)]}),n.jsx("span",{className:"text-xs text-gray-500",children:S(A.category)})]}),n.jsx(Ae,{to:`/projects/${A.id}`,className:"text-xl font-bold text-gray-800 hover:text-blue-600 transition-colors line-clamp-2",children:A.title})]}),P(A)&&n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Af,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs(Ae,{to:`/projects/${A.id}`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(nr,{className:"w-4 h-4"}),e("projects.actions.viewDetails")]}),n.jsxs(Ae,{to:`/projects/${A.id}/edit`,className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ca,{className:"w-4 h-4"}),e("projects.actions.edit")]}),n.jsxs("button",{onClick:()=>k(A.id),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(yg,{className:"w-4 h-4"}),e("projects.actions.archive")]}),n.jsx("hr",{className:"my-1"}),n.jsxs("button",{onClick:()=>O(A.id),className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(sr,{className:"w-4 h-4"}),e("projects.actions.delete")]})]})})]})]}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2 leading-relaxed",children:A.description}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:e("projects.progress")}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[A.progress.toFixed(1),"/10"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${A.progress>=9?"bg-green-500":A.progress>=5?"bg-blue-500":"bg-yellow-500"}`,style:{width:`${A.progress/10*100}%`}})})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 text-center",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[((T=A.tasks)==null?void 0:T.filter(B=>B.status==="completed").length)||0,"/",((F=A.tasks)==null?void 0:F.length)||0]}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.tasks")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:((W=A.students)==null?void 0:W.length)||0}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.students")})]}),n.jsxs("div",{children:[n.jsx("div",{className:`text-lg font-bold ${A.due_date&&El(A.due_date)<0?"text-red-600":A.due_date&&El(A.due_date)<=7?"text-yellow-600":"text-green-600"}`,children:A.due_date?El(A.due_date)<0?e("projects.overdue"):`${El(A.due_date)} ${e("projects.days")}`:"--"}),n.jsx("div",{className:"text-xs text-gray-500",children:e("projects.remaining")})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:"flex -space-x-2",children:[(K=A.students)==null?void 0:K.slice(0,4).map((B,L)=>{var ee,M,G;return n.jsx("img",{src:((ee=B.student)==null?void 0:ee.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:(M=B.student)==null?void 0:M.name,className:"w-8 h-8 rounded-full border-2 border-white object-cover",title:(G=B.student)==null?void 0:G.name},B.id)}),A.students&&A.students.length>4&&n.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-200 border-2 border-white flex items-center justify-center text-xs font-medium text-gray-600",children:["+",A.students.length-4]})]}),n.jsxs("span",{className:"mr-3 text-sm text-gray-500",children:[e("projects.lastUpdate"),": ",Ze(A.updated_at)]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[A.rating&&n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),A.rating.toFixed(1)]}),n.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-500",children:[n.jsx(tt,{className:"w-4 h-4"}),A.due_date?Ze(A.due_date):e("projects.notSpecified")]})]})]})]},A.id)})}),j.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ml,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("projects.noProjects")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("projects.startCreating")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs(Ae,{to:"/projects/new",className:"px-6 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(yt,{className:"w-4 h-4"}),e("projects.createNewProject")]}),n.jsx("button",{onClick:()=>{u("all"),h("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},N6=[{name:"درجة الإنجاز",score:0,maxScore:10,weight:.2,comments:""},{name:"جودة العمل",score:0,maxScore:10,weight:.25,comments:""},{name:"التواصل والتعاون",score:0,maxScore:10,weight:.15,comments:""},{name:"الإبداع والابتكار",score:0,maxScore:10,weight:.2,comments:""},{name:"جودة العرض والتوثيق",score:0,maxScore:10,weight:.2,comments:""}],Ij=e=>{const[t,r]=C.useState([]),[a,s]=C.useState(null),[i,o]=C.useState(!0),[l,c]=C.useState(null),{user:d}=wt(),u=async g=>{if(d)try{o(!0);const y=Me(pe,"project_evaluations"),b=et(y,We("projectId","==",g)),w=(await Je(b)).docs.map(N=>{const _=N.data();return{id:N.id,projectId:_.projectId,teacherId:_.teacherId,criteria:_.criteria||[],totalScore:_.totalScore||0,maxTotalScore:_.maxTotalScore||0,percentage:_.percentage||0,feedback:_.feedback||"",createdAt:_.createdAt?new Date(_.createdAt.toDate()).toISOString():new Date().toISOString(),updatedAt:_.updatedAt?new Date(_.updatedAt.toDate()).toISOString():new Date().toISOString()}});r(w);const j=w.find(N=>N.teacherId===d.id);s(j||{id:"",projectId:g,teacherId:d.id,criteria:[...N6],totalScore:0,maxTotalScore:50,percentage:0,feedback:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}catch(y){console.error("Error fetching project evaluations:",y),c(y instanceof Error?y.message:"حدث خطأ في تحميل تقييمات المشروع")}finally{o(!1)}},f=g=>{let y=0,b=0;g.forEach(w=>{y+=w.score*w.weight,b+=w.maxScore*w.weight});const v=b>0?y/b*100:0;return{total:y,percentage:Math.round(v)}},h=g=>{const y=g.find(b=>b.name==="درجة الإنجاز");return console.log("Completion criterion found:",y),y?(console.log("Completion criterion score:",y.score),console.log("Completion criterion maxScore:",y.maxScore),y.score):(console.log("No completion criterion found, returning 0"),0)},m=(g,y,b)=>{if(!a)return;const v=[...a.criteria];v[g]={...v[g],score:Math.min(Math.max(0,y),v[g].maxScore),comments:b||v[g].comments};const{total:w,percentage:j}=f(v);s({...a,criteria:v,totalScore:w,percentage:j})},x=g=>{a&&s({...a,feedback:g})},p=async()=>{if(!d||!a||!e)throw new Error("بيانات غير كافية لحفظ التقييم");try{console.log("Submitting evaluation with currentEvaluation:",a);const g=a==null?void 0:a.criteria.find(j=>j.name==="درجة الإنجاز");console.log("Completion criterion before save:",g);const{total:y,percentage:b}=f(a.criteria),v=h(a.criteria);console.log("Final completion score to be saved:",v);const w={projectId:e,teacherId:d.id,criteria:a.criteria,totalScore:y,maxTotalScore:a.maxTotalScore,percentage:b,feedback:a.feedback,updatedAt:Ve()};if(a.id){const j=Re(pe,"project_evaluations",a.id);await Ht(j,w);const N=Re(pe,"projects",e);return console.log("Updating project with ID:",e),console.log("Setting rating to:",b/20),await Ht(N,{rating:b/20,updatedAt:Ve()}),{...a,...w,id:a.id}}else{w.createdAt=Ve();const j=Me(pe,"project_evaluations"),N=await Aa(j,w),_=Re(pe,"projects",e);return console.log("Updating project with ID:",e),console.log("Setting rating to:",b/20),await Ht(_,{rating:b/20,updatedAt:Ve()}),{...a,...w,id:N.id}}}catch(g){throw console.error("Error saving evaluation:",g),g}};return C.useEffect(()=>{e&&d&&u(e)},[e,d]),{evaluations:t,currentEvaluation:a,loading:i,error:l,fetchProjectEvaluations:u,updateCriterionScore:m,updateFeedback:x,saveEvaluation:p}},_6=({projectId:e,onSaved:t})=>{const{currentEvaluation:r,loading:a,error:s,updateCriterionScore:i,updateFeedback:o,saveEvaluation:l}=Ij(e),[c,d]=C.useState(!1),[u,f]=C.useState(null),[h,m]=C.useState(!1),x=(v,w)=>{i(v,w)},p=(v,w)=>{i(v,(r==null?void 0:r.criteria[v].score)||0,w)},g=v=>{o(v)},y=async v=>{v.preventDefault(),d(!0),f(null),m(!1);try{console.log("Submitting evaluation with currentEvaluation:",r);const w=r==null?void 0:r.criteria.find(j=>j.name==="درجة الإنجاز");console.log("Completion criterion before save:",w),await l(),m(!0),t&&t(),setTimeout(()=>{m(!1)},3e3)}catch(w){console.error("Error saving evaluation:",w),f(w instanceof Error?w.message:"حدث خطأ في حفظ التقييم")}finally{d(!1)}},b=v=>{switch(v){case"درجة الإنجاز":return n.jsx(cd,{className:"w-5 h-5"});case"جودة العمل":return n.jsx(ar,{className:"w-5 h-5"});case"التواصل والتعاون":return n.jsx(dt,{className:"w-5 h-5"});case"الإبداع والابتكار":return n.jsx(ga,{className:"w-5 h-5"});case"جودة العرض والتوثيق":return n.jsx(Zn,{className:"w-5 h-5"});default:return n.jsx(at,{className:"w-5 h-5"})}};return a?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):s?n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(vt,{className:"w-5 h-5"}),n.jsx("p",{className:"font-medium",children:"حدث خطأ"})]}),n.jsx("p",{children:s})]}):r?n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(ar,{className:"w-6 h-6 text-blue-600"}),"تقييم المشروع"]}),h&&n.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 text-green-700 mb-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5"}),n.jsx("p",{children:"تم حفظ التقييم بنجاح"})]})}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-red-700 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(vt,{className:"w-5 h-5"}),n.jsx("p",{className:"font-medium",children:"حدث خطأ"})]}),n.jsx("p",{children:u})]}),n.jsxs("form",{onSubmit:y,children:[n.jsx("div",{className:"mb-6 text-center",children:n.jsxs("div",{className:"w-32 h-32 bg-blue-50 rounded-full flex flex-col items-center justify-center mx-auto",children:[n.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:[r.percentage,"%"]}),n.jsx("span",{className:"text-sm text-blue-600",children:"الدرجة النهائية"})]})}),n.jsxs("div",{className:"space-y-6 mb-8",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-4",children:"معايير التقييم"}),r.criteria.map((v,w)=>n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[b(v.name),n.jsx("h5",{className:"font-medium text-gray-800",children:v.name}),n.jsxs("span",{className:"text-sm text-gray-500",children:["(",v.weight*100,"%)"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:"font-bold text-blue-600",children:v.score}),n.jsxs("span",{className:"text-gray-500",children:["/ ",v.maxScore]})]})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("input",{type:"range",min:"0",max:v.maxScore,step:"0.5",value:v.score,onChange:j=>x(w,parseFloat(j.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[n.jsx("span",{children:"0"}),n.jsx("span",{children:v.maxScore/4}),n.jsx("span",{children:v.maxScore/2}),n.jsx("span",{children:v.maxScore*3/4}),n.jsx("span",{children:v.maxScore})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ملاحظات"}),n.jsx("textarea",{value:v.comments,onChange:j=>p(w,j.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"أضف ملاحظاتك حول هذا المعيار..."})]})]},w))]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("label",{className:"block font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(Wr,{className:"w-5 h-5 text-blue-600"}),"التعليق العام"]}),n.jsx("textarea",{value:r.feedback,onChange:v=>g(v.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أضف تعليقك العام على المشروع وتوصياتك للطلاب..."})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(es,{className:"w-5 h-5"}),"حفظ التقييم"]})})})]})]}):n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-yellow-700",children:n.jsx("p",{children:"لا يمكن تحميل نموذج التقييم. يرجى المحاولة مرة أخرى لاحقاً."})})},S6=({evaluation:e,teacherName:t="المعلم"})=>{const r=o=>new Date(o).toLocaleDateString("ar-SA",{year:"numeric",month:"long",day:"numeric"}),a=o=>{switch(o){case"درجة الإنجاز":return n.jsx(cd,{className:"w-4 h-4"});case"جودة العمل":return n.jsx(ar,{className:"w-4 h-4"});case"التواصل والتعاون":return n.jsx(dt,{className:"w-4 h-4"});case"الإبداع والابتكار":return n.jsx(ga,{className:"w-4 h-4"});case"جودة العرض والتوثيق":return n.jsx(Zn,{className:"w-4 h-4"});default:return n.jsx(at,{className:"w-4 h-4"})}},s=(o,l)=>{const c=o/l*100;return c>=90?"text-green-600":c>=75?"text-blue-600":c>=60?"text-yellow-600":"text-red-600"},i=o=>o>=90?"ممتاز":o>=80?"جيد جداً":o>=70?"جيد":o>=60?"مقبول":"ضعيف";return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ar,{className:"w-6 h-6 text-blue-600"}),"ملخص التقييم"]}),n.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),r(e.updatedAt)]})]}),n.jsx("div",{className:"flex items-center justify-center mb-6",children:n.jsxs("div",{className:"w-32 h-32 bg-blue-50 rounded-full flex flex-col items-center justify-center",children:[n.jsxs("span",{className:"text-3xl font-bold text-blue-600",children:[e.percentage,"%"]}),n.jsx("span",{className:"text-sm text-blue-600",children:i(e.percentage)})]})}),n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"تفاصيل التقييم"}),e.criteria.map((o,l)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[a(o.name),n.jsx("span",{className:"font-medium text-gray-800",children:o.name})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`font-bold ${s(o.score,o.maxScore)}`,children:o.score}),n.jsxs("span",{className:"text-gray-500",children:["/ ",o.maxScore]})]})]},l))]}),e.feedback&&n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2 flex items-center gap-2",children:[n.jsx(Wr,{className:"w-5 h-5 text-blue-600"}),"التعليق العام"]}),n.jsx("div",{className:"bg-gray-50 p-4 rounded-xl",children:n.jsx("p",{className:"text-gray-700 whitespace-pre-line",children:e.feedback})})]}),n.jsxs("div",{className:"text-sm text-gray-500 text-left",children:["تم التقييم بواسطة: ",t]})]})},k6=({projectId:e})=>{const{user:t}=wt(),[r,a]=C.useState([]),[s,i]=C.useState(""),[o,l]=C.useState(!0),[c,d]=C.useState(!1),[u,f]=C.useState(null),[h,m]=C.useState(null),[x,p]=C.useState(0),[g,y]=C.useState(!1),b=C.useRef(null),v=C.useRef(null),[w,j]=C.useState(null),[N,_]=C.useState(""),[E,S]=C.useState(null),[k,O]=C.useState(null),[P,A]=C.useState([]);C.useEffect(()=>{var Z;(Z=b.current)==null||Z.scrollIntoView({behavior:"smooth"})},[r]),C.useEffect(()=>{if(!e)return;l(!0),f(null);const Z=Me(pe,"chat_messages"),q=et(Z,We("project_id","==",e)),ie=Wk(q,async I=>{var we,Ee;const ve=[];for(const ce of I.docs){const fe=ce.data();let oe;try{if(fe.user_id){const qe=Re(pe,"users",fe.user_id),st=await fr(qe);if(st.exists()){const lt=st.data();oe={name:lt.name||"مستخدم غير معروف",avatar_url:lt.avatar_url,role:lt.role}}}}catch(qe){console.error("Error fetching user info:",qe)}ve.push({id:ce.id,project_id:fe.project_id,user_id:fe.user_id,message:fe.message,message_type:fe.message_type||"text",media_url:fe.media_url,reply_to:fe.reply_to,created_at:((we=fe.created_at)==null?void 0:we.toDate())||new Date,updated_at:(Ee=fe.updated_at)==null?void 0:Ee.toDate(),seen_by:fe.seen_by||[],user:oe})}if(ve.sort((ce,fe)=>ce.created_at.getTime()-fe.created_at.getTime()),a(ve),l(!1),t&&ve.length>0){const ce=ve[ve.length-1];ce.user_id!==t.id&&G(ce.id)}},I=>{console.error("Error fetching messages:",I),f("حدث خطأ في تحميل الرسائل"),l(!1)});return()=>ie()},[e,t]);const R=async()=>{if(!(!t||!e)&&!(!s.trim()&&!h)){d(!0),f(null);try{let Z="",q="text";if(h){y(!0),h.type.startsWith("image/")?q="image":h.type.startsWith("video/")?q="video":q="file";const ie=Ah(Ch,`project_chats/${e}/${Date.now()}_${h.name}`),I=zk(ie,h);I.on("state_changed",ve=>{const we=ve.bytesTransferred/ve.totalBytes*100;p(we)},ve=>{console.error("Error uploading file:",ve),f("حدث خطأ في رفع الملف"),y(!1)},async()=>{Z=await gj(I.snapshot.ref),await Aa(Me(pe,"chat_messages"),{project_id:e,user_id:t.id,message:s.trim()||`تم إرسال ${q==="image"?"صورة":q==="video"?"فيديو":"ملف"}`,message_type:q,media_url:Z,created_at:Ve(),updated_at:Ve(),seen_by:[t.id]}),i(""),m(null),p(0),y(!1),d(!1)})}else await Aa(Me(pe,"chat_messages"),{project_id:e,user_id:t.id,message:s.trim(),message_type:"text",created_at:Ve(),updated_at:Ve(),seen_by:[t.id]}),i(""),d(!1)}catch(Z){console.error("Error sending message:",Z),f("حدث خطأ في إرسال الرسالة"),d(!1)}}},T=Z=>{Z.target.files&&Z.target.files.length>0&&m(Z.target.files[0])},F=()=>{m(null),v.current&&(v.current.value="")},W=(Z,q)=>{j(Z),_(q)},K=async Z=>{if(N.trim())try{const q=Re(pe,"chat_messages",Z);await Ht(q,{message:N,updated_at:Ve()}),j(null),_("")}catch(q){console.error("Error updating message:",q),f("حدث خطأ في تحديث الرسالة")}},B=()=>{j(null),_("")},L=Z=>{S(Z)},ee=async Z=>{try{const q=r.find(I=>I.id===Z),ie=Re(pe,"chat_messages",Z);if(await qa(ie),q!=null&&q.media_url)try{const Ee=new URL(q.media_url).pathname.split("?")[0].match(/\/o\/(.+)$/);if(Ee&&Ee[1]){const ce=decodeURIComponent(Ee[1]),fe=Ah(Ch,ce);await Hk(fe)}}catch(I){console.error("Error deleting file from storage:",I)}S(null)}catch(q){console.error("Error deleting message:",q),f("حدث خطأ في حذف الرسالة")}},M=()=>{S(null)},G=async Z=>{if(t)try{const q=Re(pe,"chat_messages",Z),ie=await fr(q);if(ie.exists()){const ve=ie.data().seen_by||[];ve.includes(t.id)||await Ht(q,{seen_by:[...ve,t.id]})}}catch(q){console.error("Error marking message as seen:",q)}},V=async Z=>{try{const q=Re(pe,"chat_messages",Z),ie=await fr(q);if(ie.exists()){const ve=ie.data().seen_by||[],we=[];for(const Ee of ve){const ce=Re(pe,"users",Ee),fe=await fr(ce);if(fe.exists()){const oe=fe.data();we.push({id:Ee,name:oe.name||"مستخدم غير معروف",avatar_url:oe.avatar_url,role:oe.role})}}A(we),O(Z)}}catch(q){console.error("Error fetching seen by users:",q)}},H=()=>{O(null),A([])},re=Z=>Z.toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit",hour12:!0,calendar:"gregory"}),me=Z=>Z.toLocaleDateString("ar-SA",{weekday:"long",year:"numeric",month:"long",day:"numeric",calendar:"gregory"}),xe={};return r.forEach(Z=>{const q=me(Z.created_at);xe[q]||(xe[q]=[]),xe[q].push(Z)}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg flex flex-col h-[600px]",children:[n.jsx("div",{className:"p-4 border-b border-gray-200",children:n.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(dt,{className:"w-5 h-5 text-blue-600"}),"محادثة الفريق"]})}),n.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:o?n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):u?n.jsx("div",{className:"flex items-center justify-center h-full text-red-500",children:u}):r.length===0?n.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[n.jsx(ti,{className:"w-12 h-12 text-gray-300 mb-2"}),n.jsx("p",{children:"لا توجد رسائل بعد"}),n.jsx("p",{className:"text-sm",children:"ابدأ المحادثة مع فريق المشروع"})]}):n.jsxs("div",{className:"space-y-6",children:[Object.entries(xe).map(([Z,q])=>n.jsxs("div",{children:[n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:Z})}),n.jsx("div",{className:"space-y-4",children:q.map(ie=>{var I,ve;return n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${ie.user_id===(t==null?void 0:t.id)?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`flex gap-3 max-w-[80%] ${ie.user_id===(t==null?void 0:t.id)?"flex-row-reverse":""}`,children:[n.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 overflow-hidden",children:(I=ie.user)!=null&&I.avatar_url?n.jsx("img",{src:ie.user.avatar_url,alt:ie.user.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:`w-full h-full ${ie.user_id===(t==null?void 0:t.id)?"bg-blue-500":"bg-gradient-to-r from-purple-500 to-pink-500"} flex items-center justify-center`,children:n.jsx(xr,{className:"w-4 h-4 text-white"})})}),n.jsxs("div",{className:"relative group",children:[n.jsxs("div",{className:`rounded-2xl p-4 ${ie.user_id===(t==null?void 0:t.id)?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:[ie.user_id!==(t==null?void 0:t.id)&&n.jsx("p",{className:"font-medium text-sm mb-1",children:((ve=ie.user)==null?void 0:ve.name)||"مستخدم غير معروف"}),w===ie.id?n.jsxs("div",{className:"mb-2",children:[n.jsx("textarea",{value:N,onChange:we=>_(we.target.value),className:`w-full p-2 rounded border ${ie.user_id===(t==null?void 0:t.id)?"bg-blue-50 text-gray-800 border-blue-300":"bg-white border-gray-300"}`,rows:2}),n.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[n.jsx("button",{onClick:()=>K(ie.id),className:"p-1 bg-green-500 text-white rounded",children:n.jsx(Yk,{className:"w-4 h-4"})}),n.jsx("button",{onClick:B,className:"p-1 bg-gray-500 text-white rounded",children:n.jsx(Ot,{className:"w-4 h-4"})})]})]}):n.jsxs(n.Fragment,{children:[ie.message_type==="text"&&n.jsx("p",{className:"whitespace-pre-line",children:ie.message}),ie.message_type==="image"&&ie.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsx("img",{src:ie.media_url,alt:"صورة",className:"rounded-lg max-w-full max-h-60 object-contain"}),ie.message&&n.jsx("p",{className:"mt-2",children:ie.message})]}),ie.message_type==="video"&&ie.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsx("video",{src:ie.media_url,controls:!0,className:"rounded-lg max-w-full max-h-60"}),ie.message&&n.jsx("p",{className:"mt-2",children:ie.message})]}),ie.message_type==="file"&&ie.media_url&&n.jsxs("div",{className:"mb-2",children:[n.jsxs("a",{href:ie.media_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 bg-white bg-opacity-20 p-2 rounded-lg",children:[n.jsx(bg,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate",children:"تحميل الملف"})]}),ie.message&&n.jsx("p",{className:"mt-2",children:ie.message})]})]}),n.jsxs("div",{className:`flex items-center justify-between text-xs mt-2 ${ie.user_id===(t==null?void 0:t.id)?"text-blue-100":"text-gray-500"}`,children:[n.jsxs("span",{children:[re(ie.created_at),ie.updated_at&&" (معدل)"]}),ie.user_id===(t==null?void 0:t.id)&&ie.seen_by&&ie.seen_by.length>1&&n.jsxs("button",{onClick:()=>V(ie.id),className:"flex items-center gap-1 hover:underline",children:[n.jsx(nr,{className:"w-3 h-3"}),ie.seen_by.length-1]})]})]}),ie.user_id===(t==null?void 0:t.id)&&n.jsx("div",{className:"absolute top-2 left-2 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{className:`p-1 rounded-full ${ie.user_id===(t==null?void 0:t.id)?"bg-blue-400 hover:bg-blue-600":"bg-gray-200 hover:bg-gray-300"} text-white`,children:n.jsx(Af,{className:"w-3 h-3"})}),n.jsxs("div",{className:"absolute left-0 top-full mt-1 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10 hidden group-hover:block",children:[n.jsxs("button",{onClick:()=>W(ie.id,ie.message),className:"flex items-center gap-2 px-3 py-1 hover:bg-gray-100 w-full text-right text-sm text-gray-700",children:[n.jsx(Ca,{className:"w-3 h-3"}),"تعديل"]}),n.jsxs("button",{onClick:()=>L(ie.id),className:"flex items-center gap-2 px-3 py-1 hover:bg-gray-100 w-full text-right text-sm text-red-600",children:[n.jsx(sr,{className:"w-3 h-3"}),"حذف"]})]})]})})]})]})},ie.id)})})]},Z)),n.jsx("div",{ref:b})]})}),E&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"تأكيد الحذف"}),n.jsx("p",{className:"text-gray-600 mb-6",children:"هل أنت متأكد من حذف هذه الرسالة؟ لا يمكن التراجع عن هذا الإجراء."}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:M,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:()=>ee(E),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"حذف"})]})]})}),k&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"شاهد الرسالة"}),n.jsx("button",{onClick:H,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),n.jsx("div",{className:"max-h-60 overflow-y-auto",children:P.length>0?n.jsx("div",{className:"space-y-3",children:P.map(Z=>n.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden",children:Z.avatar_url?n.jsx("img",{src:Z.avatar_url,alt:Z.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-gray-300 flex items-center justify-center",children:n.jsx(xr,{className:"w-4 h-4 text-gray-600"})})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:Z.name}),n.jsx("p",{className:"text-xs text-gray-500",children:Z.role||"مستخدم"})]})]},Z.id))}):n.jsx("p",{className:"text-center text-gray-500 py-4",children:"لم يشاهد أحد هذه الرسالة بعد"})})]})}),h&&n.jsx("div",{className:"px-4 py-2 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[h.type.startsWith("image/")?n.jsx(dd,{className:"w-4 h-4 text-blue-500"}):h.type.startsWith("video/")?n.jsx(wr,{className:"w-4 h-4 text-purple-500"}):n.jsx(bg,{className:"w-4 h-4 text-gray-500"}),n.jsx("span",{className:"text-sm truncate max-w-[200px]",children:h.name}),g&&n.jsx("div",{className:"w-20 h-2 bg-gray-200 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-blue-500",style:{width:`${x}%`}})})]}),n.jsx("button",{onClick:F,className:"p-1 hover:bg-gray-200 rounded-full",children:n.jsx(Ot,{className:"w-4 h-4 text-gray-500"})})]})}),n.jsx("div",{className:"p-4 border-t border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"file",ref:v,onChange:T,className:"hidden"}),n.jsx("button",{onClick:()=>{var Z;return(Z=v.current)==null?void 0:Z.click()},disabled:g||c,className:"p-2 rounded-full hover:bg-gray-100 transition-colors disabled:opacity-50",children:n.jsx(bj,{className:"w-5 h-5 text-gray-500"})}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("input",{type:"text",value:s,onChange:Z=>i(Z.target.value),onKeyPress:Z=>Z.key==="Enter"&&!Z.shiftKey&&R(),placeholder:"اكتب رسالتك هنا...",disabled:g||c,className:"w-full px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"})}),n.jsx("button",{onClick:R,disabled:!s.trim()&&!h||g||c,className:"p-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:bg-gray-300",children:n.jsx(jx,{className:"w-5 h-5"})})]})})]})},Sx=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=wt(),l=async()=>{if(!(!o||!o.school_id))try{a(!0);const c=await $3(o.school_id);t(c)}catch(c){i(c instanceof Error?c.message:"حدث خطأ في تحميل الطلاب")}finally{a(!1)}};return C.useEffect(()=>{o&&o.school_id&&l()},[o]),{students:e,loading:r,error:s,fetchStudents:l}},E6=({projectId:e,maxStudents:t,currentStudents:r,onClose:a,onSuccess:s})=>{const{students:i,loading:o,error:l}=Sx(),[c,d]=C.useState(""),[u,f]=C.useState([]),[h,m]=C.useState(!1),[x,p]=C.useState(null),g=r.map(j=>j.student_id),b=i.filter(j=>!g.includes(j.id)).filter(j=>j.name.toLowerCase().includes(c.toLowerCase())||j.email.toLowerCase().includes(c.toLowerCase())||j.grade&&j.grade.toLowerCase().includes(c.toLowerCase())),v=j=>{f(N=>N.includes(j)?N.filter(_=>_!==j):r.length+N.length>=t?N:[...N,j])},w=async()=>{if(u.length!==0){m(!0),p(null);try{for(const j of u)await Oh({project_id:e,student_id:j,role:"member",created_at:new Date().toISOString(),status:"active"});s(),a()}catch(j){console.error("Error adding students to project:",j),p(j instanceof Error?j.message:"حدث خطأ في إضافة الطلاب")}finally{m(!1)}}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(sc,{className:"w-6 h-6 text-blue-600"}),"إضافة طلاب للمشروع"]}),n.jsx("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),x&&n.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4",children:x}),n.jsxs("div",{className:"relative mb-4",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث بالاسم أو البريد الإلكتروني...",value:c,onChange:j=>d(j.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-blue-800 font-medium",children:["تم اختيار ",u.length," طالب",r.length>0&&` (${r.length} موجود بالفعل)`]}),n.jsx("button",{onClick:()=>f([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:"إلغاء الكل"})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto mb-6",children:o?n.jsx("div",{className:"flex items-center justify-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):l?n.jsx("div",{className:"text-center py-8 text-red-500",children:l}):b.length>0?b.map(j=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${u.includes(j.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>v(j.id),children:[n.jsx("input",{type:"checkbox",checked:u.includes(j.id),onChange:()=>v(j.id),disabled:!u.includes(j.id)&&r.length+u.length>=t,className:"text-blue-600"}),n.jsx("img",{src:j.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:j.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:j.name}),u.includes(j.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"محدد"})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ta,{className:"w-4 h-4"}),j.email]}),j.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ts,{className:"w-4 h-4"}),j.grade]})]})]})]},j.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد طلاب"}),n.jsx("p",{className:"text-gray-600",children:c?"لم يتم العثور على طلاب يطابقون البحث":"لا يوجد طلاب متاحين للإضافة"})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"معلومات مهمة:"}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• يمكنك اختيار حتى ",t-r.length," طلاب إضافيين"]}),n.jsxs("li",{children:["• يوجد حالياً ",r.length," طالب في المشروع"]}),n.jsxs("li",{children:["• الحد الأقصى للطلاب في هذا المشروع هو ",t]}),n.jsx("li",{children:"• يمكنك تعديل دور الطالب لاحقاً (قائد/عضو)"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:a,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:w,disabled:u.length===0||h,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإضافة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(sc,{className:"w-5 h-5"}),"إضافة الطلاب (",u.length,")"]})})]})]})})},A6=({projectId:e,students:t,onClose:r,onSuccess:a})=>{const{user:s}=wt(),[i,o]=C.useState({title:"",description:"",assigned_to:"",status:"pending",priority:"medium",due_date:""}),[l,c]=C.useState(!1),[d,u]=C.useState(null),f=(m,x)=>{o(p=>({...p,[m]:x}))},h=async m=>{if(m.preventDefault(),!i.title){u("يرجى إدخال عنوان المهمة");return}if(!i.due_date){u("يرجى تحديد تاريخ الاستحقاق");return}c(!0),u(null);try{await E3({project_id:e,title:i.title,description:i.description,assigned_to:i.assigned_to||null,status:i.status,priority:i.priority,progress:i.status==="completed"?100:i.status==="in_progress"?50:0,due_date:i.due_date,created_by:s==null?void 0:s.id,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),a(),r()}catch(x){console.error("Error creating task:",x),u(x instanceof Error?x.message:"حدث خطأ في إنشاء المهمة")}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ze,{className:"w-6 h-6 text-blue-600"}),"إضافة مهمة جديدة"]}),n.jsx("button",{onClick:r,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:d})]}),n.jsxs("form",{onSubmit:h,className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المهمة *"}),n.jsx("input",{type:"text",value:i.title,onChange:m=>f("title",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان المهمة",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المهمة"}),n.jsx("textarea",{value:i.description,onChange:m=>f("description",m.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للمهمة"})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تعيين إلى"}),n.jsxs("select",{value:i.assigned_to,onChange:m=>f("assigned_to",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:"غير معين"}),t.map(m=>{var x;return n.jsxs("option",{value:m.student_id,children:[((x=m.student)==null?void 0:x.name)||"طالب غير معروف"," ",m.role==="leader"?"(قائد الفريق)":""]},m.student_id)})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الاستحقاق *"}),n.jsxs("div",{className:"relative",children:[n.jsx(tt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"date",value:i.due_date,onChange:m=>f("due_date",m.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الحالة"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="pending"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"pending",checked:i.status==="pending",onChange:()=>f("status","pending"),className:"sr-only"}),n.jsx(_t,{className:"w-5 h-5"}),n.jsx("span",{children:"في الانتظار"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="in_progress"?"bg-blue-50 border-blue-500 text-blue-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"in_progress",checked:i.status==="in_progress",onChange:()=>f("status","in_progress"),className:"sr-only"}),n.jsx(_t,{className:"w-5 h-5"}),n.jsx("span",{children:"قيد التنفيذ"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.status==="completed"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"status",value:"completed",checked:i.status==="completed",onChange:()=>f("status","completed"),className:"sr-only"}),n.jsx(ze,{className:"w-5 h-5"}),n.jsx("span",{children:"مكتمل"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الأولوية"}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="low"?"bg-green-50 border-green-500 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"low",checked:i.priority==="low",onChange:()=>f("priority","low"),className:"sr-only"}),n.jsx(F0,{className:"w-5 h-5"}),n.jsx("span",{children:"منخفضة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="medium"?"bg-yellow-50 border-yellow-500 text-yellow-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"medium",checked:i.priority==="medium",onChange:()=>f("priority","medium"),className:"sr-only"}),n.jsx(F0,{className:"w-5 h-5"}),n.jsx("span",{children:"متوسطة"})]}),n.jsxs("label",{className:`flex items-center justify-center gap-2 p-3 border rounded-xl cursor-pointer transition-colors ${i.priority==="high"?"bg-red-50 border-red-500 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"radio",name:"priority",value:"high",checked:i.priority==="high",onChange:()=>f("priority","high"),className:"sr-only"}),n.jsx(F0,{className:"w-5 h-5"}),n.jsx("span",{children:"عالية"})]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:r,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:l,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الإنشاء..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),"إنشاء المهمة"]})})]})]})]})})},T6=()=>{var fe;const{t:e}=jt(),{id:t}=pj(),[r,a]=C.useState("overview"),[s,i]=C.useState(null),[o,l]=C.useState([]),[c,d]=C.useState([]),[u,f]=C.useState(!0),[h,m]=C.useState(null),{user:x}=wt(),{evaluations:p,loading:g}=Ij(t),[y,b]=C.useState(!1),[v,w]=C.useState(!1),{fetchProjects:j,updateProject:N}=Ii(),[_,E]=C.useState(null),[S,k]=C.useState([]),[O,P]=C.useState(!1),[A,R]=C.useState(null),[T,F]=C.useState(!1),[W,K]=C.useState(!1),B=(x==null?void 0:x.role)==="student",L=(x==null?void 0:x.role)==="teacher",ee=(x==null?void 0:x.role)==="school",M=(x==null?void 0:x.role)==="admin",G=(x==null?void 0:x.id)===(s==null?void 0:s.teacher_id),V=(L||ee||M)&&(s==null?void 0:s.status)==="draft",H=async()=>{if(t)try{f(!0);const oe=await Ej(t);if(!oe){m("المشروع غير موجود"),f(!1);return}const qe=await oc(t);console.log("Students data received in ProjectDetails:",qe);const st=await Ph(t);let lt=0;try{const Ft=Me(pe,"project_evaluations"),Vt=et(Ft,We("projectId","==",t)),Jt=await Je(Vt);if(Jt.empty)console.log(`No evaluation found for project ${t}, using default progress:`,lt);else{const Dr=Jt.docs[0].data();Dr.criteria&&Dr.criteria.length>0&&(lt=Dr.criteria[0].score||0,console.log(`Found evaluation for project ${t}, completion score:`,lt))}}catch(Ft){console.error(`Error fetching evaluation for project ${t}:`,Ft)}if(console.log("Original due_date:",oe.due_date),i({...oe,progress:lt,due_date:oe.due_date}),l(qe),d(st),oe.status==="draft"){if(L)E(x.id),P(!1);else if(ee){const Ft=await g3(x.id);k(Ft),P(!0),E(oe.teacher_id||null)}else if(M){const Ft=await p3();k(Ft),P(!0),E(oe.teacher_id||null)}}else E(oe.teacher_id||null),P(!1)}catch(oe){console.error("Error fetching project details:",oe),m(oe instanceof Error?oe.message:"حدث خطأ في تحميل تفاصيل المشروع")}finally{f(!1)}};C.useEffect(()=>{H()},[t,x]);const re=async()=>{if(t)try{const oe=await oc(t);l(oe)}catch(oe){console.error("Error refreshing students:",oe)}},me=async()=>{if(t)try{const oe=await Ph(t);d(oe)}catch(oe){console.error("Error refreshing tasks:",oe)}},xe=async()=>{await H(),await j()},Z=async()=>{if((ee||M)&&!_){R(e("projectDetails.errors.selectTeacherRequired"));return}F(!0),R(null),K(!1);try{await N(t||"",{status:"active",teacher_id:_}),K(!0),await H(),await j(),setTimeout(()=>{K(!1)},3e3)}catch(oe){console.error("Error approving project:",oe),R(oe instanceof Error?oe.message:"حدث خطأ في اعتماد المشروع")}finally{F(!1)}},q=oe=>{switch(oe){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},ie=oe=>{switch(oe){case"completed":return"مكتمل";case"in_progress":return"قيد التنفيذ";case"pending":return"في الانتظار";default:return oe}},I=oe=>{switch(oe){case"document":return n.jsx(yr,{className:"w-5 h-5"});case"video":return n.jsx(wr,{className:"w-5 h-5"});case"image":return n.jsx(dd,{className:"w-5 h-5"});case"link":return n.jsx(cu,{className:"w-5 h-5"});default:return n.jsx(yr,{className:"w-5 h-5"})}};if(u)return n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})});if(h||!s)return n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:h||"لم يتم العثور على المشروع"}),n.jsx(Ae,{to:"/projects",className:"mt-4 inline-block px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة إلى المشاريع"})]})});const ve=c.filter(oe=>oe.status==="completed").length,we=c.length,Ee=s.due_date?El(s.due_date):null;console.log("Project due_date:",s.due_date),console.log("Days remaining:",Ee);const ce=M||ee||G||L&&s.status==="draft"&&s.school_id===(x==null?void 0:x.school_id)||B&&s.status==="draft"&&o.some(oe=>oe.student_id===(x==null?void 0:x.id));return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ae,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:s.title}),n.jsx("p",{className:"text-gray-600",children:s.description})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ss,{className:"w-5 h-5 text-gray-600"})}),ce&&n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(vo,{className:"w-5 h-5 text-gray-600"})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 mb-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(cd,{className:"w-8 h-8 text-blue-600"})}),n.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[s.progress.toFixed(1),"/10"]}),n.jsx("div",{className:"text-sm text-gray-600",children:"درجة الإنجاز"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(ze,{className:"w-8 h-8 text-green-600"})}),n.jsxs("div",{className:"text-2xl font-bold text-gray-800",children:[ve,"/",we]}),n.jsx("div",{className:"text-sm text-gray-600",children:"المهام"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(dt,{className:"w-8 h-8 text-purple-600"})}),n.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o.length}),n.jsx("div",{className:"text-sm text-gray-600",children:"الطلاب"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-2xl flex items-center justify-center mx-auto mb-2",children:n.jsx(tt,{className:"w-8 h-8 text-orange-600"})}),n.jsx("div",{className:`text-2xl font-bold ${Ee!==null?Ee<0?"text-red-600":Ee<=7?"text-yellow-600":"text-green-600":"text-gray-600"}`,children:Ee!==null?Ee<0?"متأخر":`${Ee} يوم`:"--"}),n.jsx("div",{className:"text-sm text-gray-600",children:"يوم متبقي"})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-gray-700",children:"درجة الإنجاز"}),n.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[s.progress.toFixed(1),"/10"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:n.jsx("div",{className:"h-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full transition-all duration-300",style:{width:`${s.progress/10*100}%`}})})]}),s.status==="draft"&&V&&n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-xl",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:e("projectDetails.approveProject")}),W&&n.jsxs("div",{className:"bg-green-100 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-4 flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5"}),n.jsx("span",{children:e("projectDetails.projectApproved")})]}),A&&n.jsxs("div",{className:"bg-red-100 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 flex items-center gap-2",children:[n.jsx(ca,{className:"w-5 h-5"}),n.jsx("span",{children:A})]}),n.jsxs("div",{className:"space-y-4",children:[O&&n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:e("projectDetails.supervisorTeacher")}),n.jsxs("select",{value:_||"",onChange:oe=>E(oe.target.value||null),className:"w-full px-4 py-3 border border-blue-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"",children:e("projectDetails.selectTeacher")}),S.map(oe=>n.jsxs("option",{value:oe.id,children:[oe.name," ",oe.subject?`(${oe.subject})`:""]},oe.id))]})]}),L&&!O&&n.jsx("p",{className:"text-blue-700 mb-4",children:e("projectDetails.assignedToYou")}),n.jsx("button",{onClick:Z,disabled:T||!_&&(ee||M),className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:T?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e("projectDetails.approving")]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),e("projectDetails.approveProject")]})})]})]})]})}),n.jsx("div",{className:"border-b border-gray-200",children:n.jsx("nav",{className:"flex space-x-8",children:[{id:"overview",name:"نظرة عامة",icon:Zn},{id:"tasks",name:"المهام",icon:ze},{id:"team",name:"الفريق",icon:dt},{id:"resources",name:"الموارد",icon:yr},{id:"chat",name:"المحادثة",icon:zt},{id:"evaluation",name:"التقييم",icon:ar}].map(oe=>n.jsxs("button",{onClick:()=>a(oe.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${r===oe.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(oe.icon,{className:"w-4 h-4"}),oe.name]},oe.id))})})]}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2",children:[r==="overview"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"أهداف المشروع"}),n.jsx("div",{className:"space-y-3",children:s.objectives&&s.objectives.map((oe,qe)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mt-0.5",children:n.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),n.jsx("p",{className:"text-gray-700 leading-relaxed",children:oe})]},qe))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"النشاط الأخير"}),c.length>0?n.jsx("div",{className:"space-y-4",children:c.slice(0,3).map(oe=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${oe.status==="completed"?"bg-green-100":oe.status==="in_progress"?"bg-blue-100":"bg-yellow-100"}`,children:oe.status==="completed"?n.jsx(ze,{className:"w-5 h-5 text-green-600"}):n.jsx(_t,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-gray-800",children:oe.title}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q(oe.status)}`,children:ie(oe.status)})]}),n.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:oe.description}),n.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["تاريخ الاستحقاق: ",Ze(oe.due_date)]})]})]},oe.id))}):n.jsx("p",{className:"text-gray-600 text-center py-4",children:"لا يوجد نشاط حديث"})]})]}),r==="tasks"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"المهام"}),ce&&n.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),"مهمة جديدة"]})]}),n.jsx("div",{className:"space-y-4",children:c.length>0?c.map(oe=>{var qe,st;return n.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:oe.title}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${q(oe.status)}`,children:ie(oe.status)})]}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:oe.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{children:["المسؤول: ",((st=(qe=o.find(lt=>lt.student_id===oe.assigned_to))==null?void 0:qe.student)==null?void 0:st.name)||"غير محدد"]}),n.jsxs("span",{children:["الموعد النهائي: ",Ze(oe.due_date)]})]})]}),ce&&n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ca,{className:"w-4 h-4 text-gray-400"})})]}),oe.status==="in_progress"&&oe.progress&&n.jsxs("div",{className:"mt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("span",{className:"text-xs text-gray-600",children:"التقدم"}),n.jsxs("span",{className:"text-xs text-gray-600",children:[oe.progress,"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"h-2 bg-blue-500 rounded-full transition-all duration-300",style:{width:`${oe.progress}%`}})})]})]},oe.id)}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ze,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد مهام"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم إضافة مهام لهذا المشروع بعد"})]})})]}),r==="team"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"فريق العمل"}),ce&&n.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),"إضافة عضو"]})]}),n.jsx("div",{className:"space-y-4",children:o.length>0?o.map(oe=>{var qe,st,lt,Ft;return n.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:shadow-md transition-all",children:[n.jsx("img",{src:((qe=oe.student)==null?void 0:qe.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:((st=oe.student)==null?void 0:st.name)||"طالب",className:"w-16 h-16 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:((lt=oe.student)==null?void 0:lt.name)||"طالب غير معروف"}),oe.role==="leader"&&n.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full",children:"قائد الفريق"})]}),n.jsx("p",{className:"text-gray-600 text-sm",children:((Ft=oe.student)==null?void 0:Ft.email)||"بريد إلكتروني غير متوفر"}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("span",{children:["المهام المكتملة: ",c.filter(Vt=>Vt.assigned_to===oe.student_id&&Vt.status==="completed").length]}),n.jsxs("span",{children:["المهام النشطة: ",c.filter(Vt=>Vt.assigned_to===oe.student_id&&Vt.status==="in_progress").length]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(zt,{className:"w-4 h-4 text-gray-400"})}),ce&&n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ca,{className:"w-4 h-4 text-gray-400"})})]})]},oe.id)}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد طلاب"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم إضافة طلاب لهذا المشروع بعد"})]})})]}),r==="resources"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"الموارد"}),ce&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:[n.jsx(bi,{className:"w-4 h-4"}),"رفع ملف"]})]}),n.jsx("div",{className:"space-y-4",children:s.resources&&s.resources.length>0?s.resources.map(oe=>{var qe,st;return n.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:shadow-md transition-all",children:[n.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center",children:I(oe.type)}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-1",children:oe.title}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{children:["رفع بواسطة: ",((st=(qe=o.find(lt=>lt.student_id===oe.uploaded_by))==null?void 0:qe.student)==null?void 0:st.name)||"غير معروف"]}),n.jsx("span",{children:Ze(oe.created_at)})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Cr,{className:"w-4 h-4 text-gray-400"})}),n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ss,{className:"w-4 h-4 text-gray-400"})})]})]},oe.id)}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(yr,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد موارد"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم إضافة موارد لهذا المشروع بعد"})]})})]}),r==="chat"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-6",children:"محادثة الفريق"}),n.jsx(k6,{projectId:t||""})]}),r==="evaluation"&&n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"space-y-6",children:L&&G?n.jsx(_6,{projectId:t||"",onSaved:xe}):n.jsx(n.Fragment,{children:g?n.jsx("div",{className:"flex items-center justify-center p-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):p.length>0?n.jsx(S6,{evaluation:p[0],teacherName:s.teacher_name||"المعلم"}):n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد تقييم"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم تقييم المشروع بعد من قبل المعلم"})]})})})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الحالة"}),n.jsx("div",{className:"mt-1",children:n.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:[n.jsx(wi,{className:"w-4 h-4"}),ie(s.status)]})})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الفئة"}),n.jsx("p",{className:"mt-1 text-gray-800",children:s.category==="stem"?"العلوم والتقنية":s.category==="entrepreneurship"?"ريادة الأعمال":s.category==="volunteer"?"التطوع":s.category==="ethics"?"الأخلاق":s.category})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الموضوع"}),n.jsx("p",{className:"mt-1 text-gray-800",children:s.subject})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"تاريخ البداية"}),n.jsx("p",{className:"mt-1 text-gray-800",children:Ze(s.created_at)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"الموعد النهائي"}),n.jsx("p",{className:"mt-1 text-gray-800",children:Ze(s.due_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:e("projectDetails.supervisorTeacher")}),n.jsx("p",{className:"mt-1 text-gray-800",children:s.teacher_id?((fe=S.find(oe=>oe.id===s.teacher_id))==null?void 0:fe.name)||"معلم غير معروف":"غير محدد"})]}),s.rating&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium text-gray-500 mb-1",children:"التقييم"}),n.jsxs("div",{className:"mt-1 flex items-center gap-1",children:[n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(oe=>n.jsx(at,{className:`w-5 h-5 ${oe<=s.rating?"text-yellow-400 fill-current":"text-gray-300"}`},oe))}),n.jsxs("span",{className:"text-gray-600 text-sm",children:["(",s.rating.toFixed(1),")"]})]})]})]})]}),ce&&n.jsxs(te.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"إجراءات سريعة"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("button",{onClick:()=>w(!0),className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-blue-50 text-blue-700 rounded-xl hover:bg-blue-100 transition-colors",children:[n.jsx(yt,{className:"w-5 h-5"}),"إضافة مهمة جديدة"]}),n.jsxs("button",{onClick:()=>b(!0),className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-green-50 text-green-700 rounded-xl hover:bg-green-100 transition-colors",children:[n.jsx(dt,{className:"w-5 h-5"}),"دعوة عضو جديد"]}),n.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-purple-50 text-purple-700 rounded-xl hover:bg-purple-100 transition-colors",children:[n.jsx(bi,{className:"w-5 h-5"}),"رفع ملف"]}),n.jsxs("button",{className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-orange-50 text-orange-700 rounded-xl hover:bg-orange-100 transition-colors",children:[n.jsx(Ss,{className:"w-5 h-5"}),"مشاركة المشروع"]}),L&&G&&n.jsxs("button",{onClick:()=>a("evaluation"),className:"w-full flex items-center gap-3 px-4 py-3 text-right bg-yellow-50 text-yellow-700 rounded-xl hover:bg-yellow-100 transition-colors",children:[n.jsx(ar,{className:"w-5 h-5"}),"تقييم المشروع"]})]})]}),n.jsxs(te.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.4},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"أعضاء الفريق"}),n.jsx("div",{className:"space-y-3",children:o.length>0?o.map(oe=>{var qe,st,lt;return n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:((qe=oe.student)==null?void 0:qe.avatar_url)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:((st=oe.student)==null?void 0:st.name)||"طالب",className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-gray-800 text-sm",children:((lt=oe.student)==null?void 0:lt.name)||"طالب غير معروف"}),n.jsx("p",{className:"text-xs text-gray-500",children:oe.role==="leader"?"قائد الفريق":"عضو"})]}),n.jsx("button",{className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(zt,{className:"w-4 h-4 text-gray-400"})})]},oe.id)}):n.jsx("p",{className:"text-gray-600 text-center py-2",children:"لا يوجد أعضاء في الفريق"})})]})]})]}),y&&n.jsx(E6,{projectId:t||"",maxStudents:s.max_students||5,currentStudents:o,onClose:()=>b(!1),onSuccess:re}),v&&n.jsx(A6,{projectId:t||"",students:o,onClose:()=>w(!1),onSuccess:me})]})},C6=()=>{var A,R;const{t:e}=jt(),t=Ho(),{user:r}=wt(),{students:a}=Sx(),{createProject:s}=Ii(),[i,o]=C.useState(1),[l,c]=C.useState([]),[d,u]=C.useState(""),[f,h]=C.useState(!1),m=(r==null?void 0:r.role)==="student"?"draft":"active",[x,p]=C.useState({title:"",description:"",problemSolved:"",category:"",subject:"",difficulty:"",duration:"",objectives:[""],materials:[""],steps:[""],due_date:"",maxStudents:5,status:m,selectedStudentIds:[]});C.useEffect(()=>{p(T=>({...T,selectedStudentIds:l}))},[l]);const g=(T,F)=>{p(W=>({...W,[T]:F}))},y=(T,F,W)=>{p(K=>({...K,[T]:K[T].map((B,L)=>L===F?W:B)}))},b=T=>{p(F=>({...F,[T]:[...F[T],""]}))},v=(T,F)=>{p(W=>({...W,[T]:W[T].filter((K,B)=>B!==F)}))},w=T=>{c(F=>F.includes(T)?F.filter(W=>W!==T):P.length+F.length>=x.maxStudents?F:[...F,T])},j=async()=>{try{h(!0),await s({...x,progress:0,due_date:x.due_date}),t("/projects")}catch(T){console.error("Error creating project:",T),alert(e("createProject.errors.creationFailed"))}finally{h(!1)}},N=()=>{i<5&&o(i+1)},_=()=>{i>1&&o(i-1)},E=[{number:1,title:e("createProject.steps.basicInfo"),icon:yr},{number:2,title:e("createProject.steps.detailsObjectives"),icon:cd},{number:3,title:e("createProject.steps.materialsSteps"),icon:Nt},{number:4,title:e("createProject.steps.finalSettings"),icon:tt},{number:5,title:e("createProject.steps.addStudents"),icon:dt}],S=[{id:"stem",name:e("projects.categories.stem"),description:e("createProject.categories.stemDesc")},{id:"entrepreneurship",name:e("projects.categories.entrepreneurship"),description:e("createProject.categories.entrepreneurshipDesc")},{id:"volunteer",name:e("projects.categories.volunteer"),description:e("createProject.categories.volunteerDesc")},{id:"ethics",name:e("projects.categories.ethics"),description:e("createProject.categories.ethicsDesc")}],k=[{id:"beginner",name:e("projectIdeas.difficulties.beginner"),description:e("createProject.difficulties.beginnerDesc")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate"),description:e("createProject.difficulties.intermediateDesc")},{id:"advanced",name:e("projectIdeas.difficulties.advanced"),description:e("createProject.difficulties.advancedDesc")}],O=a.filter(T=>T.name.toLowerCase().includes(d.toLowerCase())||T.email.toLowerCase().includes(d.toLowerCase())),P=[];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ae,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("createProject.title")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.subtitle")})]})]}),n.jsx("div",{className:"flex items-center justify-between mb-6",children:E.map((T,F)=>n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-3 ${F<E.length-1?"flex-1":""}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${i>=T.number?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:n.jsx(T.icon,{className:"w-6 h-6"})}),n.jsx("div",{className:"hidden md:block",children:n.jsx("p",{className:`font-medium ${i>=T.number?"text-blue-600":"text-gray-600"}`,children:T.title})})]}),F<E.length-1&&n.jsx("div",{className:`hidden md:block flex-1 h-1 mx-4 ${i>T.number?"bg-blue-500":"bg-gray-200"}`})]},T.number))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[i===1&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.basicInfo")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.startWithBasicInfo")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.title")," *"]}),n.jsx("input",{type:"text",value:x.title,onChange:T=>g("title",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.titlePlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.description")," *"]}),n.jsx("textarea",{value:x.description,onChange:T=>g("description",T.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.descriptionPlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.problemSolved")}),n.jsx("textarea",{value:x.problemSolved,onChange:T=>g("problemSolved",T.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.problemSolvedPlaceholder")})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.category")," *"]}),n.jsx("div",{className:"space-y-2",children:S.map(T=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"category",value:T.id,checked:x.category===T.id,onChange:F=>g("category",F.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:T.name}),n.jsx("p",{className:"text-sm text-gray-600",children:T.description})]})]},T.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.subject")," *"]}),n.jsx("input",{type:"text",value:x.subject,onChange:T=>g("subject",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.subjectPlaceholder")}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.difficulty")," *"]}),n.jsx("div",{className:"space-y-2",children:k.map(T=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"difficulty",value:T.id,checked:x.difficulty===T.id,onChange:F=>g("difficulty",F.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:T.name}),n.jsx("p",{className:"text-sm text-gray-600",children:T.description})]})]},T.id))})]})]})]})]}),i===2&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.detailsObjectives")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.defineObjectives")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.duration")," *"]}),n.jsx("input",{type:"text",value:x.duration,onChange:T=>g("duration",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.durationPlaceholder")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.maxStudents")}),n.jsx("input",{type:"number",value:x.maxStudents,onChange:T=>g("maxStudents",parseInt(T.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"20"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.objectives")," *"]}),n.jsxs("div",{className:"space-y-3",children:[x.objectives.map((T,F)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:T,onChange:W=>y("objectives",F,W.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.objective")} ${F+1}`}),x.objectives.length>1&&n.jsx("button",{onClick:()=>v("objectives",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Ot,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{onClick:()=>b("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),e("createProject.form.addNewObjective")]})]})]})]}),i===3&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.materialsSteps")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.defineMaterialsSteps")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.materials")}),n.jsxs("div",{className:"space-y-3",children:[x.materials.map((T,F)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:T,onChange:W=>y("materials",F,W.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.material")} ${F+1}`}),x.materials.length>1&&n.jsx("button",{onClick:()=>v("materials",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Ot,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{onClick:()=>b("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),e("createProject.form.addNewMaterial")]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.implementationSteps")}),n.jsxs("div",{className:"space-y-3",children:[x.steps.map((T,F)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:F+1}),n.jsx("textarea",{value:T,onChange:W=>y("steps",F,W.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.step")} ${F+1}`,rows:2}),x.steps.length>1&&n.jsx("button",{onClick:()=>v("steps",F),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(Ot,{className:"w-5 h-5"})})]},F)),n.jsxs("button",{onClick:()=>b("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),e("createProject.form.addNewStep")]})]})]})]}),i===4&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.finalSettings")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.setDeadlineStatus")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.deadline")}),n.jsx("input",{type:"date",value:x.due_date,onChange:T=>g("due_date",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.status")}),n.jsxs("select",{value:x.status,onChange:T=>g("status",T.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0,children:[n.jsx("option",{value:"draft",children:e("projects.statuses.draft")}),n.jsx("option",{value:"active",children:e("projects.statuses.active")})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("createProject.projectSummary")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.title"),":"]}),n.jsx("span",{className:"font-medium",children:x.title||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.category"),":"]}),n.jsx("span",{className:"font-medium",children:((A=S.find(T=>T.id===x.category))==null?void 0:A.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.difficulty"),":"]}),n.jsx("span",{className:"font-medium",children:((R=k.find(T=>T.id===x.difficulty))==null?void 0:R.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.duration"),":"]}),n.jsx("span",{className:"font-medium",children:x.duration||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.objectivesCount"),":"]}),n.jsx("span",{className:"font-medium",children:x.objectives.filter(T=>T.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.materialsCount"),":"]}),n.jsx("span",{className:"font-medium",children:x.materials.filter(T=>T.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.stepsCount"),":"]}),n.jsx("span",{className:"font-medium",children:x.steps.filter(T=>T.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.initialProgress"),":"]}),n.jsx("span",{className:"font-medium",children:"0/10"})]})]})]})]}),i===5&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.addStudents")}),n.jsx("p",{className:"text-gray-600",children:e("createProject.chooseParticipatingStudents")})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("createProject.searchStudentsPlaceholder"),value:d,onChange:T=>u(T.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-blue-800 font-medium",children:e("createProject.selectedStudents",{count:l.length,max:x.maxStudents})}),n.jsx("button",{onClick:()=>c([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:e("common.clearAll")})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:O.length>0?O.map(T=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${l.includes(T.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>w(T.id),children:[n.jsx("input",{type:"checkbox",checked:l.includes(T.id),onChange:()=>w(T.id),disabled:!l.includes(T.id)&&P.length+l.length>=x.maxStudents,className:"text-blue-600"}),n.jsx("img",{src:T.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:T.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:T.name}),l.includes(T.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e("createProject.selected")})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ta,{className:"w-4 h-4"}),T.email]}),T.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ts,{className:"w-4 h-4"}),T.grade]})]})]})]},T.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("createProject.noStudents")}),n.jsx("p",{className:"text-gray-600",children:e(d?"createProject.noStudentsMatch":"createProject.noStudentsAvailable")})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("createProject.importantInfo"),":"]}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• ",e("createProject.onlySchoolStudents")]}),n.jsxs("li",{children:["• ",e("createProject.canAddUpTo",{max:x.maxStudents})]}),n.jsxs("li",{children:["• ",e("createProject.canModifyLater")]}),n.jsxs("li",{children:["• ",e("createProject.searchIncludesNameEmail")]})]})]})]}),n.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-200",children:[n.jsx("div",{children:i>1&&n.jsx("button",{onClick:_,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.previous")})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ae,{to:"/projects",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),i<5?n.jsx("button",{onClick:N,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.next")}):n.jsxs("button",{onClick:j,disabled:f,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(es,{className:"w-5 h-5"}),e(f?"createProject.creating":"createProject.createProject")]})]})]})]})]})},O6=()=>{var K,B;const{t:e}=jt(),t=Ho(),{id:r}=pj(),{user:a}=wt(),{students:s}=Sx(),{updateProject:i}=Ii(),[o,l]=C.useState(1),[c,d]=C.useState([]),[u,f]=C.useState([]),[h,m]=C.useState(""),[x,p]=C.useState(!0),[g,y]=C.useState(null),[b,v]=C.useState([]);a==null||a.role,a==null||a.role,a==null||a.role,a==null||a.role;const[w,j]=C.useState({title:"",description:"",category:"",subject:"",difficulty:"",duration:"",objectives:[""],materials:[""],steps:[""],due_date:"",maxStudents:5,status:"draft",selectedStudentIds:[]});C.useEffect(()=>{(async()=>{var ee,M,G;if(!r){y("Project ID is missing"),p(!1);return}try{p(!0),y(null);const V=await Ej(r);if(!V){y("المشروع غير موجود"),p(!1);return}const H=await oc(r);v(H);const re=H.map(xe=>xe.student_id);f(re);let me="";V.due_date&&(me=new Date(V.due_date).toISOString().split("T")[0]),j({title:V.title||"",description:V.description||"",category:V.category||"",subject:V.subject||"",difficulty:V.difficulty||"",duration:V.duration||"",objectives:(ee=V.objectives)!=null&&ee.length?V.objectives:[""],materials:(M=V.materials)!=null&&M.length?V.materials:[""],steps:(G=V.steps)!=null&&G.length?V.steps:[""],due_date:me,maxStudents:V.max_students||5,status:V.status||"draft",selectedStudentIds:re}),p(!1)}catch(V){console.error("Error fetching project data:",V),y(V instanceof Error?V.message:"حدث خطأ في تحميل بيانات المشروع"),p(!1)}})()},[r]),C.useEffect(()=>{if(a&&a.school_id&&s.length>0){const L=s.filter(ee=>ee.school_id===a.school_id);d(L)}},[a,s]),C.useEffect(()=>{j(L=>({...L,selectedStudentIds:u}))},[u]);const N=(L,ee)=>{j(M=>({...M,[L]:ee}))},_=(L,ee,M)=>{j(G=>({...G,[L]:G[L].map((V,H)=>H===ee?M:V)}))},E=L=>{j(ee=>({...ee,[L]:[...ee[L],""]}))},S=(L,ee)=>{j(M=>({...M,[L]:M[L].filter((G,V)=>V!==ee)}))},k=L=>{f(ee=>ee.includes(L)?ee.filter(M=>M!==L):ee.length>=w.maxStudents?(alert(`لا يمكن إضافة أكثر من ${w.maxStudents} طلاب لهذا المشروع`),ee):[...ee,L])},O=async()=>{var L,ee,M;if(!r){y("Project ID is missing");return}try{p(!0),y(null);const G={...w,objectives:((L=w.objectives)==null?void 0:L.filter(V=>V.trim()))||[],materials:((ee=w.materials)==null?void 0:ee.filter(V=>V.trim()))||[],steps:((M=w.steps)==null?void 0:M.filter(V=>V.trim()))||[],max_students:w.maxStudents,selectedStudentIds:u};await i(r,G),t("/projects")}catch(G){console.error("Error updating project:",G),y(G instanceof Error?G.message:"حدث خطأ في تحديث المشروع"),p(!1)}},P=()=>{o<5&&l(o+1)},A=()=>{o>1&&l(o-1)},R=[{number:1,title:e("createProject.steps.basicInfo"),icon:yr},{number:2,title:e("createProject.steps.detailsObjectives"),icon:cd},{number:3,title:e("createProject.steps.materialsSteps"),icon:Nt},{number:4,title:e("createProject.steps.finalSettings"),icon:tt},{number:5,title:e("createProject.steps.addStudents"),icon:dt}],T=[{id:"stem",name:e("projects.categories.stem"),description:e("createProject.categories.stemDesc")},{id:"entrepreneurship",name:e("projects.categories.entrepreneurship"),description:e("createProject.categories.entrepreneurshipDesc")},{id:"volunteer",name:e("projects.categories.volunteer"),description:e("createProject.categories.volunteerDesc")},{id:"ethics",name:e("projects.categories.ethics"),description:e("createProject.categories.ethicsDesc")}],F=[{id:"beginner",name:e("projectIdeas.difficulties.beginner"),description:e("createProject.difficulties.beginnerDesc")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate"),description:e("createProject.difficulties.intermediateDesc")},{id:"advanced",name:e("projectIdeas.difficulties.advanced"),description:e("createProject.difficulties.advancedDesc")}],W=c.filter(L=>{var ee,M;return((ee=L.name)==null?void 0:ee.toLowerCase().includes(h.toLowerCase()))||((M=L.email)==null?void 0:M.toLowerCase().includes(h.toLowerCase()))||L.grade&&L.grade.toLowerCase().includes(h.toLowerCase())});return x?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:g}),n.jsx(Ae,{to:"/projects",className:"mt-4 inline-block px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة إلى المشاريع"})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[n.jsx(Ae,{to:"/projects",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Qn,{className:"w-6 h-6 text-gray-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:e("editProject.title")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.subtitle")})]})]}),n.jsx("div",{className:"flex items-center justify-between mb-6",children:R.map((L,ee)=>n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-3 ${ee<R.length-1?"flex-1":""}`,children:[n.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${o>=L.number?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:n.jsx(L.icon,{className:"w-6 h-6"})}),n.jsx("div",{className:"hidden md:block",children:n.jsx("p",{className:`font-medium ${o>=L.number?"text-blue-600":"text-gray-600"}`,children:L.title})})]}),ee<R.length-1&&n.jsx("div",{className:`hidden md:block flex-1 h-1 mx-4 ${o>L.number?"bg-blue-500":"bg-gray-200"}`})]},L.number))})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[o===1&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.basicInfo")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyBasicInfo")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.title")," *"]}),n.jsx("input",{type:"text",value:w.title,onChange:L=>N("title",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.titlePlaceholder")})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.description")," *"]}),n.jsx("textarea",{value:w.description,onChange:L=>N("description",L.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.descriptionPlaceholder")})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.category")," *"]}),n.jsx("div",{className:"space-y-2",children:T.map(L=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"category",value:L.id,checked:w.category===L.id,onChange:ee=>N("category",ee.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:L.name}),n.jsx("p",{className:"text-sm text-gray-600",children:L.description})]})]},L.id))})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.subject")," *"]}),n.jsx("input",{type:"text",value:w.subject,onChange:L=>N("subject",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.subjectPlaceholder")}),n.jsxs("div",{className:"mt-4",children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.difficulty")," *"]}),n.jsx("div",{className:"space-y-2",children:F.map(L=>n.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-50",children:[n.jsx("input",{type:"radio",name:"difficulty",value:L.id,checked:w.difficulty===L.id,onChange:ee=>N("difficulty",ee.target.value),className:"text-blue-600"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:L.name}),n.jsx("p",{className:"text-sm text-gray-600",children:L.description})]})]},L.id))})]})]})]})]}),o===2&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.detailsObjectives")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyObjectives")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.duration")," *"]}),n.jsx("input",{type:"text",value:w.duration,onChange:L=>N("duration",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:e("createProject.form.durationPlaceholder")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.maxStudents")}),n.jsx("input",{type:"number",value:w.maxStudents,onChange:L=>N("maxStudents",parseInt(L.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"1",max:"20"})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e("createProject.form.objectives")," *"]}),n.jsxs("div",{className:"space-y-3",children:[w.objectives.map((L,ee)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:L,onChange:M=>_("objectives",ee,M.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.objective")} ${ee+1}`}),w.objectives.length>1&&n.jsx("button",{onClick:()=>S("objectives",ee),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Ot,{className:"w-5 h-5"})})]},ee)),n.jsxs("button",{onClick:()=>E("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),e("createProject.form.addNewObjective")]})]})]})]}),o===3&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.materialsSteps")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyMaterialsSteps")})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.materials")}),n.jsxs("div",{className:"space-y-3",children:[w.materials.map((L,ee)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:L,onChange:M=>_("materials",ee,M.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.material")} ${ee+1}`}),w.materials.length>1&&n.jsx("button",{onClick:()=>S("materials",ee),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(Ot,{className:"w-5 h-5"})})]},ee)),n.jsxs("button",{onClick:()=>E("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),e("createProject.form.addNewMaterial")]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.implementationSteps")}),n.jsxs("div",{className:"space-y-3",children:[w.steps.map((L,ee)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:ee+1}),n.jsx("textarea",{value:L,onChange:M=>_("steps",ee,M.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`${e("createProject.form.step")} ${ee+1}`,rows:2}),w.steps.length>1&&n.jsx("button",{onClick:()=>S("steps",ee),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(Ot,{className:"w-5 h-5"})})]},ee)),n.jsxs("button",{onClick:()=>E("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),e("createProject.form.addNewStep")]})]})]})]}),o===4&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("createProject.steps.finalSettings")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.modifyDeadlineStatus")})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.deadline")}),n.jsx("input",{type:"date",value:w.due_date,onChange:L=>N("due_date",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("createProject.form.status")}),n.jsxs("select",{value:w.status,onChange:L=>N("status",L.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:!0,children:[n.jsx("option",{value:"draft",children:e("projects.statuses.draft")}),n.jsx("option",{value:"active",children:e("projects.statuses.active")}),n.jsx("option",{value:"completed",children:e("projects.statuses.completed")}),n.jsx("option",{value:"archived",children:e("projects.statuses.archived")})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("createProject.projectSummary")}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.title"),":"]}),n.jsx("span",{className:"font-medium",children:w.title||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("common.category"),":"]}),n.jsx("span",{className:"font-medium",children:((K=T.find(L=>L.id===w.category))==null?void 0:K.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.difficulty"),":"]}),n.jsx("span",{className:"font-medium",children:((B=F.find(L=>L.id===w.difficulty))==null?void 0:B.name)||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.form.duration"),":"]}),n.jsx("span",{className:"font-medium",children:w.duration||e("createProject.notSpecified")})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.objectivesCount"),":"]}),n.jsx("span",{className:"font-medium",children:w.objectives.filter(L=>L.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.materialsCount"),":"]}),n.jsx("span",{className:"font-medium",children:w.materials.filter(L=>L.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("createProject.stepsCount"),":"]}),n.jsx("span",{className:"font-medium",children:w.steps.filter(L=>L.trim()).length})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{className:"text-gray-600",children:[e("editProject.studentsCount"),":"]}),n.jsxs("span",{className:"font-medium",children:[u.length," ",e("editProject.outOf")," ",w.maxStudents]})]})]})]})]}),o===5&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e("editProject.manageStudents")}),n.jsx("p",{className:"text-gray-600",children:e("editProject.addRemoveStudents")})]}),n.jsxs("div",{className:"relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("createProject.searchStudentsPlaceholder"),value:h,onChange:L=>m(L.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),u.length>0&&n.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-blue-800 font-medium",children:e("createProject.selectedStudents",{count:u.length,max:w.maxStudents})}),n.jsx("button",{onClick:()=>f([]),className:"text-blue-600 hover:text-blue-800 text-sm",children:e("common.clearAll")})]})}),n.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:W.length>0?W.map(L=>n.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-xl transition-all cursor-pointer hover:shadow-md ${u.includes(L.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>k(L.id),children:[n.jsx("input",{type:"checkbox",checked:u.includes(L.id),onChange:()=>k(L.id),disabled:!u.includes(L.id)&&u.length>=w.maxStudents,className:"text-blue-600"}),n.jsx("img",{src:L.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:L.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:L.name}),u.includes(L.id)&&n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:e("createProject.selected")})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ta,{className:"w-4 h-4"}),L.email]}),L.grade&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(xr,{className:"w-4 h-4"}),L.grade]})]})]})]},L.id)):n.jsxs("div",{className:"text-center py-8",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:e("createProject.noStudents")}),n.jsx("p",{className:"text-gray-600",children:e(h?"createProject.noStudentsMatch":"createProject.noStudentsAvailable")})]})}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("createProject.importantInfo"),":"]}),n.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[n.jsxs("li",{children:["• ",e("createProject.onlySchoolStudents")]}),n.jsxs("li",{children:["• ",e("createProject.canAddUpTo",{max:w.maxStudents})]}),n.jsxs("li",{children:["• ",e("editProject.changesWillAffect")]}),n.jsxs("li",{children:["• ",e("createProject.searchIncludesNameEmail")]})]})]})]}),n.jsxs("div",{className:"flex justify-between pt-6 border-t border-gray-200",children:[n.jsx("div",{children:o>1&&n.jsx("button",{onClick:A,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.previous")})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(Ae,{to:"/projects",className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.cancel")}),o<5?n.jsx("button",{onClick:P,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.next")}):n.jsxs("button",{onClick:O,disabled:x,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(es,{className:"w-5 h-5"}),e(x?"editProject.saving":"editProject.saveChanges")]})]})]})]})]})},kx=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=wt(),l=(o==null?void 0:o.role)==="admin",c=async()=>{try{a(!0),i(null);const g=l?await T3():await A3();t(g)}catch(g){console.error("Error fetching project ideas:",g),i(g instanceof Error?g.message:"حدث خطأ في تحميل أفكار المشاريع")}finally{a(!1)}},d=async g=>{try{a(!0),i(null);const y={...g,views:0,downloads:0,rating:4.5,status:"pending"},b=await C3(y);return l&&t(v=>[b,...v]),b}catch(y){throw console.error("Error adding project idea:",y),i(y instanceof Error?y.message:"حدث خطأ في إضافة فكرة المشروع"),y}finally{a(!1)}},u=async(g,y)=>{try{return a(!0),i(null),await O3(g,y),t(b=>b.map(v=>v.id===g?{...v,...y}:v)),!0}catch(b){throw console.error("Error updating project idea:",b),i(b instanceof Error?b.message:"حدث خطأ في تحديث فكرة المشروع"),b}finally{a(!1)}},f=async g=>{try{return a(!0),i(null),await P3(g),t(y=>y.filter(b=>b.id!==g)),!0}catch(y){throw console.error("Error deleting project idea:",y),i(y instanceof Error?y.message:"حدث خطأ في حذف فكرة المشروع"),y}finally{a(!1)}},h=async g=>{try{await F3(g),t(y=>y.map(b=>b.id===g?{...b,views:b.views+1}:b))}catch(y){console.error("Error incrementing views:",y)}},m=async g=>{try{await I3(g),t(y=>y.map(b=>b.id===g?{...b,downloads:b.downloads+1}:b))}catch(y){console.error("Error incrementing downloads:",y)}},x=async g=>{if(!l)throw new Error("Only admins can approve ideas");return await u(g,{status:"approved"})},p=async(g,y)=>{if(!l)throw new Error("Only admins can reject ideas");return await u(g,{status:"rejected",feedback:y})};return C.useEffect(()=>{c()},[l]),{projectIdeas:e,loading:r,error:s,fetchProjectIdeas:c,addIdea:d,editIdea:u,removeIdea:f,incrementViews:h,incrementDownloads:m,approveIdea:x,rejectIdea:p,isAdmin:l}},Dj=({isOpen:e,onClose:t,onSubmit:r,editingIdea:a})=>{var v,w,j,N;const[s,i]=C.useState({title:"",description:"",category:"stem",difficulty:"beginner",duration:"",subject:"",image:"",objectives:[""],materials:[""],steps:[""],tags:[]}),[o,l]=C.useState(""),[c,d]=C.useState(!1),[u,f]=C.useState(null);C.useEffect(()=>{var _,E,S;i(a?{...a,objectives:(_=a.objectives)!=null&&_.length?a.objectives:[""],materials:(E=a.materials)!=null&&E.length?a.materials:[""],steps:(S=a.steps)!=null&&S.length?a.steps:[""],tags:a.tags||[]}:{title:"",description:"",category:"stem",difficulty:"beginner",duration:"",subject:"",image:"",objectives:[""],materials:[""],steps:[""],tags:[]}),l(""),f(null)},[a,e]);const h=(_,E)=>{i(S=>({...S,[_]:E}))},m=(_,E,S)=>{i(k=>{var O;return{...k,[_]:(O=k[_])==null?void 0:O.map((P,A)=>A===E?S:P)}})},x=_=>{i(E=>({...E,[_]:[...E[_]||[],""]}))},p=(_,E)=>{i(S=>{var k;return{...S,[_]:(k=S[_])==null?void 0:k.filter((O,P)=>P!==E)}})},g=()=>{o.trim()&&(i(_=>({..._,tags:[..._.tags||[],o.trim()]})),l(""))},y=_=>{i(E=>{var S;return{...E,tags:(S=E.tags)==null?void 0:S.filter((k,O)=>O!==_)}})},b=async _=>{var S,k,O;if(_.preventDefault(),!s.title||!s.description||!s.category||!s.difficulty){f("يرجى ملء جميع الحقول المطلوبة");return}const E={...s,objectives:((S=s.objectives)==null?void 0:S.filter(P=>P.trim()))||[],materials:((k=s.materials)==null?void 0:k.filter(P=>P.trim()))||[],steps:((O=s.steps)==null?void 0:O.filter(P=>P.trim()))||[]};d(!0),f(null);try{await r(E),t()}catch(P){console.error("Error submitting idea:",P),f(P instanceof Error?P.message:"حدث خطأ في حفظ فكرة المشروع")}finally{d(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ga,{className:"w-6 h-6 text-blue-600"}),a?"تعديل فكرة مشروع":"إضافة فكرة مشروع جديدة"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),n.jsxs("form",{onSubmit:b,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان المشروع *"}),n.jsx("input",{type:"text",value:s.title,onChange:_=>h("title",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل عنوان المشروع",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المشروع *"}),n.jsx("textarea",{value:s.description,onChange:_=>h("description",_.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"اكتب وصفاً شاملاً للمشروع وأهدافه",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"فئة المشروع *"}),n.jsxs("select",{value:s.category,onChange:_=>h("category",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"stem",children:"العلوم والتقنية"}),n.jsx("option",{value:"entrepreneurship",children:"ريادة الأعمال"}),n.jsx("option",{value:"volunteer",children:"التطوع"}),n.jsx("option",{value:"ethics",children:"الأخلاق"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مستوى الصعوبة *"}),n.jsxs("select",{value:s.difficulty,onChange:_=>h("difficulty",_.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"beginner",children:"مبتدئ"}),n.jsx("option",{value:"intermediate",children:"متوسط"}),n.jsx("option",{value:"advanced",children:"متقدم"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة المتوقعة"}),n.jsxs("div",{className:"relative",children:[n.jsx(_t,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.duration,onChange:_=>h("duration",_.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: 6-8 أسابيع"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الموضوع/المادة"}),n.jsxs("div",{className:"relative",children:[n.jsx(Nt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.subject,onChange:_=>h("subject",_.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"مثال: الفيزياء، البرمجة، التسويق"})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة"}),n.jsxs("div",{className:"relative",children:[n.jsx(dd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.image,onChange:_=>h("image",_.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أدخل رابط صورة المشروع"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"أهداف المشروع"}),n.jsxs("div",{className:"space-y-3",children:[(v=s.objectives)==null?void 0:v.map((_,E)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:E+1}),n.jsx("input",{type:"text",value:_,onChange:S=>m("objectives",E,S.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`الهدف ${E+1}`}),s.objectives.length>1&&n.jsx("button",{type:"button",onClick:()=>p("objectives",E),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(sr,{className:"w-5 h-5"})})]},E)),n.jsxs("button",{type:"button",onClick:()=>x("objectives"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),"إضافة هدف جديد"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المواد والأدوات المطلوبة"}),n.jsxs("div",{className:"space-y-3",children:[(w=s.materials)==null?void 0:w.map((_,E)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:_,onChange:S=>m("materials",E,S.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`المادة ${E+1}`}),s.materials.length>1&&n.jsx("button",{type:"button",onClick:()=>p("materials",E),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(sr,{className:"w-5 h-5"})})]},E)),n.jsxs("button",{type:"button",onClick:()=>x("materials"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),"إضافة مادة جديدة"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"خطوات تنفيذ المشروع"}),n.jsxs("div",{className:"space-y-3",children:[(j=s.steps)==null?void 0:j.map((_,E)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center text-sm font-medium mt-2",children:E+1}),n.jsx("textarea",{value:_,onChange:S=>m("steps",E,S.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`الخطوة ${E+1}`,rows:2}),s.steps.length>1&&n.jsx("button",{type:"button",onClick:()=>p("steps",E),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors mt-2",children:n.jsx(sr,{className:"w-5 h-5"})})]},E)),n.jsxs("button",{type:"button",onClick:()=>x("steps"),className:"flex items-center gap-2 px-4 py-2 text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),"إضافة خطوة جديدة"]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(N=s.tags)==null?void 0:N.map((_,E)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full",children:[n.jsx("span",{children:_}),n.jsx("button",{type:"button",onClick:()=>y(E),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-blue-200",children:n.jsx(Ot,{className:"w-3 h-3"})})]},E))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ud,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:_=>l(_.target.value),onKeyPress:_=>_.key==="Enter"&&(_.preventDefault(),g()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:g,className:"px-4 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(es,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة المشروع"]})})]})]})]})}):null},P6=()=>{const{t:e}=jt(),{user:t}=wt(),r=(t==null?void 0:t.role)==="admin",{projectIdeas:a,loading:s,error:i,addIdea:o,incrementViews:l,incrementDownloads:c}=kx(),[d,u]=C.useState("all"),[f,h]=C.useState("all"),[m,x]=C.useState(""),[p,g]=C.useState(!1),[y,b]=C.useState(null),[v,w]=C.useState(!1),[j,N]=C.useState(!1),_=[{id:"all",name:e("projectIdeas.categories.all"),icon:Nt,color:"from-gray-500 to-gray-600"},{id:"stem",name:e("projectIdeas.categories.stem"),icon:Jk,color:"from-blue-500 to-blue-600"},{id:"entrepreneurship",name:e("projectIdeas.categories.entrepreneurship"),icon:vi,color:"from-green-500 to-green-600"},{id:"volunteer",name:e("projectIdeas.categories.volunteer"),icon:ha,color:"from-red-500 to-red-600"},{id:"ethics",name:e("projectIdeas.categories.ethics"),icon:Ka,color:"from-purple-500 to-purple-600"}],E=[{id:"all",name:e("projectIdeas.difficulties.all")},{id:"beginner",name:e("projectIdeas.difficulties.beginner")},{id:"intermediate",name:e("projectIdeas.difficulties.intermediate")},{id:"advanced",name:e("projectIdeas.difficulties.advanced")}],S=a.filter(F=>{if(!r&&F.status!=="approved")return!1;const W=d==="all"||F.category===d,K=f==="all"||F.difficulty===f,B=F.title.toLowerCase().includes(m.toLowerCase())||F.description.toLowerCase().includes(m.toLowerCase());return W&&K&&B}),k=async F=>{try{await l(F);const W=a.find(K=>K.id===F);W&&b(W)}catch(W){console.error("Error incrementing views:",W)}},O=async F=>{var W,K,B,L;try{await c(F);const ee=a.find(M=>M.id===F);if(ee){const M=`
# ${ee.title}

## الوصف
${ee.description}

## الفئة
${T(ee.category)}

## مستوى الصعوبة
${R(ee.difficulty)}

## المدة المتوقعة
${ee.duration||"غير محدد"}

## الموضوع/المادة
${ee.subject||"غير محدد"}

## الأهداف
${((W=ee.objectives)==null?void 0:W.map(re=>`- ${re}`).join(`
`))||"لا توجد أهداف محددة"}

## المواد المطلوبة
${((K=ee.materials)==null?void 0:K.map(re=>`- ${re}`).join(`
`))||"لا توجد مواد محددة"}

## خطوات التنفيذ
${((B=ee.steps)==null?void 0:B.map((re,me)=>`${me+1}. ${re}`).join(`
`))||"لا توجد خطوات محددة"}

## الكلمات المفتاحية
${((L=ee.tags)==null?void 0:L.map(re=>`#${re}`).join(" "))||"لا توجد كلمات مفتاحية"}
        `,G=new Blob([M],{type:"text/plain;charset=utf-8"}),V=URL.createObjectURL(G),H=document.createElement("a");H.href=V,H.download=`${ee.title.replace(/\s+/g,"_")}.txt`,document.body.appendChild(H),H.click(),document.body.removeChild(H),URL.revokeObjectURL(V)}}catch(ee){console.error("Error incrementing downloads:",ee)}},P=async F=>{try{await o(F),w(!1),N(!0),setTimeout(()=>{N(!1)},5e3)}catch(W){throw console.error("Error adding idea:",W),W}},A=F=>{switch(F){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},R=F=>{switch(F){case"beginner":return e("projectIdeas.difficulties.beginner");case"intermediate":return e("projectIdeas.difficulties.intermediate");case"advanced":return e("projectIdeas.difficulties.advanced");default:return F}},T=F=>{switch(F){case"stem":return e("projectIdeas.categories.stem");case"entrepreneurship":return e("projectIdeas.categories.entrepreneurship");case"volunteer":return e("projectIdeas.categories.volunteer");case"ethics":return e("projectIdeas.categories.ethics");default:return F}};return s?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ga,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("projectIdeas.title")}),n.jsx("p",{className:"opacity-90",children:e("projectIdeas.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:S.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.projectIdeas")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:_.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.differentCategories")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:E.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.difficultyLevels")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("projectIdeas.stats.free")})]})]})]}),j&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تم إرسال فكرة المشروع بنجاح"}),n.jsx("p",{className:"text-green-700",children:"تم استلام فكرة المشروع وسيتم مراجعتها من قبل مدير النظام. سيتم نشرها بعد الموافقة عليها."})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("projectIdeas.searchPlaceholder"),value:m,onChange:F=>x(F.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>g(!p),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(zo,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 space-y-4 ${p?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projectIdeas.filters.categories")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(F=>n.jsxs("button",{onClick:()=>u(F.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${d===F.id?`bg-gradient-to-r ${F.color} text-white shadow-lg`:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(F.icon,{className:"w-4 h-4"}),F.name]},F.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("projectIdeas.filters.difficulty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(F=>n.jsx("button",{onClick:()=>h(F.id),className:`px-4 py-2 rounded-xl transition-all ${f===F.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:F.name},F.id))})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-gray-600",children:[e("projectIdeas.showing")," ",S.length," ",e("projectIdeas.of")," ",r?a.length:S.length," ",e("projectIdeas.idea")]}),n.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:[n.jsx(yt,{className:"w-4 h-4"}),e("projectIdeas.suggestNewIdea")]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map((F,W)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:W*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:F.image||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=400",alt:F.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),n.jsx("div",{className:"absolute top-4 right-4",children:n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${A(F.difficulty)}`,children:R(F.difficulty)})}),n.jsxs("div",{className:"absolute top-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(nr,{className:"w-3 h-3"}),F.views]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(Cr,{className:"w-3 h-3"}),F.downloads]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:F.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:"text-sm text-gray-600",children:F.subject||T(F.category)})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-blue-600 transition-colors",children:F.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:F.description}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),F.duration||e("resources.defaultDuration")]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(dt,{className:"w-4 h-4"}),e("projectIdeas.teamwork")]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-xl hover:bg-blue-600 transition-colors font-medium",onClick:()=>k(F.id),children:e("projectIdeas.viewDetails")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",onClick:()=>O(F.id),children:n.jsx(Cr,{className:"w-4 h-4"})})]})]})]},F.id))}),S.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ft,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("projectIdeas.noResults")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("projectIdeas.tryChangingFilters")}),n.jsx("button",{onClick:()=>{u("all"),h("all"),x("")},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.resetFilters")})]}),y&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative h-64 bg-gradient-to-r from-blue-600 to-purple-600",children:[y.image?n.jsx("img",{src:y.image,alt:y.title,className:"w-full h-full object-cover opacity-50"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(ga,{className:"w-24 h-24 text-white opacity-20"})}),n.jsx("button",{onClick:()=>b(null),className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 transition-colors",children:n.jsx(Ot,{className:"w-6 h-6"})}),n.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black to-transparent p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${A(y.difficulty)}`,children:R(y.difficulty)}),n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:T(y.category)})]}),n.jsx("h2",{className:"text-2xl font-bold text-white",children:y.title})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الوصف"}),n.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:y.description}),y.tags&&y.tags.length>0&&n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:y.tags.map((F,W)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-lg",children:["#",F]},W))})]}),n.jsx("div",{children:n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدة المتوقعة"}),n.jsx("p",{className:"font-medium",children:y.duration||"غير محدد"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"الموضوع/المادة"}),n.jsx("p",{className:"font-medium",children:y.subject||"غير محدد"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:y.rating})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المشاهدات"}),n.jsx("p",{className:"font-medium",children:y.views})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التنزيلات"}),n.jsx("p",{className:"font-medium",children:y.downloads})]})]})]})})]}),y.objectives&&y.objectives.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"أهداف المشروع"}),n.jsx("div",{className:"space-y-2",children:y.objectives.map((F,W)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mt-0.5",children:n.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),n.jsx("p",{className:"text-gray-700",children:F})]},W))})]}),y.materials&&y.materials.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"المواد والأدوات المطلوبة"}),n.jsx("div",{className:"grid md:grid-cols-2 gap-2",children:y.materials.map((F,W)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),n.jsx("span",{className:"text-gray-700",children:F})]},W))})]}),y.steps&&y.steps.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"خطوات تنفيذ المشروع"}),n.jsx("div",{className:"space-y-3",children:y.steps.map((F,W)=>n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:W+1}),n.jsx("div",{className:"bg-gray-50 p-3 rounded-lg flex-1",children:n.jsx("p",{className:"text-gray-700",children:F})})]},W))})]}),n.jsxs("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(nr,{className:"w-5 h-5"}),n.jsxs("span",{children:[y.views," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(Cr,{className:"w-5 h-5"}),n.jsxs("span",{children:[y.downloads," تنزيل"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:()=>O(y.id),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5"}),"تنزيل"]}),n.jsx("button",{onClick:()=>b(null),className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إغلاق"})]})]})]})]})})}),v&&n.jsx(Dj,{isOpen:v,onClose:()=>w(!1),onSubmit:P,editingIdea:null}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-blue-50 border border-blue-200 rounded-2xl p-6",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Cn,{className:"w-6 h-6 text-blue-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-blue-800 mb-2",children:"اقتراح فكرة مشروع جديدة"}),n.jsx("p",{className:"text-blue-700 mb-4",children:"يمكنك اقتراح فكرة مشروع جديدة ليتم إضافتها إلى قائمة أفكار المشاريع. سيتم مراجعة الفكرة من قبل مدير النظام قبل نشرها."}),n.jsxs("button",{onClick:()=>w(!0),className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 mx-auto",children:[n.jsx(yt,{className:"w-4 h-4"}),"اقتراح فكرة جديدة"]})]})]})})]})},F6=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),o=async()=>{try{a(!0);const m=Me(pe,"gallery_projects"),x=et(m,Fi("created_at","desc"),_s(20)),g=(await Je(x)).docs.map(y=>{const b=y.data();return{id:y.id,title:b.title||"مشروع بدون عنوان",description:b.description||"لا يوجد وصف",category:b.category||"عام",students:b.students||[],school:b.school||"مدرسة غير معروفة",teacher:b.teacher||"معلم غير معروف",completedAt:b.completed_at?new Date(b.completed_at.toDate()).toISOString():new Date().toISOString(),rating:b.rating||4.5,views:b.views||0,likes:b.likes||0,images:b.images||["https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=600"],video:b.video,tags:b.tags||[],awards:b.awards||[],featured:b.featured||!1}});t(g)}catch(m){console.error("Error fetching gallery projects:",m),i(m instanceof Error?m.message:"حدث خطأ في تحميل معرض المشاريع")}finally{a(!1)}},l=async m=>{try{const x=Re(pe,"gallery_projects",m);await Ht(x,{views:gi(1)}),t(p=>p.map(g=>g.id===m?{...g,views:g.views+1}:g))}catch(x){console.error("Error incrementing views:",x)}},c=async m=>{try{const x=Re(pe,"gallery_projects",m);await Ht(x,{likes:gi(1)}),t(p=>p.map(g=>g.id===m?{...g,likes:g.likes+1}:g))}catch(x){console.error("Error incrementing likes:",x)}},d=async m=>{try{let x=m.images||[];const p=Me(pe,"gallery_projects"),y={id:(await Aa(p,{title:m.title,description:m.description,category:m.category,students:m.students,school:m.school,teacher:m.teacher,completed_at:Ve(),rating:m.rating||4.5,views:0,likes:0,images:x,video:m.video,tags:m.tags||[],awards:m.awards||[],featured:m.featured||!1,created_at:Ve(),updated_at:Ve()})).id,title:m.title||"مشروع بدون عنوان",description:m.description||"لا يوجد وصف",category:m.category||"عام",students:m.students||[],school:m.school||"مدرسة غير معروفة",teacher:m.teacher||"معلم غير معروف",completedAt:new Date().toISOString(),rating:m.rating||4.5,views:0,likes:0,images:x,video:m.video,tags:m.tags||[],awards:m.awards||[],featured:m.featured||!1};return t(b=>[y,...b]),y}catch(x){throw console.error("Error adding gallery project:",x),x}},u=async(m,x)=>{try{const p=Re(pe,"gallery_projects",m);return await Ht(p,{title:x.title,description:x.description,category:x.category,students:x.students,school:x.school,teacher:x.teacher,images:x.images,video:x.video,tags:x.tags,awards:x.awards,featured:x.featured,updated_at:Ve()}),t(g=>g.map(y=>y.id===m?{...y,...x}:y)),{id:m,...x}}catch(p){throw console.error("Error updating gallery project:",p),p}},f=async m=>{try{const x=Re(pe,"gallery_projects",m);return await qa(x),t(p=>p.filter(g=>g.id!==m)),!0}catch(x){throw console.error("Error deleting gallery project:",x),x}},h=async m=>{try{const x=Ah(Ch,`gallery/${Date.now()}_${m.name}`);return await Vk(x,m),await gj(x)}catch(x){throw console.error("Error uploading image:",x),x}};return C.useEffect(()=>{o()},[]),{projects:e,loading:r,error:s,fetchGalleryProjects:o,incrementViews:l,incrementLikes:c,addGalleryProject:d,updateGalleryProject:u,deleteGalleryProject:f,uploadImage:h}},I6=[{id:"all",name:"جميع المشاريع"},{id:"stem",name:"العلوم والتقنية"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"volunteer",name:"التطوع"},{id:"ethics",name:"الأخلاق"}],Cg=[{id:"all",name:"جميع المدارس"},{id:"school1",name:"مدرسة الملك عبدالعزيز"},{id:"school2",name:"مدرسة الأمير محمد"},{id:"school3",name:"مدرسة النور الأهلية"},{id:"school4",name:"مدرسة المستقبل"}],D6=[{id:"latest",name:"الأحدث"},{id:"popular",name:"الأكثر شعبية"},{id:"rating",name:"الأعلى تقييماً"},{id:"views",name:"الأكثر مشاهدة"}],R6=()=>{const{projects:e,loading:t,error:r,incrementViews:a,incrementLikes:s}=F6(),[i,o]=C.useState("all"),[l,c]=C.useState("all"),[d,u]=C.useState("latest"),[f,h]=C.useState(""),[m,x]=C.useState("grid"),[p,g]=C.useState([]),[y,b]=C.useState(null),v=e.filter(S=>{var A;const k=i==="all"||S.category===i,O=l==="all"||S.school===((A=Cg.find(R=>R.id===l))==null?void 0:A.name),P=S.title.toLowerCase().includes(f.toLowerCase())||S.description.toLowerCase().includes(f.toLowerCase())||S.tags.some(R=>R.toLowerCase().includes(f.toLowerCase()))||S.school.toLowerCase().includes(f.toLowerCase())||S.teacher.toLowerCase().includes(f.toLowerCase())||S.students.some(R=>R.toLowerCase().includes(f.toLowerCase()));return k&&O&&P}).sort((S,k)=>{switch(d){case"popular":return k.likes-S.likes;case"rating":return k.rating-S.rating;case"views":return k.views-S.views;case"latest":default:return new Date(k.completedAt).getTime()-new Date(S.completedAt).getTime()}}),w=S=>{p.includes(S)?g(k=>k.filter(O=>O!==S)):(g(k=>[...k,S]),s(S))},j=S=>{a(S),b(S)},N=S=>{switch(S){case"stem":return"العلوم والتقنية";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return S}},_=S=>{if(navigator.share)navigator.share({title:S.title,text:S.description,url:window.location.href+"?project="+S.id}).catch(k=>console.log("Error sharing",k));else{const k=window.location.href+"?project="+S.id;navigator.clipboard.writeText(k),alert("تم نسخ رابط المشروع إلى الحافظة")}};C.useEffect(()=>{const k=new URLSearchParams(window.location.search).get("project");k&&(b(k),a(k))},[]);const E=y?e.find(S=>S.id===y):null;return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-pink-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Il,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-pink-600 to-rose-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Il,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"معرض المشاريع"}),n.jsx("p",{className:"opacity-90",children:"استكشف المشاريع المميزة والملهمة من طلابنا"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع معروض"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(S=>S.featured).length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع مميز"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.reduce((S,k)=>S+k.views,0).toLocaleString()}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المشاهدات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.reduce((S,k)=>S+k.likes,0)}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي الإعجابات"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في المشاريع...",value:f,onChange:S=>h(S.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent"})]}),n.jsx("select",{value:d,onChange:S=>u(S.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-pink-500 focus:border-transparent",children:D6.map(S=>n.jsx("option",{value:S.id,children:S.name},S.id))}),n.jsxs("div",{className:"flex border border-gray-300 rounded-xl overflow-hidden",children:[n.jsx("button",{onClick:()=>x("grid"),className:`px-4 py-3 ${m==="grid"?"bg-pink-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} transition-colors`,children:"شبكة"}),n.jsx("button",{onClick:()=>x("list"),className:`px-4 py-3 ${m==="list"?"bg-pink-500 text-white":"bg-white text-gray-700 hover:bg-gray-50"} transition-colors`,children:"قائمة"})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:I6.map(S=>n.jsx("button",{onClick:()=>o(S.id),className:`px-4 py-2 rounded-xl transition-all ${i===S.id?"bg-pink-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"المدارس"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Cg.map(S=>n.jsx("button",{onClick:()=>c(S.id),className:`px-4 py-2 rounded-xl transition-all ${l===S.id?"bg-pink-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S.name},S.id))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",v.length," من أصل ",e.length," مشروع"]})}),m==="grid"?n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map((S,k)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:k*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:S.images[0],alt:S.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),S.featured&&n.jsxs("div",{className:"absolute top-4 right-4 bg-yellow-500 text-white px-2 py-1 rounded-lg text-sm font-medium flex items-center gap-1",children:[n.jsx(ar,{className:"w-3 h-3"}),"مميز"]}),S.video&&n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx("button",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center backdrop-blur-sm",children:n.jsx(wi,{className:"w-8 h-8 text-white ml-1"})})}),n.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(nr,{className:"w-3 h-3"}),S.views.toLocaleString()]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(ha,{className:"w-3 h-3"}),S.likes]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:S.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:"text-sm text-gray-600",children:N(S.category)})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-pink-600 transition-colors line-clamp-2",children:S.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:S.description}),n.jsxs("div",{className:"flex flex-col gap-1 mb-3",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المدرسة:"})," ",S.school]}),n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المعلم:"})," ",S.teacher]})]}),n.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[S.tags.slice(0,3).map((O,P)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",O]},P)),S.tags.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",S.tags.length-3]})]}),S.awards&&S.awards.length>0&&n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"flex items-center gap-1 text-yellow-600 text-sm",children:[n.jsx(ar,{className:"w-4 h-4"}),n.jsx("span",{className:"font-medium",children:S.awards[0]}),S.awards.length>1&&n.jsxs("span",{className:"text-gray-500",children:["+",S.awards.length-1]})]})}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(dt,{className:"w-4 h-4"}),S.students.length," طالب"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),Ze(S.completedAt)]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>w(S.id),className:`p-2 rounded-lg transition-colors ${p.includes(S.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(ha,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>_(S),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(Ss,{className:"w-4 h-4"})})]}),n.jsx("button",{onClick:()=>j(S.id),className:"px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors text-sm font-medium",children:"عرض التفاصيل"})]})]})]},S.id))}):n.jsx("div",{className:"space-y-4",children:v.map((S,k)=>n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:k*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:n.jsxs("div",{className:"flex gap-6",children:[n.jsxs("div",{className:"relative w-48 h-32 rounded-xl overflow-hidden flex-shrink-0",children:[n.jsx("img",{src:S.images[0],alt:S.title,className:"w-full h-full object-cover"}),S.featured&&n.jsxs("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded-lg text-xs font-medium flex items-center gap-1",children:[n.jsx(ar,{className:"w-3 h-3"}),"مميز"]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:S.title}),n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:N(S.category)})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:S.description}),n.jsxs("div",{className:"flex flex-col gap-1 mt-2",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المدرسة:"})," ",S.school]}),n.jsxs("div",{className:"text-sm text-gray-600",children:[n.jsx("span",{className:"font-medium",children:"المعلم:"})," ",S.teacher]})]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:S.rating})]})]}),n.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:S.tags.map((O,P)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",O]},P))}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(dt,{className:"w-4 h-4"}),S.students.length," طالب"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(nr,{className:"w-4 h-4"}),S.views.toLocaleString()," مشاهدة"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ha,{className:"w-4 h-4"}),S.likes," إعجاب"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),Ze(S.completedAt)]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>w(S.id),className:`p-2 rounded-lg transition-colors ${p.includes(S.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(ha,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>_(S),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(Ss,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>j(S.id),className:"px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors text-sm font-medium",children:"عرض التفاصيل"})]})]})]})]})},S.id))}),v.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Il,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لم يتم العثور على مشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"جرب تغيير معايير البحث أو الفلاتر"}),n.jsx("button",{onClick:()=>{o("all"),c("all"),h("")},className:"px-6 py-2 bg-pink-500 text-white rounded-xl hover:bg-pink-600 transition-colors",children:"إعادة تعيين الفلاتر"})]}),y&&E&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsxs("div",{className:"relative h-80 bg-gray-900",children:[n.jsx("img",{src:E.images[0],alt:E.title,className:"w-full h-full object-contain"}),n.jsx("button",{onClick:()=>b(null),className:"absolute top-4 right-4 bg-black bg-opacity-50 text-white p-2 rounded-full hover:bg-opacity-70 transition-colors",children:n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),E.images.length>1&&n.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2",children:E.images.map((S,k)=>n.jsx("button",{className:`w-3 h-3 rounded-full ${k===0?"bg-white":"bg-white bg-opacity-50"}`},k))}),E.video&&n.jsxs("a",{href:E.video,target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-4 right-4 bg-pink-500 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-pink-600 transition-colors",children:[n.jsx(wi,{className:"w-4 h-4"}),"مشاهدة الفيديو"]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:E.title}),E.featured&&n.jsxs("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-lg text-sm font-medium flex items-center gap-1",children:[n.jsx(ar,{className:"w-4 h-4"}),"مميز"]})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 mb-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"وصف المشروع"}),n.jsx("p",{className:"text-gray-600 leading-relaxed mb-4",children:E.description}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:E.tags.map((S,k)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 text-sm rounded-lg flex items-center gap-1",children:[n.jsx(ud,{className:"w-4 h-4"}),S]},k))}),E.awards&&E.awards.length>0&&n.jsxs("div",{className:"mb-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الجوائز"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:E.awards.map((S,k)=>n.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-lg flex items-center gap-1",children:[n.jsx(ar,{className:"w-4 h-4"}),S]},k))})]})]}),n.jsx("div",{children:n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"معلومات المشروع"}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدرسة"}),n.jsx("p",{className:"font-medium",children:E.school})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المعلم المشرف"}),n.jsx("p",{className:"font-medium",children:E.teacher})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"تاريخ الإنجاز"}),n.jsx("p",{className:"font-medium",children:Ze(E.completedAt)})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:E.rating})]})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"الفئة"}),n.jsx("p",{className:"font-medium",children:N(E.category)})]})]})]})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"فريق العمل"}),n.jsx("div",{className:"flex flex-wrap gap-3",children:E.students.map((S,k)=>n.jsxs("div",{className:"bg-gray-100 rounded-full px-4 py-2 text-sm flex items-center gap-2",children:[n.jsx("div",{className:"w-6 h-6 bg-gray-300 rounded-full flex items-center justify-center text-xs text-gray-700",children:S.charAt(0)}),n.jsx("span",{children:S})]},k))})]}),n.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(nr,{className:"w-5 h-5"}),n.jsxs("span",{children:[E.views.toLocaleString()," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[n.jsx(ha,{className:"w-5 h-5"}),n.jsxs("span",{children:[E.likes," إعجاب"]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>w(E.id),className:`p-2 rounded-lg transition-colors ${p.includes(E.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(ha,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>_(E),className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(Ss,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>b(null),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"إغلاق"})]})]})]})]})})})]})},M6=async()=>{try{const e=await Je(Me(pe,"store_items")),t=[];return e.forEach(r=>{const a=r.data();t.push({id:r.id,name:a.name||"",description:a.description||"",price:a.price||0,originalPrice:a.original_price,category:a.category||"",features:a.features||[],tags:a.tags||[],image:a.image_url||"",rating:a.rating||5,reviews:a.reviews_count||0,views:a.views_count||0,inStock:a.in_stock||!1,stockQuantity:a.stock_quantity||0,discount:a.discount_percentage,featured:a.featured||!1})}),t}catch(e){throw console.error("Error fetching store items from Firestore:",e),e}},Pf=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),o=async()=>{try{a(!0),i(null),console.log("Fetching store items...");const h=await M6();console.log(`Found ${h.length} store items`),t(h)}catch(h){console.error("Error fetching store items:",h),i(h instanceof Error?h.message:"حدث خطأ في تحميل المنتجات")}finally{a(!1)}},l=async h=>{try{const m=Re(pe,"store_items",h);await Ht(m,{views_count:gi(1)}),t(x=>x.map(p=>p.id===h?{...p,views:p.views+1}:p))}catch(m){console.error("Error incrementing views:",m)}},c=async h=>{try{a(!0),i(null);const m={name:h.name,description:h.description,price:h.price,original_price:h.originalPrice??null,category:h.category,features:h.features||[],tags:h.tags||[],image_url:h.image,rating:h.rating||5,reviews_count:0,views_count:0,in_stock:h.inStock,stock_quantity:h.stockQuantity||0,discount_percentage:h.discount??null,featured:h.featured||!1,created_at:Ve(),updated_at:Ve()},p={id:(await Aa(Me(pe,"store_items"),m)).id,name:h.name,description:h.description,price:h.price,originalPrice:h.originalPrice,category:h.category,features:h.features||[],tags:h.tags||[],image:h.image,rating:h.rating||5,reviews:0,views:0,inStock:h.inStock,stockQuantity:h.stockQuantity||0,discount:h.discount,featured:h.featured||!1};return t(g=>[p,...g]),p}catch(m){throw console.error("Error creating store item:",m),i(m instanceof Error?m.message:"حدث خطأ في إضافة المنتج"),m}finally{a(!1)}},d=async(h,m)=>{try{a(!0),i(null);const x=Re(pe,"store_items",h),p={updated_at:Ve()};return m.name!==void 0&&(p.name=m.name),m.description!==void 0&&(p.description=m.description),m.price!==void 0&&(p.price=m.price),m.originalPrice!==void 0&&(p.original_price=m.originalPrice??null),m.category!==void 0&&(p.category=m.category),m.features!==void 0&&(p.features=m.features),m.tags!==void 0&&(p.tags=m.tags),m.image!==void 0&&(p.image_url=m.image),m.rating!==void 0&&(p.rating=m.rating),m.inStock!==void 0&&(p.in_stock=m.inStock),m.stockQuantity!==void 0&&(p.stock_quantity=m.stockQuantity),m.discount!==void 0&&(p.discount_percentage=m.discount??null),m.featured!==void 0&&(p.featured=m.featured),await Ht(x,p),t(g=>g.map(y=>y.id===h?{...y,...m}:y)),{id:h,...m}}catch(x){throw console.error("Error updating store item:",x),i(x instanceof Error?x.message:"حدث خطأ في تحديث المنتج"),x}finally{a(!1)}},u=async h=>{try{a(!0),i(null);const m=Re(pe,"store_items",h);return await qa(m),t(x=>x.filter(p=>p.id!==h)),!0}catch(m){throw console.error("Error deleting store item:",m),i(m instanceof Error?m.message:"حدث خطأ في حذف المنتج"),m}finally{a(!1)}},f=async()=>{try{a(!0),i(null),console.log("Deleting all store items...");const h=Me(pe,"store_items"),m=await Je(h);if(m.empty)return console.log("No store items to delete"),0;let x=0;for(const p of m.docs)await qa(p.ref),x++;return console.log(`Successfully deleted ${x} store items`),t([]),x}catch(h){throw console.error("Error deleting all store items:",h),i(h instanceof Error?h.message:"حدث خطأ في حذف جميع المنتجات"),h}finally{a(!1)}};return C.useEffect(()=>{o()},[]),{storeItems:e,loading:r,error:s,fetchStoreItems:o,incrementViews:l,createStoreItem:c,updateStoreItem:d,deleteStoreItem:u,deleteAllStoreItems:f}},$6=({isOpen:e,onClose:t,onSubmit:r,editingItem:a})=>{var E,S;const[s,i]=C.useState({name:"",description:"",price:0,originalPrice:void 0,category:"electronics",features:[""],tags:[],image:"",rating:5,inStock:!0,stockQuantity:1,discount:void 0,featured:!1}),[o,l]=C.useState(""),[c,d]=C.useState(""),[u,f]=C.useState(!1),[h,m]=C.useState(null),[x,p]=C.useState(null);C.useEffect(()=>{var k;i(a?{...a,features:(k=a.features)!=null&&k.length?a.features:[""],tags:a.tags||[]}:{name:"",description:"",price:0,originalPrice:void 0,category:"electronics",features:[""],tags:[],image:"",rating:5,inStock:!0,stockQuantity:1,discount:void 0,featured:!1}),l(""),d(""),m(null),p(null)},[a,e]);const g=[{id:"electronics",name:"الإلكترونيات"},{id:"tools",name:"الأدوات"},{id:"materials",name:"المواد"},{id:"books",name:"الكتب"},{id:"software",name:"البرمجيات"}],y=(k,O)=>{i(P=>({...P,[k]:O}))},b=(k,O)=>{i(P=>{var A;return{...P,features:((A=P.features)==null?void 0:A.map((R,T)=>T===k?O:R))||[]}})},v=()=>{c.trim()?(i(k=>({...k,features:[...k.features||[],c.trim()]})),d("")):i(k=>({...k,features:[...k.features||[],""]}))},w=k=>{i(O=>{var P;return{...O,features:((P=O.features)==null?void 0:P.filter((A,R)=>R!==k))||[]}})},j=()=>{o.trim()&&(i(k=>({...k,tags:[...k.tags||[],o.trim()]})),l(""))},N=k=>{i(O=>{var P;return{...O,tags:((P=O.tags)==null?void 0:P.filter((A,R)=>R!==k))||[]}})},_=async k=>{var P;if(k.preventDefault(),!s.name||!s.description||!s.price||!s.category||!s.image){m("يرجى ملء جميع الحقول المطلوبة");return}const O={...s,features:((P=s.features)==null?void 0:P.filter(A=>A.trim()))||[]};f(!0),m(null),p(null);try{await r(O),p(a?"تم تحديث المنتج بنجاح":"تم إضافة المنتج بنجاح"),setTimeout(()=>{t()},1500)}catch(A){console.error("Error submitting store item:",A),m(A instanceof Error?A.message:"حدث خطأ في حفظ المنتج")}finally{f(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Hr,{className:"w-6 h-6 text-purple-600"}),a?"تعديل منتج":"إضافة منتج جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),h&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:h})]}),x&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:x})]}),n.jsxs("form",{onSubmit:_,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اسم المنتج *"}),n.jsx("input",{type:"text",value:s.name,onChange:k=>y("name",k.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل اسم المنتج",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف المنتج *"}),n.jsx("textarea",{value:s.description,onChange:k=>y("description",k.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"اكتب وصفاً تفصيلياً للمنتج",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة *"}),n.jsx("select",{value:s.category,onChange:k=>y("category",k.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:g.map(k=>n.jsx("option",{value:k.id,children:k.name},k.id))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(dd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.image,onChange:k=>y("image",k.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل رابط صورة المنتج",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر *"}),n.jsxs("div",{className:"relative",children:[n.jsx(lu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.price,onChange:k=>y("price",parseFloat(k.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل سعر المنتج",min:"0",step:"0.01",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر الأصلي (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx(lu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.originalPrice||"",onChange:k=>y("originalPrice",k.target.value?parseFloat(k.target.value):void 0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل السعر الأصلي قبل الخصم",min:"0",step:"0.01"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نسبة الخصم (اختياري)"}),n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:"%"}),n.jsx("input",{type:"number",value:s.discount||"",onChange:k=>y("discount",k.target.value?parseFloat(k.target.value):void 0),className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل نسبة الخصم",min:"0",max:"100"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التقييم"}),n.jsxs("div",{className:"relative",children:[n.jsx(at,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.rating,onChange:k=>y("rating",parseFloat(k.target.value)||5),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل تقييم المنتج",min:"1",max:"5",step:"0.1"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكمية المتوفرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(Tf,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"number",value:s.stockQuantity,onChange:k=>y("stockQuantity",parseInt(k.target.value)||0),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الكمية المتوفرة",min:"0"})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"inStock",checked:s.inStock,onChange:k=>y("inStock",k.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("label",{htmlFor:"inStock",className:"mr-2 block text-sm text-gray-900",children:"متوفر في المخزون"})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"featured",checked:s.featured,onChange:k=>y("featured",k.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("label",{htmlFor:"featured",className:"mr-2 block text-sm text-gray-900",children:"منتج مميز"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مميزات المنتج"}),n.jsxs("div",{className:"space-y-3",children:[(E=s.features)==null?void 0:E.map((k,O)=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("input",{type:"text",value:k,onChange:P=>b(O,P.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:`الميزة ${O+1}`}),s.features&&s.features.length>1&&n.jsx("button",{type:"button",onClick:()=>w(O),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:n.jsx(sr,{className:"w-5 h-5"})})]},O)),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:c,onChange:k=>d(k.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل ميزة جديدة"}),n.jsx("button",{type:"button",onClick:v,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:n.jsx(yt,{className:"w-5 h-5"})})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(S=s.tags)==null?void 0:S.map((k,O)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-800 rounded-full",children:[n.jsx("span",{children:k}),n.jsx("button",{type:"button",onClick:()=>N(O),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-purple-200",children:n.jsx(Ot,{className:"w-3 h-3"})})]},O))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ud,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:k=>l(k.target.value),onKeyPress:k=>k.key==="Enter"&&(k.preventDefault(),j()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:j,className:"px-4 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:u,className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:u?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(es,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة المنتج"]})})]})]})]})}):null},Og=({isOpen:e,onClose:t,onConfirm:r,itemName:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(vt,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف المنتج التالي؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(sr,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null,L6=({isOpen:e,onClose:t,item:r,onAddToCart:a,onToggleWishlist:s,isInWishlist:i})=>{const{t:o}=jt();if(!e||!r)return null;const l=async()=>{const c={title:r.name,text:r.description,url:window.location.href};if(navigator.share)try{await navigator.share(c)}catch{try{await navigator.clipboard.writeText(window.location.href),alert("تم نسخ رابط المنتج إلى الحافظة")}catch(u){console.error("Error copying to clipboard:",u),alert("حدث خطأ في المشاركة")}}else try{await navigator.clipboard.writeText(window.location.href),alert("تم نسخ رابط المنتج إلى الحافظة")}catch(d){console.error("Error copying to clipboard:",d),alert("حدث خطأ في المشاركة")}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsx(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-10 p-2 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-0",children:[n.jsx("div",{className:"h-full bg-gray-100 flex items-center justify-center p-8",children:n.jsx("img",{src:r.image,alt:r.name,className:"max-w-full max-h-[400px] object-contain"})}),n.jsxs("div",{className:"p-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:r.category==="electronics"?o("store.categories.electronics"):r.category==="tools"?o("store.categories.tools"):r.category==="materials"?o("store.categories.materials"):r.category==="books"?o("store.categories.books"):r.category==="software"?o("store.categories.software"):r.category}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-5 h-5 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:r.rating}),n.jsxs("span",{className:"text-gray-500",children:["(",r.reviews," ",o("store.reviews"),")"]})]})]}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:r.name}),n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsxs("span",{className:"text-3xl font-bold text-purple-600",children:[r.price," ",o("store.currency")]}),r.originalPrice&&n.jsxs("span",{className:"text-xl text-gray-400 line-through",children:[r.originalPrice," ",o("store.currency")]}),r.discount&&n.jsxs("span",{className:"px-2 py-1 bg-red-500 text-white rounded-lg text-sm font-medium",children:["-",r.discount,"%"]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الوصف"}),n.jsx("p",{className:"text-gray-600 leading-relaxed",children:r.description})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"المميزات"}),n.jsx("ul",{className:"space-y-2",children:r.features.map((c,d)=>n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),n.jsx("span",{className:"text-gray-700",children:c})]},d))})]}),r.tags&&r.tags.length>0&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:r.tags.map((c,d)=>n.jsxs("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm flex items-center gap-1",children:[n.jsx(ud,{className:"w-3 h-3"}),c]},d))})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[n.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.inStock?o("store.inStock"):o("store.outOfStock")}),r.inStock&&n.jsxs("span",{className:"text-sm text-gray-600",children:["(",r.stockQuantity," قطعة متوفرة)"]})]}),n.jsxs("div",{className:"flex gap-3 mb-6",children:[n.jsxs("button",{onClick:()=>a(r.id),disabled:!r.inStock,className:"flex-1 bg-purple-500 text-white py-3 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[n.jsx(Hr,{className:"w-5 h-5"}),o("store.addToCart")]}),n.jsx("button",{onClick:()=>s(r.id),className:`p-3 rounded-xl transition-colors ${i?"bg-red-500 text-white":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(ha,{className:"w-5 h-5"})}),n.jsx("button",{onClick:l,className:"p-3 bg-gray-100 text-gray-600 rounded-xl hover:bg-gray-200 transition-colors",children:n.jsx(Ss,{className:"w-5 h-5"})})]}),n.jsxs(Ae,{to:"/cart",className:"w-full py-3 px-4 bg-gray-800 text-white rounded-xl hover:bg-gray-900 transition-colors font-medium flex items-center justify-center gap-2 mb-6",children:[n.jsx(Hr,{className:"w-5 h-5"}),"الذهاب إلى سلة التسوق"]}),n.jsxs("div",{className:"border-t border-gray-200 pt-6 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(ic,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"شحن مجاني"}),n.jsx("p",{className:"text-sm text-gray-600",children:"للطلبات فوق 200 ريال"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(Tf,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"ضمان الجودة"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ضمان استرجاع لمدة 30 يوم"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(_t,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"توصيل سريع"}),n.jsx("p",{className:"text-sm text-gray-600",children:"خلال 2-5 أيام عمل"})]})]})]})]})]})]})})})},B6=()=>{const{t:e}=jt(),{user:t}=wt(),r=(t==null?void 0:t.role)==="admin",{storeItems:a,loading:s,error:i,incrementViews:o,createStoreItem:l,updateStoreItem:c,deleteStoreItem:d,deleteAllStoreItems:u}=Pf(),{cart:f,wishlist:h,addToCart:m,removeFromCart:x,toggleWishlist:p,getTotalItems:g,getTotalPrice:y}=_x(),[b,v]=C.useState("all"),[w,j]=C.useState(""),[N,_]=C.useState(!1),[E,S]=C.useState(null),[k,O]=C.useState(!1),[P,A]=C.useState(!1),[R,T]=C.useState(null),[F,W]=C.useState(!1),[K,B]=C.useState(!1),[L,ee]=C.useState(!1),[M,G]=C.useState(!1),[V,H]=C.useState(null);C.useEffect(()=>{r&&ee(!0)},[r]);const re=[{id:"all",name:e("store.categories.all")},{id:"electronics",name:e("store.categories.electronics")},{id:"tools",name:e("store.categories.tools")},{id:"materials",name:e("store.categories.materials")},{id:"books",name:e("store.categories.books")},{id:"software",name:e("store.categories.software")}],me=a.filter(ce=>{const fe=b==="all"||ce.category===b,oe=ce.name.toLowerCase().includes(w.toLowerCase())||ce.description.toLowerCase().includes(w.toLowerCase());return fe&&oe}),xe=ce=>{o(ce);const fe=a.find(oe=>oe.id===ce);fe&&(H(fe),G(!0))},Z=()=>{S(null),_(!0)},q=ce=>{S(ce),_(!0)},ie=ce=>{T(ce),O(!0)},I=()=>{A(!0)},ve=async()=>{if(R){W(!0);try{await d(R.id),O(!1)}catch(ce){console.error("Error deleting item:",ce)}finally{W(!1),T(null)}}},we=async()=>{B(!0);try{await u(),A(!1)}catch(ce){console.error("Error deleting all items:",ce)}finally{B(!1)}},Ee=async ce=>{E?await c(E.id,ce):await l(ce)};return s?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Hr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("store.title")}),n.jsx("p",{className:"opacity-90",children:e("store.subtitle")})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[r&&n.jsxs("button",{onClick:()=>ee(!L),className:"bg-white bg-opacity-20 text-white px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(vo,{className:"w-5 h-5"}),L?"وضع المستخدم":"وضع الإدارة"]}),!L&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"relative",children:n.jsxs("button",{className:"bg-white bg-opacity-20 text-white px-4 py-2 rounded-xl hover:bg-opacity-30 transition-all duration-200 backdrop-blur-sm flex items-center gap-2",children:[n.jsx(ha,{className:"w-5 h-5"}),e("store.wishlist")," (",h.length,")"]})}),n.jsxs("div",{className:"relative",children:[n.jsxs(Ae,{to:"/cart",className:"bg-white text-purple-600 px-4 py-2 rounded-xl hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Hr,{className:"w-5 h-5"}),e("store.cart")," (",g(),")"]}),g()>0&&n.jsx("span",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:g()})]})]}),r&&L&&n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:Z,className:"bg-white text-purple-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),"إضافة منتج جديد"]}),n.jsxs("button",{onClick:I,className:"bg-red-500 text-white px-6 py-3 rounded-xl font-medium hover:bg-red-600 transition-all duration-200 flex items-center gap-2",children:[n.jsx(sr,{className:"w-5 h-5"}),"حذف جميع المنتجات"]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:a.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.availableProducts")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:re.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.categories")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.customerSupport")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e("store.stats.freeShipping")}),n.jsx("div",{className:"text-sm opacity-80",children:e("store.stats.shipping")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("store.searchPlaceholder"),value:w,onChange:ce=>j(ce.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("store.filters.categories")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:re.map(ce=>n.jsx("button",{onClick:()=>v(ce.id),className:`px-4 py-2 rounded-xl transition-all ${b===ce.id?"bg-purple-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:ce.name},ce.id))})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-gray-600",children:[e("store.showing")," ",me.length," ",e("store.of")," ",a.length," ",e("store.product")]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-sm text-gray-600",children:[e("store.sortBy"),":"]}),n.jsxs("select",{className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[n.jsx("option",{children:e("store.sortOptions.newest")}),n.jsx("option",{children:e("store.sortOptions.priceLowToHigh")}),n.jsx("option",{children:e("store.sortOptions.priceHighToLow")}),n.jsx("option",{children:e("store.sortOptions.rating")})]})]})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:me.map((ce,fe)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:fe*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:ce.image,alt:ce.name,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),ce.discount&&n.jsxs("div",{className:"absolute top-4 right-4 bg-red-500 text-white px-2 py-1 rounded-lg text-sm font-medium",children:["-",ce.discount,"%"]}),n.jsx("div",{className:"absolute top-4 left-4",children:L?n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>q(ce),className:"p-2 rounded-full bg-white bg-opacity-80 text-blue-600 hover:bg-blue-500 hover:text-white transition-all",children:n.jsx(Ca,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>ie(ce),className:"p-2 rounded-full bg-white bg-opacity-80 text-red-600 hover:bg-red-500 hover:text-white transition-all",children:n.jsx(sr,{className:"w-4 h-4"})})]}):n.jsx("button",{onClick:()=>p(ce.id),className:`p-2 rounded-full transition-all ${h.includes(ce.id)?"bg-red-500 text-white":"bg-white bg-opacity-80 text-gray-600 hover:bg-red-500 hover:text-white"}`,children:n.jsx(ha,{className:"w-4 h-4"})})}),n.jsx("div",{className:"absolute bottom-4 left-4",children:n.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${ce.inStock?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:ce.inStock?e("store.inStock"):e("store.outOfStock")})})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:ce.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsxs("span",{className:"text-sm text-gray-600",children:["(",ce.reviews," ",e("store.reviews"),")"]})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-purple-600 transition-colors",children:ce.name}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-2 leading-relaxed",children:ce.description}),n.jsx("div",{className:"mb-4",children:n.jsxs("div",{className:"flex flex-wrap gap-1",children:[ce.features.slice(0,2).map((oe,qe)=>n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:oe},qe)),ce.features.length>2&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",ce.features.length-2," ",e("store.more")]})]})}),n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsxs("span",{className:"text-2xl font-bold text-purple-600",children:[ce.price," ",e("store.currency")]}),ce.originalPrice&&n.jsxs("span",{className:"text-lg text-gray-400 line-through",children:[ce.originalPrice," ",e("store.currency")]})]}),n.jsx("div",{className:"flex gap-2",children:L?n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>q(ce),className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-xl hover:bg-blue-600 transition-colors font-medium flex items-center justify-center gap-2",children:[n.jsx(Ca,{className:"w-4 h-4"}),"تعديل"]}),n.jsx("button",{onClick:()=>ie(ce),className:"px-4 py-2 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors",children:n.jsx(sr,{className:"w-4 h-4"})})]}):n.jsxs(n.Fragment,{children:[f[ce.id]?n.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[n.jsx("button",{onClick:()=>x(ce.id),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:n.jsx(wj,{className:"w-4 h-4"})}),n.jsx("span",{className:"flex-1 text-center font-medium",children:f[ce.id]}),n.jsx("button",{onClick:()=>m(ce.id),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:n.jsx(yt,{className:"w-4 h-4"})})]}):n.jsxs("button",{onClick:()=>m(ce.id),disabled:!ce.inStock,className:"flex-1 bg-purple-500 text-white py-2 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[n.jsx(Hr,{className:"w-4 h-4"}),e("store.addToCart")]}),n.jsx("button",{onClick:()=>xe(ce.id),className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(nr,{className:"w-4 h-4"})})]})})]})]},ce.id))}),me.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ft,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("store.noProductsFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:a.length===0?e("store.noProductsInStore"):e("store.tryChangingFilters")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[r&&L&&n.jsxs("button",{onClick:Z,className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2",children:[n.jsx(yt,{className:"w-4 h-4"}),"إضافة منتج جديد"]}),a.length>0&&n.jsx("button",{onClick:()=>{v("all"),j("")},className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:e("common.resetFilters")})]})]}),!L&&g()>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"fixed bottom-6 right-6 bg-white rounded-2xl shadow-2xl p-6 border border-gray-200 z-50",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("store.cartSummary")}),n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[e("store.numberOfProducts"),":"]}),n.jsx("span",{className:"font-medium",children:g()})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[e("store.total"),":"]}),n.jsxs("span",{className:"font-bold text-purple-600",children:[y(a).toFixed(2)," ",e("store.currency")]})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ae,{to:"/cart",className:"flex-1 bg-purple-500 text-white py-2 px-4 rounded-xl hover:bg-purple-600 transition-colors font-medium",children:e("store.checkout")}),n.jsx(Ae,{to:"/cart",className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("store.viewCart")})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gray-50 rounded-2xl p-8",children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6 text-center",children:e("store.whyChooseUs")}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ic,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.freeShipping")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.freeShippingDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Ka,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.qualityGuarantee")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.qualityGuaranteeDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ri,{className:"w-8 h-8 text-purple-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.securePayment")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.securePaymentDesc")})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Tf,{className:"w-8 h-8 text-orange-600"})}),n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:e("store.features.easyReturns")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("store.features.easyReturnsDesc")})]})]})]}),n.jsx($6,{isOpen:N,onClose:()=>_(!1),onSubmit:Ee,editingItem:E}),n.jsx(Og,{isOpen:k,onClose:()=>O(!1),onConfirm:ve,itemName:(R==null?void 0:R.name)||"",isDeleting:F}),n.jsx(Og,{isOpen:P,onClose:()=>A(!1),onConfirm:we,itemName:"جميع المنتجات",isDeleting:K}),n.jsx(L6,{isOpen:M,onClose:()=>G(!1),item:V,onAddToCart:m,onToggleWishlist:p,isInWishlist:V?h.includes(V.id):!1})]})},Rj=30,Dh=200,Mj=.15,U6=()=>{const{t:e}=jt(),{cart:t,wishlist:r,addToCart:a,removeFromCart:s,updateQuantity:i,clearCart:o,toggleWishlist:l,getTotalItems:c,getTotalPrice:d}=_x(),{storeItems:u,loading:f,error:h}=Pf(),[m,x]=C.useState(""),[p,g]=C.useState(null),[y,b]=C.useState(null),[v,w]=C.useState(!1),[j,N]=C.useState(0),_=Object.entries(t).map(([R,T])=>({item:u.find(W=>W.id===R),quantity:T})).filter(({item:R})=>R!==void 0),E=d(u),S=E>Dh?0:Rj,k=E*Mj,O=E+S+k-j,P=R=>{window.confirm("هل أنت متأكد من حذف هذا المنتج من السلة؟")&&i(R,0)},A=()=>{if(!m.trim()){g("يرجى إدخال كود الخصم");return}w(!0),g(null),b(null),setTimeout(()=>{if(m.toUpperCase()==="DISCOUNT20"){const R=E*.2;N(R),b("تم تطبيق الخصم بنجاح!")}else g("كود الخصم غير صالح");w(!1)},1e3)};return f?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):h?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:h})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Hr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"سلة التسوق"}),n.jsx("p",{className:"opacity-90",children:"مراجعة وإدارة منتجاتك"})]})]})}),n.jsx("div",{className:"flex items-center",children:n.jsxs(Ae,{to:"/store",className:"flex items-center gap-2 text-purple-600 hover:text-purple-800 transition-colors",children:[n.jsx(Qn,{className:"w-5 h-5"}),n.jsx("span",{children:"العودة إلى المتجر"})]})}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsx("div",{className:"lg:col-span-2",children:n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["المنتجات (",c(),")"]}),_.length>0&&n.jsxs("button",{onClick:()=>o(),className:"text-red-600 hover:text-red-800 transition-colors text-sm flex items-center gap-1",children:[n.jsx(sr,{className:"w-4 h-4"}),"حذف الكل"]})]}),_.length>0?n.jsx("div",{className:"space-y-4",children:_.map(({item:R,quantity:T})=>R&&n.jsxs("div",{className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:shadow-md transition-all",children:[n.jsx("div",{className:"w-20 h-20 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:R.image,alt:R.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-1",children:R.name}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-2",children:[n.jsxs("span",{children:["الفئة: ",R.category==="electronics"?e("store.categories.electronics"):R.category==="tools"?e("store.categories.tools"):R.category==="materials"?e("store.categories.materials"):R.category==="books"?e("store.categories.books"):R.category==="software"?e("store.categories.software"):R.category]}),R.inStock?n.jsx("span",{className:"text-green-600",children:"متوفر"}):n.jsx("span",{className:"text-red-600",children:"غير متوفر"})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>s(R.id),className:"p-1 border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:n.jsx(wj,{className:"w-4 h-4"})}),n.jsx("span",{className:"w-8 text-center",children:T}),n.jsx("button",{onClick:()=>a(R.id),className:"p-1 border border-gray-300 rounded hover:bg-gray-100 transition-colors",children:n.jsx(yt,{className:"w-4 h-4"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>l(R.id),className:`p-1 rounded transition-colors ${r.includes(R.id)?"text-red-600 hover:text-red-800":"text-gray-400 hover:text-red-600"}`,children:n.jsx(ha,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>P(R.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",children:n.jsx(sr,{className:"w-4 h-4"})})]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[R.price," ",e("store.currency")]}),n.jsxs("div",{className:"text-sm text-gray-500",children:["الإجمالي: ",(R.price*T).toFixed(2)," ",e("store.currency")]})]})]},R.id))}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Hr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"سلة التسوق فارغة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم تقم بإضافة أي منتجات إلى سلة التسوق بعد"}),n.jsxs(Ae,{to:"/store",className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors inline-flex items-center gap-2",children:[n.jsx(Hr,{className:"w-4 h-4"}),"تسوق الآن"]})]}),_.length>10&&n.jsx("div",{className:"flex justify-center mt-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(Dl,{className:"w-5 h-5"})}),n.jsx("span",{className:"px-4 py-2",children:"صفحة 1 من 2"}),n.jsx("button",{className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50",children:n.jsx(Rl,{className:"w-5 h-5"})})]})})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"ملخص الطلب"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"المجموع الفرعي"}),n.jsxs("span",{className:"font-medium",children:[E.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الشحن"}),S===0?n.jsx("span",{className:"text-green-600",children:"مجاني"}):n.jsxs("span",{className:"font-medium",children:[S.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{className:"font-medium",children:[k.toFixed(2)," ",e("store.currency")]})]}),j>0&&n.jsxs("div",{className:"flex justify-between text-green-600",children:[n.jsx("span",{children:"الخصم"}),n.jsxs("span",{className:"font-medium",children:["-",j.toFixed(2)," ",e("store.currency")]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-4 mt-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-lg font-bold text-gray-800",children:"الإجمالي"}),n.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[O.toFixed(2)," ",e("store.currency")]})]})})]}),n.jsxs("div",{className:"mt-6",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"كود الخصم"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:m,onChange:R=>x(R.target.value),placeholder:"أدخل كود الخصم",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"}),n.jsx("button",{onClick:A,disabled:v,className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-900 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:v?"جاري التطبيق...":"تطبيق"})]}),p&&n.jsx("p",{className:"mt-2 text-sm text-red-600",children:p}),y&&n.jsx("p",{className:"mt-2 text-sm text-green-600",children:y}),n.jsx("p",{className:"mt-2 text-xs text-gray-500",children:'جرب كود "DISCOUNT20" للحصول على خصم 20%'})]}),n.jsxs(Ae,{to:"/checkout",className:`w-full mt-6 px-6 py-3 bg-purple-600 text-white rounded-xl font-medium flex items-center justify-center gap-2 ${_.length===0?"opacity-50 cursor-not-allowed pointer-events-none":"hover:bg-purple-700 transition-colors"}`,children:[n.jsx(ri,{className:"w-5 h-5"}),"المتابعة للدفع"]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"معلومات الشحن"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:n.jsx(ic,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"شحن مجاني"}),n.jsxs("p",{className:"text-sm text-gray-600",children:["للطلبات فوق ",Dh," ريال"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:n.jsx(Tf,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"توصيل سريع"}),n.jsx("p",{className:"text-sm text-gray-600",children:"خلال 2-5 أيام عمل"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(Ka,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800",children:"ضمان الجودة"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ضمان استرجاع لمدة 30 يوم"})]})]})]})]})]})]})]})},W6=()=>{const{t:e}=jt(),t=Ho(),{user:r}=wt(),{cart:a,clearCart:s,getTotalItems:i,getTotalPrice:o}=_x(),{storeItems:l,loading:c,error:d}=Pf(),[u,f]=C.useState({fullName:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||"",phone:(r==null?void 0:r.phone)||"",address:"",city:"",postalCode:"",country:"Saudi Arabia",notes:"",saveInfo:!0,paymentMethod:"credit-card",cardNumber:"",cardName:"",cardExpiry:"",cardCvv:"",agreeToTerms:!1}),[h,m]=C.useState(!1),[x,p]=C.useState(null),[g,y]=C.useState(!1),[b,v]=C.useState(null),[w,j]=C.useState(!0),[N,_]=C.useState(!0),[E,S]=C.useState(!0),k=Object.entries(a).map(([L,ee])=>({item:l.find(G=>G.id===L),quantity:ee})).filter(({item:L})=>L!==void 0),O=o(l),P=O>Dh?0:Rj,A=O*Mj,R=O+P+A,T=(L,ee)=>{f(M=>({...M,[L]:ee}))},F=()=>{if(!u.fullName||!u.email||!u.phone||!u.address||!u.city)return p("يرجى ملء جميع الحقول المطلوبة"),!1;if(!u.agreeToTerms)return p("يجب الموافقة على الشروط والأحكام للمتابعة"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email))return p("يرجى إدخال بريد إلكتروني صحيح"),!1;if(!/^\d{9,15}$/.test(u.phone.replace(/\D/g,"")))return p("يرجى إدخال رقم هاتف صحيح"),!1;if(u.paymentMethod==="credit-card"){if(!u.cardNumber||!u.cardName||!u.cardExpiry||!u.cardCvv)return p("يرجى إدخال جميع تفاصيل بطاقة الائتمان"),!1;if(!/^\d{16}$/.test(u.cardNumber.replace(/\D/g,"")))return p("يرجى إدخال رقم بطاقة صحيح (16 رقم)"),!1;if(!/^(0[1-9]|1[0-2])\/([0-9]{2})$/.test(u.cardExpiry))return p("يرجى إدخال تاريخ انتهاء صلاحية صحيح (MM/YY)"),!1;if(!/^\d{3,4}$/.test(u.cardCvv))return p("يرجى إدخال رمز CVV صحيح (3-4 أرقام)"),!1}return p(null),!0},W=async L=>{if(L.preventDefault(),!!F()){m(!0);try{await new Promise(M=>setTimeout(M,2e3));const ee=Math.floor(1e5+Math.random()*9e5).toString();v(ee),s(),y(!0)}catch(ee){console.error("Error processing order:",ee),p("حدث خطأ أثناء معالجة الطلب. يرجى المحاولة مرة أخرى.")}finally{m(!1)}}},K=L=>{const M=L.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),G=M&&M[0]||"",V=[];for(let H=0,re=G.length;H<re;H+=4)V.push(G.substring(H,H+4));return V.length?V.join(" "):L},B=L=>{const ee=L.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return ee.length>=2?`${ee.substring(0,2)}/${ee.substring(2,4)}`:ee};return c?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):d?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:d})]})}):k.length===0&&!g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Hr,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"سلة التسوق فارغة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"يرجى إضافة منتجات إلى سلة التسوق قبل المتابعة للدفع"}),n.jsxs(Ae,{to:"/store",className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors inline-flex items-center gap-2",children:[n.jsx(Hr,{className:"w-4 h-4"}),"تسوق الآن"]})]})}):g?n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-green-600 to-teal-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ze,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"تم إتمام الطلب بنجاح"}),n.jsx("p",{className:"opacity-90",children:"شكراً لك على الطلب!"})]})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[n.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:n.jsx(ze,{className:"w-12 h-12 text-green-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"تم استلام طلبك"}),n.jsxs("p",{className:"text-gray-600 mb-6",children:["لقد تم استلام طلبك بنجاح وسيتم معالجته في أقرب وقت ممكن.",n.jsx("br",{}),"سيتم إرسال تأكيد الطلب إلى بريدك الإلكتروني."]}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6 inline-block",children:[n.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["رقم الطلب: #",b]}),n.jsx("p",{className:"text-gray-600",children:"يرجى الاحتفاظ بهذا الرقم للرجوع إليه في المستقبل"})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(Ae,{to:"/store",className:"px-6 py-3 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors",children:"العودة إلى المتجر"}),n.jsx("button",{onClick:()=>t("/"),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"الذهاب إلى الصفحة الرئيسية"})]})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ri,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إتمام الطلب"}),n.jsx("p",{className:"opacity-90",children:"أدخل بيانات الشحن والدفع"})]})]})}),n.jsx("div",{className:"flex items-center",children:n.jsxs(Ae,{to:"/cart",className:"flex items-center gap-2 text-purple-600 hover:text-purple-800 transition-colors",children:[n.jsx(Qn,{className:"w-5 h-5"}),n.jsx("span",{children:"العودة إلى سلة التسوق"})]})}),n.jsx("form",{onSubmit:W,children:n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[x&&n.jsxs(te.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-xl flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:x})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>j(!w),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(ic,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"معلومات الشحن"})]}),w?n.jsx(I0,{className:"w-5 h-5 text-gray-500"}):n.jsx(D0,{className:"w-5 h-5 text-gray-500"})]}),w&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل *"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.fullName,onChange:L=>T("fullName",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الاسم الكامل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"البريد الإلكتروني *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ta,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:u.email,onChange:L=>T("email",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل البريد الإلكتروني",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Pr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"tel",value:u.phone,onChange:L=>T("phone",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل رقم الهاتف",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدينة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Sn,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.city,onChange:L=>T("city",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل المدينة",required:!0})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"العنوان *"}),n.jsxs("div",{className:"relative",children:[n.jsx(vj,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.address,onChange:L=>T("address",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل العنوان بالتفصيل",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الرمز البريدي"}),n.jsxs("div",{className:"relative",children:[n.jsx(Ef,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.postalCode,onChange:L=>T("postalCode",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أدخل الرمز البريدي"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الدولة"}),n.jsxs("div",{className:"relative",children:[n.jsx(tc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:u.country,onChange:L=>T("country",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[n.jsx("option",{value:"Saudi Arabia",children:"المملكة العربية السعودية"}),n.jsx("option",{value:"United Arab Emirates",children:"الإمارات العربية المتحدة"}),n.jsx("option",{value:"Kuwait",children:"الكويت"}),n.jsx("option",{value:"Bahrain",children:"البحرين"}),n.jsx("option",{value:"Oman",children:"عمان"}),n.jsx("option",{value:"Qatar",children:"قطر"})]})]})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ملاحظات إضافية"}),n.jsx("textarea",{value:u.notes,onChange:L=>T("notes",L.target.value),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"أي ملاحظات خاصة بالطلب أو الشحن"})]})]}),n.jsx("div",{className:"mt-4",children:n.jsxs("label",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",checked:u.saveInfo,onChange:L=>T("saveInfo",L.target.checked),className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),n.jsx("span",{className:"mr-2 text-sm text-gray-700",children:"حفظ هذه المعلومات للطلبات القادمة"})]})})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>_(!N),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(ri,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"طريقة الدفع"})]}),N?n.jsx(I0,{className:"w-5 h-5 text-gray-500"}):n.jsx(D0,{className:"w-5 h-5 text-gray-500"})]}),N&&n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"space-y-4 mb-6",children:[n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"credit-card",checked:u.paymentMethod==="credit-card",onChange:()=>T("paymentMethod","credit-card"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"بطاقة ائتمان"}),n.jsx("p",{className:"text-sm text-gray-600",children:"Visa, Mastercard, American Express"})]}),n.jsxs("div",{className:"mr-auto flex gap-2",children:[n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Visa_Inc._logo.svg/2560px-Visa_Inc._logo.svg.png",alt:"Visa",className:"h-6"}),n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/1280px-Mastercard-logo.svg.png",alt:"Mastercard",className:"h-6"}),n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/f/fa/American_Express_logo_%282018%29.svg/1200px-American_Express_logo_%282018%29.svg.png",alt:"American Express",className:"h-6"})]})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"mada",checked:u.paymentMethod==="mada",onChange:()=>T("paymentMethod","mada"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"مدى"}),n.jsx("p",{className:"text-sm text-gray-600",children:"الدفع ببطاقة مدى"})]}),n.jsx("div",{className:"mr-auto",children:n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/ar/b/b0/Mada_Logo.png",alt:"Mada",className:"h-6"})})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"apple-pay",checked:u.paymentMethod==="apple-pay",onChange:()=>T("paymentMethod","apple-pay"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"Apple Pay"}),n.jsx("p",{className:"text-sm text-gray-600",children:"الدفع باستخدام Apple Pay"})]}),n.jsx("div",{className:"mr-auto",children:n.jsx("img",{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/Apple_Pay_logo.svg/2560px-Apple_Pay_logo.svg.png",alt:"Apple Pay",className:"h-6"})})]}),n.jsxs("label",{className:"flex items-center p-4 border border-gray-200 rounded-xl cursor-pointer hover:bg-gray-50 transition-colors",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"cash-on-delivery",checked:u.paymentMethod==="cash-on-delivery",onChange:()=>T("paymentMethod","cash-on-delivery"),className:"text-purple-600"}),n.jsxs("div",{className:"mr-3",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"الدفع عند الاستلام"}),n.jsx("p",{className:"text-sm text-gray-600",children:"ادفع نقداً عند استلام الطلب"})]})]})]}),u.paymentMethod==="credit-card"&&n.jsxs("div",{className:"space-y-4 border-t border-gray-200 pt-4",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"تفاصيل البطاقة"}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم البطاقة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ri,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardNumber,onChange:L=>T("cardNumber",K(L.target.value)),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"XXXX XXXX XXXX XXXX",maxLength:19,required:u.paymentMethod==="credit-card"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم على البطاقة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardName,onChange:L=>T("cardName",L.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"الاسم كما يظهر على البطاقة",required:u.paymentMethod==="credit-card"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"تاريخ الانتهاء *"}),n.jsx("input",{type:"text",value:u.cardExpiry,onChange:L=>T("cardExpiry",B(L.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"MM/YY",maxLength:5,required:u.paymentMethod==="credit-card"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رمز الأمان (CVV) *"}),n.jsxs("div",{className:"relative",children:[n.jsx(rc,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:u.cardCvv,onChange:L=>T("cardCvv",L.target.value.replace(/\D/g,"").slice(0,4)),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"XXX",maxLength:4,required:u.paymentMethod==="credit-card"})]})]})]})]}),n.jsx("div",{className:"mt-6 bg-gray-50 p-4 rounded-xl",children:n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(rc,{className:"w-4 h-4 text-green-600"}),n.jsx("span",{children:"جميع المعاملات مشفرة وآمنة. بياناتك محمية."})]})})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx("input",{type:"checkbox",id:"agreeToTerms",checked:u.agreeToTerms,onChange:L=>T("agreeToTerms",L.target.checked),className:"mt-1 w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500",required:!0}),n.jsxs("label",{htmlFor:"agreeToTerms",className:"text-sm text-gray-700",children:["أوافق على ",n.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"الشروط والأحكام"})," و ",n.jsx("a",{href:"#",className:"text-purple-600 hover:underline",children:"سياسة الخصوصية"})]})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between cursor-pointer",onClick:()=>S(!E),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:n.jsx(Hr,{className:"w-5 h-5 text-purple-600"})}),n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"ملخص الطلب"})]}),E?n.jsx(I0,{className:"w-5 h-5 text-gray-500"}):n.jsx(D0,{className:"w-5 h-5 text-gray-500"})]}),E&&n.jsxs("div",{className:"p-6",children:[n.jsx("div",{className:"space-y-4 mb-6",children:k.map(({item:L,quantity:ee})=>L&&n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:L.image,alt:L.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-medium text-gray-800 text-sm",children:L.name}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm text-gray-500",children:["الكمية: ",ee]}),n.jsxs("span",{className:"font-medium text-purple-600",children:[(L.price*ee).toFixed(2)," ",e("store.currency")]})]})]})]},L.id))}),n.jsxs("div",{className:"space-y-3 border-t border-gray-200 pt-4",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"المجموع الفرعي"}),n.jsxs("span",{className:"font-medium",children:[O.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الشحن"}),P===0?n.jsx("span",{className:"text-green-600",children:"مجاني"}):n.jsxs("span",{className:"font-medium",children:[P.toFixed(2)," ",e("store.currency")]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"ضريبة القيمة المضافة (15%)"}),n.jsxs("span",{className:"font-medium",children:[A.toFixed(2)," ",e("store.currency")]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-3 mt-2",children:n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-lg font-bold text-gray-800",children:"الإجمالي"}),n.jsxs("span",{className:"text-lg font-bold text-purple-600",children:[R.toFixed(2)," ",e("store.currency")]})]})})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("button",{type:"submit",disabled:h,className:"w-full px-6 py-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:h?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"جاري معالجة الطلب..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ri,{className:"w-5 h-5"}),"إتمام الطلب"]})}),n.jsxs("div",{className:"mt-4 flex items-center justify-center gap-4 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ka,{className:"w-4 h-4"}),n.jsx("span",{children:"دفع آمن"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ic,{className:"w-4 h-4"}),n.jsx("span",{children:"شحن سريع"})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ze,{className:"w-4 h-4"}),n.jsx("span",{children:"ضمان الجودة"})]})]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6",children:[n.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"بحاجة إلى مساعدة؟"}),n.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"إذا كان لديك أي أسئلة أو استفسارات حول طلبك، يرجى التواصل مع فريق خدمة العملاء."}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors text-sm",children:"اتصل بنا"}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors text-sm",children:"الأسئلة الشائعة"})]})]})]})]})})]})},H6=[{icon:ga,titleKey:"aiAssistant.features.projectIdeas.title",descriptionKey:"aiAssistant.features.projectIdeas.description",color:"from-yellow-400 to-orange-500"},{icon:Qk,titleKey:"aiAssistant.features.programming.title",descriptionKey:"aiAssistant.features.programming.description",color:"from-blue-500 to-purple-600"},{icon:e3,titleKey:"aiAssistant.features.problemSolving.title",descriptionKey:"aiAssistant.features.problemSolving.description",color:"from-green-500 to-teal-600"},{icon:Nt,titleKey:"aiAssistant.features.research.title",descriptionKey:"aiAssistant.features.research.description",color:"from-indigo-500 to-blue-600"},{icon:nc,titleKey:"aiAssistant.features.design.title",descriptionKey:"aiAssistant.features.design.description",color:"from-pink-500 to-rose-600"},{icon:tc,titleKey:"aiAssistant.features.languages.title",descriptionKey:"aiAssistant.features.languages.description",color:"from-purple-500 to-pink-600"}],z6=["aiAssistant.quickPrompts.aiProject","aiAssistant.quickPrompts.programming","aiAssistant.quickPrompts.mathProblem","aiAssistant.quickPrompts.entrepreneurship","aiAssistant.quickPrompts.presentation","aiAssistant.quickPrompts.timeManagement"],V6=[{id:"1",type:"user",message:"aiAssistant.mockConversation.user1",timestamp:"2024-01-21T10:00:00Z"},{id:"2",type:"assistant",message:"aiAssistant.mockConversation.assistant1",timestamp:"2024-01-21T10:00:30Z"},{id:"3",type:"user",message:"aiAssistant.mockConversation.user2",timestamp:"2024-01-21T10:01:00Z"},{id:"4",type:"assistant",message:"aiAssistant.mockConversation.assistant2",timestamp:"2024-01-21T10:01:45Z"}],G6=()=>{const{t:e}=jt(),[t,r]=C.useState(V6.map(u=>({...u,message:e(u.message)}))),[a,s]=C.useState(""),[i,o]=C.useState(!1),l=async()=>{if(!a.trim())return;const u={id:Date.now().toString(),type:"user",message:a,timestamp:new Date().toISOString()};r(f=>[...f,u]),s(""),o(!0),setTimeout(()=>{const f={id:(Date.now()+1).toString(),type:"assistant",message:e("aiAssistant.simulatedResponse"),timestamp:new Date().toISOString()};r(h=>[...h,f]),o(!1)},2e3)},c=u=>{s(e(u))},d=u=>new Date(u).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"});return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ti,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("aiAssistant.title")}),n.jsx("p",{className:"opacity-90",children:e("aiAssistant.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.alwaysAvailable")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"∞"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.unlimitedQuestions")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"6"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.specializations")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"AI"}),n.jsx("div",{className:"text-sm opacity-80",children:e("aiAssistant.stats.artificialIntelligence")})]})]})]}),n.jsxs("div",{className:"grid lg:grid-cols-4 gap-6",children:[n.jsxs(te.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.1},className:"lg:col-span-1 space-y-4",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(Zk,{className:"w-5 h-5 text-purple-600"}),e("aiAssistant.howCanIHelp")]}),n.jsx("div",{className:"space-y-3",children:H6.map((u,f)=>n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.4,delay:f*.1},className:"group cursor-pointer",children:n.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${u.color} rounded-lg flex items-center justify-center flex-shrink-0`,children:n.jsx(u.icon,{className:"w-5 h-5 text-white"})}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-purple-600 transition-colors",children:e(u.titleKey)}),n.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:e(u.descriptionKey)})]})]})},f))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:e("aiAssistant.quickPrompts.title")}),n.jsx("div",{className:"space-y-2",children:z6.map((u,f)=>n.jsx("button",{onClick:()=>c(u),className:"w-full text-right p-3 text-sm text-gray-700 hover:bg-purple-50 hover:text-purple-700 rounded-lg transition-colors",children:e(u)},f))})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"lg:col-span-3",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg h-[600px] flex flex-col",children:[n.jsx("div",{className:"p-6 border-b border-gray-200",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:n.jsx(ti,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:e("aiAssistant.chatHeader.title")}),n.jsxs("p",{className:"text-sm text-green-600 flex items-center gap-1",children:[n.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e("aiAssistant.chatHeader.online")]})]})]})}),n.jsxs("div",{className:"flex-1 p-6 overflow-y-auto space-y-4",children:[t.map(u=>n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${u.type==="user"?"justify-end":"justify-start"}`,children:n.jsxs("div",{className:`flex gap-3 max-w-[80%] ${u.type==="user"?"flex-row-reverse":""}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${u.type==="user"?"bg-blue-500":"bg-gradient-to-r from-purple-500 to-pink-500"}`,children:u.type==="user"?n.jsx(xr,{className:"w-4 h-4 text-white"}):n.jsx(ti,{className:"w-4 h-4 text-white"})}),n.jsxs("div",{className:`rounded-2xl p-4 ${u.type==="user"?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:[n.jsx("p",{className:"whitespace-pre-line leading-relaxed",children:u.message}),n.jsx("p",{className:`text-xs mt-2 ${u.type==="user"?"text-blue-100":"text-gray-500"}`,children:d(u.timestamp)})]})]})},u.id)),i&&n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex justify-start",children:n.jsxs("div",{className:"flex gap-3 max-w-[80%]",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0",children:n.jsx(ti,{className:"w-4 h-4 text-white"})}),n.jsx("div",{className:"bg-gray-100 rounded-2xl p-4",children:n.jsxs("div",{className:"flex gap-1",children:[n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),n.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})})]}),n.jsxs("div",{className:"p-6 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("button",{className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors",children:n.jsx(bj,{className:"w-5 h-5 text-gray-600"})}),n.jsx("div",{className:"flex-1 relative",children:n.jsx("input",{type:"text",value:a,onChange:u=>s(u.target.value),onKeyPress:u=>u.key==="Enter"&&l(),placeholder:e("aiAssistant.inputPlaceholder"),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})}),n.jsx("button",{className:"p-3 rounded-xl bg-gray-100 hover:bg-gray-200 transition-colors",children:n.jsx(t3,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:l,disabled:!a.trim(),className:"p-3 rounded-xl bg-purple-500 hover:bg-purple-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:n.jsx(jx,{className:"w-5 h-5 text-white"})})]}),n.jsx("div",{className:"mt-3 text-center",children:n.jsx("p",{className:"text-xs text-gray-500",children:e("aiAssistant.disclaimer")})})]})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(r3,{className:"w-6 h-6 text-purple-600"}),e("aiAssistant.tips.title")]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.beSpecific.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.beSpecific.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.provideContext.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.provideContext.description")})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4",children:[n.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:e("aiAssistant.tips.askForExamples.title")}),n.jsx("p",{className:"text-gray-600 text-sm",children:e("aiAssistant.tips.askForExamples.description")})]})]})]})]})},Ex=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),o=async m=>{try{a(!0);const x=Me(pe,"learning_resources");let p;m?p=et(x,We("type","==",m),_s(50)):p=et(x,Fi("created_at","desc"),_s(50));let y=(await Je(p)).docs.map(b=>{const v=b.data();return{id:b.id,title:v.title,description:v.description,type:v.type,category:v.category,author:v.author,duration:v.duration,difficulty:v.difficulty,rating:v.rating||4.5,views:v.views_count||0,likes:v.likes_count||0,thumbnail:v.thumbnail,contentUrl:v.contentUrl||v.content_url,watchUrl:v.watch_url||v.contentUrl||v.content_url,embedUrl:v.embed_url||v.videoUrl||v.video_url,tags:v.tags||[],featured:v.featured||!1,createdAt:v.created_at?new Date(v.created_at.toDate()).toISOString():new Date().toISOString(),lessons:v.lessons,certificate:v.certificate,fileSize:v.fileSize||v.file_size,episodes:v.episodes,downloadUrl:v.downloadUrl||v.download_url,videoUrl:v.videoUrl||v.video_url}});m&&(y=y.sort((b,v)=>new Date(v.createdAt).getTime()-new Date(b.createdAt).getTime())),t(y)}catch(x){console.error("Error fetching learning resources:",x),i(x instanceof Error?x.message:"حدث خطأ في تحميل المصادر التعليمية")}finally{a(!1)}},l=async m=>{try{const x=Re(pe,"learning_resources",m);await Ht(x,{views_count:gi(1)}),t(p=>p.map(g=>g.id===m?{...g,views:g.views+1}:g))}catch(x){console.error("Error incrementing views:",x)}},c=async m=>{try{const x=Re(pe,"learning_resources",m);await Ht(x,{likes_count:gi(1)}),t(p=>p.map(g=>g.id===m?{...g,likes:g.likes+1}:g))}catch(x){console.error("Error incrementing likes:",x)}},d=async m=>{try{const x=Me(pe,"learning_resources");let p=m.watchUrl,g=m.embedUrl;if(m.type==="video"&&m.videoUrl){if(m.videoUrl.includes("embed")&&!p){const v=m.videoUrl.split("/").pop();v&&(p=`https://www.youtube.com/watch?v=${v}`)}if(m.videoUrl.includes("watch")&&!g){const v=new URL(m.videoUrl).searchParams.get("v");v&&(g=`https://www.youtube.com/embed/${v}`)}}const y={title:m.title||"",description:m.description||"",type:m.type||"video",category:m.category||"",author:m.author||"",duration:m.duration||null,difficulty:m.difficulty||null,rating:m.rating||4.5,views_count:0,likes_count:0,thumbnail:m.thumbnail||null,content_url:p||m.contentUrl||null,video_url:g||m.videoUrl||null,watch_url:p||m.watchUrl||m.contentUrl||null,embed_url:g||m.embedUrl||m.videoUrl||null,tags:m.tags||[],featured:m.featured||!1,created_at:Ve(),updated_at:Ve()};m.type==="course"?(y.lessons=m.lessons,y.certificate=m.certificate):m.type==="template"?(y.file_size=m.fileSize,y.download_url=m.downloadUrl):m.type==="podcast"&&(y.episodes=m.episodes);const b=await Aa(x,y);return await o(),{id:b.id,...y}}catch(x){throw console.error("Error creating learning resource:",x),x}},u=async(m,x)=>{try{const p=Re(pe,"learning_resources",m);let g=x.watchUrl,y=x.embedUrl;if(x.type==="video"&&x.videoUrl){if(x.videoUrl.includes("embed")&&!g){const v=x.videoUrl.split("/").pop();v&&(g=`https://www.youtube.com/watch?v=${v}`)}if(x.videoUrl.includes("watch")&&!y){const v=new URL(x.videoUrl).searchParams.get("v");v&&(y=`https://www.youtube.com/embed/${v}`)}}const b={updated_at:Ve()};return x.title!==void 0&&(b.title=x.title),x.description!==void 0&&(b.description=x.description),x.type!==void 0&&(b.type=x.type),x.category!==void 0&&(b.category=x.category),x.author!==void 0&&(b.author=x.author),x.duration!==void 0&&(b.duration=x.duration),x.difficulty!==void 0&&(b.difficulty=x.difficulty),x.thumbnail!==void 0&&(b.thumbnail=x.thumbnail),x.contentUrl!==void 0&&(b.content_url=x.contentUrl),x.videoUrl!==void 0&&(b.video_url=x.videoUrl),g!==void 0&&(b.watch_url=g),y!==void 0&&(b.embed_url=y),x.tags!==void 0&&(b.tags=x.tags),x.featured!==void 0&&(b.featured=x.featured),x.type==="course"?(x.lessons!==void 0&&(b.lessons=x.lessons),x.certificate!==void 0&&(b.certificate=x.certificate)):x.type==="template"?(x.fileSize!==void 0&&(b.file_size=x.fileSize),x.downloadUrl!==void 0&&(b.download_url=x.downloadUrl)):x.type==="podcast"&&x.episodes!==void 0&&(b.episodes=x.episodes),await Ht(p,b),await o(),{id:m,...x}}catch(p){throw console.error("Error updating learning resource:",p),p}},f=async m=>{try{const x=Re(pe,"learning_resources",m);return await qa(x),t(p=>p.filter(g=>g.id!==m)),!0}catch(x){throw console.error("Error deleting learning resource:",x),x}},h=async()=>{try{const m=await R3();return await o(),m}catch(m){throw console.error("Error cleaning up duplicate resources:",m),m}};return C.useEffect(()=>{o()},[]),{resources:e,loading:r,error:s,fetchResources:o,incrementViews:l,incrementLikes:c,createResource:d,updateResource:u,deleteResource:f,cleanupDuplicateResources:h}},q6=()=>{const{t:e}=jt(),{resources:t,loading:r,error:a,incrementViews:s,incrementLikes:i}=Ex(),[o,l]=C.useState("all"),[c,d]=C.useState("all"),[u,f]=C.useState(""),[h,m]=C.useState([]),x=[{id:"all",name:e("resources.types.all"),icon:Nt},{id:"article",name:e("resources.types.article"),icon:yr},{id:"video",name:e("resources.types.video"),icon:wr},{id:"course",name:e("resources.types.course"),icon:wi},{id:"template",name:e("resources.types.template"),icon:Cr},{id:"podcast",name:e("resources.types.podcast"),icon:wg},{id:"link",name:e("resources.types.link"),icon:cu}],p=[{id:"all",name:e("resources.categories.all")},{id:"project-management",name:e("resources.categories.projectManagement")},{id:"programming",name:e("resources.categories.programming")},{id:"design",name:e("resources.categories.design")},{id:"entrepreneurship",name:e("resources.categories.entrepreneurship")},{id:"stem",name:e("resources.categories.stem")},{id:"soft-skills",name:e("resources.categories.softSkills")}],g=t.filter(N=>{const _=o==="all"||N.type===o,E=c==="all"||N.category===c,S=N.title.toLowerCase().includes(u.toLowerCase())||N.description.toLowerCase().includes(u.toLowerCase())||N.tags.some(k=>k.toLowerCase().includes(u.toLowerCase()));return _&&E&&S}),y=N=>{h.includes(N)?m(_=>_.filter(E=>E!==N)):(m(_=>[..._,N]),i(N))},b=N=>{s(N)},v=N=>{const _=x.find(E=>E.id===N);return _?_.icon:yr},w=N=>{switch(N){case"مبتدئ":case"beginner":return"bg-green-100 text-green-800";case"متوسط":case"intermediate":return"bg-yellow-100 text-yellow-800";case"متقدم":case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},j=N=>{switch(N){case"مبتدئ":case"beginner":return e("resources.difficulties.beginner");case"متوسط":case"intermediate":return e("resources.difficulties.intermediate");case"متقدم":case"advanced":return e("resources.difficulties.advanced");default:return N}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Nt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("resources.title")}),n.jsx("p",{className:"opacity-90",children:e("resources.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.learningResource")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.contentType")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.specialtyCategory")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("resources.stats.free")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("resources.searchPlaceholder"),value:u,onChange:N=>f(N.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("resources.filters.contentType")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:x.map(N=>n.jsxs("button",{onClick:()=>l(N.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${o===N.id?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(N.icon,{className:"w-4 h-4"}),N.name]},N.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("resources.filters.category")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(N=>n.jsx("button",{onClick:()=>d(N.id),className:`px-4 py-2 rounded-xl transition-all ${c===N.id?"bg-teal-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:N.name},N.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("resources.showing")," ",g.length," ",e("resources.of")," ",t.length," ",e("resources.resource")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((N,_)=>{var S;const E=v(N.type);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:_*.1},className:"bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"relative h-48 overflow-hidden",children:[n.jsx("img",{src:N.thumbnail||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=400",alt:N.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),N.featured&&n.jsx("div",{className:"absolute top-4 right-4 bg-yellow-500 text-white px-2 py-1 rounded-lg text-sm font-medium",children:e("resources.featured")}),n.jsx("div",{className:"absolute top-4 left-4",children:n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(E,{className:"w-3 h-3"}),(S=x.find(k=>k.id===N.type))==null?void 0:S.name]})}),n.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2",children:[n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(nr,{className:"w-3 h-3"}),N.views.toLocaleString()]}),n.jsxs("div",{className:"bg-black bg-opacity-50 text-white px-2 py-1 rounded-lg text-xs flex items-center gap-1",children:[n.jsx(ha,{className:"w-3 h-3"}),N.likes]})]})]}),n.jsxs("div",{className:"p-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"text-sm font-medium",children:N.rating})]}),n.jsx("span",{className:"text-gray-300",children:"•"}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w(N.difficulty||"beginner")}`,children:j(N.difficulty||"beginner")})]}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 group-hover:text-emerald-600 transition-colors line-clamp-2",children:N.title}),n.jsx("p",{className:"text-gray-600 mb-4 line-clamp-3 leading-relaxed",children:N.description}),n.jsxs("div",{className:"flex flex-wrap gap-1 mb-4",children:[N.tags.slice(0,3).map((k,O)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",k]},O)),N.tags.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",N.tags.length-3," ",e("resources.more")]})]}),n.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),N.duration||e("resources.defaultDuration")]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(dt,{className:"w-4 h-4"}),N.author]})]}),N.type==="course"&&N.lessons&&n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-4",children:[n.jsxs("span",{children:[N.lessons," ",e("resources.lesson")]}),N.certificate&&n.jsx("span",{children:e("resources.certifiedCourse")})]}),N.type==="template"&&N.fileSize&&n.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[e("resources.fileSize"),": ",N.fileSize]}),N.type==="podcast"&&N.episodes&&n.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[N.episodes," ",e("resources.episode")]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>y(N.id),className:`p-2 rounded-lg transition-colors ${h.includes(N.id)?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-600"}`,children:n.jsx(ha,{className:"w-4 h-4"})}),n.jsx("button",{className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-600 transition-colors",children:n.jsx(Ss,{className:"w-4 h-4"})}),(N.type==="template"||N.downloadUrl)&&n.jsx("button",{className:"p-2 rounded-lg bg-gray-100 text-gray-600 hover:bg-green-100 hover:text-green-600 transition-colors",children:n.jsx(Cr,{className:"w-4 h-4"})})]}),N.type==="video"?n.jsxs("a",{href:N.watchUrl||N.contentUrl||"#",target:"_blank",rel:"noopener noreferrer",onClick:()=>b(N.id),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm font-medium flex items-center gap-2",children:[n.jsx(wi,{className:"w-4 h-4"}),e("resources.actions.watch")]}):n.jsxs("button",{onClick:()=>b(N.id),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm font-medium flex items-center gap-2",children:[N.type==="course"&&n.jsx(Nt,{className:"w-4 h-4"}),N.type==="template"&&n.jsx(Cr,{className:"w-4 h-4"}),N.type==="podcast"&&n.jsx(wg,{className:"w-4 h-4"}),N.type==="article"&&n.jsx(yr,{className:"w-4 h-4"}),N.type==="link"&&n.jsx(cu,{className:"w-4 h-4"}),N.type==="course"&&e("resources.actions.startCourse"),N.type==="template"&&e("resources.actions.download"),N.type==="podcast"&&e("resources.actions.listen"),N.type==="article"&&e("resources.actions.read"),N.type==="link"&&e("resources.actions.visit")]})]})]})]},N.id)})}),g.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ft,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("resources.noResourcesFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("resources.tryChangingFilters")}),n.jsx("button",{onClick:()=>{l("all"),d("all"),f("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("common.resetFilters")})]})]})},K6=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=wt(),l=async()=>{if(o)try{a(!0);const u=Me(pe,"intellectual_property");let f;if(o.role==="student")f=et(u,We("student_id","==",o.id));else if(o.role==="teacher"){const x=Me(pe,"users"),p=et(x,We("role","==","student"),We("school_id","==",o.school_id)),y=(await Je(p)).docs.map(b=>b.id);if(y.length>0)f=et(u,We("student_id","in",y));else{t([]),a(!1);return}}else f=u;const h=await Je(f),m=await Promise.all(h.docs.map(async x=>{const p=x.data();let g={id:p.student_id,name:"طالب غير معروف",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",school:"مدرسة غير معروفة"};if(p.student_id){const b=Re(pe,"users",p.student_id),v=await fr(b);if(v.exists()){const w=v.data();if(g.name=w.name,g.avatar=w.avatar_url||g.avatar,w.school_id){const j=Re(pe,"schools",w.school_id),N=await fr(j);N.exists()&&(g.school=N.data().name)}}}let y=null;if(p.project_id){const b=Re(pe,"projects",p.project_id),v=await fr(b);if(v.exists()){const w=v.data();y={id:v.id,title:w.title}}}return{id:x.id,title:p.title,description:p.description,type:p.type,status:p.status,student:g,project:y,submittedAt:p.submitted_at?new Date(p.submitted_at.toDate()).toISOString():new Date().toISOString(),reviewedAt:p.reviewed_at?new Date(p.reviewed_at.toDate()).toISOString():void 0,documents:p.documents||[],tags:p.tags||[],certificateNumber:p.certificate_number,rejectionReason:p.rejection_reason,estimatedReviewDate:p.estimated_review_date?new Date(p.estimated_review_date.toDate()).toISOString():void 0}}));t(m)}catch(u){console.error("Error fetching intellectual properties:",u),i(u instanceof Error?u.message:"حدث خطأ في تحميل طلبات الملكية الفكرية")}finally{a(!1)}},c=async u=>{var f;if(!o)throw new Error("يجب تسجيل الدخول أولاً");try{const h=Me(pe,"intellectual_property"),m={student_id:o.id,project_id:(f=u.project)==null?void 0:f.id,title:u.title,description:u.description,type:u.type,status:"pending",documents:u.documents||[],tags:u.tags||[],submitted_at:Ve(),estimated_review_date:an.fromDate(new Date(Date.now()+7*24*60*60*1e3))},x=await Aa(h,m);return await l(),{id:x.id,...m}}catch(h){throw console.error("Error creating intellectual property:",h),h}},d=async(u,f)=>{try{const h=Re(pe,"intellectual_property",u),m={};f.status&&(m.status=f.status,f.status==="approved"?(m.reviewed_at=Ve(),f.certificateNumber&&(m.certificate_number=f.certificateNumber)):f.status==="rejected"&&(m.reviewed_at=Ve(),f.rejectionReason&&(m.rejection_reason=f.rejectionReason))),f.documents&&(m.documents=f.documents),f.tags&&(m.tags=f.tags),await Ht(h,m),await l()}catch(h){throw console.error("Error updating intellectual property:",h),h}};return C.useEffect(()=>{o&&l()},[o]),{intellectualProperties:e,loading:r,error:s,fetchIntellectualProperties:l,createIntellectualProperty:c,updateIntellectualProperty:d}},X6=()=>{const{t:e}=jt(),{intellectualProperties:t,loading:r,error:a}=K6(),[s,i]=C.useState("all"),[o,l]=C.useState("all"),[c,d]=C.useState(""),u=[{id:"all",name:e("intellectualProperty.types.all"),icon:Nt,color:"from-gray-500 to-gray-600"},{id:"invention",name:e("intellectualProperty.types.invention"),icon:ga,color:"from-yellow-400 to-orange-500"},{id:"design",name:e("intellectualProperty.types.design"),icon:nc,color:"from-pink-500 to-rose-600"},{id:"software",name:e("intellectualProperty.types.software"),icon:jg,color:"from-blue-500 to-purple-600"},{id:"research",name:e("intellectualProperty.types.research"),icon:Nt,color:"from-green-500 to-teal-600"}],f=[{id:"all",name:e("intellectualProperty.statuses.all"),color:"bg-gray-100 text-gray-800",icon:Nt},{id:"pending",name:e("intellectualProperty.statuses.pending"),color:"bg-yellow-100 text-yellow-800",icon:_t},{id:"approved",name:e("intellectualProperty.statuses.approved"),color:"bg-green-100 text-green-800",icon:ze},{id:"rejected",name:e("intellectualProperty.statuses.rejected"),color:"bg-red-100 text-red-800",icon:Br}],h=t.filter(g=>{const y=s==="all"||g.type===s,b=o==="all"||g.status===o,v=g.title.toLowerCase().includes(c.toLowerCase())||g.description.toLowerCase().includes(c.toLowerCase())||g.tags.some(w=>w.toLowerCase().includes(c.toLowerCase()));return y&&b&&v}),m=g=>f.find(b=>b.id===g)||{name:g,color:"bg-gray-100 text-gray-800",icon:ca},x=g=>u.find(b=>b.id===g)||{name:g,icon:yr,color:"from-gray-400 to-gray-500"},p=g=>g;return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-purple-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-purple-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Ka,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("intellectualProperty.title")}),n.jsx("p",{className:"opacity-90",children:e("intellectualProperty.subtitle")})]})]}),n.jsxs("button",{className:"bg-white text-purple-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),e("intellectualProperty.newRegistration")]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.totalRequests")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(g=>g.status==="approved").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.approved")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(g=>g.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.underReview")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:u.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("intellectualProperty.stats.protectionTypes")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("intellectualProperty.searchPlaceholder"),value:c,onChange:g=>d(g.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("intellectualProperty.filters.propertyType")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:u.map(g=>n.jsxs("button",{onClick:()=>i(g.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${s===g.id?"bg-purple-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[g.icon&&n.jsx(g.icon,{className:"w-4 h-4"}),g.name]},g.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("intellectualProperty.filters.requestStatus")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:f.map(g=>n.jsxs("button",{onClick:()=>l(g.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${o===g.id?"bg-indigo-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[g.icon&&n.jsx(g.icon,{className:"w-4 h-4"}),g.name]},g.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("intellectualProperty.showing")," ",h.length," ",e("intellectualProperty.of")," ",t.length," ",e("intellectualProperty.request")]})}),n.jsx("div",{className:"space-y-4",children:h.map((g,y)=>{const b=m(g.status),v=x(g.type);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:y*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[n.jsx("div",{className:`w-16 h-16 bg-gradient-to-r ${v.color} rounded-2xl flex items-center justify-center flex-shrink-0`,children:n.jsx(v.icon,{className:"w-8 h-8 text-white"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g.title}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${b.color}`,children:b.name})]}),n.jsx("p",{className:"text-gray-600 mb-3 leading-relaxed",children:g.description}),n.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:g.tags.map((w,j)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",w]},j))}),n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("img",{src:g.student.avatar,alt:g.student.name,className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:g.student.name}),n.jsx("p",{className:"text-sm text-gray-500",children:g.student.school})]})]}),g.project&&n.jsxs("div",{className:"text-sm text-gray-500 mb-3",children:[n.jsxs("span",{children:[e("intellectualProperty.relatedProject"),": "]}),n.jsx("span",{className:"text-purple-600 hover:text-purple-800 cursor-pointer",children:g.project.title})]}),n.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.submissionDate"),": ",Ze(g.submittedAt)]})]}),g.reviewedAt&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(ze,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.reviewDate"),": ",Ze(g.reviewedAt)]})]}),g.estimatedReviewDate&&!g.reviewedAt&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),n.jsxs("span",{children:[e("intellectualProperty.estimatedReview"),": ",Ze(g.estimatedReviewDate)]})]})]})]})]}),g.certificateNumber&&n.jsx("div",{className:"text-right",children:n.jsxs("div",{className:"bg-green-100 text-green-800 px-3 py-2 rounded-lg text-sm font-medium",children:[e("intellectualProperty.certificateNumber"),": ",g.certificateNumber]})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("intellectualProperty.attachedDocuments"),":"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-2",children:g.documents.map((w,j)=>n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[n.jsx(yr,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:w.name}),n.jsx("p",{className:"text-xs text-gray-500",children:p(w.size)})]}),n.jsx("button",{className:"p-1 rounded hover:bg-gray-200 transition-colors",children:n.jsx(Cr,{className:"w-4 h-4 text-gray-500"})})]},j))})]}),g.status==="rejected"&&g.rejectionReason&&n.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[n.jsxs("h4",{className:"font-medium text-red-800 mb-2 flex items-center gap-2",children:[n.jsx(Br,{className:"w-4 h-4"}),e("intellectualProperty.rejectionReason"),":"]}),n.jsx("p",{className:"text-red-700 text-sm",children:g.rejectionReason})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors text-sm",children:[n.jsx(nr,{className:"w-4 h-4"}),e("intellectualProperty.actions.viewDetails")]}),g.status==="approved"&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:[n.jsx(Cr,{className:"w-4 h-4"}),e("intellectualProperty.actions.downloadCertificate")]}),g.status==="rejected"&&n.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:[n.jsx(bi,{className:"w-4 h-4"}),e("intellectualProperty.actions.resubmit")]})]}),n.jsxs("div",{className:"text-sm text-gray-500",children:[e("intellectualProperty.protectionType"),": ",v.name]})]})]},g.id)})}),h.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Ka,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("intellectualProperty.noRequests")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("intellectualProperty.noRequestsFound")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{className:"px-6 py-2 bg-purple-500 text-white rounded-xl hover:bg-purple-600 transition-colors flex items-center gap-2",children:[n.jsx(yt,{className:"w-4 h-4"}),e("intellectualProperty.newRegistration")]}),n.jsx("button",{onClick:()=>{i("all"),l("all"),d("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:e("intellectualProperty.importantInfo.title")}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2",children:[e("intellectualProperty.importantInfo.availableTypes"),":"]}),n.jsxs("ul",{className:"space-y-2 text-gray-600",children:[n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(ga,{className:"w-4 h-4 text-yellow-500"}),e("intellectualProperty.importantInfo.inventions")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(jg,{className:"w-4 h-4 text-blue-500"}),e("intellectualProperty.importantInfo.software")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(nc,{className:"w-4 h-4 text-pink-500"}),e("intellectualProperty.importantInfo.designs")]}),n.jsxs("li",{className:"flex items-center gap-2",children:[n.jsx(Nt,{className:"w-4 h-4 text-green-500"}),e("intellectualProperty.importantInfo.research")]})]})]}),n.jsxs("div",{children:[n.jsxs("h4",{className:"font-semibold text-gray-800 mb-2",children:[e("intellectualProperty.importantInfo.registrationSteps"),":"]}),n.jsxs("ol",{className:"space-y-2 text-gray-600",children:[n.jsxs("li",{children:["1. ",e("intellectualProperty.importantInfo.step1")]}),n.jsxs("li",{children:["2. ",e("intellectualProperty.importantInfo.step2")]}),n.jsxs("li",{children:["3. ",e("intellectualProperty.importantInfo.step3")]}),n.jsxs("li",{children:["4. ",e("intellectualProperty.importantInfo.step4")]})]})]})]})]})]})},Y6=()=>{const[e,t]=C.useState([]),[r,a]=C.useState(!0),[s,i]=C.useState(null),{user:o}=wt(),l=async()=>{if(o)try{a(!0);const c=Me(pe,"users");let d;if(o.role==="admin")d=et(c,Fi("created_at","desc"),_s(50));else if(o.role==="school"&&o.id)d=et(c,We("school_id","==",o.id),_s(50));else if(o.role==="teacher"&&o.school_id)d=et(c,We("school_id","==",o.school_id),We("role","==","student"),_s(50));else{t([]),a(!1);return}const u=await Je(d),f=await Promise.all(u.docs.map(async h=>{const m=h.data();let x;if(m.school_id){const y=await fr(Re(pe,"schools",m.school_id));y.exists()&&(x=y.data().name)}let p=0,g=0;if(m.role==="student"){const y=Me(pe,"project_students"),b=et(y,We("student_id","==",h.id)),w=(await Je(b)).docs.map(j=>j.data().project_id);if(w.length>0){const j=Me(pe,"projects"),N=et(j,We("__name__","in",w)),_=await Je(N);p=_.size,g=_.docs.filter(E=>E.data().status==="completed").length}}else if(m.role==="teacher"){const y=Me(pe,"projects"),b=et(y,We("teacher_id","==",h.id));p=(await Je(b)).size;const w=Me(pe,"users"),j=et(w,We("role","==","student"),We("school_id","==",m.school_id)),N=await Je(j);m.studentsCount=N.size}return{id:h.id,name:m.name||"",email:m.email||"",role:m.role||"student",avatar:m.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",school:x,school_id:m.school_id,grade:m.grade,subject:m.subject,experience:m.experience_years?`${m.experience_years} سنوات`:void 0,joinedAt:m.created_at?new Date(m.created_at.toDate()).toISOString():new Date().toISOString(),lastActive:m.last_active_at?new Date(m.last_active_at.toDate()).toISOString():new Date().toISOString(),projectsCount:p,completedProjects:g,studentsCount:m.studentsCount,teachersCount:m.teachersCount,status:m.status||"active",location:m.location||"غير محدد",department:m.department,permissions:m.permissions,type:m.type,establishedYear:m.established_year,certifications:m.certifications,phone:m.phone}}));t(f)}catch(c){console.error("Error fetching users:",c),i(c instanceof Error?c.message:"حدث خطأ في تحميل المستخدمين")}finally{a(!1)}};return C.useEffect(()=>{o&&l()},[o]),{users:e,loading:r,error:s,fetchUsers:l}},Pg=[{id:"all",name:"جميع المستخدمين"},{id:"student",name:"طلاب",icon:Ts,color:"bg-blue-500"},{id:"teacher",name:"معلمين",icon:Nt,color:"bg-green-500"},{id:"school",name:"مدارس",icon:Sn,color:"bg-purple-500"},{id:"admin",name:"مديرين",icon:Ka,color:"bg-red-500"}],Fg=()=>{const{users:e,loading:t,error:r}=Y6(),[a,s]=C.useState("all"),[i,o]=C.useState(""),[l,c]=C.useState(!1),d=e.filter(x=>{const p=a==="all"||x.role===a,g=x.name.toLowerCase().includes(i.toLowerCase())||x.email.toLowerCase().includes(i.toLowerCase())||x.school&&x.school.toLowerCase().includes(i.toLowerCase());return p&&g}),u=x=>Pg.find(g=>g.id===x)||{name:x,icon:dt,color:"bg-gray-500"},f=x=>{switch(x){case"student":return"طالب";case"teacher":return"معلم";case"school":return"مدرسة";case"admin":return"مدير";default:return x}},h=x=>{switch(x){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"suspended":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},m=x=>{switch(x){case"active":return"نشط";case"inactive":return"غير نشط";case"suspended":return"موقوف";default:return x}};return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(dt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة المستخدمين"}),n.jsx("p",{className:"opacity-90",children:"إدارة ومتابعة جميع مستخدمي المنصة"})]})]}),n.jsxs("button",{className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),"إضافة مستخدم"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المستخدمين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(x=>x.role==="student").length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلاب"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(x=>x.role==="teacher").length}),n.jsx("div",{className:"text-sm opacity-80",children:"معلمين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(x=>x.status==="active").length}),n.jsx("div",{className:"text-sm opacity-80",children:"نشط"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في المستخدمين...",value:i,onChange:x=>o(x.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>c(!l),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(zo,{className:"w-5 h-5"}),"الفلاتر"]})]}),n.jsxs("div",{className:`mt-4 ${l?"block":"hidden lg:block"}`,children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"نوع المستخدم"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Pg.map(x=>n.jsxs("button",{onClick:()=>s(x.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${a===x.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[x.icon&&n.jsx(x.icon,{className:"w-4 h-4"}),x.name]},x.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",d.length," من أصل ",e.length," مستخدم"]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map((x,p)=>{const g=u(x.role);return n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:p*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 group",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:x.avatar,alt:x.name,className:"w-16 h-16 rounded-full object-cover"}),n.jsx("div",{className:`absolute -bottom-1 -right-1 w-5 h-5 ${g.color} rounded-full flex items-center justify-center`,children:n.jsx(g.icon,{className:"w-3 h-3 text-white"})})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 group-hover:text-blue-600 transition-colors",children:x.name}),n.jsx("p",{className:"text-sm text-gray-600",children:f(x.role)}),n.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium mt-1 ${h(x.status)}`,children:m(x.status)})]})]}),n.jsxs("div",{className:"relative group/menu",children:[n.jsx("button",{className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Af,{className:"w-5 h-5 text-gray-400"})}),n.jsx("div",{className:"absolute left-0 top-10 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover/menu:opacity-100 group-hover/menu:visible transition-all duration-200 z-10",children:n.jsxs("div",{className:"p-2",children:[n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(nr,{className:"w-4 h-4"}),"عرض الملف الشخصي"]}),n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ca,{className:"w-4 h-4"}),"تعديل"]}),n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-gray-700 hover:bg-gray-50 rounded-md",children:[n.jsx(Ta,{className:"w-4 h-4"}),"إرسال رسالة"]}),n.jsx("hr",{className:"my-1"}),n.jsxs("button",{className:"flex items-center gap-2 w-full text-right px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md",children:[n.jsx(sr,{className:"w-4 h-4"}),"حذف"]})]})})]})]}),n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Ta,{className:"w-4 h-4"}),n.jsx("span",{className:"truncate",children:x.email})]}),x.phone&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Pr,{className:"w-4 h-4"}),n.jsx("span",{children:x.phone})]}),x.location&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Ef,{className:"w-4 h-4"}),n.jsx("span",{children:x.location})]})]}),x.role==="student"&&n.jsxs("div",{className:"space-y-2 mb-4",children:[x.school&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Sn,{className:"w-4 h-4"}),n.jsx("span",{children:x.school})]}),x.grade&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Ts,{className:"w-4 h-4"}),n.jsx("span",{children:x.grade})]})]}),x.role==="teacher"&&n.jsxs("div",{className:"space-y-2 mb-4",children:[x.school&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Sn,{className:"w-4 h-4"}),n.jsx("span",{children:x.school})]}),x.subject&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Nt,{className:"w-4 h-4"}),n.jsx("span",{children:x.subject})]}),x.experience&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(ar,{className:"w-4 h-4"}),n.jsx("span",{children:x.experience})]})]}),x.role==="school"&&n.jsxs("div",{className:"space-y-2 mb-4",children:[x.type&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Sn,{className:"w-4 h-4"}),n.jsx("span",{children:x.type})]}),x.establishedYear&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(tt,{className:"w-4 h-4"}),n.jsxs("span",{children:["تأسست عام ",x.establishedYear]})]})]}),x.role==="admin"&&x.department&&n.jsx("div",{className:"space-y-2 mb-4",children:n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(Ka,{className:"w-4 h-4"}),n.jsx("span",{children:x.department})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[x.role==="student"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.projectsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"مشاريع"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.completedProjects||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"مكتملة"})]})]}),x.role==="teacher"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.projectsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"مشاريع"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.studentsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"طلاب"})]})]}),x.role==="school"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.studentsCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"طلاب"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-lg font-bold text-gray-800",children:x.teachersCount||0}),n.jsx("div",{className:"text-xs text-gray-500",children:"معلمين"})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[n.jsxs("div",{className:"text-xs text-gray-500",children:["انضم: ",Ze(x.joinedAt)]}),n.jsx("div",{className:"text-xs text-gray-500",children:x6(x.lastActive)})]})]},x.id)})}),d.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا يوجد مستخدمين"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم يتم العثور على مستخدمين يطابقون معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(sc,{className:"w-4 h-4"}),"إضافة مستخدم جديد"]}),n.jsx("button",{onClick:()=>{s("all"),o("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]})]})};var $j={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function r(){for(var i="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(i=s(i,a(l)))}return i}function a(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return r.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var o="";for(var l in i)t.call(i,l)&&i[l]&&(o=s(o,l));return o}function s(i,o){return o?i?i+" "+o:i+o:i}e.exports?(r.default=r,e.exports=r):window.classNames=r})()})($j);var J6=$j.exports;const pt=bt(J6);function Z6(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Rs=Z6;const Vo=bt(Rs);var Q6=typeof Bn=="object"&&Bn&&Bn.Object===Object&&Bn,Lj=Q6,eE=Lj,tE=typeof self=="object"&&self&&self.Object===Object&&self,rE=eE||tE||Function("return this")(),Pn=rE,aE=Pn,nE=aE.Symbol,fd=nE,Ig=fd,Bj=Object.prototype,sE=Bj.hasOwnProperty,iE=Bj.toString,ul=Ig?Ig.toStringTag:void 0;function oE(e){var t=sE.call(e,ul),r=e[ul];try{e[ul]=void 0;var a=!0}catch{}var s=iE.call(e);return a&&(t?e[ul]=r:delete e[ul]),s}var lE=oE,cE=Object.prototype,dE=cE.toString;function uE(e){return dE.call(e)}var fE=uE,Dg=fd,hE=lE,mE=fE,xE="[object Null]",pE="[object Undefined]",Rg=Dg?Dg.toStringTag:void 0;function gE(e){return e==null?e===void 0?pE:xE:Rg&&Rg in Object(e)?hE(e):mE(e)}var ss=gE,vE=ss,yE=Rs,bE="[object AsyncFunction]",wE="[object Function]",jE="[object GeneratorFunction]",NE="[object Proxy]";function _E(e){if(!yE(e))return!1;var t=vE(e);return t==wE||t==jE||t==bE||t==NE}var Ax=_E;const De=bt(Ax);var SE=Array.isArray,da=SE;const hr=bt(da);function kE(e){return e!=null&&typeof e=="object"}var is=kE,EE=ss,AE=da,TE=is,CE="[object String]";function OE(e){return typeof e=="string"||!AE(e)&&TE(e)&&EE(e)==CE}var PE=OE;const hd=bt(PE);var FE=ss,IE=is,DE="[object Symbol]";function RE(e){return typeof e=="symbol"||IE(e)&&FE(e)==DE}var Go=RE,ME=da,$E=Go,LE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,BE=/^\w*$/;function UE(e,t){if(ME(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||$E(e)?!0:BE.test(e)||!LE.test(e)||t!=null&&e in Object(t)}var Tx=UE,WE=Pn,HE=WE["__core-js_shared__"],zE=HE,M0=zE,Mg=function(){var e=/[^.]+$/.exec(M0&&M0.keys&&M0.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function VE(e){return!!Mg&&Mg in e}var GE=VE,qE=Function.prototype,KE=qE.toString;function XE(e){if(e!=null){try{return KE.call(e)}catch{}try{return e+""}catch{}}return""}var Uj=XE,YE=Ax,JE=GE,ZE=Rs,QE=Uj,e5=/[\\^$.*+?()[\]{}|]/g,t5=/^\[object .+?Constructor\]$/,r5=Function.prototype,a5=Object.prototype,n5=r5.toString,s5=a5.hasOwnProperty,i5=RegExp("^"+n5.call(s5).replace(e5,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function o5(e){if(!ZE(e)||JE(e))return!1;var t=YE(e)?i5:t5;return t.test(QE(e))}var l5=o5;function c5(e,t){return e==null?void 0:e[t]}var d5=c5,u5=l5,f5=d5;function h5(e,t){var r=f5(e,t);return u5(r)?r:void 0}var Di=h5,m5=Di,x5=m5(Object,"create"),Ff=x5,$g=Ff;function p5(){this.__data__=$g?$g(null):{},this.size=0}var g5=p5;function v5(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var y5=v5,b5=Ff,w5="__lodash_hash_undefined__",j5=Object.prototype,N5=j5.hasOwnProperty;function _5(e){var t=this.__data__;if(b5){var r=t[e];return r===w5?void 0:r}return N5.call(t,e)?t[e]:void 0}var S5=_5,k5=Ff,E5=Object.prototype,A5=E5.hasOwnProperty;function T5(e){var t=this.__data__;return k5?t[e]!==void 0:A5.call(t,e)}var C5=T5,O5=Ff,P5="__lodash_hash_undefined__";function F5(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=O5&&t===void 0?P5:t,this}var I5=F5,D5=g5,R5=y5,M5=S5,$5=C5,L5=I5;function qo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}qo.prototype.clear=D5;qo.prototype.delete=R5;qo.prototype.get=M5;qo.prototype.has=$5;qo.prototype.set=L5;var B5=qo;function U5(){this.__data__=[],this.size=0}var W5=U5;function H5(e,t){return e===t||e!==e&&t!==t}var Cx=H5,z5=Cx;function V5(e,t){for(var r=e.length;r--;)if(z5(e[r][0],t))return r;return-1}var If=V5,G5=If,q5=Array.prototype,K5=q5.splice;function X5(e){var t=this.__data__,r=G5(t,e);if(r<0)return!1;var a=t.length-1;return r==a?t.pop():K5.call(t,r,1),--this.size,!0}var Y5=X5,J5=If;function Z5(e){var t=this.__data__,r=J5(t,e);return r<0?void 0:t[r][1]}var Q5=Z5,eA=If;function tA(e){return eA(this.__data__,e)>-1}var rA=tA,aA=If;function nA(e,t){var r=this.__data__,a=aA(r,e);return a<0?(++this.size,r.push([e,t])):r[a][1]=t,this}var sA=nA,iA=W5,oA=Y5,lA=Q5,cA=rA,dA=sA;function Ko(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}Ko.prototype.clear=iA;Ko.prototype.delete=oA;Ko.prototype.get=lA;Ko.prototype.has=cA;Ko.prototype.set=dA;var Df=Ko,uA=Di,fA=Pn,hA=uA(fA,"Map"),Ox=hA,Lg=B5,mA=Df,xA=Ox;function pA(){this.size=0,this.__data__={hash:new Lg,map:new(xA||mA),string:new Lg}}var gA=pA;function vA(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var yA=vA,bA=yA;function wA(e,t){var r=e.__data__;return bA(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Rf=wA,jA=Rf;function NA(e){var t=jA(this,e).delete(e);return this.size-=t?1:0,t}var _A=NA,SA=Rf;function kA(e){return SA(this,e).get(e)}var EA=kA,AA=Rf;function TA(e){return AA(this,e).has(e)}var CA=TA,OA=Rf;function PA(e,t){var r=OA(this,e),a=r.size;return r.set(e,t),this.size+=r.size==a?0:1,this}var FA=PA,IA=gA,DA=_A,RA=EA,MA=CA,$A=FA;function Xo(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var a=e[t];this.set(a[0],a[1])}}Xo.prototype.clear=IA;Xo.prototype.delete=DA;Xo.prototype.get=RA;Xo.prototype.has=MA;Xo.prototype.set=$A;var Px=Xo,Wj=Px,LA="Expected a function";function Fx(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(LA);var r=function(){var a=arguments,s=t?t.apply(this,a):a[0],i=r.cache;if(i.has(s))return i.get(s);var o=e.apply(this,a);return r.cache=i.set(s,o)||i,o};return r.cache=new(Fx.Cache||Wj),r}Fx.Cache=Wj;var BA=Fx,UA=BA,WA=500;function HA(e){var t=UA(e,function(a){return r.size===WA&&r.clear(),a}),r=t.cache;return t}var zA=HA,VA=zA,GA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,qA=/\\(\\)?/g,KA=VA(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(GA,function(r,a,s,i){t.push(s?i.replace(qA,"$1"):a||r)}),t}),XA=KA;function YA(e,t){for(var r=-1,a=e==null?0:e.length,s=Array(a);++r<a;)s[r]=t(e[r],r,e);return s}var Ix=YA,Bg=fd,JA=Ix,ZA=da,QA=Go,Ug=Bg?Bg.prototype:void 0,Wg=Ug?Ug.toString:void 0;function Hj(e){if(typeof e=="string")return e;if(ZA(e))return JA(e,Hj)+"";if(QA(e))return Wg?Wg.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var eT=Hj,tT=eT;function rT(e){return e==null?"":tT(e)}var zj=rT,aT=da,nT=Tx,sT=XA,iT=zj;function oT(e,t){return aT(e)?e:nT(e,t)?[e]:sT(iT(e))}var Vj=oT,lT=Go;function cT(e){if(typeof e=="string"||lT(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var Mf=cT,dT=Vj,uT=Mf;function fT(e,t){t=dT(t,e);for(var r=0,a=t.length;e!=null&&r<a;)e=e[uT(t[r++])];return r&&r==a?e:void 0}var Dx=fT,hT=Dx;function mT(e,t,r){var a=e==null?void 0:hT(e,t);return a===void 0?r:a}var Gj=mT;const Ar=bt(Gj);function xT(e){return e==null}var pT=xT;const Pe=bt(pT);var qj={exports:{}},At={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fr=typeof Symbol=="function"&&Symbol.for,Rx=Fr?Symbol.for("react.element"):60103,Mx=Fr?Symbol.for("react.portal"):60106,$f=Fr?Symbol.for("react.fragment"):60107,Lf=Fr?Symbol.for("react.strict_mode"):60108,Bf=Fr?Symbol.for("react.profiler"):60114,Uf=Fr?Symbol.for("react.provider"):60109,Wf=Fr?Symbol.for("react.context"):60110,$x=Fr?Symbol.for("react.async_mode"):60111,Hf=Fr?Symbol.for("react.concurrent_mode"):60111,zf=Fr?Symbol.for("react.forward_ref"):60112,Vf=Fr?Symbol.for("react.suspense"):60113,gT=Fr?Symbol.for("react.suspense_list"):60120,Gf=Fr?Symbol.for("react.memo"):60115,qf=Fr?Symbol.for("react.lazy"):60116,vT=Fr?Symbol.for("react.block"):60121,yT=Fr?Symbol.for("react.fundamental"):60117,bT=Fr?Symbol.for("react.responder"):60118,wT=Fr?Symbol.for("react.scope"):60119;function Pa(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Rx:switch(e=e.type,e){case $x:case Hf:case $f:case Bf:case Lf:case Vf:return e;default:switch(e=e&&e.$$typeof,e){case Wf:case zf:case qf:case Gf:case Uf:return e;default:return t}}case Mx:return t}}}function Kj(e){return Pa(e)===Hf}At.AsyncMode=$x;At.ConcurrentMode=Hf;At.ContextConsumer=Wf;At.ContextProvider=Uf;At.Element=Rx;At.ForwardRef=zf;At.Fragment=$f;At.Lazy=qf;At.Memo=Gf;At.Portal=Mx;At.Profiler=Bf;At.StrictMode=Lf;At.Suspense=Vf;At.isAsyncMode=function(e){return Kj(e)||Pa(e)===$x};At.isConcurrentMode=Kj;At.isContextConsumer=function(e){return Pa(e)===Wf};At.isContextProvider=function(e){return Pa(e)===Uf};At.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Rx};At.isForwardRef=function(e){return Pa(e)===zf};At.isFragment=function(e){return Pa(e)===$f};At.isLazy=function(e){return Pa(e)===qf};At.isMemo=function(e){return Pa(e)===Gf};At.isPortal=function(e){return Pa(e)===Mx};At.isProfiler=function(e){return Pa(e)===Bf};At.isStrictMode=function(e){return Pa(e)===Lf};At.isSuspense=function(e){return Pa(e)===Vf};At.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===$f||e===Hf||e===Bf||e===Lf||e===Vf||e===gT||typeof e=="object"&&e!==null&&(e.$$typeof===qf||e.$$typeof===Gf||e.$$typeof===Uf||e.$$typeof===Wf||e.$$typeof===zf||e.$$typeof===yT||e.$$typeof===bT||e.$$typeof===wT||e.$$typeof===vT)};At.typeOf=Pa;qj.exports=At;var jT=qj.exports,NT=ss,_T=is,ST="[object Number]";function kT(e){return typeof e=="number"||_T(e)&&NT(e)==ST}var Xj=kT;const ET=bt(Xj);var AT=Xj;function TT(e){return AT(e)&&e!=+e}var CT=TT;const Yo=bt(CT);var ia=function(t){return t===0?0:t>0?1:-1},ai=function(t){return hd(t)&&t.indexOf("%")===t.length-1},be=function(t){return ET(t)&&!Yo(t)},br=function(t){return be(t)||hd(t)},OT=0,Ri=function(t){var r=++OT;return"".concat(t||"").concat(r)},ma=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!be(t)&&!hd(t))return a;var i;if(ai(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return Yo(i)&&(i=a),s&&i>r&&(i=r),i},xs=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},PT=function(t){if(!hr(t))return!1;for(var r=t.length,a={},s=0;s<r;s++)if(!a[t[s]])a[t[s]]=!0;else return!0;return!1},gr=function(t,r){return be(t)&&be(r)?function(a){return t+a*(r-t)}:function(){return r}};function uu(e,t,r){return!e||!e.length?null:e.find(function(a){return a&&(typeof t=="function"?t(a):Ar(a,t))===r})}function uo(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function Rh(e){"@babel/helpers - typeof";return Rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rh(e)}var FT=["viewBox","children"],IT=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Hg=["points","pathLength"],$0={svg:FT,polygon:Hg,polyline:Hg},Lx=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],fu=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(C.isValidElement(t)&&(a=t.props),!Vo(a))return null;var s={};return Object.keys(a).forEach(function(i){Lx.includes(i)&&(s[i]=r||function(o){return a[i](a,o)})}),s},DT=function(t,r,a){return function(s){return t(r,a,s),null}},ji=function(t,r,a){if(!Vo(t)||Rh(t)!=="object")return null;var s=null;return Object.keys(t).forEach(function(i){var o=t[i];Lx.includes(i)&&typeof o=="function"&&(s||(s={}),s[i]=DT(o,r,a))}),s},RT=["children"],MT=["children"];function zg(e,t){if(e==null)return{};var r=$T(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function $T(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Mh(e){"@babel/helpers - typeof";return Mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mh(e)}var Vg={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart"},ks=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Gg=null,L0=null,Bx=function e(t){if(t===Gg&&hr(L0))return L0;var r=[];return C.Children.forEach(t,function(a){Pe(a)||(jT.isFragment(a)?r=r.concat(e(a.props.children)):r.push(a))}),L0=r,Gg=t,r};function Ea(e,t){var r=[],a=[];return hr(t)?a=t.map(function(s){return ks(s)}):a=[ks(t)],Bx(e).forEach(function(s){var i=Ar(s,"type.displayName")||Ar(s,"type.name");a.indexOf(i)!==-1&&r.push(s)}),r}function Un(e,t){var r=Ea(e,t);return r&&r[0]}var qg=function(t){if(!t||!t.props)return!1;var r=t.props,a=r.width,s=r.height;return!(!be(a)||a<=0||!be(s)||s<=0)},LT=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],BT=function(t){return t&&t.type&&hd(t.type)&&LT.indexOf(t.type)>=0},Yj=function(t){return t&&Mh(t)==="object"&&"cx"in t&&"cy"in t&&"r"in t},UT=function(t,r,a,s){var i,o=(i=$0==null?void 0:$0[s])!==null&&i!==void 0?i:[];return!De(t)&&(s&&o.includes(r)||IT.includes(r))||a&&Lx.includes(r)},Fe=function(t,r,a){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(C.isValidElement(t)&&(s=t.props),!Vo(s))return null;var i={};return Object.keys(s).forEach(function(o){var l;UT((l=s)===null||l===void 0?void 0:l[o],o,r,a)&&(i[o]=s[o])}),i},Jj=function e(t,r){if(t===r)return!0;var a=C.Children.count(t);if(a!==C.Children.count(r))return!1;if(a===0)return!0;if(a===1)return Kg(hr(t)?t[0]:t,hr(r)?r[0]:r);for(var s=0;s<a;s++){var i=t[s],o=r[s];if(hr(i)||hr(o)){if(!e(i,o))return!1}else if(!Kg(i,o))return!1}return!0},Kg=function(t,r){if(Pe(t)&&Pe(r))return!0;if(!Pe(t)&&!Pe(r)){var a=t.props||{},s=a.children,i=zg(a,RT),o=r.props||{},l=o.children,c=zg(o,MT);return s&&l?uo(i,c)&&Jj(s,l):!s&&!l?uo(i,c):!1}return!1},Xg=function(t,r){var a=[],s={};return Bx(t).forEach(function(i,o){if(BT(i))a.push(i);else if(i){var l=ks(i.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!s[l])){var f=d(i,l,o);a.push(f),s[l]=!0}}}),a},WT=function(t){var r=t&&t.type;return r&&Vg[r]?Vg[r]:null},HT=function(t,r){return Bx(r).indexOf(t)},zT=["children","width","height","viewBox","className","style"];function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},$h.apply(this,arguments)}function VT(e,t){if(e==null)return{};var r=GT(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function GT(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Lh(e){var t=e.children,r=e.width,a=e.height,s=e.viewBox,i=e.className,o=e.style,l=VT(e,zT),c=s||{width:r,height:a,x:0,y:0},d=pt("recharts-surface",i);return Q.createElement("svg",$h({},Fe(l,!0,"svg"),{className:d,width:r,height:a,style:o,viewBox:"".concat(c.x," ").concat(c.y," ").concat(c.width," ").concat(c.height)}),Q.createElement("title",null,e.title),Q.createElement("desc",null,e.desc),t)}var qT=["children","className"];function Bh(){return Bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Bh.apply(this,arguments)}function KT(e,t){if(e==null)return{};var r=XT(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function XT(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var ot=Q.forwardRef(function(e,t){var r=e.children,a=e.className,s=KT(e,qT),i=pt("recharts-layer",a);return Q.createElement("g",Bh({className:i},Fe(s,!0),{ref:t}),r)}),YT=Df;function JT(){this.__data__=new YT,this.size=0}var ZT=JT;function QT(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var eC=QT;function tC(e){return this.__data__.get(e)}var rC=tC;function aC(e){return this.__data__.has(e)}var nC=aC,sC=Df,iC=Ox,oC=Px,lC=200;function cC(e,t){var r=this.__data__;if(r instanceof sC){var a=r.__data__;if(!iC||a.length<lC-1)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new oC(a)}return r.set(e,t),this.size=r.size,this}var dC=cC,uC=Df,fC=ZT,hC=eC,mC=rC,xC=nC,pC=dC;function Jo(e){var t=this.__data__=new uC(e);this.size=t.size}Jo.prototype.clear=fC;Jo.prototype.delete=hC;Jo.prototype.get=mC;Jo.prototype.has=xC;Jo.prototype.set=pC;var Zj=Jo,gC="__lodash_hash_undefined__";function vC(e){return this.__data__.set(e,gC),this}var yC=vC;function bC(e){return this.__data__.has(e)}var wC=bC,jC=Px,NC=yC,_C=wC;function hu(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new jC;++t<r;)this.add(e[t])}hu.prototype.add=hu.prototype.push=NC;hu.prototype.has=_C;var Qj=hu;function SC(e,t){for(var r=-1,a=e==null?0:e.length;++r<a;)if(t(e[r],r,e))return!0;return!1}var e2=SC;function kC(e,t){return e.has(t)}var t2=kC,EC=Qj,AC=e2,TC=t2,CC=1,OC=2;function PC(e,t,r,a,s,i){var o=r&CC,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(e),u=i.get(t);if(d&&u)return d==t&&u==e;var f=-1,h=!0,m=r&OC?new EC:void 0;for(i.set(e,t),i.set(t,e);++f<l;){var x=e[f],p=t[f];if(a)var g=o?a(p,x,f,t,e,i):a(x,p,f,e,t,i);if(g!==void 0){if(g)continue;h=!1;break}if(m){if(!AC(t,function(y,b){if(!TC(m,b)&&(x===y||s(x,y,r,a,i)))return m.push(b)})){h=!1;break}}else if(!(x===p||s(x,p,r,a,i))){h=!1;break}}return i.delete(e),i.delete(t),h}var r2=PC,FC=Pn,IC=FC.Uint8Array,DC=IC;function RC(e){var t=-1,r=Array(e.size);return e.forEach(function(a,s){r[++t]=[s,a]}),r}var MC=RC;function $C(e){var t=-1,r=Array(e.size);return e.forEach(function(a){r[++t]=a}),r}var Ux=$C,Yg=fd,Jg=DC,LC=Cx,BC=r2,UC=MC,WC=Ux,HC=1,zC=2,VC="[object Boolean]",GC="[object Date]",qC="[object Error]",KC="[object Map]",XC="[object Number]",YC="[object RegExp]",JC="[object Set]",ZC="[object String]",QC="[object Symbol]",eO="[object ArrayBuffer]",tO="[object DataView]",Zg=Yg?Yg.prototype:void 0,B0=Zg?Zg.valueOf:void 0;function rO(e,t,r,a,s,i,o){switch(r){case tO:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case eO:return!(e.byteLength!=t.byteLength||!i(new Jg(e),new Jg(t)));case VC:case GC:case XC:return LC(+e,+t);case qC:return e.name==t.name&&e.message==t.message;case YC:case ZC:return e==t+"";case KC:var l=UC;case JC:var c=a&HC;if(l||(l=WC),e.size!=t.size&&!c)return!1;var d=o.get(e);if(d)return d==t;a|=zC,o.set(e,t);var u=BC(l(e),l(t),a,s,i,o);return o.delete(e),u;case QC:if(B0)return B0.call(e)==B0.call(t)}return!1}var aO=rO;function nO(e,t){for(var r=-1,a=t.length,s=e.length;++r<a;)e[s+r]=t[r];return e}var a2=nO,sO=a2,iO=da;function oO(e,t,r){var a=t(e);return iO(e)?a:sO(a,r(e))}var lO=oO;function cO(e,t){for(var r=-1,a=e==null?0:e.length,s=0,i=[];++r<a;){var o=e[r];t(o,r,e)&&(i[s++]=o)}return i}var dO=cO;function uO(){return[]}var fO=uO,hO=dO,mO=fO,xO=Object.prototype,pO=xO.propertyIsEnumerable,Qg=Object.getOwnPropertySymbols,gO=Qg?function(e){return e==null?[]:(e=Object(e),hO(Qg(e),function(t){return pO.call(e,t)}))}:mO,vO=gO;function yO(e,t){for(var r=-1,a=Array(e);++r<e;)a[r]=t(r);return a}var bO=yO,wO=ss,jO=is,NO="[object Arguments]";function _O(e){return jO(e)&&wO(e)==NO}var SO=_O,ev=SO,kO=is,n2=Object.prototype,EO=n2.hasOwnProperty,AO=n2.propertyIsEnumerable,TO=ev(function(){return arguments}())?ev:function(e){return kO(e)&&EO.call(e,"callee")&&!AO.call(e,"callee")},Wx=TO,mu={exports:{}};function CO(){return!1}var OO=CO;mu.exports;(function(e,t){var r=Pn,a=OO,s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===s,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||a;e.exports=d})(mu,mu.exports);var s2=mu.exports,PO=9007199254740991,FO=/^(?:0|[1-9]\d*)$/;function IO(e,t){var r=typeof e;return t=t??PO,!!t&&(r=="number"||r!="symbol"&&FO.test(e))&&e>-1&&e%1==0&&e<t}var Hx=IO,DO=9007199254740991;function RO(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=DO}var zx=RO,MO=ss,$O=zx,LO=is,BO="[object Arguments]",UO="[object Array]",WO="[object Boolean]",HO="[object Date]",zO="[object Error]",VO="[object Function]",GO="[object Map]",qO="[object Number]",KO="[object Object]",XO="[object RegExp]",YO="[object Set]",JO="[object String]",ZO="[object WeakMap]",QO="[object ArrayBuffer]",eP="[object DataView]",tP="[object Float32Array]",rP="[object Float64Array]",aP="[object Int8Array]",nP="[object Int16Array]",sP="[object Int32Array]",iP="[object Uint8Array]",oP="[object Uint8ClampedArray]",lP="[object Uint16Array]",cP="[object Uint32Array]",Rt={};Rt[tP]=Rt[rP]=Rt[aP]=Rt[nP]=Rt[sP]=Rt[iP]=Rt[oP]=Rt[lP]=Rt[cP]=!0;Rt[BO]=Rt[UO]=Rt[QO]=Rt[WO]=Rt[eP]=Rt[HO]=Rt[zO]=Rt[VO]=Rt[GO]=Rt[qO]=Rt[KO]=Rt[XO]=Rt[YO]=Rt[JO]=Rt[ZO]=!1;function dP(e){return LO(e)&&$O(e.length)&&!!Rt[MO(e)]}var uP=dP;function fP(e){return function(t){return e(t)}}var i2=fP,xu={exports:{}};xu.exports;(function(e,t){var r=Lj,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,o=i&&r.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(xu,xu.exports);var hP=xu.exports,mP=uP,xP=i2,tv=hP,rv=tv&&tv.isTypedArray,pP=rv?xP(rv):mP,o2=pP,gP=bO,vP=Wx,yP=da,bP=s2,wP=Hx,jP=o2,NP=Object.prototype,_P=NP.hasOwnProperty;function SP(e,t){var r=yP(e),a=!r&&vP(e),s=!r&&!a&&bP(e),i=!r&&!a&&!s&&jP(e),o=r||a||s||i,l=o?gP(e.length,String):[],c=l.length;for(var d in e)(t||_P.call(e,d))&&!(o&&(d=="length"||s&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||wP(d,c)))&&l.push(d);return l}var kP=SP,EP=Object.prototype;function AP(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||EP;return e===r}var TP=AP;function CP(e,t){return function(r){return e(t(r))}}var l2=CP,OP=l2,PP=OP(Object.keys,Object),FP=PP,IP=TP,DP=FP,RP=Object.prototype,MP=RP.hasOwnProperty;function $P(e){if(!IP(e))return DP(e);var t=[];for(var r in Object(e))MP.call(e,r)&&r!="constructor"&&t.push(r);return t}var LP=$P,BP=Ax,UP=zx;function WP(e){return e!=null&&UP(e.length)&&!BP(e)}var md=WP,HP=kP,zP=LP,VP=md;function GP(e){return VP(e)?HP(e):zP(e)}var Kf=GP,qP=lO,KP=vO,XP=Kf;function YP(e){return qP(e,XP,KP)}var JP=YP,av=JP,ZP=1,QP=Object.prototype,e8=QP.hasOwnProperty;function t8(e,t,r,a,s,i){var o=r&ZP,l=av(e),c=l.length,d=av(t),u=d.length;if(c!=u&&!o)return!1;for(var f=c;f--;){var h=l[f];if(!(o?h in t:e8.call(t,h)))return!1}var m=i.get(e),x=i.get(t);if(m&&x)return m==t&&x==e;var p=!0;i.set(e,t),i.set(t,e);for(var g=o;++f<c;){h=l[f];var y=e[h],b=t[h];if(a)var v=o?a(b,y,h,t,e,i):a(y,b,h,e,t,i);if(!(v===void 0?y===b||s(y,b,r,a,i):v)){p=!1;break}g||(g=h=="constructor")}if(p&&!g){var w=e.constructor,j=t.constructor;w!=j&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof j=="function"&&j instanceof j)&&(p=!1)}return i.delete(e),i.delete(t),p}var r8=t8,a8=Di,n8=Pn,s8=a8(n8,"DataView"),i8=s8,o8=Di,l8=Pn,c8=o8(l8,"Promise"),d8=c8,u8=Di,f8=Pn,h8=u8(f8,"Set"),c2=h8,m8=Di,x8=Pn,p8=m8(x8,"WeakMap"),g8=p8,Uh=i8,Wh=Ox,Hh=d8,zh=c2,Vh=g8,d2=ss,Zo=Uj,nv="[object Map]",v8="[object Object]",sv="[object Promise]",iv="[object Set]",ov="[object WeakMap]",lv="[object DataView]",y8=Zo(Uh),b8=Zo(Wh),w8=Zo(Hh),j8=Zo(zh),N8=Zo(Vh),Ks=d2;(Uh&&Ks(new Uh(new ArrayBuffer(1)))!=lv||Wh&&Ks(new Wh)!=nv||Hh&&Ks(Hh.resolve())!=sv||zh&&Ks(new zh)!=iv||Vh&&Ks(new Vh)!=ov)&&(Ks=function(e){var t=d2(e),r=t==v8?e.constructor:void 0,a=r?Zo(r):"";if(a)switch(a){case y8:return lv;case b8:return nv;case w8:return sv;case j8:return iv;case N8:return ov}return t});var _8=Ks,U0=Zj,S8=r2,k8=aO,E8=r8,cv=_8,dv=da,uv=s2,A8=o2,T8=1,fv="[object Arguments]",hv="[object Array]",Dd="[object Object]",C8=Object.prototype,mv=C8.hasOwnProperty;function O8(e,t,r,a,s,i){var o=dv(e),l=dv(t),c=o?hv:cv(e),d=l?hv:cv(t);c=c==fv?Dd:c,d=d==fv?Dd:d;var u=c==Dd,f=d==Dd,h=c==d;if(h&&uv(e)){if(!uv(t))return!1;o=!0,u=!1}if(h&&!u)return i||(i=new U0),o||A8(e)?S8(e,t,r,a,s,i):k8(e,t,c,r,a,s,i);if(!(r&T8)){var m=u&&mv.call(e,"__wrapped__"),x=f&&mv.call(t,"__wrapped__");if(m||x){var p=m?e.value():e,g=x?t.value():t;return i||(i=new U0),s(p,g,r,a,i)}}return h?(i||(i=new U0),E8(e,t,r,a,s,i)):!1}var P8=O8,F8=P8,xv=is;function u2(e,t,r,a,s){return e===t?!0:e==null||t==null||!xv(e)&&!xv(t)?e!==e&&t!==t:F8(e,t,r,a,u2,s)}var Vx=u2,I8=Zj,D8=Vx,R8=1,M8=2;function $8(e,t,r,a){var s=r.length,i=s,o=!a;if(e==null)return!i;for(e=Object(e);s--;){var l=r[s];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<i;){l=r[s];var c=l[0],d=e[c],u=l[1];if(o&&l[2]){if(d===void 0&&!(c in e))return!1}else{var f=new I8;if(a)var h=a(d,u,c,e,t,f);if(!(h===void 0?D8(u,d,R8|M8,a,f):h))return!1}}return!0}var L8=$8,B8=Rs;function U8(e){return e===e&&!B8(e)}var f2=U8,W8=f2,H8=Kf;function z8(e){for(var t=H8(e),r=t.length;r--;){var a=t[r],s=e[a];t[r]=[a,s,W8(s)]}return t}var V8=z8;function G8(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var h2=G8,q8=L8,K8=V8,X8=h2;function Y8(e){var t=K8(e);return t.length==1&&t[0][2]?X8(t[0][0],t[0][1]):function(r){return r===e||q8(r,e,t)}}var J8=Y8;function Z8(e,t){return e!=null&&t in Object(e)}var Q8=Z8,eF=Vj,tF=Wx,rF=da,aF=Hx,nF=zx,sF=Mf;function iF(e,t,r){t=eF(t,e);for(var a=-1,s=t.length,i=!1;++a<s;){var o=sF(t[a]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++a!=s?i:(s=e==null?0:e.length,!!s&&nF(s)&&aF(o,s)&&(rF(e)||tF(e)))}var oF=iF,lF=Q8,cF=oF;function dF(e,t){return e!=null&&cF(e,t,lF)}var uF=dF,fF=Vx,hF=Gj,mF=uF,xF=Tx,pF=f2,gF=h2,vF=Mf,yF=1,bF=2;function wF(e,t){return xF(e)&&pF(t)?gF(vF(e),t):function(r){var a=hF(r,e);return a===void 0&&a===t?mF(r,e):fF(t,a,yF|bF)}}var jF=wF;function NF(e){return e}var Qo=NF;function _F(e){return function(t){return t==null?void 0:t[e]}}var SF=_F,kF=Dx;function EF(e){return function(t){return kF(t,e)}}var AF=EF,TF=SF,CF=AF,OF=Tx,PF=Mf;function FF(e){return OF(e)?TF(PF(e)):CF(e)}var IF=FF,DF=J8,RF=jF,MF=Qo,$F=da,LF=IF;function BF(e){return typeof e=="function"?e:e==null?MF:typeof e=="object"?$F(e)?RF(e[0],e[1]):DF(e):LF(e)}var Fn=BF;function UF(e,t,r,a){for(var s=e.length,i=r+(a?1:-1);a?i--:++i<s;)if(t(e[i],i,e))return i;return-1}var m2=UF;function WF(e){return e!==e}var HF=WF;function zF(e,t,r){for(var a=r-1,s=e.length;++a<s;)if(e[a]===t)return a;return-1}var VF=zF,GF=m2,qF=HF,KF=VF;function XF(e,t,r){return t===t?KF(e,t,r):GF(e,qF,r)}var YF=XF,JF=YF;function ZF(e,t){var r=e==null?0:e.length;return!!r&&JF(e,t,0)>-1}var QF=ZF;function eI(e,t,r){for(var a=-1,s=e==null?0:e.length;++a<s;)if(r(t,e[a]))return!0;return!1}var tI=eI;function rI(){}var aI=rI,W0=c2,nI=aI,sI=Ux,iI=1/0,oI=W0&&1/sI(new W0([,-0]))[1]==iI?function(e){return new W0(e)}:nI,lI=oI,cI=Qj,dI=QF,uI=tI,fI=t2,hI=lI,mI=Ux,xI=200;function pI(e,t,r){var a=-1,s=dI,i=e.length,o=!0,l=[],c=l;if(r)o=!1,s=uI;else if(i>=xI){var d=t?null:hI(e);if(d)return mI(d);o=!1,s=fI,c=new cI}else c=t?[]:l;e:for(;++a<i;){var u=e[a],f=t?t(u):u;if(u=r||u!==0?u:0,o&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(u)}else s(c,f,r)||(c!==l&&c.push(f),l.push(u))}return l}var gI=pI,vI=Fn,yI=gI;function bI(e,t){return e&&e.length?yI(e,vI(t)):[]}var wI=bI;const pu=bt(wI);var qn=function(t,r){for(var a=arguments.length,s=new Array(a>2?a-2:0),i=2;i<a;i++)s[i-2]=arguments[i]};function jI(e,t,r){var a=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(s);++a<s;)i[a]=e[a+t];return i}var NI=jI,_I=NI;function SI(e,t,r){var a=e.length;return r=r===void 0?a:r,!t&&r>=a?e:_I(e,t,r)}var kI=SI,EI="\\ud800-\\udfff",AI="\\u0300-\\u036f",TI="\\ufe20-\\ufe2f",CI="\\u20d0-\\u20ff",OI=AI+TI+CI,PI="\\ufe0e\\ufe0f",FI="\\u200d",II=RegExp("["+FI+EI+OI+PI+"]");function DI(e){return II.test(e)}var x2=DI;function RI(e){return e.split("")}var MI=RI,p2="\\ud800-\\udfff",$I="\\u0300-\\u036f",LI="\\ufe20-\\ufe2f",BI="\\u20d0-\\u20ff",UI=$I+LI+BI,WI="\\ufe0e\\ufe0f",HI="["+p2+"]",Gh="["+UI+"]",qh="\\ud83c[\\udffb-\\udfff]",zI="(?:"+Gh+"|"+qh+")",g2="[^"+p2+"]",v2="(?:\\ud83c[\\udde6-\\uddff]){2}",y2="[\\ud800-\\udbff][\\udc00-\\udfff]",VI="\\u200d",b2=zI+"?",w2="["+WI+"]?",GI="(?:"+VI+"(?:"+[g2,v2,y2].join("|")+")"+w2+b2+")*",qI=w2+b2+GI,KI="(?:"+[g2+Gh+"?",Gh,v2,y2,HI].join("|")+")",XI=RegExp(qh+"(?="+qh+")|"+KI+qI,"g");function YI(e){return e.match(XI)||[]}var JI=YI,ZI=MI,QI=x2,eD=JI;function tD(e){return QI(e)?eD(e):ZI(e)}var rD=tD,aD=kI,nD=x2,sD=rD,iD=zj;function oD(e){return function(t){t=iD(t);var r=nD(t)?sD(t):void 0,a=r?r[0]:t.charAt(0),s=r?aD(r,1).join(""):t.slice(1);return a[e]()+s}}var lD=oD,cD=lD,dD=cD("toUpperCase"),uD=dD;const Xf=bt(uD);function It(e){return function(){return e}}const j2=Math.cos,gu=Math.sin,fn=Math.sqrt,vu=Math.PI,Yf=2*vu,Kh=Math.PI,Xh=2*Kh,Xs=1e-6,fD=Xh-Xs;function N2(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function hD(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return N2;const r=10**t;return function(a){this._+=a[0];for(let s=1,i=a.length;s<i;++s)this._+=Math.round(arguments[s]*r)/r+a[s]}}class mD{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?N2:hD(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,s){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+s}`}bezierCurveTo(t,r,a,s,i,o){this._append`C${+t},${+r},${+a},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,a,s,i){if(t=+t,r=+r,a=+a,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=a-t,d=s-r,u=o-t,f=l-r,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Xs)if(!(Math.abs(f*c-d*u)>Xs)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=a-o,x=s-l,p=c*c+d*d,g=m*m+x*x,y=Math.sqrt(p),b=Math.sqrt(h),v=i*Math.tan((Kh-Math.acos((p+h-g)/(2*y*b)))/2),w=v/b,j=v/y;Math.abs(w-1)>Xs&&this._append`L${t+w*u},${r+w*f}`,this._append`A${i},${i},0,0,${+(f*m>u*x)},${this._x1=t+j*c},${this._y1=r+j*d}`}}arc(t,r,a,s,i,o){if(t=+t,r=+r,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let l=a*Math.cos(s),c=a*Math.sin(s),d=t+l,u=r+c,f=1^o,h=o?s-i:i-s;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Xs||Math.abs(this._y1-u)>Xs)&&this._append`L${d},${u}`,a&&(h<0&&(h=h%Xh+Xh),h>fD?this._append`A${a},${a},0,1,${f},${t-l},${r-c}A${a},${a},0,1,${f},${this._x1=d},${this._y1=u}`:h>Xs&&this._append`A${a},${a},0,${+(h>=Kh)},${f},${this._x1=t+a*Math.cos(i)},${this._y1=r+a*Math.sin(i)}`)}rect(t,r,a,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+s}h${-a}Z`}toString(){return this._}}function Gx(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new mD(t)}function qx(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _2(e){this._context=e}_2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Jf(e){return new _2(e)}function S2(e){return e[0]}function k2(e){return e[1]}function E2(e,t){var r=It(!0),a=null,s=Jf,i=null,o=Gx(l);e=typeof e=="function"?e:e===void 0?S2:It(e),t=typeof t=="function"?t:t===void 0?k2:It(t);function l(c){var d,u=(c=qx(c)).length,f,h=!1,m;for(a==null&&(i=s(m=o())),d=0;d<=u;++d)!(d<u&&r(f=c[d],d,c))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(f,d,c),+t(f,d,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:It(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:It(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:It(!!c),l):r},l.curve=function(c){return arguments.length?(s=c,a!=null&&(i=s(a)),l):s},l.context=function(c){return arguments.length?(c==null?a=i=null:i=s(a=c),l):a},l}function Rd(e,t,r){var a=null,s=It(!0),i=null,o=Jf,l=null,c=Gx(d);e=typeof e=="function"?e:e===void 0?S2:It(+e),t=typeof t=="function"?t:It(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?k2:It(+r);function d(f){var h,m,x,p=(f=qx(f)).length,g,y=!1,b,v=new Array(p),w=new Array(p);for(i==null&&(l=o(b=c())),h=0;h<=p;++h){if(!(h<p&&s(g=f[h],h,f))===y)if(y=!y)m=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=h-1;x>=m;--x)l.point(v[x],w[x]);l.lineEnd(),l.areaEnd()}y&&(v[h]=+e(g,h,f),w[h]=+t(g,h,f),l.point(a?+a(g,h,f):v[h],r?+r(g,h,f):w[h]))}if(b)return l=null,b+""||null}function u(){return E2().defined(s).curve(o).context(i)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:It(+f),a=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:It(+f),d):e},d.x1=function(f){return arguments.length?(a=f==null?null:typeof f=="function"?f:It(+f),d):a},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:It(+f),r=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:It(+f),d):t},d.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:It(+f),d):r},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(r)},d.lineX1=function(){return u().x(a).y(t)},d.defined=function(f){return arguments.length?(s=typeof f=="function"?f:It(!!f),d):s},d.curve=function(f){return arguments.length?(o=f,i!=null&&(l=o(i)),d):o},d.context=function(f){return arguments.length?(f==null?i=l=null:l=o(i=f),d):i},d}class A2{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function xD(e){return new A2(e,!0)}function pD(e){return new A2(e,!1)}const Kx={draw(e,t){const r=fn(t/vu);e.moveTo(r,0),e.arc(0,0,r,0,Yf)}},gD={draw(e,t){const r=fn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},T2=fn(1/3),vD=T2*2,yD={draw(e,t){const r=fn(t/vD),a=r*T2;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},bD={draw(e,t){const r=fn(t),a=-r/2;e.rect(a,a,r,r)}},wD=.8908130915292852,C2=gu(vu/10)/gu(7*vu/10),jD=gu(Yf/10)*C2,ND=-j2(Yf/10)*C2,_D={draw(e,t){const r=fn(t*wD),a=jD*r,s=ND*r;e.moveTo(0,-r),e.lineTo(a,s);for(let i=1;i<5;++i){const o=Yf*i/5,l=j2(o),c=gu(o);e.lineTo(c*r,-l*r),e.lineTo(l*a-c*s,c*a+l*s)}e.closePath()}},H0=fn(3),SD={draw(e,t){const r=-fn(t/(H0*3));e.moveTo(0,r*2),e.lineTo(-H0*r,-r),e.lineTo(H0*r,-r),e.closePath()}},Ia=-.5,Da=fn(3)/2,Yh=1/fn(12),kD=(Yh/2+1)*3,ED={draw(e,t){const r=fn(t/kD),a=r/2,s=r*Yh,i=a,o=r*Yh+r,l=-i,c=o;e.moveTo(a,s),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(Ia*a-Da*s,Da*a+Ia*s),e.lineTo(Ia*i-Da*o,Da*i+Ia*o),e.lineTo(Ia*l-Da*c,Da*l+Ia*c),e.lineTo(Ia*a+Da*s,Ia*s-Da*a),e.lineTo(Ia*i+Da*o,Ia*o-Da*i),e.lineTo(Ia*l+Da*c,Ia*c-Da*l),e.closePath()}};function AD(e,t){let r=null,a=Gx(s);e=typeof e=="function"?e:It(e||Kx),t=typeof t=="function"?t:It(t===void 0?64:+t);function s(){let i;if(r||(r=i=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return s.type=function(i){return arguments.length?(e=typeof i=="function"?i:It(i),s):e},s.size=function(i){return arguments.length?(t=typeof i=="function"?i:It(+i),s):t},s.context=function(i){return arguments.length?(r=i??null,s):r},s}function yu(){}function bu(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function O2(e){this._context=e}O2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:bu(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TD(e){return new O2(e)}function P2(e){this._context=e}P2.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CD(e){return new P2(e)}function F2(e){this._context=e}F2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:bu(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function OD(e){return new F2(e)}function I2(e){this._context=e}I2.prototype={areaStart:yu,areaEnd:yu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function PD(e){return new I2(e)}function pv(e){return e<0?-1:1}function gv(e,t,r){var a=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(a||s<0&&-0),o=(r-e._y1)/(s||a<0&&-0),l=(i*s+o*a)/(a+s);return(pv(i)+pv(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function vv(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function z0(e,t,r){var a=e._x0,s=e._y0,i=e._x1,o=e._y1,l=(i-a)/3;e._context.bezierCurveTo(a+l,s+l*t,i-l,o-l*r,i,o)}function wu(e){this._context=e}wu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:z0(this,this._t0,vv(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,z0(this,vv(this,r=gv(this,e,t)),r);break;default:z0(this,this._t0,r=gv(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function D2(e){this._context=new R2(e)}(D2.prototype=Object.create(wu.prototype)).point=function(e,t){wu.prototype.point.call(this,t,e)};function R2(e){this._context=e}R2.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,s,i){this._context.bezierCurveTo(t,e,a,r,i,s)}};function FD(e){return new wu(e)}function ID(e){return new D2(e)}function M2(e){this._context=e}M2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=yv(e),s=yv(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(a[0][i],s[0][i],a[1][i],s[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function yv(e){var t,r=e.length-1,a,s=new Array(r),i=new Array(r),o=new Array(r);for(s[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=s[t]/i[t-1],i[t]-=a,o[t]-=a*o[t-1];for(s[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)s[t]=(o[t]-s[t+1])/i[t];for(i[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function DD(e){return new M2(e)}function Zf(e,t){this._context=e,this._t=t}Zf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function RD(e){return new Zf(e,.5)}function MD(e){return new Zf(e,0)}function $D(e){return new Zf(e,1)}function yo(e,t){if((o=e.length)>1)for(var r=1,a,s,i=e[t[0]],o,l=i.length;r<o;++r)for(s=i,i=e[t[r]],a=0;a<l;++a)i[a][1]+=i[a][0]=isNaN(s[a][1])?s[a][0]:s[a][1]}function Jh(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function LD(e,t){return e[t]}function BD(e){const t=[];return t.key=e,t}function UD(){var e=It([]),t=Jh,r=yo,a=LD;function s(i){var o=Array.from(e.apply(this,arguments),BD),l,c=o.length,d=-1,u;for(const f of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+a(f,o[l].key,d,i)]).data=f;for(l=0,u=qx(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return s.keys=function(i){return arguments.length?(e=typeof i=="function"?i:It(Array.from(i)),s):e},s.value=function(i){return arguments.length?(a=typeof i=="function"?i:It(+i),s):a},s.order=function(i){return arguments.length?(t=i==null?Jh:typeof i=="function"?i:It(Array.from(i)),s):t},s.offset=function(i){return arguments.length?(r=i??yo,s):r},s}function WD(e,t){if((a=e.length)>0){for(var r,a,s=0,i=e[0].length,o;s<i;++s){for(o=r=0;r<a;++r)o+=e[r][s][1]||0;if(o)for(r=0;r<a;++r)e[r][s][1]/=o}yo(e,t)}}function HD(e,t){if((s=e.length)>0){for(var r=0,a=e[t[0]],s,i=a.length;r<i;++r){for(var o=0,l=0;o<s;++o)l+=e[o][r][1]||0;a[r][1]+=a[r][0]=-l/2}yo(e,t)}}function zD(e,t){if(!(!((o=e.length)>0)||!((i=(s=e[t[0]]).length)>0))){for(var r=0,a=1,s,i,o;a<i;++a){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],f=u[a][1]||0,h=u[a-1][1]||0,m=(f-h)/2,x=0;x<l;++x){var p=e[t[x]],g=p[a][1]||0,y=p[a-1][1]||0;m+=g-y}c+=f,d+=m*f}s[a-1][1]+=s[a-1][0]=r,c&&(r-=d/c)}s[a-1][1]+=s[a-1][0]=r,yo(e,t)}}function lc(e){"@babel/helpers - typeof";return lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lc(e)}var VD=["type","size","sizeType"];function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Zh.apply(this,arguments)}function bv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function wv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bv(Object(r),!0).forEach(function(a){GD(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function GD(e,t,r){return t=qD(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qD(e){var t=KD(e,"string");return lc(t)==="symbol"?t:String(t)}function KD(e,t){if(lc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(lc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XD(e,t){if(e==null)return{};var r=YD(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function YD(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var $2={symbolCircle:Kx,symbolCross:gD,symbolDiamond:yD,symbolSquare:bD,symbolStar:_D,symbolTriangle:SD,symbolWye:ED},JD=Math.PI/180,ZD=function(t){var r="symbol".concat(Xf(t));return $2[r]||Kx},QD=function(t,r,a){if(r==="area")return t;switch(a){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*JD;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},eR=function(t,r){$2["symbol".concat(Xf(t))]=r},Xx=function(t){var r=t.type,a=r===void 0?"circle":r,s=t.size,i=s===void 0?64:s,o=t.sizeType,l=o===void 0?"area":o,c=XD(t,VD),d=wv(wv({},c),{},{type:a,size:i,sizeType:l}),u=function(){var g=ZD(a),y=AD().type(g).size(QD(i,l,a));return y()},f=d.className,h=d.cx,m=d.cy,x=Fe(d,!0);return h===+h&&m===+m&&i===+i?Q.createElement("path",Zh({},x,{className:pt("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(m,")"),d:u()})):null};Xx.registerSymbol=eR;function bo(e){"@babel/helpers - typeof";return bo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bo(e)}function Qh(){return Qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Qh.apply(this,arguments)}function jv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function tR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jv(Object(r),!0).forEach(function(a){cc(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function rR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aR(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,L2(a.key),a)}}function nR(e,t,r){return t&&aR(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function sR(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&em(e,t)}function em(e,t){return em=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},em(e,t)}function iR(e){var t=cR();return function(){var a=ju(e),s;if(t){var i=ju(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return oR(this,s)}}function oR(e,t){if(t&&(bo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lR(e)}function lR(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ju(e){return ju=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ju(e)}function cc(e,t,r){return t=L2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L2(e){var t=dR(e,"string");return bo(t)==="symbol"?t:String(t)}function dR(e,t){if(bo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(bo(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ra=32,Yx=function(e){sR(r,e);var t=iR(r);function r(){return rR(this,r),t.apply(this,arguments)}return nR(r,[{key:"renderIcon",value:function(s){var i=this.props.inactiveColor,o=Ra/2,l=Ra/6,c=Ra/3,d=s.inactive?i:s.color;if(s.type==="plainline")return Q.createElement("line",{strokeWidth:4,fill:"none",stroke:d,strokeDasharray:s.payload.strokeDasharray,x1:0,y1:o,x2:Ra,y2:o,className:"recharts-legend-icon"});if(s.type==="line")return Q.createElement("path",{strokeWidth:4,fill:"none",stroke:d,d:"M0,".concat(o,"h").concat(c,`
            A`).concat(l,",").concat(l,",0,1,1,").concat(2*c,",").concat(o,`
            H`).concat(Ra,"M").concat(2*c,",").concat(o,`
            A`).concat(l,",").concat(l,",0,1,1,").concat(c,",").concat(o),className:"recharts-legend-icon"});if(s.type==="rect")return Q.createElement("path",{stroke:"none",fill:d,d:"M0,".concat(Ra/8,"h").concat(Ra,"v").concat(Ra*3/4,"h").concat(-Ra,"z"),className:"recharts-legend-icon"});if(Q.isValidElement(s.legendIcon)){var u=tR({},s);return delete u.legendIcon,Q.cloneElement(s.legendIcon,u)}return Q.createElement(Xx,{fill:d,cx:o,cy:o,size:Ra,sizeType:"diameter",type:s.type})}},{key:"renderItems",value:function(){var s=this,i=this.props,o=i.payload,l=i.iconSize,c=i.layout,d=i.formatter,u=i.inactiveColor,f={x:0,y:0,width:Ra,height:Ra},h={display:c==="horizontal"?"inline-block":"block",marginRight:10},m={display:"inline-block",verticalAlign:"middle",marginRight:4};return o.map(function(x,p){var g,y=x.formatter||d,b=pt((g={"recharts-legend-item":!0},cc(g,"legend-item-".concat(p),!0),cc(g,"inactive",x.inactive),g));if(x.type==="none")return null;var v=De(x.value)?null:x.value;qn(!De(x.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var w=x.inactive?u:x.color;return Q.createElement("li",Qh({className:b,style:h,key:"legend-item-".concat(p)},ji(s.props,x,p)),Q.createElement(Lh,{width:l,height:l,viewBox:f,style:m},s.renderIcon(x)),Q.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},y?y(v,x,p):v))})}},{key:"render",value:function(){var s=this.props,i=s.payload,o=s.layout,l=s.align;if(!i||!i.length)return null;var c={padding:0,margin:0,textAlign:o==="horizontal"?l:"left"};return Q.createElement("ul",{className:"recharts-default-legend",style:c},this.renderItems())}}]),r}(C.PureComponent);cc(Yx,"displayName","Legend");cc(Yx,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});function wo(e){"@babel/helpers - typeof";return wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wo(e)}var uR=["ref"];function Nv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Gi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nv(Object(r),!0).forEach(function(a){Qf(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function fR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _v(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,U2(a.key),a)}}function hR(e,t,r){return t&&_v(e.prototype,t),r&&_v(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mR(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tm(e,t)}function tm(e,t){return tm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},tm(e,t)}function xR(e){var t=gR();return function(){var a=Nu(e),s;if(t){var i=Nu(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return pR(this,s)}}function pR(e,t){if(t&&(wo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return B2(e)}function B2(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gR(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nu(e){return Nu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Nu(e)}function Qf(e,t,r){return t=U2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U2(e){var t=vR(e,"string");return wo(t)==="symbol"?t:String(t)}function vR(e,t){if(wo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(wo(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yR(e,t){if(e==null)return{};var r=bR(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function bR(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function wR(e){return e.value}function jR(e,t){return e===!0?pu(t,wR):De(e)?pu(t,e):t}function NR(e,t){if(Q.isValidElement(e))return Q.cloneElement(e,t);if(De(e))return Q.createElement(e,t);t.ref;var r=yR(t,uR);return Q.createElement(Yx,r)}var Sv=1,dc=function(e){mR(r,e);var t=xR(r);function r(){var a;fR(this,r);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=t.call.apply(t,[this].concat(i)),Qf(B2(a),"state",{boxWidth:-1,boxHeight:-1}),a}return hR(r,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){return this.wrapperNode&&this.wrapperNode.getBoundingClientRect?this.wrapperNode.getBoundingClientRect():null}},{key:"getBBoxSnapshot",value:function(){var s=this.state,i=s.boxWidth,o=s.boxHeight;return i>=0&&o>=0?{width:i,height:o}:null}},{key:"getDefaultPosition",value:function(s){var i=this.props,o=i.layout,l=i.align,c=i.verticalAlign,d=i.margin,u=i.chartWidth,f=i.chartHeight,h,m;if(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))if(l==="center"&&o==="vertical"){var x=this.getBBoxSnapshot()||{width:0};h={left:((u||0)-x.width)/2}}else h=l==="right"?{right:d&&d.right||0}:{left:d&&d.left||0};if(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))if(c==="middle"){var p=this.getBBoxSnapshot()||{height:0};m={top:((f||0)-p.height)/2}}else m=c==="bottom"?{bottom:d&&d.bottom||0}:{top:d&&d.top||0};return Gi(Gi({},h),m)}},{key:"updateBBox",value:function(){var s=this.state,i=s.boxWidth,o=s.boxHeight,l=this.props.onBBoxUpdate;if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var c=this.wrapperNode.getBoundingClientRect();(Math.abs(c.width-i)>Sv||Math.abs(c.height-o)>Sv)&&this.setState({boxWidth:c.width,boxHeight:c.height},function(){l&&l(c)})}else(i!==-1||o!==-1)&&this.setState({boxWidth:-1,boxHeight:-1},function(){l&&l(null)})}},{key:"render",value:function(){var s=this,i=this.props,o=i.content,l=i.width,c=i.height,d=i.wrapperStyle,u=i.payloadUniqBy,f=i.payload,h=Gi(Gi({position:"absolute",width:l||"auto",height:c||"auto"},this.getDefaultPosition(d)),d);return Q.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(x){s.wrapperNode=x}},NR(o,Gi(Gi({},this.props),{},{payload:jR(u,f)})))}}],[{key:"getWithHeight",value:function(s,i){var o=s.props.layout;return o==="vertical"&&be(s.props.height)?{height:s.props.height}:o==="horizontal"?{width:s.props.width||i}:null}}]),r}(C.PureComponent);Qf(dc,"displayName","Legend");Qf(dc,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var W2={exports:{}},_R="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",SR=_R,kR=SR;function H2(){}function z2(){}z2.resetWarningCache=H2;var ER=function(){function e(a,s,i,o,l,c){if(c!==kR){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:z2,resetWarningCache:H2};return r.PropTypes=r,r};W2.exports=ER();var AR=W2.exports;const Xe=bt(AR);var TR=Object.getOwnPropertyNames,CR=Object.getOwnPropertySymbols,OR=Object.prototype.hasOwnProperty;function kv(e,t){return function(a,s,i){return e(a,s,i)&&t(a,s,i)}}function Md(e){return function(r,a,s){if(!r||!a||typeof r!="object"||typeof a!="object")return e(r,a,s);var i=s.cache,o=i.get(r),l=i.get(a);if(o&&l)return o===a&&l===r;i.set(r,a),i.set(a,r);var c=e(r,a,s);return i.delete(r),i.delete(a),c}}function Ev(e){return TR(e).concat(CR(e))}var PR=Object.hasOwn||function(e,t){return OR.call(e,t)};function Mi(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var FR="__v",IR="__o",DR="_owner",Av=Object.getOwnPropertyDescriptor,Tv=Object.keys;function RR(e,t,r){var a=e.length;if(t.length!==a)return!1;for(;a-- >0;)if(!r.equals(e[a],t[a],a,a,e,t,r))return!1;return!0}function MR(e,t){return Mi(e.getTime(),t.getTime())}function $R(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function LR(e,t){return e===t}function Cv(e,t,r){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var d=t.entries(),u=!1,f=0;(l=d.next())&&!l.done;){if(s[f]){f++;continue}var h=o.value,m=l.value;if(r.equals(h[0],m[0],c,f,e,t,r)&&r.equals(h[1],m[1],h[0],m[0],e,t,r)){u=s[f]=!0;break}f++}if(!u)return!1;c++}return!0}var BR=Mi;function UR(e,t,r){var a=Tv(e),s=a.length;if(Tv(t).length!==s)return!1;for(;s-- >0;)if(!V2(e,t,r,a[s]))return!1;return!0}function fl(e,t,r){var a=Ev(e),s=a.length;if(Ev(t).length!==s)return!1;for(var i,o,l;s-- >0;)if(i=a[s],!V2(e,t,r,i)||(o=Av(e,i),l=Av(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function WR(e,t){return Mi(e.valueOf(),t.valueOf())}function HR(e,t){return e.source===t.source&&e.flags===t.flags}function Ov(e,t,r){var a=e.size;if(a!==t.size)return!1;if(!a)return!0;for(var s=new Array(a),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!s[u]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){d=s[u]=!0;break}u++}if(!d)return!1}return!0}function zR(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function VR(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function V2(e,t,r,a){return(a===DR||a===IR||a===FR)&&(e.$$typeof||t.$$typeof)?!0:PR(t,a)&&r.equals(e[a],t[a],a,a,e,t,r)}var GR="[object Arguments]",qR="[object Boolean]",KR="[object Date]",XR="[object Error]",YR="[object Map]",JR="[object Number]",ZR="[object Object]",QR="[object RegExp]",eM="[object Set]",tM="[object String]",rM="[object URL]",aM=Array.isArray,Pv=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,Fv=Object.assign,nM=Object.prototype.toString.call.bind(Object.prototype.toString);function sM(e){var t=e.areArraysEqual,r=e.areDatesEqual,a=e.areErrorsEqual,s=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,d=e.areRegExpsEqual,u=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual;return function(x,p,g){if(x===p)return!0;if(x==null||p==null)return!1;var y=typeof x;if(y!==typeof p)return!1;if(y!=="object")return y==="number"?o(x,p,g):y==="function"?s(x,p,g):!1;var b=x.constructor;if(b!==p.constructor)return!1;if(b===Object)return l(x,p,g);if(aM(x))return t(x,p,g);if(Pv!=null&&Pv(x))return f(x,p,g);if(b===Date)return r(x,p,g);if(b===RegExp)return d(x,p,g);if(b===Map)return i(x,p,g);if(b===Set)return u(x,p,g);var v=nM(x);return v===KR?r(x,p,g):v===QR?d(x,p,g):v===YR?i(x,p,g):v===eM?u(x,p,g):v===ZR?typeof x.then!="function"&&typeof p.then!="function"&&l(x,p,g):v===rM?h(x,p,g):v===XR?a(x,p,g):v===GR?l(x,p,g):v===qR||v===JR||v===tM?c(x,p,g):!1}}function iM(e){var t=e.circular,r=e.createCustomConfig,a=e.strict,s={areArraysEqual:a?fl:RR,areDatesEqual:MR,areErrorsEqual:$R,areFunctionsEqual:LR,areMapsEqual:a?kv(Cv,fl):Cv,areNumbersEqual:BR,areObjectsEqual:a?fl:UR,arePrimitiveWrappersEqual:WR,areRegExpsEqual:HR,areSetsEqual:a?kv(Ov,fl):Ov,areTypedArraysEqual:a?fl:zR,areUrlsEqual:VR};if(r&&(s=Fv({},s,r(s))),t){var i=Md(s.areArraysEqual),o=Md(s.areMapsEqual),l=Md(s.areObjectsEqual),c=Md(s.areSetsEqual);s=Fv({},s,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return s}function oM(e){return function(t,r,a,s,i,o,l){return e(t,r,l)}}function lM(e){var t=e.circular,r=e.comparator,a=e.createState,s=e.equals,i=e.strict;if(a)return function(c,d){var u=a(),f=u.cache,h=f===void 0?t?new WeakMap:void 0:f,m=u.meta;return r(c,d,{cache:h,equals:s,meta:m,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:s,meta:void 0,strict:i})};var o={cache:void 0,equals:s,meta:void 0,strict:i};return function(c,d){return r(c,d,o)}}var cM=Ms();Ms({strict:!0});Ms({circular:!0});Ms({circular:!0,strict:!0});Ms({createInternalComparator:function(){return Mi}});Ms({strict:!0,createInternalComparator:function(){return Mi}});Ms({circular:!0,createInternalComparator:function(){return Mi}});Ms({circular:!0,createInternalComparator:function(){return Mi},strict:!0});function Ms(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,a=e.createInternalComparator,s=e.createState,i=e.strict,o=i===void 0?!1:i,l=iM(e),c=sM(l),d=a?a(c):oM(c);return lM({circular:r,comparator:c,createState:s,equals:d,strict:o})}function dM(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Iv(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,a=function s(i){r<0&&(r=i),i-r>t?(e(i),r=-1):dM(s)};requestAnimationFrame(a)}function rm(e){"@babel/helpers - typeof";return rm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rm(e)}function uM(e){return xM(e)||mM(e)||hM(e)||fM()}function fM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hM(e,t){if(e){if(typeof e=="string")return Dv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dv(e,t)}}function Dv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function mM(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xM(e){if(Array.isArray(e))return e}function pM(){var e={},t=function(){return null},r=!1,a=function s(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=uM(o),c=l[0],d=l.slice(1);if(typeof c=="number"){Iv(s.bind(null,d),c);return}s(c),Iv(s.bind(null,d));return}rm(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,a(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function uc(e){"@babel/helpers - typeof";return uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uc(e)}function Rv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function jo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rv(Object(r),!0).forEach(function(a){_u(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function _u(e,t,r){return t=gM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gM(e){var t=vM(e,"string");return uc(t)==="symbol"?t:String(t)}function vM(e,t){if(uc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(uc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yM=["Webkit","Moz","O","ms"],bM=["-webkit-","-moz-","-o-","-ms-"],wM=["transform","transformOrigin","transition"],jM=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(a,s){return a.filter(function(i){return s.includes(i)})})},NM=function(t){return t},_M=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},SM=function(t,r){if(wM.indexOf(t)===-1)return _u({},t,Number.isNaN(r)?0:r);var a=t==="transition",s=t.replace(/(\w)/,function(o){return o.toUpperCase()}),i=r;return yM.reduce(function(o,l,c){return a&&(i=r.replace(/(transform|transform-origin)/gim,"".concat(bM[c],"$1"))),jo(jo({},o),{},_u({},l+s,i))},{})},$l=function(t,r){return Object.keys(r).reduce(function(a,s){return jo(jo({},a),{},_u({},s,t(s,r[s])))},{})},am=function(t){return Object.keys(t).reduce(function(r,a){return jo(jo({},r),SM(a,r[a]))},t)},Mv=function(t,r,a){return t.map(function(s){return"".concat(_M(s)," ").concat(r,"ms ").concat(a)}).join(",")};function kM(e,t){return TM(e)||AM(e,t)||G2(e,t)||EM()}function EM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AM(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function TM(e){if(Array.isArray(e))return e}function CM(e){return FM(e)||PM(e)||G2(e)||OM()}function OM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G2(e,t){if(e){if(typeof e=="string")return nm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nm(e,t)}}function PM(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FM(e){if(Array.isArray(e))return nm(e)}function nm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Su=1e-4,q2=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},K2=function(t,r){return t.map(function(a,s){return a*Math.pow(r,s)}).reduce(function(a,s){return a+s})},$v=function(t,r){return function(a){var s=q2(t,r);return K2(s,a)}},IM=function(t,r){return function(a){var s=q2(t,r),i=[].concat(CM(s.map(function(o,l){return o*l}).slice(1)),[0]);return K2(i,a)}},Lv=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var s=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":s=0,i=0,o=1,l=1;break;case"ease":s=.25,i=.1,o=.25,l=1;break;case"ease-in":s=.42,i=0,o=1,l=1;break;case"ease-out":s=.42,i=0,o=.58,l=1;break;case"ease-in-out":s=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(g){return parseFloat(g)}),u=kM(d,4);s=u[0],i=u[1],o=u[2],l=u[3]}}}var f=$v(s,o),h=$v(i,l),m=IM(s,o),x=function(y){return y>1?1:y<0?0:y},p=function(y){for(var b=y>1?1:y,v=b,w=0;w<8;++w){var j=f(v)-b,N=m(v);if(Math.abs(j-b)<Su||N<Su)return h(v);v=x(v-j/N)}return h(v)};return p.isStepper=!1,p},DM=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,a=r===void 0?100:r,s=t.damping,i=s===void 0?8:s,o=t.dt,l=o===void 0?17:o,c=function(u,f,h){var m=-(u-f)*a,x=h*i,p=h+(m-x)*l/1e3,g=h*l/1e3+u;return Math.abs(g-f)<Su&&Math.abs(p)<Su?[f,0]:[g,p]};return c.isStepper=!0,c.dt=l,c},RM=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var s=r[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Lv(s);case"spring":return DM();default:if(s.split("(")[0]==="cubic-bezier")return Lv(s)}return typeof s=="function"?s:null};function fc(e){"@babel/helpers - typeof";return fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fc(e)}function Bv(e){return LM(e)||$M(e)||X2(e)||MM()}function MM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $M(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function LM(e){if(Array.isArray(e))return im(e)}function Uv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function $r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uv(Object(r),!0).forEach(function(a){sm(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function sm(e,t,r){return t=BM(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BM(e){var t=UM(e,"string");return fc(t)==="symbol"?t:String(t)}function UM(e,t){if(fc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(fc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WM(e,t){return VM(e)||zM(e,t)||X2(e,t)||HM()}function HM(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X2(e,t){if(e){if(typeof e=="string")return im(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return im(e,t)}}function im(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function zM(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function VM(e){if(Array.isArray(e))return e}var ku=function(t,r,a){return t+(r-t)*a},om=function(t){var r=t.from,a=t.to;return r!==a},GM=function e(t,r,a){var s=$l(function(i,o){if(om(o)){var l=t(o.from,o.to,o.velocity),c=WM(l,2),d=c[0],u=c[1];return $r($r({},o),{},{from:d,velocity:u})}return o},r);return a<1?$l(function(i,o){return om(o)?$r($r({},o),{},{velocity:ku(o.velocity,s[i].velocity,a),from:ku(o.from,s[i].from,a)}):o},r):e(t,s,a-1)};const qM=function(e,t,r,a,s){var i=jM(e,t),o=i.reduce(function(g,y){return $r($r({},g),{},sm({},y,[e[y],t[y]]))},{}),l=i.reduce(function(g,y){return $r($r({},g),{},sm({},y,{from:e[y],velocity:0,to:t[y]}))},{}),c=-1,d,u,f=function(){return null},h=function(){return $l(function(y,b){return b.from},l)},m=function(){return!Object.values(l).filter(om).length},x=function(y){d||(d=y);var b=y-d,v=b/r.dt;l=GM(r,l,v),s($r($r($r({},e),t),h())),d=y,m()||(c=requestAnimationFrame(f))},p=function(y){u||(u=y);var b=(y-u)/a,v=$l(function(j,N){return ku.apply(void 0,Bv(N).concat([r(b)]))},o);if(s($r($r($r({},e),t),v)),b<1)c=requestAnimationFrame(f);else{var w=$l(function(j,N){return ku.apply(void 0,Bv(N).concat([r(1)]))},o);s($r($r($r({},e),t),w))}};return f=r.isStepper?x:p,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function No(e){"@babel/helpers - typeof";return No=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},No(e)}var KM=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function XM(e,t){if(e==null)return{};var r=YM(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function YM(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function V0(e){return e$(e)||QM(e)||ZM(e)||JM()}function JM(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZM(e,t){if(e){if(typeof e=="string")return lm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lm(e,t)}}function QM(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function e$(e){if(Array.isArray(e))return lm(e)}function lm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Wv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Qa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wv(Object(r),!0).forEach(function(a){Al(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Al(e,t,r){return t=Y2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t$(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r$(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,Y2(a.key),a)}}function a$(e,t,r){return t&&r$(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Y2(e){var t=n$(e,"string");return No(t)==="symbol"?t:String(t)}function n$(e,t){if(No(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(No(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s$(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cm(e,t)}function cm(e,t){return cm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},cm(e,t)}function i$(e){var t=o$();return function(){var a=Eu(e),s;if(t){var i=Eu(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return dm(this,s)}}function dm(e,t){if(t&&(No(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return um(e)}function um(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Eu(e){return Eu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Eu(e)}var un=function(e){s$(r,e);var t=i$(r);function r(a,s){var i;t$(this,r),i=t.call(this,a,s);var o=i.props,l=o.isActive,c=o.attributeName,d=o.from,u=o.to,f=o.steps,h=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(um(i)),i.changeStyle=i.changeStyle.bind(um(i)),!l||m<=0)return i.state={style:{}},typeof h=="function"&&(i.state={style:u}),dm(i);if(f&&f.length)i.state={style:f[0].style};else if(d){if(typeof h=="function")return i.state={style:d},dm(i);i.state={style:c?Al({},c,d):d}}else i.state={style:{}};return i}return a$(r,[{key:"componentDidMount",value:function(){var s=this.props,i=s.isActive,o=s.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,u=i.to,f=i.from,h=this.state.style;if(l){if(!o){var m={style:c?Al({},c,u):u};this.state&&h&&(c&&h[c]!==u||!c&&h!==u)&&this.setState(m);return}if(!(cM(s.to,u)&&s.canBegin&&s.isActive)){var x=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var p=x||d?f:s.to;if(this.state&&h){var g={style:c?Al({},c,p):p};(c&&[c]!==p||!c&&h!==p)&&this.setState(g)}this.runAnimation(Qa(Qa({},this.props),{},{from:p,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var i=this,o=s.from,l=s.to,c=s.duration,d=s.easing,u=s.begin,f=s.onAnimationEnd,h=s.onAnimationStart,m=qM(o,l,RM(d),c,this.changeStyle),x=function(){i.stopJSAnimation=m()};this.manager.start([h,u,x,c,f])}},{key:"runStepAnimation",value:function(s){var i=this,o=s.steps,l=s.begin,c=s.onAnimationStart,d=o[0],u=d.style,f=d.duration,h=f===void 0?0:f,m=function(p,g,y){if(y===0)return p;var b=g.duration,v=g.easing,w=v===void 0?"ease":v,j=g.style,N=g.properties,_=g.onAnimationEnd,E=y>0?o[y-1]:g,S=N||Object.keys(j);if(typeof w=="function"||w==="spring")return[].concat(V0(p),[i.runJSAnimation.bind(i,{from:E.style,to:j,duration:b,easing:w}),b]);var k=Mv(S,b,w),O=Qa(Qa(Qa({},E.style),j),{},{transition:k});return[].concat(V0(p),[O,b,_]).filter(NM)};return this.manager.start([c].concat(V0(o.reduce(m,[u,Math.max(h,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=pM());var i=s.begin,o=s.duration,l=s.attributeName,c=s.to,d=s.easing,u=s.onAnimationStart,f=s.onAnimationEnd,h=s.steps,m=s.children,x=this.manager;if(this.unSubscribe=x.subscribe(this.handleStyleChange),typeof d=="function"||typeof m=="function"||d==="spring"){this.runJSAnimation(s);return}if(h.length>1){this.runStepAnimation(s);return}var p=l?Al({},l,c):c,g=Mv(Object.keys(p),o,d);x.start([u,i,Qa(Qa({},p),{},{transition:g}),o,f])}},{key:"render",value:function(){var s=this.props,i=s.children;s.begin;var o=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=XM(s,KM),d=C.Children.count(i),u=am(this.state.style);if(typeof i=="function")return i(u);if(!l||d===0||o<=0)return i;var f=function(m){var x=m.props,p=x.style,g=p===void 0?{}:p,y=x.className,b=C.cloneElement(m,Qa(Qa({},c),{},{style:Qa(Qa({},g),u),className:y}));return b};return d===1?f(C.Children.only(i)):Q.createElement("div",null,C.Children.map(i,function(h){return f(h)}))}}]),r}(C.PureComponent);un.displayName="Animate";un.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};un.propTypes={from:Xe.oneOfType([Xe.object,Xe.string]),to:Xe.oneOfType([Xe.object,Xe.string]),attributeName:Xe.string,duration:Xe.number,begin:Xe.number,easing:Xe.oneOfType([Xe.string,Xe.func]),steps:Xe.arrayOf(Xe.shape({duration:Xe.number.isRequired,style:Xe.object.isRequired,easing:Xe.oneOfType([Xe.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Xe.func]),properties:Xe.arrayOf("string"),onAnimationEnd:Xe.func})),children:Xe.oneOfType([Xe.node,Xe.func]),isActive:Xe.bool,canBegin:Xe.bool,onAnimationEnd:Xe.func,shouldReAnimate:Xe.bool,onAnimationStart:Xe.func,onAnimationReStart:Xe.func};Number.isFinite===void 0&&(Number.isFinite=function(e){return typeof e=="number"&&isFinite(e)});Xe.object,Xe.object,Xe.object,Xe.element;Xe.object,Xe.object,Xe.object,Xe.oneOfType([Xe.array,Xe.element]),Xe.any;var Hv=fd,l$=Wx,c$=da,zv=Hv?Hv.isConcatSpreadable:void 0;function d$(e){return c$(e)||l$(e)||!!(zv&&e&&e[zv])}var u$=d$,f$=a2,h$=u$;function J2(e,t,r,a,s){var i=-1,o=e.length;for(r||(r=h$),s||(s=[]);++i<o;){var l=e[i];t>0&&r(l)?t>1?J2(l,t-1,r,a,s):f$(s,l):a||(s[s.length]=l)}return s}var Z2=J2;function m$(e){return function(t,r,a){for(var s=-1,i=Object(t),o=a(t),l=o.length;l--;){var c=o[e?l:++s];if(r(i[c],c,i)===!1)break}return t}}var x$=m$,p$=x$,g$=p$(),v$=g$,y$=v$,b$=Kf;function w$(e,t){return e&&y$(e,t,b$)}var Q2=w$,j$=md;function N$(e,t){return function(r,a){if(r==null)return r;if(!j$(r))return e(r,a);for(var s=r.length,i=t?s:-1,o=Object(r);(t?i--:++i<s)&&a(o[i],i,o)!==!1;);return r}}var _$=N$,S$=Q2,k$=_$,E$=k$(S$),Jx=E$,A$=Jx,T$=md;function C$(e,t){var r=-1,a=T$(e)?Array(e.length):[];return A$(e,function(s,i,o){a[++r]=t(s,i,o)}),a}var eN=C$;function O$(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var P$=O$,Vv=Go;function F$(e,t){if(e!==t){var r=e!==void 0,a=e===null,s=e===e,i=Vv(e),o=t!==void 0,l=t===null,c=t===t,d=Vv(t);if(!l&&!d&&!i&&e>t||i&&o&&c&&!l&&!d||a&&o&&c||!r&&c||!s)return 1;if(!a&&!i&&!d&&e<t||d&&r&&s&&!a&&!i||l&&r&&s||!o&&s||!c)return-1}return 0}var I$=F$,D$=I$;function R$(e,t,r){for(var a=-1,s=e.criteria,i=t.criteria,o=s.length,l=r.length;++a<o;){var c=D$(s[a],i[a]);if(c){if(a>=l)return c;var d=r[a];return c*(d=="desc"?-1:1)}}return e.index-t.index}var M$=R$,G0=Ix,$$=Dx,L$=Fn,B$=eN,U$=P$,W$=i2,H$=M$,z$=Qo,V$=da;function G$(e,t,r){t.length?t=G0(t,function(i){return V$(i)?function(o){return $$(o,i.length===1?i[0]:i)}:i}):t=[z$];var a=-1;t=G0(t,W$(L$));var s=B$(e,function(i,o,l){var c=G0(t,function(d){return d(i)});return{criteria:c,index:++a,value:i}});return U$(s,function(i,o){return H$(i,o,r)})}var q$=G$;function K$(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var X$=K$,Y$=X$,Gv=Math.max;function J$(e,t,r){return t=Gv(t===void 0?e.length-1:t,0),function(){for(var a=arguments,s=-1,i=Gv(a.length-t,0),o=Array(i);++s<i;)o[s]=a[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=a[s];return l[t]=r(o),Y$(e,this,l)}}var Z$=J$;function Q$(e){return function(){return e}}var eL=Q$,tL=Di,rL=function(){try{var e=tL(Object,"defineProperty");return e({},"",{}),e}catch{}}(),tN=rL,aL=eL,qv=tN,nL=Qo,sL=qv?function(e,t){return qv(e,"toString",{configurable:!0,enumerable:!1,value:aL(t),writable:!0})}:nL,iL=sL,oL=800,lL=16,cL=Date.now;function dL(e){var t=0,r=0;return function(){var a=cL(),s=lL-(a-r);if(r=a,s>0){if(++t>=oL)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var uL=dL,fL=iL,hL=uL,mL=hL(fL),xL=mL,pL=Qo,gL=Z$,vL=xL;function yL(e,t){return vL(gL(e,t,pL),e+"")}var bL=yL,wL=Cx,jL=md,NL=Hx,_L=Rs;function SL(e,t,r){if(!_L(r))return!1;var a=typeof t;return(a=="number"?jL(r)&&NL(t,r.length):a=="string"&&t in r)?wL(r[t],e):!1}var e0=SL,kL=Z2,EL=q$,AL=bL,Kv=e0,TL=AL(function(e,t){if(e==null)return[];var r=t.length;return r>1&&Kv(e,t[0],t[1])?t=[]:r>2&&Kv(t[0],t[1],t[2])&&(t=[t[0]]),EL(e,kL(t,1),[])}),CL=TL;const Zx=bt(CL);function hc(e){"@babel/helpers - typeof";return hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hc(e)}function OL(e,t){return DL(e)||IL(e,t)||FL(e,t)||PL()}function PL(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function FL(e,t){if(e){if(typeof e=="string")return Xv(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xv(e,t)}}function Xv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function IL(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function DL(e){if(Array.isArray(e))return e}function Yv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function q0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yv(Object(r),!0).forEach(function(a){RL(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function RL(e,t,r){return t=ML(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ML(e){var t=$L(e,"string");return hc(t)==="symbol"?t:String(t)}function $L(e,t){if(hc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(hc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function LL(e){return hr(e)&&br(e[0])&&br(e[1])?e.join(" ~ "):e}var BL=function(t){var r=t.separator,a=r===void 0?" : ":r,s=t.contentStyle,i=s===void 0?{}:s,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,f=t.formatter,h=t.itemSorter,m=t.wrapperClassName,x=t.labelClassName,p=t.label,g=t.labelFormatter,y=function(){if(u&&u.length){var S={padding:0,margin:0},k=(h?Zx(u,h):u).map(function(O,P){if(O.type==="none")return null;var A=q0({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},l),R=O.formatter||f||LL,T=O.value,F=O.name,W=T,K=F;if(R&&W!=null&&K!=null){var B=R(T,F,O,P,u);if(Array.isArray(B)){var L=OL(B,2);W=L[0],K=L[1]}else W=B}return Q.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(P),style:A},br(K)?Q.createElement("span",{className:"recharts-tooltip-item-name"},K):null,br(K)?Q.createElement("span",{className:"recharts-tooltip-item-separator"},a):null,Q.createElement("span",{className:"recharts-tooltip-item-value"},W),Q.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return Q.createElement("ul",{className:"recharts-tooltip-item-list",style:S},k)}return null},b=q0({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),v=q0({margin:0},d),w=!Pe(p),j=w?p:"",N=pt("recharts-default-tooltip",m),_=pt("recharts-tooltip-label",x);return w&&g&&u!==void 0&&u!==null&&(j=g(p,u)),Q.createElement("div",{className:N,style:b},Q.createElement("p",{className:_,style:v},Q.isValidElement(j)?j:"".concat(j)),y())},UL=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},$s={isSsr:UL()};function _o(e){"@babel/helpers - typeof";return _o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_o(e)}function Jv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function $n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jv(Object(r),!0).forEach(function(a){vn(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jv(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function WL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HL(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,rN(a.key),a)}}function zL(e,t,r){return t&&HL(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function VL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fm(e,t)}function fm(e,t){return fm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},fm(e,t)}function GL(e){var t=KL();return function(){var a=Au(e),s;if(t){var i=Au(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return qL(this,s)}}function qL(e,t){if(t&&(_o(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iu(e)}function iu(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KL(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Au(e){return Au=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Au(e)}function vn(e,t,r){return t=rN(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rN(e){var t=XL(e,"string");return _o(t)==="symbol"?t:String(t)}function XL(e,t){if(_o(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(_o(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hl="recharts-tooltip-wrapper",Zv=1;function YL(e){return e.dataKey}function JL(e,t){return e===!0?pu(t,YL):De(e)?pu(t,e):t}function ZL(e,t){return Q.isValidElement(e)?Q.cloneElement(e,t):De(e)?Q.createElement(e,t):Q.createElement(BL,t)}var nn=function(e){VL(r,e);var t=GL(r);function r(){var a;WL(this,r);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=t.call.apply(t,[this].concat(i)),vn(iu(a),"state",{boxWidth:-1,boxHeight:-1,dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),vn(iu(a),"handleKeyDown",function(l){l.key==="Escape"&&a.setState({dismissed:!0,dismissedAtCoordinate:$n($n({},a.state.dismissedAtCoordinate),{},{x:a.props.coordinate.x,y:a.props.coordinate.y})})}),vn(iu(a),"getTranslate",function(l){var c=l.key,d=l.tooltipDimension,u=l.viewBoxDimension,f=a.props,h=f.allowEscapeViewBox,m=f.reverseDirection,x=f.coordinate,p=f.offset,g=f.position,y=f.viewBox;if(g&&be(g[c]))return g[c];var b=x[c]-d-p,v=x[c]+p;if(h[c])return m[c]?b:v;if(m[c]){var w=b,j=y[c];return w<j?Math.max(v,y[c]):Math.max(b,y[c])}var N=v+d,_=y[c]+u;return N>_?Math.max(b,y[c]):Math.max(v,y[c])}),a}return zL(r,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"updateBBox",value:function(){var s=this.state,i=s.boxWidth,o=s.boxHeight,l=s.dismissed;if(l?(document.removeEventListener("keydown",this.handleKeyDown),(this.props.coordinate.x!==this.state.dismissedAtCoordinate.x||this.props.coordinate.y!==this.state.dismissedAtCoordinate.y)&&this.setState({dismissed:!1})):document.addEventListener("keydown",this.handleKeyDown),this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var c=this.wrapperNode.getBoundingClientRect();(Math.abs(c.width-i)>Zv||Math.abs(c.height-o)>Zv)&&this.setState({boxWidth:c.width,boxHeight:c.height})}else(i!==-1||o!==-1)&&this.setState({boxWidth:-1,boxHeight:-1})}},{key:"render",value:function(){var s,i=this,o=this.props,l=o.payload,c=o.isAnimationActive,d=o.animationDuration,u=o.animationEasing,f=o.filterNull,h=o.payloadUniqBy,m=JL(h,f&&l&&l.length?l.filter(function(A){return!Pe(A.value)}):l),x=m&&m.length,p=this.props,g=p.content,y=p.viewBox,b=p.coordinate,v=p.position,w=p.active,j=p.wrapperStyle,N=$n({pointerEvents:"none",visibility:!this.state.dismissed&&w&&x?"visible":"hidden",position:"absolute",top:0,left:0},j),_,E;if(v&&be(v.x)&&be(v.y))_=v.x,E=v.y;else{var S=this.state,k=S.boxWidth,O=S.boxHeight;k>0&&O>0&&b?(_=this.getTranslate({key:"x",tooltipDimension:k,viewBoxDimension:y.width}),E=this.getTranslate({key:"y",tooltipDimension:O,viewBoxDimension:y.height})):N.visibility="hidden"}N=$n($n({},am({transform:this.props.useTranslate3d?"translate3d(".concat(_,"px, ").concat(E,"px, 0)"):"translate(".concat(_,"px, ").concat(E,"px)")})),N),c&&w&&(N=$n($n({},am({transition:"transform ".concat(d,"ms ").concat(u)})),N));var P=pt(hl,(s={},vn(s,"".concat(hl,"-right"),be(_)&&b&&be(b.x)&&_>=b.x),vn(s,"".concat(hl,"-left"),be(_)&&b&&be(b.x)&&_<b.x),vn(s,"".concat(hl,"-bottom"),be(E)&&b&&be(b.y)&&E>=b.y),vn(s,"".concat(hl,"-top"),be(E)&&b&&be(b.y)&&E<b.y),s));return Q.createElement("div",{tabIndex:-1,role:"dialog",className:P,style:N,ref:function(R){i.wrapperNode=R}},ZL(g,$n($n({},this.props),{},{payload:m})))}}]),r}(C.PureComponent);vn(nn,"displayName","Tooltip");vn(nn,"defaultProps",{active:!1,allowEscapeViewBox:{x:!1,y:!1},reverseDirection:{x:!1,y:!1},offset:10,viewBox:{x:0,y:0,height:0,width:0},coordinate:{x:0,y:0},cursorStyle:{},separator:" : ",wrapperStyle:{},contentStyle:{},itemStyle:{},labelStyle:{},cursor:!0,trigger:"hover",isAnimationActive:!$s.isSsr,animationEasing:"ease",animationDuration:400,filterNull:!0,useTranslate3d:!1});var QL=Pn,e7=function(){return QL.Date.now()},t7=e7,r7=/\s/;function a7(e){for(var t=e.length;t--&&r7.test(e.charAt(t)););return t}var n7=a7,s7=n7,i7=/^\s+/;function o7(e){return e&&e.slice(0,s7(e)+1).replace(i7,"")}var l7=o7,c7=l7,Qv=Rs,d7=Go,ey=NaN,u7=/^[-+]0x[0-9a-f]+$/i,f7=/^0b[01]+$/i,h7=/^0o[0-7]+$/i,m7=parseInt;function x7(e){if(typeof e=="number")return e;if(d7(e))return ey;if(Qv(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Qv(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=c7(e);var r=f7.test(e);return r||h7.test(e)?m7(e.slice(2),r?2:8):u7.test(e)?ey:+e}var aN=x7,p7=Rs,K0=t7,ty=aN,g7="Expected a function",v7=Math.max,y7=Math.min;function b7(e,t,r){var a,s,i,o,l,c,d=0,u=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(g7);t=ty(t)||0,p7(r)&&(u=!!r.leading,f="maxWait"in r,i=f?v7(ty(r.maxWait)||0,t):i,h="trailing"in r?!!r.trailing:h);function m(N){var _=a,E=s;return a=s=void 0,d=N,o=e.apply(E,_),o}function x(N){return d=N,l=setTimeout(y,t),u?m(N):o}function p(N){var _=N-c,E=N-d,S=t-_;return f?y7(S,i-E):S}function g(N){var _=N-c,E=N-d;return c===void 0||_>=t||_<0||f&&E>=i}function y(){var N=K0();if(g(N))return b(N);l=setTimeout(y,p(N))}function b(N){return l=void 0,h&&a?m(N):(a=s=void 0,o)}function v(){l!==void 0&&clearTimeout(l),d=0,a=c=s=l=void 0}function w(){return l===void 0?o:b(K0())}function j(){var N=K0(),_=g(N);if(a=arguments,s=this,c=N,_){if(l===void 0)return x(c);if(f)return clearTimeout(l),l=setTimeout(y,t),m(c)}return l===void 0&&(l=setTimeout(y,t)),o}return j.cancel=v,j.flush=w,j}var nN=b7;const w7=bt(nN);var j7=nN,N7=Rs,_7="Expected a function";function S7(e,t,r){var a=!0,s=!0;if(typeof e!="function")throw new TypeError(_7);return N7(r)&&(a="leading"in r?!!r.leading:a,s="trailing"in r?!!r.trailing:s),j7(e,t,{leading:a,maxWait:t,trailing:s})}var k7=S7;const sN=bt(k7);var hm=function(e,t){return hm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var s in a)a.hasOwnProperty(s)&&(r[s]=a[s])},hm(e,t)};function E7(e,t){hm(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function A7(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(e);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(e,a[s])&&(r[a[s]]=e[a[s]]);return r}var T7=function(e,t,r,a){switch(t){case"debounce":return w7(e,r,a);case"throttle":return sN(e,r,a);default:return e}},ry=function(e){return typeof e=="function"},ml=function(){return typeof window>"u"},ay=function(e){return e instanceof Element||e instanceof HTMLDocument},C7=function(e,t,r){return function(a){var s=a.width,i=a.height;e(function(o){return o.width===s&&o.height===i||o.width===s&&!r||o.height===i&&!t?o:{width:s,height:i}})}},O7=function(e){E7(t,e);function t(r){var a=e.call(this,r)||this;a.cancelHandler=function(){a.resizeHandler&&a.resizeHandler.cancel&&(a.resizeHandler.cancel(),a.resizeHandler=null)},a.attachObserver=function(){var d=a.props,u=d.targetRef,f=d.observerOptions;if(!ml()){u&&u.current&&(a.targetRef.current=u.current);var h=a.getElement();h&&(a.observableElement&&a.observableElement===h||(a.observableElement=h,a.resizeObserver.observe(h,f)))}},a.getElement=function(){var d=a.props,u=d.querySelector,f=d.targetDomEl;if(ml())return null;if(u)return document.querySelector(u);if(f&&ay(f))return f;if(a.targetRef&&ay(a.targetRef.current))return a.targetRef.current;var h=xj.findDOMNode(a);if(!h)return null;var m=a.getRenderType();switch(m){case"renderProp":return h;case"childFunction":return h;case"child":return h;case"childArray":return h;default:return h.parentElement}},a.createResizeHandler=function(d){var u=a.props,f=u.handleWidth,h=f===void 0?!0:f,m=u.handleHeight,x=m===void 0?!0:m,p=u.onResize;if(!(!h&&!x)){var g=C7(function(y){return a.setState(y,function(){return p==null?void 0:p(a.state.width,a.state.height)})},h,x);d.forEach(function(y){var b=y&&y.contentRect||{},v=b.width,w=b.height,j=!a.skipOnMount&&!ml();j&&g({width:v,height:w}),a.skipOnMount=!1})}},a.getRenderType=function(){var d=a.props,u=d.render,f=d.children;return ry(u)?"renderProp":ry(f)?"childFunction":C.isValidElement(f)?"child":Array.isArray(f)?"childArray":"parent"};var s=r.skipOnMount,i=r.refreshMode,o=r.refreshRate,l=o===void 0?1e3:o,c=r.refreshOptions;return a.state={width:void 0,height:void 0},a.skipOnMount=s,a.targetRef=C.createRef(),a.observableElement=null,ml()||(a.resizeHandler=T7(a.createResizeHandler,i,l,c),a.resizeObserver=new window.ResizeObserver(a.resizeHandler)),a}return t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){ml()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var r=this.props,a=r.render,s=r.children,i=r.nodeType,o=i===void 0?"div":i,l=this.state,c=l.width,d=l.height,u={width:c,height:d,targetRef:this.targetRef},f=this.getRenderType();switch(f){case"renderProp":return a==null?void 0:a(u);case"childFunction":{var h=s;return h==null?void 0:h(u)}case"child":{var m=s;if(m.type&&typeof m.type=="string"){u.targetRef;var x=A7(u,["targetRef"]);return C.cloneElement(m,x)}return C.cloneElement(m,u)}case"childArray":{var p=s;return p.map(function(g){return!!g&&C.cloneElement(g,u)})}default:return Q.createElement(o,null)}},t}(C.PureComponent);function mc(e){"@babel/helpers - typeof";return mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mc(e)}function mm(){return mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},mm.apply(this,arguments)}function ny(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function sy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ny(Object(r),!0).forEach(function(a){P7(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ny(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function P7(e,t,r){return t=F7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F7(e){var t=I7(e,"string");return mc(t)==="symbol"?t:String(t)}function I7(e,t){if(mc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(mc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function D7(e,t){return L7(e)||$7(e,t)||M7(e,t)||R7()}function R7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M7(e,t){if(e){if(typeof e=="string")return iy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iy(e,t)}}function iy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function $7(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function L7(e){if(Array.isArray(e))return e}var xl=C.forwardRef(function(e,t){var r=e.aspect,a=e.initialDimension,s=a===void 0?{width:-1,height:-1}:a,i=e.width,o=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,d=e.minWidth,u=d===void 0?0:d,f=e.minHeight,h=e.maxHeight,m=e.children,x=e.debounce,p=x===void 0?0:x,g=e.id,y=e.className,b=e.onResize,v=e.style,w=v===void 0?{}:v,j=C.useState({containerWidth:s.width,containerHeight:s.height}),N=D7(j,2),_=N[0],E=N[1],S=C.useRef(null);C.useImperativeHandle(t,function(){return S},[S]);var k=C.useCallback(function(){return S.current?{containerWidth:S.current.clientWidth,containerHeight:S.current.clientHeight}:null},[]),O=C.useCallback(function(){var R=k();if(R){var T=R.containerWidth,F=R.containerHeight;b&&b(T,F),E(function(W){var K=W.containerWidth,B=W.containerHeight;return T!==K||F!==B?{containerWidth:T,containerHeight:F}:W})}},[k,b]),P=C.useMemo(function(){var R=_.containerWidth,T=_.containerHeight;if(R<0||T<0)return null;qn(ai(o)||ai(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),qn(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=ai(o)?R:o,W=ai(c)?T:c;return r&&r>0&&(F?W=F/r:W&&(F=W*r),h&&W>h&&(W=h)),qn(F>0||W>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,W,o,c,u,f,r),C.cloneElement(m,{width:F,height:W})},[r,m,c,h,f,u,_,o]);C.useEffect(function(){var R=k();R&&E(R)},[k]);var A=sy(sy({},w),{},{width:o,height:c,minWidth:u,minHeight:f,maxHeight:h});return Q.createElement(O7,{handleWidth:!0,handleHeight:!0,onResize:O,targetRef:S,refreshMode:p>0?"debounce":void 0,refreshRate:p},Q.createElement("div",mm({},g!=null?{id:"".concat(g)}:{},{className:pt("recharts-responsive-container",y),style:A,ref:S}),P))}),t0=function(t){return null};t0.displayName="Cell";function xc(e){"@babel/helpers - typeof";return xc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xc(e)}function oy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ly(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oy(Object(r),!0).forEach(function(a){B7(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oy(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function B7(e,t,r){return t=U7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U7(e){var t=W7(e,"string");return xc(t)==="symbol"?t:String(t)}function W7(e,t){if(xc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(xc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cy(e){return G7(e)||V7(e)||z7(e)||H7()}function H7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z7(e,t){if(e){if(typeof e=="string")return xm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xm(e,t)}}function V7(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function G7(e){if(Array.isArray(e))return xm(e)}function xm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var qi={widthCache:{},cacheCount:0},q7=2e3,K7={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},X7=["minWidth","maxWidth","width","minHeight","maxHeight","height","top","left","fontSize","lineHeight","padding","margin","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom"],dy="recharts_measurement_span";function Y7(e,t){return X7.indexOf(e)>=0&&t===+t?"".concat(t,"px"):t}function J7(e){var t=e.split(""),r=t.reduce(function(a,s){return s===s.toUpperCase()?[].concat(cy(a),["-",s.toLowerCase()]):[].concat(cy(a),[s])},[]);return r.join("")}var Z7=function(t){return Object.keys(t).reduce(function(r,a){return"".concat(r).concat(J7(a),":").concat(Y7(a,t[a]),";")},"")},Ll=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||$s.isSsr)return{width:0,height:0};var a="".concat(t),s=Z7(r),i="".concat(a,"-").concat(s);if(qi.widthCache[i])return qi.widthCache[i];try{var o=document.getElementById(dy);o||(o=document.createElement("span"),o.setAttribute("id",dy),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var l=ly(ly({},K7),r);Object.keys(l).map(function(u){return o.style[u]=l[u],u}),o.textContent=a;var c=o.getBoundingClientRect(),d={width:c.width,height:c.height};return qi.widthCache[i]=d,++qi.cacheCount>q7&&(qi.cacheCount=0,qi.widthCache={}),d}catch{return{width:0,height:0}}},Q7=function(t){var r=t.ownerDocument.documentElement,a={top:0,left:0};return typeof t.getBoundingClientRect<"u"&&(a=t.getBoundingClientRect()),{top:a.top+window.pageYOffset-r.clientTop,left:a.left+window.pageXOffset-r.clientLeft}},eB=function(t,r){return{chartX:Math.round(t.pageX-r.left),chartY:Math.round(t.pageY-r.top)}};function pc(e){"@babel/helpers - typeof";return pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pc(e)}function Tu(e,t){return nB(e)||aB(e,t)||rB(e,t)||tB()}function tB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rB(e,t){if(e){if(typeof e=="string")return uy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uy(e,t)}}function uy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function aB(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function nB(e){if(Array.isArray(e))return e}function sB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fy(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,oB(a.key),a)}}function iB(e,t,r){return t&&fy(e.prototype,t),r&&fy(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oB(e){var t=lB(e,"string");return pc(t)==="symbol"?t:String(t)}function lB(e,t){if(pc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(pc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var hy=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,my=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cB=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,dB=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,iN={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},uB=Object.keys(iN),ao="NaN";function fB(e,t){return e*iN[t]}var $d=function(){function e(t,r){sB(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!cB.test(r)&&(this.num=NaN,this.unit=""),uB.includes(r)&&(this.num=fB(t,r),this.unit="px")}return iB(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var a,s=(a=dB.exec(r))!==null&&a!==void 0?a:[],i=Tu(s,3),o=i[1],l=i[2];return new e(parseFloat(o),l??"")}}]),e}();function oN(e){if(e.includes(ao))return ao;for(var t=e;t.includes("*")||t.includes("/");){var r,a=(r=hy.exec(t))!==null&&r!==void 0?r:[],s=Tu(a,4),i=s[1],o=s[2],l=s[3],c=$d.parse(i??""),d=$d.parse(l??""),u=o==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return ao;t=t.replace(hy,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=my.exec(t))!==null&&f!==void 0?f:[],m=Tu(h,4),x=m[1],p=m[2],g=m[3],y=$d.parse(x??""),b=$d.parse(g??""),v=p==="+"?y.add(b):y.subtract(b);if(v.isNaN())return ao;t=t.replace(my,v.toString())}return t}var xy=/\(([^()]*)\)/;function hB(e){for(var t=e;t.includes("(");){var r=xy.exec(t),a=Tu(r,2),s=a[1];t=t.replace(xy,oN(s))}return t}function mB(e){var t=e.replace(/\s+/g,"");return t=hB(t),t=oN(t),t}function xB(e){try{return mB(e)}catch{return ao}}function X0(e){var t=xB(e.slice(5,-1));return t===ao?"":t}var pB=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],gB=["dx","dy","angle","className","breakAll"];function pm(){return pm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pm.apply(this,arguments)}function py(e,t){if(e==null)return{};var r=vB(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function vB(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function gy(e,t){return jB(e)||wB(e,t)||bB(e,t)||yB()}function yB(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bB(e,t){if(e){if(typeof e=="string")return vy(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vy(e,t)}}function vy(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function wB(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function jB(e){if(Array.isArray(e))return e}var lN=/[ \f\n\r\t\v\u2028\u2029]+/,cN=function(t){var r=t.children,a=t.breakAll,s=t.style;try{var i=[];Pe(r)||(a?i=r.toString().split(""):i=r.toString().split(lN));var o=i.map(function(c){return{word:c,width:Ll(c,s).width}}),l=a?0:Ll(" ",s).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},NB=function(t,r,a,s,i){var o=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=be(o),f=l,h=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return T.reduce(function(F,W){var K=W.word,B=W.width,L=F[F.length-1];if(L&&(s==null||i||L.width+B+a<Number(s)))L.words.push(K),L.width+=B+a;else{var ee={words:[K],width:B};F.push(ee)}return F},[])},m=h(r),x=function(T){return T.reduce(function(F,W){return F.width>W.width?F:W})};if(!u)return m;for(var p="…",g=function(T){var F=f.slice(0,T),W=cN({breakAll:d,style:c,children:F+p}).wordsWithComputedWidth,K=h(W),B=K.length>o||x(K).width>Number(s);return[B,K]},y=0,b=f.length-1,v=0,w;y<=b&&v<=f.length-1;){var j=Math.floor((y+b)/2),N=j-1,_=g(N),E=gy(_,2),S=E[0],k=E[1],O=g(j),P=gy(O,1),A=P[0];if(!S&&!A&&(y=j+1),S&&A&&(b=j-1),!S&&A){w=k;break}v++}return w||m},yy=function(t){var r=Pe(t)?[]:t.toString().split(lN);return[{words:r}]},_B=function(t){var r=t.width,a=t.scaleToFit,s=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||a)&&!$s.isSsr){var c,d,u=cN({breakAll:o,children:s,style:i});if(u){var f=u.wordsWithComputedWidth,h=u.spaceWidth;c=f,d=h}else return yy(s);return NB({breakAll:o,children:s,maxLines:l,style:i},c,d,r,a)}return yy(s)},by="#808080",Ni=function(t){var r=t.x,a=r===void 0?0:r,s=t.y,i=s===void 0?0:s,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,f=u===void 0?!1:u,h=t.textAnchor,m=h===void 0?"start":h,x=t.verticalAnchor,p=x===void 0?"end":x,g=t.fill,y=g===void 0?by:g,b=py(t,pB),v=C.useMemo(function(){return _B({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),w=b.dx,j=b.dy,N=b.angle,_=b.className,E=b.breakAll,S=py(b,gB);if(!br(a)||!br(i))return null;var k=a+(be(w)?w:0),O=i+(be(j)?j:0),P;switch(p){case"start":P=X0("calc(".concat(d,")"));break;case"middle":P=X0("calc(".concat((v.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:P=X0("calc(".concat(v.length-1," * -").concat(l,")"));break}var A=[];if(f){var R=v[0].width,T=b.width;A.push("scale(".concat((be(T)?T/R:1)/R,")"))}return N&&A.push("rotate(".concat(N,", ").concat(k,", ").concat(O,")")),A.length&&(S.transform=A.join(" ")),Q.createElement("text",pm({},Fe(S,!0),{x:k,y:O,className:pt("recharts-text",_),textAnchor:m,fill:y.includes("url")?by:y}),v.map(function(F,W){return Q.createElement("tspan",{x:k,dy:W===0?P:l,key:W},F.words.join(E?"":" "))}))},SB=Vx;function kB(e,t){return SB(e,t)}var EB=kB;const _i=bt(EB);var AB=Go;function TB(e,t,r){for(var a=-1,s=e.length;++a<s;){var i=e[a],o=t(i);if(o!=null&&(l===void 0?o===o&&!AB(o):r(o,l)))var l=o,c=i}return c}var r0=TB;function CB(e,t){return e>t}var dN=CB,OB=r0,PB=dN,FB=Qo;function IB(e){return e&&e.length?OB(e,FB,PB):void 0}var DB=IB;const bs=bt(DB);function RB(e,t){return e<t}var uN=RB,MB=r0,$B=uN,LB=Qo;function BB(e){return e&&e.length?MB(e,LB,$B):void 0}var UB=BB;const a0=bt(UB);var WB=Ix,HB=Fn,zB=eN,VB=da;function GB(e,t){var r=VB(e)?WB:zB;return r(e,HB(t))}var qB=GB,KB=Z2,XB=qB;function YB(e,t){return KB(XB(e,t),1)}var JB=YB;const ZB=bt(JB);function Es(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function QB(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Qx(e){let t,r,a;e.length!==2?(t=Es,r=(l,c)=>Es(e(l),c),a=(l,c)=>e(l)-c):(t=e===Es||e===QB?e:e9,r=e,a=e);function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;r(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=s(l,c,d,u-1);return f>d&&a(l[f-1],c)>-a(l[f],c)?f-1:f}return{left:s,center:o,right:i}}function e9(){return 0}function fN(e){return e===null?NaN:+e}function*t9(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const r9=Qx(Es),xd=r9.right;Qx(fN).center;class wy extends Map{constructor(t,r=s9){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,s]of t)this.set(a,s)}get(t){return super.get(jy(this,t))}has(t){return super.has(jy(this,t))}set(t,r){return super.set(a9(this,t),r)}delete(t){return super.delete(n9(this,t))}}function jy({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function a9({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function n9({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function s9(e){return e!==null&&typeof e=="object"?e.valueOf():e}function i9(e=Es){if(e===Es)return hN;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function hN(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const o9=Math.sqrt(50),l9=Math.sqrt(10),c9=Math.sqrt(2);function Cu(e,t,r){const a=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(a)),i=a/Math.pow(10,s),o=i>=o9?10:i>=l9?5:i>=c9?2:1;let l,c,d;return s<0?(d=Math.pow(10,-s)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,s)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?Cu(e,t,r*2):[l,c,d]}function gm(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[s,i,o]=a?Cu(t,e,r):Cu(e,t,r);if(!(i>=s))return[];const l=i-s+1,c=new Array(l);if(a)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(s+d)/-o;else for(let d=0;d<l;++d)c[d]=(s+d)*o;return c}function vm(e,t,r){return t=+t,e=+e,r=+r,Cu(e,t,r)[2]}function ym(e,t,r){t=+t,e=+e,r=+r;const a=t<e,s=a?vm(t,e,r):vm(e,t,r);return(a?-1:1)*(s<0?1/-s:s)}function Ny(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function _y(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function mN(e,t,r=0,a=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(s=s===void 0?hN:i9(s);a>r;){if(a-r>600){const c=a-r+1,d=t-r+1,u=Math.log(c),f=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*f/c+h)),x=Math.min(a,Math.floor(t+(c-d)*f/c+h));mN(e,t,m,x,s)}const i=e[t];let o=r,l=a;for(pl(e,r,t),s(e[a],i)>0&&pl(e,r,a);o<l;){for(pl(e,o,l),++o,--l;s(e[o],i)<0;)++o;for(;s(e[l],i)>0;)--l}s(e[r],i)===0?pl(e,r,l):(++l,pl(e,l,a)),l<=t&&(r=l+1),t<=l&&(a=l-1)}return e}function pl(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function d9(e,t,r){if(e=Float64Array.from(t9(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return _y(e);if(t>=1)return Ny(e);var a,s=(a-1)*t,i=Math.floor(s),o=Ny(mN(e,i).subarray(0,i+1)),l=_y(e.subarray(i+1));return o+(l-o)*(s-i)}}function u9(e,t,r=fN){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,s=(a-1)*t,i=Math.floor(s),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(s-i)}}function f9(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var a=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(s);++a<s;)i[a]=e+a*r;return i}function Ja(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function os(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const bm=Symbol("implicit");function ep(){var e=new wy,t=[],r=[],a=bm;function s(i){let o=e.get(i);if(o===void 0){if(a!==bm)return a;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return s.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new wy;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(i){return arguments.length?(r=Array.from(i),s):r.slice()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return ep(t,r).unknown(a)},Ja.apply(s,arguments),s}function gc(){var e=ep().unknown(void 0),t=e.domain,r=e.range,a=0,s=1,i,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var h=t().length,m=s<a,x=m?s:a,p=m?a:s;i=(p-x)/Math.max(1,h-c+d*2),l&&(i=Math.floor(i)),x+=(p-x-i*(h-c))*u,o=i*(1-c),l&&(x=Math.round(x),o=Math.round(o));var g=f9(h).map(function(y){return x+i*y});return r(m?g.reverse():g)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([a,s]=h,a=+a,s=+s,f()):[a,s]},e.rangeRound=function(h){return[a,s]=h,a=+a,s=+s,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,d=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(d=+h,f()):d},e.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},e.copy=function(){return gc(t(),[a,s]).round(l).paddingInner(c).paddingOuter(d).align(u)},Ja.apply(f(),arguments)}function xN(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return xN(t())},e}function Bl(){return xN(gc.apply(null,arguments).paddingInner(1))}function tp(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function pN(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function pd(){}var vc=.7,Ou=1/vc,fo="\\s*([+-]?\\d+)\\s*",yc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",kn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",h9=/^#([0-9a-f]{3,8})$/,m9=new RegExp(`^rgb\\(${fo},${fo},${fo}\\)$`),x9=new RegExp(`^rgb\\(${kn},${kn},${kn}\\)$`),p9=new RegExp(`^rgba\\(${fo},${fo},${fo},${yc}\\)$`),g9=new RegExp(`^rgba\\(${kn},${kn},${kn},${yc}\\)$`),v9=new RegExp(`^hsl\\(${yc},${kn},${kn}\\)$`),y9=new RegExp(`^hsla\\(${yc},${kn},${kn},${yc}\\)$`),Sy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};tp(pd,bc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ky,formatHex:ky,formatHex8:b9,formatHsl:w9,formatRgb:Ey,toString:Ey});function ky(){return this.rgb().formatHex()}function b9(){return this.rgb().formatHex8()}function w9(){return gN(this).formatHsl()}function Ey(){return this.rgb().formatRgb()}function bc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=h9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Ay(t):r===3?new xa(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ld(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ld(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=m9.exec(e))?new xa(t[1],t[2],t[3],1):(t=x9.exec(e))?new xa(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=p9.exec(e))?Ld(t[1],t[2],t[3],t[4]):(t=g9.exec(e))?Ld(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=v9.exec(e))?Oy(t[1],t[2]/100,t[3]/100,1):(t=y9.exec(e))?Oy(t[1],t[2]/100,t[3]/100,t[4]):Sy.hasOwnProperty(e)?Ay(Sy[e]):e==="transparent"?new xa(NaN,NaN,NaN,0):null}function Ay(e){return new xa(e>>16&255,e>>8&255,e&255,1)}function Ld(e,t,r,a){return a<=0&&(e=t=r=NaN),new xa(e,t,r,a)}function j9(e){return e instanceof pd||(e=bc(e)),e?(e=e.rgb(),new xa(e.r,e.g,e.b,e.opacity)):new xa}function wm(e,t,r,a){return arguments.length===1?j9(e):new xa(e,t,r,a??1)}function xa(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}tp(xa,wm,pN(pd,{brighter(e){return e=e==null?Ou:Math.pow(Ou,e),new xa(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?vc:Math.pow(vc,e),new xa(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new xa(di(this.r),di(this.g),di(this.b),Pu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ty,formatHex:Ty,formatHex8:N9,formatRgb:Cy,toString:Cy}));function Ty(){return`#${ni(this.r)}${ni(this.g)}${ni(this.b)}`}function N9(){return`#${ni(this.r)}${ni(this.g)}${ni(this.b)}${ni((isNaN(this.opacity)?1:this.opacity)*255)}`}function Cy(){const e=Pu(this.opacity);return`${e===1?"rgb(":"rgba("}${di(this.r)}, ${di(this.g)}, ${di(this.b)}${e===1?")":`, ${e})`}`}function Pu(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function di(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ni(e){return e=di(e),(e<16?"0":"")+e.toString(16)}function Oy(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new sn(e,t,r,a)}function gN(e){if(e instanceof sn)return new sn(e.h,e.s,e.l,e.opacity);if(e instanceof pd||(e=bc(e)),!e)return new sn;if(e instanceof sn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,s=Math.min(t,r,a),i=Math.max(t,r,a),o=NaN,l=i-s,c=(i+s)/2;return l?(t===i?o=(r-a)/l+(r<a)*6:r===i?o=(a-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+s:2-i-s,o*=60):l=c>0&&c<1?0:o,new sn(o,l,c,e.opacity)}function _9(e,t,r,a){return arguments.length===1?gN(e):new sn(e,t,r,a??1)}function sn(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}tp(sn,_9,pN(pd,{brighter(e){return e=e==null?Ou:Math.pow(Ou,e),new sn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?vc:Math.pow(vc,e),new sn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,s=2*r-a;return new xa(Y0(e>=240?e-240:e+120,s,a),Y0(e,s,a),Y0(e<120?e+240:e-120,s,a),this.opacity)},clamp(){return new sn(Py(this.h),Bd(this.s),Bd(this.l),Pu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Pu(this.opacity);return`${e===1?"hsl(":"hsla("}${Py(this.h)}, ${Bd(this.s)*100}%, ${Bd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Py(e){return e=(e||0)%360,e<0?e+360:e}function Bd(e){return Math.max(0,Math.min(1,e||0))}function Y0(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const rp=e=>()=>e;function S9(e,t){return function(r){return e+r*t}}function k9(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function E9(e){return(e=+e)==1?vN:function(t,r){return r-t?k9(t,r,e):rp(isNaN(t)?r:t)}}function vN(e,t){var r=t-e;return r?S9(e,r):rp(isNaN(e)?t:e)}const Fy=function e(t){var r=E9(t);function a(s,i){var o=r((s=wm(s)).r,(i=wm(i)).r),l=r(s.g,i.g),c=r(s.b,i.b),d=vN(s.opacity,i.opacity);return function(u){return s.r=o(u),s.g=l(u),s.b=c(u),s.opacity=d(u),s+""}}return a.gamma=e,a}(1);function A9(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),s;return function(i){for(s=0;s<r;++s)a[s]=e[s]*(1-i)+t[s]*i;return a}}function T9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function C9(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,s=new Array(a),i=new Array(r),o;for(o=0;o<a;++o)s[o]=el(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<a;++o)i[o]=s[o](l);return i}}function O9(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function Fu(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function P9(e,t){var r={},a={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=el(e[s],t[s]):a[s]=t[s];return function(i){for(s in r)a[s]=r[s](i);return a}}var jm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,J0=new RegExp(jm.source,"g");function F9(e){return function(){return e}}function I9(e){return function(t){return e(t)+""}}function D9(e,t){var r=jm.lastIndex=J0.lastIndex=0,a,s,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(a=jm.exec(e))&&(s=J0.exec(t));)(i=s.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(a=a[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,c.push({i:o,x:Fu(a,s)})),r=J0.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?I9(c[0].x):F9(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function el(e,t){var r=typeof t,a;return t==null||r==="boolean"?rp(t):(r==="number"?Fu:r==="string"?(a=bc(t))?(t=a,Fy):D9:t instanceof bc?Fy:t instanceof Date?O9:T9(t)?A9:Array.isArray(t)?C9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?P9:Fu)(e,t)}function ap(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function R9(e,t){t===void 0&&(t=e,e=el);for(var r=0,a=t.length-1,s=t[0],i=new Array(a<0?0:a);r<a;)i[r]=e(s,s=t[++r]);return function(o){var l=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return i[l](o-l)}}function M9(e){return function(){return e}}function Iu(e){return+e}var Iy=[0,1];function oa(e){return e}function Nm(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:M9(isNaN(t)?NaN:.5)}function $9(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function L9(e,t,r){var a=e[0],s=e[1],i=t[0],o=t[1];return s<a?(a=Nm(s,a),i=r(o,i)):(a=Nm(a,s),i=r(i,o)),function(l){return i(a(l))}}function B9(e,t,r){var a=Math.min(e.length,t.length)-1,s=new Array(a),i=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)s[o]=Nm(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=xd(e,l,1,a)-1;return i[c](s[c](l))}}function gd(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function n0(){var e=Iy,t=Iy,r=el,a,s,i,o=oa,l,c,d;function u(){var h=Math.min(e.length,t.length);return o!==oa&&(o=$9(e[0],e[h-1])),l=h>2?B9:L9,c=d=null,f}function f(h){return h==null||isNaN(h=+h)?i:(c||(c=l(e.map(a),t,r)))(a(o(h)))}return f.invert=function(h){return o(s((d||(d=l(t,e.map(a),Fu)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Iu),u()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),u()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=ap,u()},f.clamp=function(h){return arguments.length?(o=h?!0:oa,u()):o!==oa},f.interpolate=function(h){return arguments.length?(r=h,u()):r},f.unknown=function(h){return arguments.length?(i=h,f):i},function(h,m){return a=h,s=m,u()}}function np(){return n0()(oa,oa)}function U9(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Du(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function So(e){return e=Du(Math.abs(e)),e?e[1]:NaN}function W9(e,t){return function(r,a){for(var s=r.length,i=[],o=0,l=e[0],c=0;s>0&&l>0&&(c+l+1>a&&(l=Math.max(1,a-c)),i.push(r.substring(s-=l,s+l)),!((c+=l+1)>a));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function H9(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var z9=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wc(e){if(!(t=z9.exec(e)))throw new Error("invalid format: "+e);var t;return new sp({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}wc.prototype=sp.prototype;function sp(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}sp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function V9(e){e:for(var t=e.length,r=1,a=-1,s;r<t;++r)switch(e[r]){case".":a=s=r;break;case"0":a===0&&(a=r),s=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(s+1):e}var yN;function G9(e,t){var r=Du(e,t);if(!r)return e+"";var a=r[0],s=r[1],i=s-(yN=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=a.length;return i===o?a:i>o?a+new Array(i-o+1).join("0"):i>0?a.slice(0,i)+"."+a.slice(i):"0."+new Array(1-i).join("0")+Du(e,Math.max(0,t+i-1))[0]}function Dy(e,t){var r=Du(e,t);if(!r)return e+"";var a=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+a:a.length>s+1?a.slice(0,s+1)+"."+a.slice(s+1):a+new Array(s-a.length+2).join("0")}const Ry={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:U9,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Dy(e*100,t),r:Dy,s:G9,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function My(e){return e}var $y=Array.prototype.map,Ly=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function q9(e){var t=e.grouping===void 0||e.thousands===void 0?My:W9($y.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?My:H9($y.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=wc(f);var h=f.fill,m=f.align,x=f.sign,p=f.symbol,g=f.zero,y=f.width,b=f.comma,v=f.precision,w=f.trim,j=f.type;j==="n"?(b=!0,j="g"):Ry[j]||(v===void 0&&(v=12),w=!0,j="g"),(g||h==="0"&&m==="=")&&(g=!0,h="0",m="=");var N=p==="$"?r:p==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():"",_=p==="$"?a:/[%p]/.test(j)?o:"",E=Ry[j],S=/[defgprs%]/.test(j);v=v===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function k(O){var P=N,A=_,R,T,F;if(j==="c")A=E(O)+A,O="";else{O=+O;var W=O<0||1/O<0;if(O=isNaN(O)?c:E(Math.abs(O),v),w&&(O=V9(O)),W&&+O==0&&x!=="+"&&(W=!1),P=(W?x==="("?x:l:x==="-"||x==="("?"":x)+P,A=(j==="s"?Ly[8+yN/3]:"")+A+(W&&x==="("?")":""),S){for(R=-1,T=O.length;++R<T;)if(F=O.charCodeAt(R),48>F||F>57){A=(F===46?s+O.slice(R+1):O.slice(R))+A,O=O.slice(0,R);break}}}b&&!g&&(O=t(O,1/0));var K=P.length+O.length+A.length,B=K<y?new Array(y-K+1).join(h):"";switch(b&&g&&(O=t(B+O,B.length?y-A.length:1/0),B=""),m){case"<":O=P+O+A+B;break;case"=":O=P+B+O+A;break;case"^":O=B.slice(0,K=B.length>>1)+P+O+A+B.slice(K);break;default:O=B+P+O+A;break}return i(O)}return k.toString=function(){return f+""},k}function u(f,h){var m=d((f=wc(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(So(h)/3)))*3,p=Math.pow(10,-x),g=Ly[8+x/3];return function(y){return m(p*y)+g}}return{format:d,formatPrefix:u}}var Ud,ip,bN;K9({thousands:",",grouping:[3],currency:["$",""]});function K9(e){return Ud=q9(e),ip=Ud.format,bN=Ud.formatPrefix,Ud}function X9(e){return Math.max(0,-So(Math.abs(e)))}function Y9(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(So(t)/3)))*3-So(Math.abs(e)))}function J9(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,So(t)-So(e))+1}function wN(e,t,r,a){var s=ym(e,t,r),i;switch(a=wc(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(i=Y9(s,o))&&(a.precision=i),bN(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(i=J9(s,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=i-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(i=X9(s))&&(a.precision=i-(a.type==="%")*2);break}}return ip(a)}function Ls(e){var t=e.domain;return e.ticks=function(r){var a=t();return gm(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var s=t();return wN(s[0],s[s.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),s=0,i=a.length-1,o=a[s],l=a[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=s,s=i,i=d);u-- >0;){if(d=vm(o,l,r),d===c)return a[s]=o,a[i]=l,t(a);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function Ru(){var e=np();return e.copy=function(){return gd(e,Ru())},Ja.apply(e,arguments),Ls(e)}function jN(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,Iu),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return jN(e).unknown(t)},e=arguments.length?Array.from(e,Iu):[0,1],Ls(r)}function NN(e,t){e=e.slice();var r=0,a=e.length-1,s=e[r],i=e[a],o;return i<s&&(o=r,r=a,a=o,o=s,s=i,i=o),e[r]=t.floor(s),e[a]=t.ceil(i),e}function By(e){return Math.log(e)}function Uy(e){return Math.exp(e)}function Z9(e){return-Math.log(-e)}function Q9(e){return-Math.exp(-e)}function eU(e){return isFinite(e)?+("1e"+e):e<0?0:e}function tU(e){return e===10?eU:e===Math.E?Math.exp:t=>Math.pow(e,t)}function rU(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Wy(e){return(t,r)=>-e(-t,r)}function op(e){const t=e(By,Uy),r=t.domain;let a=10,s,i;function o(){return s=rU(a),i=tU(a),r()[0]<0?(s=Wy(s),i=Wy(i),e(Z9,Q9)):e(By,Uy),t}return t.base=function(l){return arguments.length?(a=+l,o()):a},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let h=s(d),m=s(u),x,p;const g=l==null?10:+l;let y=[];if(!(a%1)&&m-h<g){if(h=Math.floor(h),m=Math.ceil(m),d>0){for(;h<=m;++h)for(x=1;x<a;++x)if(p=h<0?x/i(-h):x*i(h),!(p<d)){if(p>u)break;y.push(p)}}else for(;h<=m;++h)for(x=a-1;x>=1;--x)if(p=h>0?x/i(-h):x*i(h),!(p<d)){if(p>u)break;y.push(p)}y.length*2<g&&(y=gm(d,u,g))}else y=gm(h,m,Math.min(m-h,g)).map(i);return f?y.reverse():y},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=a===10?"s":","),typeof c!="function"&&(!(a%1)&&(c=wc(c)).precision==null&&(c.trim=!0),c=ip(c)),l===1/0)return c;const d=Math.max(1,a*l/t.ticks().length);return u=>{let f=u/i(Math.round(s(u)));return f*a<a-.5&&(f*=a),f<=d?c(u):""}},t.nice=()=>r(NN(r(),{floor:l=>i(Math.floor(s(l))),ceil:l=>i(Math.ceil(s(l)))})),t}function _N(){const e=op(n0()).domain([1,10]);return e.copy=()=>gd(e,_N()).base(e.base()),Ja.apply(e,arguments),e}function Hy(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function zy(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function lp(e){var t=1,r=e(Hy(t),zy(t));return r.constant=function(a){return arguments.length?e(Hy(t=+a),zy(t)):t},Ls(r)}function SN(){var e=lp(n0());return e.copy=function(){return gd(e,SN()).constant(e.constant())},Ja.apply(e,arguments)}function Vy(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function aU(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function nU(e){return e<0?-e*e:e*e}function cp(e){var t=e(oa,oa),r=1;function a(){return r===1?e(oa,oa):r===.5?e(aU,nU):e(Vy(r),Vy(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,a()):r},Ls(t)}function dp(){var e=cp(n0());return e.copy=function(){return gd(e,dp()).exponent(e.exponent())},Ja.apply(e,arguments),e}function sU(){return dp.apply(null,arguments).exponent(.5)}function Gy(e){return Math.sign(e)*e*e}function iU(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function kN(){var e=np(),t=[0,1],r=!1,a;function s(i){var o=iU(e(i));return isNaN(o)?a:r?Math.round(o):o}return s.invert=function(i){return e.invert(Gy(i))},s.domain=function(i){return arguments.length?(e.domain(i),s):e.domain()},s.range=function(i){return arguments.length?(e.range((t=Array.from(i,Iu)).map(Gy)),s):t.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(r=!!i,s):r},s.clamp=function(i){return arguments.length?(e.clamp(i),s):e.clamp()},s.unknown=function(i){return arguments.length?(a=i,s):a},s.copy=function(){return kN(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},Ja.apply(s,arguments),Ls(s)}function EN(){var e=[],t=[],r=[],a;function s(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=u9(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?a:t[xd(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Es),s()},i.range=function(o){return arguments.length?(t=Array.from(o),s()):t.slice()},i.unknown=function(o){return arguments.length?(a=o,i):a},i.quantiles=function(){return r.slice()},i.copy=function(){return EN().domain(e).range(t).unknown(a)},Ja.apply(i,arguments)}function AN(){var e=0,t=1,r=1,a=[.5],s=[0,1],i;function o(c){return c!=null&&c<=c?s[xd(a,c,0,r)]:i}function l(){var c=-1;for(a=new Array(r);++c<r;)a[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,l()):s.slice()},o.invertExtent=function(c){var d=s.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,a[0]]:d>=r?[a[r-1],t]:[a[d-1],a[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return a.slice()},o.copy=function(){return AN().domain([e,t]).range(s).unknown(i)},Ja.apply(Ls(o),arguments)}function TN(){var e=[.5],t=[0,1],r,a=1;function s(i){return i!=null&&i<=i?t[xd(e,i,0,a)]:r}return s.domain=function(i){return arguments.length?(e=Array.from(i),a=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(i){return arguments.length?(t=Array.from(i),a=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return TN().domain(e).range(t).unknown(r)},Ja.apply(s,arguments)}const Z0=new Date,Q0=new Date;function Nr(e,t,r,a){function s(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(e(i=new Date(+i)),i),s.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),s.round=i=>{const o=s(i),l=s.ceil(i);return i-o<l-i?o:l},s.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,l)=>{const c=[];if(i=s.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),e(i);while(d<i&&i<o);return c},s.filter=i=>Nr(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(s.count=(i,o)=>(Z0.setTime(+i),Q0.setTime(+o),e(Z0),e(Q0),Math.floor(r(Z0,Q0))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(a?o=>a(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const Mu=Nr(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Mu.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Nr(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Mu);Mu.range;const Wn=1e3,Va=Wn*60,Hn=Va*60,ts=Hn*24,up=ts*7,qy=ts*30,eh=ts*365,si=Nr(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Wn)},(e,t)=>(t-e)/Wn,e=>e.getUTCSeconds());si.range;const fp=Nr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wn)},(e,t)=>{e.setTime(+e+t*Va)},(e,t)=>(t-e)/Va,e=>e.getMinutes());fp.range;const hp=Nr(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Va)},(e,t)=>(t-e)/Va,e=>e.getUTCMinutes());hp.range;const mp=Nr(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Wn-e.getMinutes()*Va)},(e,t)=>{e.setTime(+e+t*Hn)},(e,t)=>(t-e)/Hn,e=>e.getHours());mp.range;const xp=Nr(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Hn)},(e,t)=>(t-e)/Hn,e=>e.getUTCHours());xp.range;const vd=Nr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Va)/ts,e=>e.getDate()-1);vd.range;const s0=Nr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ts,e=>e.getUTCDate()-1);s0.range;const CN=Nr(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ts,e=>Math.floor(e/ts));CN.range;function $i(e){return Nr(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Va)/up)}const i0=$i(0),$u=$i(1),oU=$i(2),lU=$i(3),ko=$i(4),cU=$i(5),dU=$i(6);i0.range;$u.range;oU.range;lU.range;ko.range;cU.range;dU.range;function Li(e){return Nr(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/up)}const o0=Li(0),Lu=Li(1),uU=Li(2),fU=Li(3),Eo=Li(4),hU=Li(5),mU=Li(6);o0.range;Lu.range;uU.range;fU.range;Eo.range;hU.range;mU.range;const pp=Nr(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());pp.range;const gp=Nr(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());gp.range;const rs=Nr(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());rs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Nr(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});rs.range;const as=Nr(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());as.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Nr(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});as.range;function ON(e,t,r,a,s,i){const o=[[si,1,Wn],[si,5,5*Wn],[si,15,15*Wn],[si,30,30*Wn],[i,1,Va],[i,5,5*Va],[i,15,15*Va],[i,30,30*Va],[s,1,Hn],[s,3,3*Hn],[s,6,6*Hn],[s,12,12*Hn],[a,1,ts],[a,2,2*ts],[r,1,up],[t,1,qy],[t,3,3*qy],[e,1,eh]];function l(d,u,f){const h=u<d;h&&([d,u]=[u,d]);const m=f&&typeof f.range=="function"?f:c(d,u,f),x=m?m.range(d,+u+1):[];return h?x.reverse():x}function c(d,u,f){const h=Math.abs(u-d)/f,m=Qx(([,,g])=>g).right(o,h);if(m===o.length)return e.every(ym(d/eh,u/eh,f));if(m===0)return Mu.every(Math.max(ym(d,u,f),1));const[x,p]=o[h/o[m-1][2]<o[m][2]/h?m-1:m];return x.every(p)}return[l,c]}const[xU,pU]=ON(as,gp,o0,CN,xp,hp),[gU,vU]=ON(rs,pp,i0,vd,mp,fp);function th(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function rh(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function gl(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function yU(e){var t=e.dateTime,r=e.date,a=e.time,s=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=vl(s),u=yl(s),f=vl(i),h=yl(i),m=vl(o),x=yl(o),p=vl(l),g=yl(l),y=vl(c),b=yl(c),v={a:W,A:K,b:B,B:L,c:null,d:Qy,e:Qy,f:WU,g:ZU,G:eW,H:LU,I:BU,j:UU,L:PN,m:HU,M:zU,p:ee,q:M,Q:rb,s:ab,S:VU,u:GU,U:qU,V:KU,w:XU,W:YU,x:null,X:null,y:JU,Y:QU,Z:tW,"%":tb},w={a:G,A:V,b:H,B:re,c:null,d:eb,e:eb,f:sW,g:xW,G:gW,H:rW,I:aW,j:nW,L:IN,m:iW,M:oW,p:me,q:xe,Q:rb,s:ab,S:lW,u:cW,U:dW,V:uW,w:fW,W:hW,x:null,X:null,y:mW,Y:pW,Z:vW,"%":tb},j={a:k,A:O,b:P,B:A,c:R,d:Jy,e:Jy,f:DU,g:Yy,G:Xy,H:Zy,I:Zy,j:OU,L:IU,m:CU,M:PU,p:S,q:TU,Q:MU,s:$U,S:FU,u:_U,U:SU,V:kU,w:NU,W:EU,x:T,X:F,y:Yy,Y:Xy,Z:AU,"%":RU};v.x=N(r,v),v.X=N(a,v),v.c=N(t,v),w.x=N(r,w),w.X=N(a,w),w.c=N(t,w);function N(Z,q){return function(ie){var I=[],ve=-1,we=0,Ee=Z.length,ce,fe,oe;for(ie instanceof Date||(ie=new Date(+ie));++ve<Ee;)Z.charCodeAt(ve)===37&&(I.push(Z.slice(we,ve)),(fe=Ky[ce=Z.charAt(++ve)])!=null?ce=Z.charAt(++ve):fe=ce==="e"?" ":"0",(oe=q[ce])&&(ce=oe(ie,fe)),I.push(ce),we=ve+1);return I.push(Z.slice(we,ve)),I.join("")}}function _(Z,q){return function(ie){var I=gl(1900,void 0,1),ve=E(I,Z,ie+="",0),we,Ee;if(ve!=ie.length)return null;if("Q"in I)return new Date(I.Q);if("s"in I)return new Date(I.s*1e3+("L"in I?I.L:0));if(q&&!("Z"in I)&&(I.Z=0),"p"in I&&(I.H=I.H%12+I.p*12),I.m===void 0&&(I.m="q"in I?I.q:0),"V"in I){if(I.V<1||I.V>53)return null;"w"in I||(I.w=1),"Z"in I?(we=rh(gl(I.y,0,1)),Ee=we.getUTCDay(),we=Ee>4||Ee===0?Lu.ceil(we):Lu(we),we=s0.offset(we,(I.V-1)*7),I.y=we.getUTCFullYear(),I.m=we.getUTCMonth(),I.d=we.getUTCDate()+(I.w+6)%7):(we=th(gl(I.y,0,1)),Ee=we.getDay(),we=Ee>4||Ee===0?$u.ceil(we):$u(we),we=vd.offset(we,(I.V-1)*7),I.y=we.getFullYear(),I.m=we.getMonth(),I.d=we.getDate()+(I.w+6)%7)}else("W"in I||"U"in I)&&("w"in I||(I.w="u"in I?I.u%7:"W"in I?1:0),Ee="Z"in I?rh(gl(I.y,0,1)).getUTCDay():th(gl(I.y,0,1)).getDay(),I.m=0,I.d="W"in I?(I.w+6)%7+I.W*7-(Ee+5)%7:I.w+I.U*7-(Ee+6)%7);return"Z"in I?(I.H+=I.Z/100|0,I.M+=I.Z%100,rh(I)):th(I)}}function E(Z,q,ie,I){for(var ve=0,we=q.length,Ee=ie.length,ce,fe;ve<we;){if(I>=Ee)return-1;if(ce=q.charCodeAt(ve++),ce===37){if(ce=q.charAt(ve++),fe=j[ce in Ky?q.charAt(ve++):ce],!fe||(I=fe(Z,ie,I))<0)return-1}else if(ce!=ie.charCodeAt(I++))return-1}return I}function S(Z,q,ie){var I=d.exec(q.slice(ie));return I?(Z.p=u.get(I[0].toLowerCase()),ie+I[0].length):-1}function k(Z,q,ie){var I=m.exec(q.slice(ie));return I?(Z.w=x.get(I[0].toLowerCase()),ie+I[0].length):-1}function O(Z,q,ie){var I=f.exec(q.slice(ie));return I?(Z.w=h.get(I[0].toLowerCase()),ie+I[0].length):-1}function P(Z,q,ie){var I=y.exec(q.slice(ie));return I?(Z.m=b.get(I[0].toLowerCase()),ie+I[0].length):-1}function A(Z,q,ie){var I=p.exec(q.slice(ie));return I?(Z.m=g.get(I[0].toLowerCase()),ie+I[0].length):-1}function R(Z,q,ie){return E(Z,t,q,ie)}function T(Z,q,ie){return E(Z,r,q,ie)}function F(Z,q,ie){return E(Z,a,q,ie)}function W(Z){return o[Z.getDay()]}function K(Z){return i[Z.getDay()]}function B(Z){return c[Z.getMonth()]}function L(Z){return l[Z.getMonth()]}function ee(Z){return s[+(Z.getHours()>=12)]}function M(Z){return 1+~~(Z.getMonth()/3)}function G(Z){return o[Z.getUTCDay()]}function V(Z){return i[Z.getUTCDay()]}function H(Z){return c[Z.getUTCMonth()]}function re(Z){return l[Z.getUTCMonth()]}function me(Z){return s[+(Z.getUTCHours()>=12)]}function xe(Z){return 1+~~(Z.getUTCMonth()/3)}return{format:function(Z){var q=N(Z+="",v);return q.toString=function(){return Z},q},parse:function(Z){var q=_(Z+="",!1);return q.toString=function(){return Z},q},utcFormat:function(Z){var q=N(Z+="",w);return q.toString=function(){return Z},q},utcParse:function(Z){var q=_(Z+="",!0);return q.toString=function(){return Z},q}}}var Ky={"-":"",_:" ",0:"0"},Ir=/^\s*\d+/,bU=/^%/,wU=/[\\^$*+?|[\]().{}]/g;function gt(e,t,r){var a=e<0?"-":"",s=(a?-e:e)+"",i=s.length;return a+(i<r?new Array(r-i+1).join(t)+s:s)}function jU(e){return e.replace(wU,"\\$&")}function vl(e){return new RegExp("^(?:"+e.map(jU).join("|")+")","i")}function yl(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function NU(e,t,r){var a=Ir.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function _U(e,t,r){var a=Ir.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function SU(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function kU(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function EU(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function Xy(e,t,r){var a=Ir.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function Yy(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function AU(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function TU(e,t,r){var a=Ir.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function CU(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function Jy(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function OU(e,t,r){var a=Ir.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function Zy(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function PU(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function FU(e,t,r){var a=Ir.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function IU(e,t,r){var a=Ir.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function DU(e,t,r){var a=Ir.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function RU(e,t,r){var a=bU.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function MU(e,t,r){var a=Ir.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function $U(e,t,r){var a=Ir.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function Qy(e,t){return gt(e.getDate(),t,2)}function LU(e,t){return gt(e.getHours(),t,2)}function BU(e,t){return gt(e.getHours()%12||12,t,2)}function UU(e,t){return gt(1+vd.count(rs(e),e),t,3)}function PN(e,t){return gt(e.getMilliseconds(),t,3)}function WU(e,t){return PN(e,t)+"000"}function HU(e,t){return gt(e.getMonth()+1,t,2)}function zU(e,t){return gt(e.getMinutes(),t,2)}function VU(e,t){return gt(e.getSeconds(),t,2)}function GU(e){var t=e.getDay();return t===0?7:t}function qU(e,t){return gt(i0.count(rs(e)-1,e),t,2)}function FN(e){var t=e.getDay();return t>=4||t===0?ko(e):ko.ceil(e)}function KU(e,t){return e=FN(e),gt(ko.count(rs(e),e)+(rs(e).getDay()===4),t,2)}function XU(e){return e.getDay()}function YU(e,t){return gt($u.count(rs(e)-1,e),t,2)}function JU(e,t){return gt(e.getFullYear()%100,t,2)}function ZU(e,t){return e=FN(e),gt(e.getFullYear()%100,t,2)}function QU(e,t){return gt(e.getFullYear()%1e4,t,4)}function eW(e,t){var r=e.getDay();return e=r>=4||r===0?ko(e):ko.ceil(e),gt(e.getFullYear()%1e4,t,4)}function tW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+gt(t/60|0,"0",2)+gt(t%60,"0",2)}function eb(e,t){return gt(e.getUTCDate(),t,2)}function rW(e,t){return gt(e.getUTCHours(),t,2)}function aW(e,t){return gt(e.getUTCHours()%12||12,t,2)}function nW(e,t){return gt(1+s0.count(as(e),e),t,3)}function IN(e,t){return gt(e.getUTCMilliseconds(),t,3)}function sW(e,t){return IN(e,t)+"000"}function iW(e,t){return gt(e.getUTCMonth()+1,t,2)}function oW(e,t){return gt(e.getUTCMinutes(),t,2)}function lW(e,t){return gt(e.getUTCSeconds(),t,2)}function cW(e){var t=e.getUTCDay();return t===0?7:t}function dW(e,t){return gt(o0.count(as(e)-1,e),t,2)}function DN(e){var t=e.getUTCDay();return t>=4||t===0?Eo(e):Eo.ceil(e)}function uW(e,t){return e=DN(e),gt(Eo.count(as(e),e)+(as(e).getUTCDay()===4),t,2)}function fW(e){return e.getUTCDay()}function hW(e,t){return gt(Lu.count(as(e)-1,e),t,2)}function mW(e,t){return gt(e.getUTCFullYear()%100,t,2)}function xW(e,t){return e=DN(e),gt(e.getUTCFullYear()%100,t,2)}function pW(e,t){return gt(e.getUTCFullYear()%1e4,t,4)}function gW(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Eo(e):Eo.ceil(e),gt(e.getUTCFullYear()%1e4,t,4)}function vW(){return"+0000"}function tb(){return"%"}function rb(e){return+e}function ab(e){return Math.floor(+e/1e3)}var Ki,RN,MN;yW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function yW(e){return Ki=yU(e),RN=Ki.format,Ki.parse,MN=Ki.utcFormat,Ki.utcParse,Ki}function bW(e){return new Date(e)}function wW(e){return e instanceof Date?+e:+new Date(+e)}function vp(e,t,r,a,s,i,o,l,c,d){var u=np(),f=u.invert,h=u.domain,m=d(".%L"),x=d(":%S"),p=d("%I:%M"),g=d("%I %p"),y=d("%a %d"),b=d("%b %d"),v=d("%B"),w=d("%Y");function j(N){return(c(N)<N?m:l(N)<N?x:o(N)<N?p:i(N)<N?g:a(N)<N?s(N)<N?y:b:r(N)<N?v:w)(N)}return u.invert=function(N){return new Date(f(N))},u.domain=function(N){return arguments.length?h(Array.from(N,wW)):h().map(bW)},u.ticks=function(N){var _=h();return e(_[0],_[_.length-1],N??10)},u.tickFormat=function(N,_){return _==null?j:d(_)},u.nice=function(N){var _=h();return(!N||typeof N.range!="function")&&(N=t(_[0],_[_.length-1],N??10)),N?h(NN(_,N)):u},u.copy=function(){return gd(u,vp(e,t,r,a,s,i,o,l,c,d))},u}function jW(){return Ja.apply(vp(gU,vU,rs,pp,i0,vd,mp,fp,si,RN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function NW(){return Ja.apply(vp(xU,pU,as,gp,o0,s0,xp,hp,si,MN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function l0(){var e=0,t=1,r,a,s,i,o=oa,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(s===0?.5:(f=(i(f)-r)*s,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,r=i(e=+e),a=i(t=+t),s=r===a?0:1/(a-r),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(h){var m,x;return arguments.length?([m,x]=h,o=f(m,x),d):[o(0),o(1)]}}return d.range=u(el),d.rangeRound=u(ap),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,r=f(e),a=f(t),s=r===a?0:1/(a-r),d}}function Bs(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function $N(){var e=Ls(l0()(oa));return e.copy=function(){return Bs(e,$N())},os.apply(e,arguments)}function LN(){var e=op(l0()).domain([1,10]);return e.copy=function(){return Bs(e,LN()).base(e.base())},os.apply(e,arguments)}function BN(){var e=lp(l0());return e.copy=function(){return Bs(e,BN()).constant(e.constant())},os.apply(e,arguments)}function yp(){var e=cp(l0());return e.copy=function(){return Bs(e,yp()).exponent(e.exponent())},os.apply(e,arguments)}function _W(){return yp.apply(null,arguments).exponent(.5)}function UN(){var e=[],t=oa;function r(a){if(a!=null&&!isNaN(a=+a))return t((xd(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Es),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,s)=>t(s/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(s,i)=>d9(e,i/a))},r.copy=function(){return UN(t).domain(e)},os.apply(r,arguments)}function c0(){var e=0,t=.5,r=1,a=1,s,i,o,l,c,d=oa,u,f=!1,h;function m(p){return isNaN(p=+p)?h:(p=.5+((p=+u(p))-i)*(a*p<a*i?l:c),d(f?Math.max(0,Math.min(1,p)):p))}m.domain=function(p){return arguments.length?([e,t,r]=p,s=u(e=+e),i=u(t=+t),o=u(r=+r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),a=i<s?-1:1,m):[e,t,r]},m.clamp=function(p){return arguments.length?(f=!!p,m):f},m.interpolator=function(p){return arguments.length?(d=p,m):d};function x(p){return function(g){var y,b,v;return arguments.length?([y,b,v]=g,d=R9(p,[y,b,v]),m):[d(0),d(.5),d(1)]}}return m.range=x(el),m.rangeRound=x(ap),m.unknown=function(p){return arguments.length?(h=p,m):h},function(p){return u=p,s=p(e),i=p(t),o=p(r),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),a=i<s?-1:1,m}}function WN(){var e=Ls(c0()(oa));return e.copy=function(){return Bs(e,WN())},os.apply(e,arguments)}function HN(){var e=op(c0()).domain([.1,1,10]);return e.copy=function(){return Bs(e,HN()).base(e.base())},os.apply(e,arguments)}function zN(){var e=lp(c0());return e.copy=function(){return Bs(e,zN()).constant(e.constant())},os.apply(e,arguments)}function bp(){var e=cp(c0());return e.copy=function(){return Bs(e,bp()).exponent(e.exponent())},os.apply(e,arguments)}function SW(){return bp.apply(null,arguments).exponent(.5)}const nb=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:gc,scaleDiverging:WN,scaleDivergingLog:HN,scaleDivergingPow:bp,scaleDivergingSqrt:SW,scaleDivergingSymlog:zN,scaleIdentity:jN,scaleImplicit:bm,scaleLinear:Ru,scaleLog:_N,scaleOrdinal:ep,scalePoint:Bl,scalePow:dp,scaleQuantile:EN,scaleQuantize:AN,scaleRadial:kN,scaleSequential:$N,scaleSequentialLog:LN,scaleSequentialPow:yp,scaleSequentialQuantile:UN,scaleSequentialSqrt:_W,scaleSequentialSymlog:BN,scaleSqrt:sU,scaleSymlog:SN,scaleThreshold:TN,scaleTime:jW,scaleUtc:NW,tickFormat:wN},Symbol.toStringTag,{value:"Module"}));var tl=1e9,kW={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},jp,Wt=!0,Xa="[DecimalError] ",ui=Xa+"Invalid argument: ",wp=Xa+"Exponent out of range: ",rl=Math.floor,Ys=Math.pow,EW=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,_a,Sr=1e7,Mt=7,VN=9007199254740991,Bu=rl(VN/Mt),Oe={};Oe.absoluteValue=Oe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Oe.comparedTo=Oe.cmp=function(e){var t,r,a,s,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(a=i.d.length,s=e.d.length,t=0,r=a<s?a:s;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return a===s?0:a>s^i.s<0?1:-1};Oe.decimalPlaces=Oe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Mt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Oe.dividedBy=Oe.div=function(e){return Kn(this,new this.constructor(e))};Oe.dividedToIntegerBy=Oe.idiv=function(e){var t=this,r=t.constructor;return Pt(Kn(t,new r(e),0,1),r.precision)};Oe.equals=Oe.eq=function(e){return!this.cmp(e)};Oe.exponent=function(){return mr(this)};Oe.greaterThan=Oe.gt=function(e){return this.cmp(e)>0};Oe.greaterThanOrEqualTo=Oe.gte=function(e){return this.cmp(e)>=0};Oe.isInteger=Oe.isint=function(){return this.e>this.d.length-2};Oe.isNegative=Oe.isneg=function(){return this.s<0};Oe.isPositive=Oe.ispos=function(){return this.s>0};Oe.isZero=function(){return this.s===0};Oe.lessThan=Oe.lt=function(e){return this.cmp(e)<0};Oe.lessThanOrEqualTo=Oe.lte=function(e){return this.cmp(e)<1};Oe.logarithm=Oe.log=function(e){var t,r=this,a=r.constructor,s=a.precision,i=s+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(_a))throw Error(Xa+"NaN");if(r.s<1)throw Error(Xa+(r.s?"NaN":"-Infinity"));return r.eq(_a)?new a(0):(Wt=!1,t=Kn(jc(r,i),jc(e,i),i),Wt=!0,Pt(t,s))};Oe.minus=Oe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?KN(t,e):GN(t,(e.s=-e.s,e))};Oe.modulo=Oe.mod=function(e){var t,r=this,a=r.constructor,s=a.precision;if(e=new a(e),!e.s)throw Error(Xa+"NaN");return r.s?(Wt=!1,t=Kn(r,e,0,1).times(e),Wt=!0,r.minus(t)):Pt(new a(r),s)};Oe.naturalExponential=Oe.exp=function(){return qN(this)};Oe.naturalLogarithm=Oe.ln=function(){return jc(this)};Oe.negated=Oe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Oe.plus=Oe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?GN(t,e):KN(t,(e.s=-e.s,e))};Oe.precision=Oe.sd=function(e){var t,r,a,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ui+e);if(t=mr(s)+1,a=s.d.length-1,r=a*Mt+1,a=s.d[a],a){for(;a%10==0;a/=10)r--;for(a=s.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};Oe.squareRoot=Oe.sqrt=function(){var e,t,r,a,s,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Xa+"NaN")}for(e=mr(l),Wt=!1,s=Math.sqrt(+l),s==0||s==1/0?(t=wn(l.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=rl((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new c(t)):a=new c(s.toString()),r=c.precision,s=o=r+3;;)if(i=a,a=i.plus(Kn(l,i,o+2)).times(.5),wn(i.d).slice(0,o)===(t=wn(a.d)).slice(0,o)){if(t=t.slice(o-3,o+1),s==o&&t=="4999"){if(Pt(i,r+1,0),i.times(i).eq(l)){a=i;break}}else if(t!="9999")break;o+=4}return Wt=!0,Pt(a,r)};Oe.times=Oe.mul=function(e){var t,r,a,s,i,o,l,c,d,u=this,f=u.constructor,h=u.d,m=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,c=h.length,d=m.length,c<d&&(i=h,h=m,m=i,o=c,c=d,d=o),i=[],o=c+d,a=o;a--;)i.push(0);for(a=d;--a>=0;){for(t=0,s=c+a;s>a;)l=i[s]+m[a]*h[s-a-1]+t,i[s--]=l%Sr|0,t=l/Sr|0;i[s]=(i[s]+t)%Sr|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Wt?Pt(e,f.precision):e};Oe.toDecimalPlaces=Oe.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(On(e,0,tl),t===void 0?t=a.rounding:On(t,0,8),Pt(r,e+mr(r)+1,t))};Oe.toExponential=function(e,t){var r,a=this,s=a.constructor;return e===void 0?r=Si(a,!0):(On(e,0,tl),t===void 0?t=s.rounding:On(t,0,8),a=Pt(new s(a),e+1,t),r=Si(a,!0,e+1)),r};Oe.toFixed=function(e,t){var r,a,s=this,i=s.constructor;return e===void 0?Si(s):(On(e,0,tl),t===void 0?t=i.rounding:On(t,0,8),a=Pt(new i(s),e+mr(s)+1,t),r=Si(a.abs(),!1,e+mr(a)+1),s.isneg()&&!s.isZero()?"-"+r:r)};Oe.toInteger=Oe.toint=function(){var e=this,t=e.constructor;return Pt(new t(e),mr(e)+1,t.rounding)};Oe.toNumber=function(){return+this};Oe.toPower=Oe.pow=function(e){var t,r,a,s,i,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(_a);if(l=new c(l),!l.s){if(e.s<1)throw Error(Xa+"Infinity");return l}if(l.eq(_a))return l;if(a=c.precision,e.eq(_a))return Pt(l,a);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=VN){for(s=new c(_a),t=Math.ceil(a/Mt+4),Wt=!1;r%2&&(s=s.times(l),ib(s.d,t)),r=rl(r/2),r!==0;)l=l.times(l),ib(l.d,t);return Wt=!0,e.s<0?new c(_a).div(s):Pt(s,a)}}else if(i<0)throw Error(Xa+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,Wt=!1,s=e.times(jc(l,a+d)),Wt=!0,s=qN(s),s.s=i,s};Oe.toPrecision=function(e,t){var r,a,s=this,i=s.constructor;return e===void 0?(r=mr(s),a=Si(s,r<=i.toExpNeg||r>=i.toExpPos)):(On(e,1,tl),t===void 0?t=i.rounding:On(t,0,8),s=Pt(new i(s),e,t),r=mr(s),a=Si(s,e<=r||r<=i.toExpNeg,e)),a};Oe.toSignificantDigits=Oe.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(On(e,1,tl),t===void 0?t=a.rounding:On(t,0,8)),Pt(new a(r),e,t)};Oe.toString=Oe.valueOf=Oe.val=Oe.toJSON=Oe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=mr(e),r=e.constructor;return Si(e,t<=r.toExpNeg||t>=r.toExpPos)};function GN(e,t){var r,a,s,i,o,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Wt?Pt(t,f):t;if(c=e.d,d=t.d,o=e.e,s=t.e,c=c.slice(),i=o-s,i){for(i<0?(a=c,i=-i,l=d.length):(a=d,s=o,l=c.length),o=Math.ceil(f/Mt),l=o>l?o+1:l+1,i>l&&(i=l,a.length=1),a.reverse();i--;)a.push(0);a.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,a=d,d=c,c=a),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/Sr|0,c[i]%=Sr;for(r&&(c.unshift(r),++s),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=s,Wt?Pt(t,f):t}function On(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ui+e)}function wn(e){var t,r,a,s=e.length-1,i="",o=e[0];if(s>0){for(i+=o,t=1;t<s;t++)a=e[t]+"",r=Mt-a.length,r&&(i+=ys(r)),i+=a;o=e[t],a=o+"",r=Mt-a.length,r&&(i+=ys(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Kn=function(){function e(a,s){var i,o=0,l=a.length;for(a=a.slice();l--;)i=a[l]*s+o,a[l]=i%Sr|0,o=i/Sr|0;return o&&a.unshift(o),a}function t(a,s,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(a[l]!=s[l]){c=a[l]>s[l]?1:-1;break}return c}function r(a,s,i){for(var o=0;i--;)a[i]-=o,o=a[i]<s[i]?1:0,a[i]=o*Sr+a[i]-s[i];for(;!a[0]&&a.length>1;)a.shift()}return function(a,s,i,o){var l,c,d,u,f,h,m,x,p,g,y,b,v,w,j,N,_,E,S=a.constructor,k=a.s==s.s?1:-1,O=a.d,P=s.d;if(!a.s)return new S(a);if(!s.s)throw Error(Xa+"Division by zero");for(c=a.e-s.e,_=P.length,j=O.length,m=new S(k),x=m.d=[],d=0;P[d]==(O[d]||0);)++d;if(P[d]>(O[d]||0)&&--c,i==null?b=i=S.precision:o?b=i+(mr(a)-mr(s))+1:b=i,b<0)return new S(0);if(b=b/Mt+2|0,d=0,_==1)for(u=0,P=P[0],b++;(d<j||u)&&b--;d++)v=u*Sr+(O[d]||0),x[d]=v/P|0,u=v%P|0;else{for(u=Sr/(P[0]+1)|0,u>1&&(P=e(P,u),O=e(O,u),_=P.length,j=O.length),w=_,p=O.slice(0,_),g=p.length;g<_;)p[g++]=0;E=P.slice(),E.unshift(0),N=P[0],P[1]>=Sr/2&&++N;do u=0,l=t(P,p,_,g),l<0?(y=p[0],_!=g&&(y=y*Sr+(p[1]||0)),u=y/N|0,u>1?(u>=Sr&&(u=Sr-1),f=e(P,u),h=f.length,g=p.length,l=t(f,p,h,g),l==1&&(u--,r(f,_<h?E:P,h))):(u==0&&(l=u=1),f=P.slice()),h=f.length,h<g&&f.unshift(0),r(p,f,g),l==-1&&(g=p.length,l=t(P,p,_,g),l<1&&(u++,r(p,_<g?E:P,g))),g=p.length):l===0&&(u++,p=[0]),x[d++]=u,l&&p[0]?p[g++]=O[w]||0:(p=[O[w]],g=1);while((w++<j||p[0]!==void 0)&&b--)}return x[0]||x.shift(),m.e=c,Pt(m,o?i+mr(m)+1:i)}}();function qN(e,t){var r,a,s,i,o,l,c=0,d=0,u=e.constructor,f=u.precision;if(mr(e)>16)throw Error(wp+mr(e));if(!e.s)return new u(_a);for(Wt=!1,l=f,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(a=Math.log(Ys(2,d))/Math.LN10*2+5|0,l+=a,r=s=i=new u(_a),u.precision=l;;){if(s=Pt(s.times(e),l),r=r.times(++c),o=i.plus(Kn(s,r,l)),wn(o.d).slice(0,l)===wn(i.d).slice(0,l)){for(;d--;)i=Pt(i.times(i),l);return u.precision=f,t==null?(Wt=!0,Pt(i,f)):i}i=o}}function mr(e){for(var t=e.e*Mt,r=e.d[0];r>=10;r/=10)t++;return t}function ah(e,t,r){if(t>e.LN10.sd())throw Wt=!0,r&&(e.precision=r),Error(Xa+"LN10 precision limit exceeded");return Pt(new e(e.LN10),t)}function ys(e){for(var t="";e--;)t+="0";return t}function jc(e,t){var r,a,s,i,o,l,c,d,u,f=1,h=10,m=e,x=m.d,p=m.constructor,g=p.precision;if(m.s<1)throw Error(Xa+(m.s?"NaN":"-Infinity"));if(m.eq(_a))return new p(0);if(t==null?(Wt=!1,d=g):d=t,m.eq(10))return t==null&&(Wt=!0),ah(p,d);if(d+=h,p.precision=d,r=wn(x),a=r.charAt(0),i=mr(m),Math.abs(i)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)m=m.times(e),r=wn(m.d),a=r.charAt(0),f++;i=mr(m),a>1?(m=new p("0."+r),i++):m=new p(a+"."+r.slice(1))}else return c=ah(p,d+2,g).times(i+""),m=jc(new p(a+"."+r.slice(1)),d-h).plus(c),p.precision=g,t==null?(Wt=!0,Pt(m,g)):m;for(l=o=m=Kn(m.minus(_a),m.plus(_a),d),u=Pt(m.times(m),d),s=3;;){if(o=Pt(o.times(u),d),c=l.plus(Kn(o,new p(s),d)),wn(c.d).slice(0,d)===wn(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(ah(p,d+2,g).times(i+""))),l=Kn(l,new p(f),d),p.precision=g,t==null?(Wt=!0,Pt(l,g)):l;l=c,s+=2}}function sb(e,t){var r,a,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(a,s),t){if(s-=a,r=r-a-1,e.e=rl(r/Mt),e.d=[],a=(r+1)%Mt,r<0&&(a+=Mt),a<s){for(a&&e.d.push(+t.slice(0,a)),s-=Mt;a<s;)e.d.push(+t.slice(a,a+=Mt));t=t.slice(a),a=Mt-t.length}else a-=s;for(;a--;)t+="0";if(e.d.push(+t),Wt&&(e.e>Bu||e.e<-Bu))throw Error(wp+r)}else e.s=0,e.e=0,e.d=[0];return e}function Pt(e,t,r){var a,s,i,o,l,c,d,u,f=e.d;for(o=1,i=f[0];i>=10;i/=10)o++;if(a=t-o,a<0)a+=Mt,s=t,d=f[u=0];else{if(u=Math.ceil((a+1)/Mt),i=f.length,u>=i)return e;for(d=i=f[u],o=1;i>=10;i/=10)o++;a%=Mt,s=a-Mt+o}if(r!==void 0&&(i=Ys(10,o-s-1),l=d/i%10|0,c=t<0||f[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(a>0?s>0?d/Ys(10,o-s):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(i=mr(e),f.length=1,t=t-i-1,f[0]=Ys(10,(Mt-t%Mt)%Mt),e.e=rl(-t/Mt)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(a==0?(f.length=u,i=1,u--):(f.length=u+1,i=Ys(10,Mt-a),f[u]=s>0?(d/Ys(10,o-s)%Ys(10,s)|0)*i:0),c)for(;;)if(u==0){(f[0]+=i)==Sr&&(f[0]=1,++e.e);break}else{if(f[u]+=i,f[u]!=Sr)break;f[u--]=0,i=1}for(a=f.length;f[--a]===0;)f.pop();if(Wt&&(e.e>Bu||e.e<-Bu))throw Error(wp+mr(e));return e}function KN(e,t){var r,a,s,i,o,l,c,d,u,f,h=e.constructor,m=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Wt?Pt(t,m):t;if(c=e.d,f=t.d,a=t.e,d=e.e,c=c.slice(),o=d-a,o){for(u=o<0,u?(r=c,o=-o,l=f.length):(r=f,a=d,l=c.length),s=Math.max(Math.ceil(m/Mt),l)+2,o>s&&(o=s,r.length=1),r.reverse(),s=o;s--;)r.push(0);r.reverse()}else{for(s=c.length,l=f.length,u=s<l,u&&(l=s),s=0;s<l;s++)if(c[s]!=f[s]){u=c[s]<f[s];break}o=0}for(u&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,s=f.length-l;s>0;--s)c[l++]=0;for(s=f.length;s>o;){if(c[--s]<f[s]){for(i=s;i&&c[--i]===0;)c[i]=Sr-1;--c[i],c[s]+=Sr}c[s]-=f[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--a;return c[0]?(t.d=c,t.e=a,Wt?Pt(t,m):t):new h(0)}function Si(e,t,r){var a,s=mr(e),i=wn(e.d),o=i.length;return t?(r&&(a=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+ys(a):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+ys(-s-1)+i,r&&(a=r-o)>0&&(i+=ys(a))):s>=o?(i+=ys(s+1-o),r&&(a=r-s-1)>0&&(i=i+"."+ys(a))):((a=s+1)<o&&(i=i.slice(0,a)+"."+i.slice(a)),r&&(a=r-o)>0&&(s+1===o&&(i+="."),i+=ys(a))),e.s<0?"-"+i:i}function ib(e,t){if(e.length>t)return e.length=t,!0}function XN(e){var t,r,a;function s(i){var o=this;if(!(o instanceof s))return new s(i);if(o.constructor=s,i instanceof s){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(ui+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return sb(o,i.toString())}else if(typeof i!="string")throw Error(ui+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,EW.test(i))sb(o,i);else throw Error(ui+i)}if(s.prototype=Oe,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=XN,s.config=s.set=AW,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return s.config(e),s}function AW(e){if(!e||typeof e!="object")throw Error(Xa+"Object expected");var t,r,a,s=["precision",1,tl,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((a=e[r=s[t]])!==void 0)if(rl(a)===a&&a>=s[t+1]&&a<=s[t+2])this[r]=a;else throw Error(ui+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(ui+r+": "+a);return this}var jp=XN(kW);_a=new jp(1);const Tt=jp;function TW(e){return FW(e)||PW(e)||OW(e)||CW()}function CW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OW(e,t){if(e){if(typeof e=="string")return _m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _m(e,t)}}function PW(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function FW(e){if(Array.isArray(e))return _m(e)}function _m(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var IW=function(t){return t},YN={},JN=function(t){return t===YN},ob=function(t){return function r(){return arguments.length===0||arguments.length===1&&JN(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},DW=function e(t,r){return t===1?r:ob(function(){for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];var o=s.filter(function(l){return l!==YN}).length;return o>=t?r.apply(void 0,s):e(t-o,ob(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=s.map(function(f){return JN(f)?c.shift():f});return r.apply(void 0,TW(u).concat(c))}))})},d0=function(t){return DW(t.length,t)},Sm=function(t,r){for(var a=[],s=t;s<r;++s)a[s-t]=s;return a},RW=d0(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),MW=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return IW;var s=r.reverse(),i=s[0],o=s.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},km=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},ZN=function(t){var r=null,a=null;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,a=t.apply(void 0,i)),a}};function $W(e){var t;return e===0?t=1:t=Math.floor(new Tt(e).abs().log(10).toNumber())+1,t}function LW(e,t,r){for(var a=new Tt(e),s=0,i=[];a.lt(t)&&s<1e5;)i.push(a.toNumber()),a=a.add(r),s++;return i}var BW=d0(function(e,t,r){var a=+e,s=+t;return a+r*(s-a)}),UW=d0(function(e,t,r){var a=t-+e;return a=a||1/0,(r-e)/a}),WW=d0(function(e,t,r){var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});const u0={rangeStep:LW,getDigitCount:$W,interpolateNumber:BW,uninterpolateNumber:UW,uninterpolateTruncation:WW};function Em(e){return VW(e)||zW(e)||QN(e)||HW()}function HW(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zW(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function VW(e){if(Array.isArray(e))return Am(e)}function Nc(e,t){return KW(e)||qW(e,t)||QN(e,t)||GW()}function GW(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QN(e,t){if(e){if(typeof e=="string")return Am(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Am(e,t)}}function Am(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function qW(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],a=!0,s=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(a=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));a=!0);}catch(c){s=!0,i=c}finally{try{!a&&o.return!=null&&o.return()}finally{if(s)throw i}}return r}}function KW(e){if(Array.isArray(e))return e}function e_(e){var t=Nc(e,2),r=t[0],a=t[1],s=r,i=a;return r>a&&(s=a,i=r),[s,i]}function t_(e,t,r){if(e.lte(0))return new Tt(0);var a=u0.getDigitCount(e.toNumber()),s=new Tt(10).pow(a),i=e.div(s),o=a!==1?.05:.1,l=new Tt(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(s);return t?c:new Tt(Math.ceil(c))}function XW(e,t,r){var a=1,s=new Tt(e);if(!s.isint()&&r){var i=Math.abs(e);i<1?(a=new Tt(10).pow(u0.getDigitCount(e)-1),s=new Tt(Math.floor(s.div(a).toNumber())).mul(a)):i>1&&(s=new Tt(Math.floor(e)))}else e===0?s=new Tt(Math.floor((t-1)/2)):r||(s=new Tt(Math.floor(e)));var o=Math.floor((t-1)/2),l=MW(RW(function(c){return s.add(new Tt(c-o).mul(a)).toNumber()}),Sm);return l(0,t)}function r_(e,t,r,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Tt(0),tickMin:new Tt(0),tickMax:new Tt(0)};var i=t_(new Tt(t).sub(e).div(r-1),a,s),o;e<=0&&t>=0?o=new Tt(0):(o=new Tt(e).add(t).div(2),o=o.sub(new Tt(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new Tt(t).sub(o).div(i).toNumber()),d=l+c+1;return d>r?r_(e,t,r,a,s+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:o.sub(new Tt(l).mul(i)),tickMax:o.add(new Tt(c).mul(i))})}function YW(e){var t=Nc(e,2),r=t[0],a=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),l=e_([r,a]),c=Nc(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var f=u===1/0?[d].concat(Em(Sm(0,s-1).map(function(){return 1/0}))):[].concat(Em(Sm(0,s-1).map(function(){return-1/0})),[u]);return r>a?km(f):f}if(d===u)return XW(d,s,i);var h=r_(d,u,o,i),m=h.step,x=h.tickMin,p=h.tickMax,g=u0.rangeStep(x,p.add(new Tt(.1).mul(m)),m);return r>a?km(g):g}function JW(e,t){var r=Nc(e,2),a=r[0],s=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=e_([a,s]),l=Nc(o,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[a,s];if(c===d)return[c];var u=Math.max(t,2),f=t_(new Tt(d).sub(c).div(u-1),i,0),h=[].concat(Em(u0.rangeStep(new Tt(c),new Tt(d).sub(new Tt(.99).mul(f)),f)),[d]);return a>s?km(h):h}var ZW=ZN(YW),QW=ZN(JW),eH=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Uu.apply(this,arguments)}function tH(e,t){return sH(e)||nH(e,t)||aH(e,t)||rH()}function rH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aH(e,t){if(e){if(typeof e=="string")return lb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lb(e,t)}}function lb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function nH(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function sH(e){if(Array.isArray(e))return e}function iH(e,t){if(e==null)return{};var r=oH(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function oH(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function yd(e){var t=e.offset,r=e.layout,a=e.width,s=e.dataKey,i=e.data,o=e.dataPointFormatter,l=e.xAxis,c=e.yAxis,d=iH(e,eH),u=Fe(d),f=i.map(function(h,m){var x=o(h,s),p=x.x,g=x.y,y=x.value,b=x.errorVal;if(!b)return null;var v=[],w,j;if(Array.isArray(b)){var N=tH(b,2);w=N[0],j=N[1]}else w=j=b;if(r==="vertical"){var _=l.scale,E=g+t,S=E+a,k=E-a,O=_(y-w),P=_(y+j);v.push({x1:P,y1:S,x2:P,y2:k}),v.push({x1:O,y1:E,x2:P,y2:E}),v.push({x1:O,y1:S,x2:O,y2:k})}else if(r==="horizontal"){var A=c.scale,R=p+t,T=R-a,F=R+a,W=A(y-w),K=A(y+j);v.push({x1:T,y1:K,x2:F,y2:K}),v.push({x1:R,y1:W,x2:R,y2:K}),v.push({x1:T,y1:W,x2:F,y2:W})}return Q.createElement(ot,Uu({className:"recharts-errorBar",key:"bar-".concat(m)},u),v.map(function(B,L){return Q.createElement("line",Uu({},B,{key:"line-".concat(L)}))}))});return Q.createElement(ot,{className:"recharts-errorBars"},f)}yd.defaultProps={stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"};yd.displayName="ErrorBar";function _c(e){"@babel/helpers - typeof";return _c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_c(e)}function cb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function nh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cb(Object(r),!0).forEach(function(a){lH(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function lH(e,t,r){return t=cH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cH(e){var t=dH(e,"string");return _c(t)==="symbol"?t:String(t)}function dH(e,t){if(_c(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(_c(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var a_=function(t){var r=t.children,a=t.formattedGraphicalItems,s=t.legendWidth,i=t.legendContent,o=Un(r,dc);if(!o)return null;var l;return o.props&&o.props.payload?l=o.props&&o.props.payload:i==="children"?l=(a||[]).reduce(function(c,d){var u=d.item,f=d.props,h=f.sectors||f.data||[];return c.concat(h.map(function(m){return{type:o.props.iconType||u.props.legendType,value:m.name,color:m.fill,payload:m}}))},[]):l=(a||[]).map(function(c){var d=c.item,u=d.props,f=u.dataKey,h=u.name,m=u.legendType,x=u.hide;return{inactive:x,dataKey:f,type:o.props.iconType||m||"square",color:Np(d),value:h||f,payload:d.props}}),nh(nh(nh({},o.props),dc.getWithHeight(o,s)),{},{payload:l,item:o})};function Sc(e){"@babel/helpers - typeof";return Sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sc(e)}function db(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?db(Object(r),!0).forEach(function(a){ho(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):db(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ho(e,t,r){return t=uH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uH(e){var t=fH(e,"string");return Sc(t)==="symbol"?t:String(t)}function fH(e,t){if(Sc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Sc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ub(e){return pH(e)||xH(e)||mH(e)||hH()}function hH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mH(e,t){if(e){if(typeof e=="string")return Tm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Tm(e,t)}}function xH(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pH(e){if(Array.isArray(e))return Tm(e)}function Tm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ur(e,t,r){return Pe(e)||Pe(t)?r:br(t)?Ar(e,t,r):De(t)?t(e):r}function Ul(e,t,r,a){var s=ZB(e,function(l){return ur(l,t)});if(r==="number"){var i=s.filter(function(l){return be(l)||parseFloat(l)});return i.length?[a0(i),bs(i)]:[1/0,-1/0]}var o=a?s.filter(function(l){return!Pe(l)}):s;return o.map(function(l){return br(l)||l instanceof Date?l:""})}var gH=function(t){var r,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=a==null?void 0:a.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var u=d>0?s[d-1].coordinate:s[l-1].coordinate,f=s[d].coordinate,h=d>=l-1?s[0].coordinate:s[d+1].coordinate,m=void 0;if(ia(f-u)!==ia(h-f)){var x=[];if(ia(h-f)===ia(c[1]-c[0])){m=h;var p=f+c[1]-c[0];x[0]=Math.min(p,(p+u)/2),x[1]=Math.max(p,(p+u)/2)}else{m=u;var g=h+c[1]-c[0];x[0]=Math.min(f,(g+f)/2),x[1]=Math.max(f,(g+f)/2)}var y=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(t>y[0]&&t<=y[1]||t>=x[0]&&t<=x[1]){o=s[d].index;break}}else{var b=Math.min(u,h),v=Math.max(u,h);if(t>(b+f)/2&&t<=(v+f)/2){o=s[d].index;break}}}else for(var w=0;w<l;w++)if(w===0&&t<=(a[w].coordinate+a[w+1].coordinate)/2||w>0&&w<l-1&&t>(a[w].coordinate+a[w-1].coordinate)/2&&t<=(a[w].coordinate+a[w+1].coordinate)/2||w===l-1&&t>(a[w].coordinate+a[w-1].coordinate)/2){o=a[w].index;break}return o},Np=function(t){var r=t,a=r.type.displayName,s=t.props,i=s.stroke,o=s.fill,l;switch(a){case"Line":l=i;break;case"Area":case"Radar":l=i&&i!=="none"?i:o;break;default:l=o;break}return l},vH=function(t){var r=t.barSize,a=t.stackGroups,s=a===void 0?{}:a;if(!s)return{};for(var i={},o=Object.keys(s),l=0,c=o.length;l<c;l++)for(var d=s[o[l]].stackGroups,u=Object.keys(d),f=0,h=u.length;f<h;f++){var m=d[u[f]],x=m.items,p=m.cateAxisId,g=x.filter(function(v){return ks(v.type).indexOf("Bar")>=0});if(g&&g.length){var y=g[0].props.barSize,b=g[0].props[p];i[b]||(i[b]=[]),i[b].push({item:g[0],stackList:g.slice(1),barSize:Pe(y)?r:y})}}return i},yH=function(t){var r=t.barGap,a=t.barCategoryGap,s=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var d=ma(r,s,0,!0),u,f=[];if(o[0].barSize===+o[0].barSize){var h=!1,m=s/c,x=o.reduce(function(w,j){return w+j.barSize||0},0);x+=(c-1)*d,x>=s&&(x-=(c-1)*d,d=0),x>=s&&m>0&&(h=!0,m*=.9,x=c*m);var p=(s-x)/2>>0,g={offset:p-d,size:0};u=o.reduce(function(w,j){var N={item:j.item,position:{offset:g.offset+g.size+d,size:h?m:j.barSize}},_=[].concat(ub(w),[N]);return g=_[_.length-1].position,j.stackList&&j.stackList.length&&j.stackList.forEach(function(E){_.push({item:E,position:g})}),_},f)}else{var y=ma(a,s,0,!0);s-2*y-(c-1)*d<=0&&(d=0);var b=(s-2*y-(c-1)*d)/c;b>1&&(b>>=0);var v=l===+l?Math.min(b,l):b;u=o.reduce(function(w,j,N){var _=[].concat(ub(w),[{item:j.item,position:{offset:y+(b+d)*N+(b-v)/2,size:v}}]);return j.stackList&&j.stackList.length&&j.stackList.forEach(function(E){_.push({item:E,position:_[_.length-1].position})}),_},f)}return u},bH=function(t,r,a,s){var i=a.children,o=a.width,l=a.margin,c=o-(l.left||0)-(l.right||0),d=a_({children:i,legendWidth:c});if(d){var u=s||{},f=u.width,h=u.height,m=d.align,x=d.verticalAlign,p=d.layout;if((p==="vertical"||p==="horizontal"&&x==="middle")&&m!=="center"&&be(t[m]))return Ha(Ha({},t),{},ho({},m,t[m]+(f||0)));if((p==="horizontal"||p==="vertical"&&m==="center")&&x!=="middle"&&be(t[x]))return Ha(Ha({},t),{},ho({},x,t[x]+(h||0)))}return t},wH=function(t,r,a){return Pe(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||a==="x"?r==="xAxis":a==="y"?r==="yAxis":!0},n_=function(t,r,a,s,i){var o=r.props.children,l=Ea(o,yd).filter(function(d){return wH(s,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var f=ur(u,a,0),h=hr(f)?[a0(f),bs(f)]:[f,f],m=c.reduce(function(x,p){var g=ur(u,p,0),y=h[0]-Math.abs(hr(g)?g[0]:g),b=h[1]+Math.abs(hr(g)?g[1]:g);return[Math.min(y,x[0]),Math.max(b,x[1])]},[1/0,-1/0]);return[Math.min(m[0],d[0]),Math.max(m[1],d[1])]},[1/0,-1/0])}return null},jH=function(t,r,a,s,i){var o=r.map(function(l){return n_(t,l,a,i,s)}).filter(function(l){return!Pe(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},s_=function(t,r,a,s,i){var o=r.map(function(c){var d=c.props.dataKey;return a==="number"&&d&&n_(t,c,d,s)||Ul(t,d,a,i)});if(a==="number")return o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,d){for(var u=0,f=d.length;u<f;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},i_=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},fb=function(t,r,a,s){if(s)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===a&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(a),l},ps=function(t,r,a){if(!t)return null;var s=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?s.bandwidth()/2:2,d=(r||a)&&o==="category"&&s.bandwidth?s.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?ia(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(f){var h=i?i.indexOf(f):f;return{coordinate:s(h)+d,value:f,offset:d}});return u.filter(function(f){return!Yo(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:s(f)+d,value:f,index:h,offset:d}}):s.ticks&&!a?s.ticks(t.tickCount).map(function(f){return{coordinate:s(f)+d,value:f,offset:d}}):s.domain().map(function(f,h){return{coordinate:s(f)+d,value:i?i[f]:f,index:h,offset:d}})},Wd=function(t,r,a){var s;return De(a)?s=a:De(r)&&(s=r),De(t)||s?function(i,o,l,c){De(t)&&t(i,o,l,c),De(s)&&s(i,o,l,c)}:null},o_=function(t,r,a){var s=t.scale,i=t.type,o=t.layout,l=t.axisType;if(s==="auto")return o==="radial"&&l==="radiusAxis"?{scale:gc(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:Ru(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!a)?{scale:Bl(),realScaleType:"point"}:i==="category"?{scale:gc(),realScaleType:"band"}:{scale:Ru(),realScaleType:"linear"};if(hd(s)){var c="scale".concat(Xf(s));return{scale:(nb[c]||Bl)(),realScaleType:nb[c]?c:"point"}}return De(s)?{scale:s}:{scale:Bl(),realScaleType:"point"}},hb=1e-4,l_=function(t){var r=t.domain();if(!(!r||r.length<=2)){var a=r.length,s=t.range(),i=Math.min(s[0],s[1])-hb,o=Math.max(s[0],s[1])+hb,l=t(r[0]),c=t(r[a-1]);(l<i||l>o||c<i||c>o)&&t.domain([r[0],r[a-1]])}},NH=function(t,r){if(!t)return null;for(var a=0,s=t.length;a<s;a++)if(t[a].item===r)return t[a].position;return null},_H=function(t,r){if(!r||r.length!==2||!be(r[0])||!be(r[1]))return t;var a=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!be(t[0])||t[0]<a)&&(i[0]=a),(!be(t[1])||t[1]>s)&&(i[1]=s),i[0]>s&&(i[0]=s),i[1]<a&&(i[1]=a),i},SH=function(t){var r=t.length;if(!(r<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,o=0,l=0;l<r;++l){var c=Yo(t[l][a][1])?t[l][a][0]:t[l][a][1];c>=0?(t[l][a][0]=i,t[l][a][1]=i+c,i=t[l][a][1]):(t[l][a][0]=o,t[l][a][1]=o+c,o=t[l][a][1])}},kH=function(t){var r=t.length;if(!(r<=0))for(var a=0,s=t[0].length;a<s;++a)for(var i=0,o=0;o<r;++o){var l=Yo(t[o][a][1])?t[o][a][0]:t[o][a][1];l>=0?(t[o][a][0]=i,t[o][a][1]=i+l,i=t[o][a][1]):(t[o][a][0]=0,t[o][a][1]=0)}},EH={sign:SH,expand:WD,none:yo,silhouette:HD,wiggle:zD,positive:kH},AH=function(t,r,a){var s=r.map(function(l){return l.props.dataKey}),i=EH[a],o=UD().keys(s).value(function(l,c){return+ur(l,c,0)}).order(Jh).offset(i);return o(t)},TH=function(t,r,a,s,i,o){if(!t)return null;var l=o?r.reverse():r,c={},d=l.reduce(function(f,h){var m=h.props,x=m.stackId,p=m.hide;if(p)return f;var g=h.props[a],y=f[g]||{hasStack:!1,stackGroups:{}};if(br(x)){var b=y.stackGroups[x]||{numericAxisId:a,cateAxisId:s,items:[]};b.items.push(h),y.hasStack=!0,y.stackGroups[x]=b}else y.stackGroups[Ri("_stackId_")]={numericAxisId:a,cateAxisId:s,items:[h]};return Ha(Ha({},f),{},ho({},g,y))},c),u={};return Object.keys(d).reduce(function(f,h){var m=d[h];if(m.hasStack){var x={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(p,g){var y=m.stackGroups[g];return Ha(Ha({},p),{},ho({},g,{numericAxisId:a,cateAxisId:s,items:y.items,stackedData:AH(t,y.items,i)}))},x)}return Ha(Ha({},f),{},ho({},h,m))},u)},c_=function(t,r){var a=r.realScaleType,s=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=a||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&s==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=ZW(d,i,l);return t.domain([a0(u),bs(u)]),{niceTicks:u}}if(i&&s==="number"){var f=t.domain(),h=QW(f,i,l);return{niceTicks:h}}return null},Wu=function(t){var r=t.axis,a=t.ticks,s=t.bandSize,i=t.entry,o=t.index,l=t.dataKey;if(r.type==="category"){if(!r.allowDuplicatedCategory&&r.dataKey&&!Pe(i[r.dataKey])){var c=uu(a,"value",i[r.dataKey]);if(c)return c.coordinate+s/2}return a[o]?a[o].coordinate+s/2:null}var d=ur(i,Pe(l)?r.dataKey:l);return Pe(d)?null:r.scale(d)},mb=function(t){var r=t.axis,a=t.ticks,s=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return a[l]?a[l].coordinate+s:null;var c=ur(o,r.dataKey,r.domain[l]);return Pe(c)?null:r.scale(c)-i/2+s},CH=function(t){var r=t.numericAxis,a=r.scale.domain();if(r.type==="number"){var s=Math.min(a[0],a[1]),i=Math.max(a[0],a[1]);return s<=0&&i>=0?0:i<0?i:s}return a[0]},OH=function(t,r){var a=t.props.stackId;if(br(a)){var s=r[a];if(s){var i=s.items.indexOf(t);return i>=0?s.stackedData[i]:null}}return null},PH=function(t){return t.reduce(function(r,a){return[a0(a.concat([r[0]]).filter(be)),bs(a.concat([r[1]]).filter(be))]},[1/0,-1/0])},d_=function(t,r,a){return Object.keys(t).reduce(function(s,i){var o=t[i],l=o.stackedData,c=l.reduce(function(d,u){var f=PH(u.slice(r,a+1));return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},xb=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,pb=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Cm=function(t,r,a){if(De(t))return t(r,a);if(!hr(t))return r;var s=[];if(be(t[0]))s[0]=a?t[0]:Math.min(t[0],r[0]);else if(xb.test(t[0])){var i=+xb.exec(t[0])[1];s[0]=r[0]-i}else De(t[0])?s[0]=t[0](r[0]):s[0]=r[0];if(be(t[1]))s[1]=a?t[1]:Math.max(t[1],r[1]);else if(pb.test(t[1])){var o=+pb.exec(t[1])[1];s[1]=r[1]+o}else De(t[1])?s[1]=t[1](r[1]):s[1]=r[1];return s},Hu=function(t,r,a){if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!a||s>0)return s}if(t&&r&&r.length>=2){for(var i=Zx(r,function(f){return f.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return a?void 0:0},gb=function(t,r,a){return!t||!t.length||_i(t,Ar(a,"type.defaultProps.domain"))?r:t},u_=function(t,r){var a=t.props,s=a.dataKey,i=a.name,o=a.unit,l=a.formatter,c=a.tooltipType,d=a.chartType;return Ha(Ha({},Fe(t)),{},{dataKey:s,unit:o,formatter:l,name:i||s,color:Np(t),value:ur(r,s),type:c,payload:r,chartType:d})};function kc(e){"@babel/helpers - typeof";return kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kc(e)}function vb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vb(Object(r),!0).forEach(function(a){f_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function f_(e,t,r){return t=FH(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FH(e){var t=IH(e,"string");return kc(t)==="symbol"?t:String(t)}function IH(e,t){if(kc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(kc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function DH(e,t){return LH(e)||$H(e,t)||MH(e,t)||RH()}function RH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MH(e,t){if(e){if(typeof e=="string")return yb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yb(e,t)}}function yb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function $H(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function LH(e){if(Array.isArray(e))return e}var zu=Math.PI/180,BH=function(t){return t*180/Math.PI},Dt=function(t,r,a,s){return{x:t+Math.cos(-zu*s)*a,y:r+Math.sin(-zu*s)*a}},h_=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},UH=function(t,r,a,s,i){var o=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=ma(t.cx,o,o/2),f=ma(t.cy,l,l/2),h=h_(o,l,a),m=ma(t.innerRadius,h,0),x=ma(t.outerRadius,h,h*.8),p=Object.keys(r);return p.reduce(function(g,y){var b=r[y],v=b.domain,w=b.reversed,j;if(Pe(b.range))s==="angleAxis"?j=[c,d]:s==="radiusAxis"&&(j=[m,x]),w&&(j=[j[1],j[0]]);else{j=b.range;var N=j,_=DH(N,2);c=_[0],d=_[1]}var E=o_(b,i),S=E.realScaleType,k=E.scale;k.domain(v).range(j),l_(k);var O=c_(k,Ln(Ln({},b),{},{realScaleType:S})),P=Ln(Ln(Ln({},b),O),{},{range:j,radius:x,realScaleType:S,scale:k,cx:u,cy:f,innerRadius:m,outerRadius:x,startAngle:c,endAngle:d});return Ln(Ln({},g),{},f_({},y,P))},{})},WH=function(t,r){var a=t.x,s=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(a-i,2)+Math.pow(s-o,2))},HH=function(t,r){var a=t.x,s=t.y,i=r.cx,o=r.cy,l=WH({x:a,y:s},{x:i,y:o});if(l<=0)return{radius:l};var c=(a-i)/l,d=Math.acos(c);return s>o&&(d=2*Math.PI-d),{radius:l,angle:BH(d),angleInRadian:d}},zH=function(t){var r=t.startAngle,a=t.endAngle,s=Math.floor(r/360),i=Math.floor(a/360),o=Math.min(s,i);return{startAngle:r-o*360,endAngle:a-o*360}},VH=function(t,r){var a=r.startAngle,s=r.endAngle,i=Math.floor(a/360),o=Math.floor(s/360),l=Math.min(i,o);return t+l*360},bb=function(t,r){var a=t.x,s=t.y,i=HH({x:a,y:s},r),o=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(o<c||o>d)return!1;if(o===0)return!0;var u=zH(r),f=u.startAngle,h=u.endAngle,m=l,x;if(f<=h){for(;m>h;)m-=360;for(;m<f;)m+=360;x=m>=f&&m<=h}else{for(;m>f;)m-=360;for(;m<h;)m+=360;x=m>=h&&m<=f}return x?Ln(Ln({},r),{},{radius:o,angle:VH(m,r)}):null};function Ec(e){"@babel/helpers - typeof";return Ec=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ec(e)}var GH=["offset"];function qH(e){return JH(e)||YH(e)||XH(e)||KH()}function KH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XH(e,t){if(e){if(typeof e=="string")return Om(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Om(e,t)}}function YH(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function JH(e){if(Array.isArray(e))return Om(e)}function Om(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function ZH(e,t){if(e==null)return{};var r=QH(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function QH(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function wb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wb(Object(r),!0).forEach(function(a){ez(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ez(e,t,r){return t=tz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tz(e){var t=rz(e,"string");return Ec(t)==="symbol"?t:String(t)}function rz(e,t){if(Ec(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ec(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ac(){return Ac=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ac.apply(this,arguments)}var az=function(t){var r=t.value,a=t.formatter,s=Pe(t.children)?r:t.children;return De(a)?a(s):s},nz=function(t,r){var a=ia(r-t),s=Math.min(Math.abs(r-t),360);return a*s},sz=function(t,r,a){var s=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,d=c.cx,u=c.cy,f=c.innerRadius,h=c.outerRadius,m=c.startAngle,x=c.endAngle,p=c.clockWise,g=(f+h)/2,y=nz(m,x),b=y>=0?1:-1,v,w;s==="insideStart"?(v=m+b*o,w=p):s==="insideEnd"?(v=x-b*o,w=!p):s==="end"&&(v=x+b*o,w=p),w=y<=0?w:!w;var j=Dt(d,u,g,v),N=Dt(d,u,g,v+(w?1:-1)*359),_="M".concat(j.x,",").concat(j.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(w?0:1,`,
    `).concat(N.x,",").concat(N.y),E=Pe(t.id)?Ri("recharts-radial-line-"):t.id;return Q.createElement("text",Ac({},a,{dominantBaseline:"central",className:pt("recharts-radial-bar-label",l)}),Q.createElement("defs",null,Q.createElement("path",{id:E,d:_})),Q.createElement("textPath",{xlinkHref:"#".concat(E)},r))},iz=function(t){var r=t.viewBox,a=t.offset,s=t.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,u=i.startAngle,f=i.endAngle,h=(u+f)/2;if(s==="outside"){var m=Dt(o,l,d+a,h),x=m.x,p=m.y;return{x,y:p,textAnchor:x>=o?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var g=(c+d)/2,y=Dt(o,l,g,h),b=y.x,v=y.y;return{x:b,y:v,textAnchor:"middle",verticalAnchor:"middle"}},oz=function(t){var r=t.viewBox,a=t.parentViewBox,s=t.offset,i=t.position,o=r,l=o.x,c=o.y,d=o.width,u=o.height,f=u>=0?1:-1,h=f*s,m=f>0?"end":"start",x=f>0?"start":"end",p=d>=0?1:-1,g=p*s,y=p>0?"end":"start",b=p>0?"start":"end";if(i==="top"){var v={x:l+d/2,y:c-f*s,textAnchor:"middle",verticalAnchor:m};return pr(pr({},v),a?{height:Math.max(c-a.y,0),width:d}:{})}if(i==="bottom"){var w={x:l+d/2,y:c+u+h,textAnchor:"middle",verticalAnchor:x};return pr(pr({},w),a?{height:Math.max(a.y+a.height-(c+u),0),width:d}:{})}if(i==="left"){var j={x:l-g,y:c+u/2,textAnchor:y,verticalAnchor:"middle"};return pr(pr({},j),a?{width:Math.max(j.x-a.x,0),height:u}:{})}if(i==="right"){var N={x:l+d+g,y:c+u/2,textAnchor:b,verticalAnchor:"middle"};return pr(pr({},N),a?{width:Math.max(a.x+a.width-N.x,0),height:u}:{})}var _=a?{width:d,height:u}:{};return i==="insideLeft"?pr({x:l+g,y:c+u/2,textAnchor:b,verticalAnchor:"middle"},_):i==="insideRight"?pr({x:l+d-g,y:c+u/2,textAnchor:y,verticalAnchor:"middle"},_):i==="insideTop"?pr({x:l+d/2,y:c+h,textAnchor:"middle",verticalAnchor:x},_):i==="insideBottom"?pr({x:l+d/2,y:c+u-h,textAnchor:"middle",verticalAnchor:m},_):i==="insideTopLeft"?pr({x:l+g,y:c+h,textAnchor:b,verticalAnchor:x},_):i==="insideTopRight"?pr({x:l+d-g,y:c+h,textAnchor:y,verticalAnchor:x},_):i==="insideBottomLeft"?pr({x:l+g,y:c+u-h,textAnchor:b,verticalAnchor:m},_):i==="insideBottomRight"?pr({x:l+d-g,y:c+u-h,textAnchor:y,verticalAnchor:m},_):Vo(i)&&(be(i.x)||ai(i.x))&&(be(i.y)||ai(i.y))?pr({x:l+ma(i.x,d),y:c+ma(i.y,u),textAnchor:"end",verticalAnchor:"end"},_):pr({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},_)},lz=function(t){return"cx"in t&&be(t.cx)};function Er(e){var t=e.offset,r=t===void 0?5:t,a=ZH(e,GH),s=pr({offset:r},a),i=s.viewBox,o=s.position,l=s.value,c=s.children,d=s.content,u=s.className,f=u===void 0?"":u,h=s.textBreakAll;if(!i||Pe(l)&&Pe(c)&&!C.isValidElement(d)&&!De(d))return null;if(C.isValidElement(d))return C.cloneElement(d,s);var m;if(De(d)){if(m=C.createElement(d,s),C.isValidElement(m))return m}else m=az(s);var x=lz(i),p=Fe(s,!0);if(x&&(o==="insideStart"||o==="insideEnd"||o==="end"))return sz(s,m,p);var g=x?iz(s):oz(s);return Q.createElement(Ni,Ac({className:pt("recharts-label",f)},p,g,{breakAll:h}),m)}Er.displayName="Label";var m_=function(t){var r=t.cx,a=t.cy,s=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,f=t.x,h=t.y,m=t.top,x=t.left,p=t.width,g=t.height,y=t.clockWise,b=t.labelViewBox;if(b)return b;if(be(p)&&be(g)){if(be(f)&&be(h))return{x:f,y:h,width:p,height:g};if(be(m)&&be(x))return{x:m,y:x,width:p,height:g}}return be(f)&&be(h)?{x:f,y:h,width:0,height:0}:be(r)&&be(a)?{cx:r,cy:a,startAngle:i||s||0,endAngle:o||s||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:y}:t.viewBox?t.viewBox:{}},cz=function(t,r){return t?t===!0?Q.createElement(Er,{key:"label-implicit",viewBox:r}):br(t)?Q.createElement(Er,{key:"label-implicit",viewBox:r,value:t}):C.isValidElement(t)?t.type===Er?C.cloneElement(t,{key:"label-implicit",viewBox:r}):Q.createElement(Er,{key:"label-implicit",content:t,viewBox:r}):De(t)?Q.createElement(Er,{key:"label-implicit",content:t,viewBox:r}):Vo(t)?Q.createElement(Er,Ac({viewBox:r},t,{key:"label-implicit"})):null:null},dz=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&a&&!t.label)return null;var s=t.children,i=m_(t),o=Ea(s,Er).map(function(c,d){return C.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!a)return o;var l=cz(t.label,r||i);return[l].concat(qH(o))};Er.parseViewBox=m_;Er.renderCallByParent=dz;function uz(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var fz=uz;const hz=bt(fz);function Tc(e){"@babel/helpers - typeof";return Tc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tc(e)}var mz=["valueAccessor"],xz=["data","dataKey","clockWise","id","textBreakAll"];function pz(e){return bz(e)||yz(e)||vz(e)||gz()}function gz(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vz(e,t){if(e){if(typeof e=="string")return Pm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pm(e,t)}}function yz(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bz(e){if(Array.isArray(e))return Pm(e)}function Pm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Vu(){return Vu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Vu.apply(this,arguments)}function jb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Nb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jb(Object(r),!0).forEach(function(a){wz(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function wz(e,t,r){return t=jz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jz(e){var t=Nz(e,"string");return Tc(t)==="symbol"?t:String(t)}function Nz(e,t){if(Tc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Tc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _b(e,t){if(e==null)return{};var r=_z(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function _z(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var Sz=function(t){return hr(t.value)?hz(t.value):t.value};function En(e){var t=e.valueAccessor,r=t===void 0?Sz:t,a=_b(e,mz),s=a.data,i=a.dataKey,o=a.clockWise,l=a.id,c=a.textBreakAll,d=_b(a,xz);return!s||!s.length?null:Q.createElement(ot,{className:"recharts-label-list"},s.map(function(u,f){var h=Pe(i)?r(u,f):ur(u&&u.payload,i),m=Pe(l)?{}:{id:"".concat(l,"-").concat(f)};return Q.createElement(Er,Vu({},Fe(u,!0),d,m,{parentViewBox:u.parentViewBox,index:f,value:h,textBreakAll:c,viewBox:Er.parseViewBox(Pe(o)?u:Nb(Nb({},u),{},{clockWise:o})),key:"label-".concat(f)}))}))}En.displayName="LabelList";function kz(e,t){return e?e===!0?Q.createElement(En,{key:"labelList-implicit",data:t}):Q.isValidElement(e)||De(e)?Q.createElement(En,{key:"labelList-implicit",data:t,content:e}):Vo(e)?Q.createElement(En,Vu({data:t},e,{key:"labelList-implicit"})):null:null}function Ez(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var a=e.children,s=Ea(a,En).map(function(o,l){return C.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return s;var i=kz(e.label,t);return[i].concat(pz(s))}En.renderCallByParent=Ez;function Cc(e){"@babel/helpers - typeof";return Cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cc(e)}function Fm(){return Fm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Fm.apply(this,arguments)}function Sb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function kb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sb(Object(r),!0).forEach(function(a){Az(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Az(e,t,r){return t=Tz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tz(e){var t=Cz(e,"string");return Cc(t)==="symbol"?t:String(t)}function Cz(e,t){if(Cc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Cc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oz=function(t,r){var a=ia(r-t),s=Math.min(Math.abs(r-t),359.999);return a*s},Hd=function(t){var r=t.cx,a=t.cy,s=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+s,f=Math.asin(c/u)/zu,h=d?i:i+o*f,m=Dt(r,a,u,h),x=Dt(r,a,s,h),p=d?i-o*f:i,g=Dt(r,a,u*Math.cos(f*zu),p);return{center:m,circleTangency:x,lineTangency:g,theta:f}},x_=function(t){var r=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=Oz(o,l),d=o+c,u=Dt(r,a,i,o),f=Dt(r,a,i,d),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var m=Dt(r,a,s,o),x=Dt(r,a,s,d);h+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(r,",").concat(a," Z");return h},Pz=function(t){var r=t.cx,a=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,f=ia(u-d),h=Hd({cx:r,cy:a,radius:i,angle:d,sign:f,cornerRadius:o,cornerIsExternal:c}),m=h.circleTangency,x=h.lineTangency,p=h.theta,g=Hd({cx:r,cy:a,radius:i,angle:u,sign:-f,cornerRadius:o,cornerIsExternal:c}),y=g.circleTangency,b=g.lineTangency,v=g.theta,w=c?Math.abs(d-u):Math.abs(d-u)-p-v;if(w<0)return l?"M ".concat(x.x,",").concat(x.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):x_({cx:r,cy:a,innerRadius:s,outerRadius:i,startAngle:d,endAngle:u});var j="M ".concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(w>180),",").concat(+(f<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(s>0){var N=Hd({cx:r,cy:a,radius:s,angle:d,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),_=N.circleTangency,E=N.lineTangency,S=N.theta,k=Hd({cx:r,cy:a,radius:s,angle:u,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),O=k.circleTangency,P=k.lineTangency,A=k.theta,R=c?Math.abs(d-u):Math.abs(d-u)-S-A;if(R<0&&o===0)return"".concat(j,"L").concat(r,",").concat(a,"Z");j+="L".concat(P.x,",").concat(P.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(O.x,",").concat(O.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(R>180),",").concat(+(f>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(E.x,",").concat(E.y,"Z")}else j+="L".concat(r,",").concat(a,"Z");return j},Fz={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},p_=function(t){var r=kb(kb({},Fz),t),a=r.cx,s=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,f=r.endAngle,h=r.className;if(o<i||u===f)return null;var m=pt("recharts-sector",h),x=o-i,p=ma(l,x,0,!0),g;return p>0&&Math.abs(u-f)<360?g=Pz({cx:a,cy:s,innerRadius:i,outerRadius:o,cornerRadius:Math.min(p,x/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):g=x_({cx:a,cy:s,innerRadius:i,outerRadius:o,startAngle:u,endAngle:f}),Q.createElement("path",Fm({},Fe(r,!0),{className:m,d:g,role:"img"}))};function Oc(e){"@babel/helpers - typeof";return Oc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oc(e)}function Im(){return Im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Im.apply(this,arguments)}function Eb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ab(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Eb(Object(r),!0).forEach(function(a){Iz(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Eb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Iz(e,t,r){return t=Dz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dz(e){var t=Rz(e,"string");return Oc(t)==="symbol"?t:String(t)}function Rz(e,t){if(Oc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Oc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tb={curveBasisClosed:CD,curveBasisOpen:OD,curveBasis:TD,curveBumpX:xD,curveBumpY:pD,curveLinearClosed:PD,curveLinear:Jf,curveMonotoneX:FD,curveMonotoneY:ID,curveNatural:DD,curveStep:RD,curveStepAfter:$D,curveStepBefore:MD},zd=function(t){return t.x===+t.x&&t.y===+t.y},bl=function(t){return t.x},wl=function(t){return t.y},Mz=function(t,r){if(De(t))return t;var a="curve".concat(Xf(t));return(a==="curveMonotone"||a==="curveBump")&&r?Tb["".concat(a).concat(r==="vertical"?"Y":"X")]:Tb[a]||Jf},$z=function(t){var r=t.type,a=r===void 0?"linear":r,s=t.points,i=s===void 0?[]:s,o=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=Mz(a,l),f=d?i.filter(function(p){return zd(p)}):i,h;if(hr(o)){var m=d?o.filter(function(p){return zd(p)}):o,x=f.map(function(p,g){return Ab(Ab({},p),{},{base:m[g]})});return l==="vertical"?h=Rd().y(wl).x1(bl).x0(function(p){return p.base.x}):h=Rd().x(bl).y1(wl).y0(function(p){return p.base.y}),h.defined(zd).curve(u),h(x)}return l==="vertical"&&be(o)?h=Rd().y(wl).x1(bl).x0(o):be(o)?h=Rd().x(bl).y1(wl).y0(o):h=E2().x(bl).y(wl),h.defined(zd).curve(u),h(f)},fi=function(t){var r=t.className,a=t.points,s=t.path,i=t.pathRef;if((!a||!a.length)&&!s)return null;var o=a&&a.length?$z(t):s;return Q.createElement("path",Im({},Fe(t),fu(t),{className:pt("recharts-curve",r),d:o,ref:i}))};function Pc(e){"@babel/helpers - typeof";return Pc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pc(e)}function Gu(){return Gu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gu.apply(this,arguments)}function Lz(e,t){return Hz(e)||Wz(e,t)||Uz(e,t)||Bz()}function Bz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Uz(e,t){if(e){if(typeof e=="string")return Cb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cb(e,t)}}function Cb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function Wz(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function Hz(e){if(Array.isArray(e))return e}function Ob(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Pb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ob(Object(r),!0).forEach(function(a){zz(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ob(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function zz(e,t,r){return t=Vz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vz(e){var t=Gz(e,"string");return Pc(t)==="symbol"?t:String(t)}function Gz(e,t){if(Pc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Pc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fb=function(t,r,a,s,i){var o=Math.min(Math.abs(a)/2,Math.abs(s)/2),l=s>=0?1:-1,c=a>=0?1:-1,d=s>=0&&a>=0||s<0&&a<0?1:0,u;if(o>0&&i instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=i[h]>o?o:i[h];u="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(t+c*f[0],",").concat(r)),u+="L ".concat(t+a-c*f[1],",").concat(r),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(t+a,",").concat(r+l*f[1])),u+="L ".concat(t+a,",").concat(r+s-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(t+a-c*f[2],",").concat(r+s)),u+="L ".concat(t+c*f[3],",").concat(r+s),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+s-l*f[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var x=Math.min(o,i);u="M ".concat(t,",").concat(r+l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+c*x,",").concat(r,`
            L `).concat(t+a-c*x,",").concat(r,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+a,",").concat(r+l*x,`
            L `).concat(t+a,",").concat(r+s-l*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t+a-c*x,",").concat(r+s,`
            L `).concat(t+c*x,",").concat(r+s,`
            A `).concat(x,",").concat(x,",0,0,").concat(d,",").concat(t,",").concat(r+s-l*x," Z")}else u="M ".concat(t,",").concat(r," h ").concat(a," v ").concat(s," h ").concat(-a," Z");return u},qz=function(t,r){if(!t||!r)return!1;var a=t.x,s=t.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),u=Math.max(i,i+l),f=Math.min(o,o+c),h=Math.max(o,o+c);return a>=d&&a<=u&&s>=f&&s<=h}return!1},Kz={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},_p=function(t){var r=Pb(Pb({},Kz),t),a=C.useRef(),s=C.useState(-1),i=Lz(s,2),o=i[0],l=i[1];C.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var w=a.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,d=r.y,u=r.width,f=r.height,h=r.radius,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,y=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||u===0||f===0)return null;var v=pt("recharts-rectangle",m);return b?Q.createElement(un,{canBegin:o>0,from:{width:u,height:f,x:c,y:d},to:{width:u,height:f,x:c,y:d},duration:p,animationEasing:x,isActive:b},function(w){var j=w.width,N=w.height,_=w.x,E=w.y;return Q.createElement(un,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,isActive:y,easing:x},Q.createElement("path",Gu({},Fe(r,!0),{className:v,d:Fb(_,E,j,N,h),ref:a})))}):Q.createElement("path",Gu({},Fe(r,!0),{className:v,d:Fb(c,d,u,f,h)}))},Xz=["points","className","baseLinePoints","connectNulls"];function no(){return no=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},no.apply(this,arguments)}function Yz(e,t){if(e==null)return{};var r=Jz(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Jz(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Ib(e){return tV(e)||eV(e)||Qz(e)||Zz()}function Zz(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qz(e,t){if(e){if(typeof e=="string")return Dm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dm(e,t)}}function eV(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tV(e){if(Array.isArray(e))return Dm(e)}function Dm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var Db=function(t){return t&&t.x===+t.x&&t.y===+t.y},rV=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(a){Db(a)?r[r.length-1].push(a):r[r.length-1].length>0&&r.push([])}),Db(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Wl=function(t,r){var a=rV(t);r&&(a=[a.reduce(function(i,o){return[].concat(Ib(i),Ib(o))},[])]);var s=a.map(function(i){return i.reduce(function(o,l,c){return"".concat(o).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return a.length===1?"".concat(s,"Z"):s},aV=function(t,r,a){var s=Wl(t,a);return"".concat(s.slice(-1)==="Z"?s.slice(0,-1):s,"L").concat(Wl(r.reverse(),a).slice(1))},nV=function(t){var r=t.points,a=t.className,s=t.baseLinePoints,i=t.connectNulls,o=Yz(t,Xz);if(!r||!r.length)return null;var l=pt("recharts-polygon",a);if(s&&s.length){var c=o.stroke&&o.stroke!=="none",d=aV(r,s,i);return Q.createElement("g",{className:l},Q.createElement("path",no({},Fe(o,!0),{fill:d.slice(-1)==="Z"?o.fill:"none",stroke:"none",d})),c?Q.createElement("path",no({},Fe(o,!0),{fill:"none",d:Wl(r,i)})):null,c?Q.createElement("path",no({},Fe(o,!0),{fill:"none",d:Wl(s,i)})):null)}var u=Wl(r,i);return Q.createElement("path",no({},Fe(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",className:l,d:u}))};function Rm(){return Rm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Rm.apply(this,arguments)}var bd=function(t){var r=t.cx,a=t.cy,s=t.r,i=t.className,o=pt("recharts-dot",i);return r===+r&&a===+a&&s===+s?Q.createElement("circle",Rm({},Fe(t),fu(t),{className:o,cx:r,cy:a,r:s})):null};function Fc(e){"@babel/helpers - typeof";return Fc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fc(e)}var sV=["x","y","top","left","width","height","className"];function Mm(){return Mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Mm.apply(this,arguments)}function Rb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function iV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rb(Object(r),!0).forEach(function(a){oV(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function oV(e,t,r){return t=lV(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lV(e){var t=cV(e,"string");return Fc(t)==="symbol"?t:String(t)}function cV(e,t){if(Fc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Fc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dV(e,t){if(e==null)return{};var r=uV(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function uV(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}var fV=function(t,r,a,s,i,o){return"M".concat(t,",").concat(i,"v").concat(s,"M").concat(o,",").concat(r,"h").concat(a)},hV=function(t){var r=t.x,a=r===void 0?0:r,s=t.y,i=s===void 0?0:s,o=t.top,l=o===void 0?0:o,c=t.left,d=c===void 0?0:c,u=t.width,f=u===void 0?0:u,h=t.height,m=h===void 0?0:h,x=t.className,p=dV(t,sV),g=iV({x:a,y:i,top:l,left:d,width:f,height:m},p);return!be(a)||!be(i)||!be(f)||!be(m)||!be(l)||!be(d)?null:Q.createElement("path",Mm({},Fe(g,!0),{className:pt("recharts-cross",x),d:fV(a,i,f,m,l,d)}))},mV=r0,xV=Fn,pV=uN;function gV(e,t){return e&&e.length?mV(e,xV(t),pV):void 0}var vV=gV;const yV=bt(vV);var bV=r0,wV=dN,jV=Fn;function NV(e,t){return e&&e.length?bV(e,jV(t),wV):void 0}var _V=NV;const SV=bt(_V);var kV=["cx","cy","angle","ticks","axisLine"],EV=["ticks","tick","angle","tickFormatter","stroke"];function Ao(e){"@babel/helpers - typeof";return Ao=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ao(e)}function Hl(){return Hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Hl.apply(this,arguments)}function Mb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Gs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mb(Object(r),!0).forEach(function(a){f0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function $b(e,t){if(e==null)return{};var r=AV(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function AV(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function TV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lb(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,g_(a.key),a)}}function CV(e,t,r){return t&&Lb(e.prototype,t),r&&Lb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function OV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$m(e,t)}function $m(e,t){return $m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},$m(e,t)}function PV(e){var t=DV();return function(){var a=qu(e),s;if(t){var i=qu(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return FV(this,s)}}function FV(e,t){if(t&&(Ao(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return IV(e)}function IV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function qu(e){return qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qu(e)}function f0(e,t,r){return t=g_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g_(e){var t=RV(e,"string");return Ao(t)==="symbol"?t:String(t)}function RV(e,t){if(Ao(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ao(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var h0=function(e){OV(r,e);var t=PV(r);function r(){return TV(this,r),t.apply(this,arguments)}return CV(r,[{key:"getTickValueCoord",value:function(s){var i=s.coordinate,o=this.props,l=o.angle,c=o.cx,d=o.cy;return Dt(c,d,i,l)}},{key:"getTickTextAnchor",value:function(){var s=this.props.orientation,i;switch(s){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var s=this.props,i=s.cx,o=s.cy,l=s.angle,c=s.ticks,d=SV(c,function(f){return f.coordinate||0}),u=yV(c,function(f){return f.coordinate||0});return{cx:i,cy:o,startAngle:l,endAngle:l,innerRadius:u.coordinate||0,outerRadius:d.coordinate||0}}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.cx,o=s.cy,l=s.angle,c=s.ticks,d=s.axisLine,u=$b(s,kV),f=c.reduce(function(p,g){return[Math.min(p[0],g.coordinate),Math.max(p[1],g.coordinate)]},[1/0,-1/0]),h=Dt(i,o,f[0],l),m=Dt(i,o,f[1],l),x=Gs(Gs(Gs({},Fe(u)),{},{fill:"none"},Fe(d)),{},{x1:h.x,y1:h.y,x2:m.x,y2:m.y});return Q.createElement("line",Hl({className:"recharts-polar-radius-axis-line"},x))}},{key:"renderTicks",value:function(){var s=this,i=this.props,o=i.ticks,l=i.tick,c=i.angle,d=i.tickFormatter,u=i.stroke,f=$b(i,EV),h=this.getTickTextAnchor(),m=Fe(f),x=Fe(l),p=o.map(function(g,y){var b=s.getTickValueCoord(g),v=Gs(Gs(Gs(Gs({textAnchor:h,transform:"rotate(".concat(90-c,", ").concat(b.x,", ").concat(b.y,")")},m),{},{stroke:"none",fill:u},x),{},{index:y},b),{},{payload:g});return Q.createElement(ot,Hl({className:"recharts-polar-radius-axis-tick",key:"tick-".concat(y)},ji(s.props,g,y)),r.renderTickItem(l,v,d?d(g.value,y):g.value))});return Q.createElement(ot,{className:"recharts-polar-radius-axis-ticks"},p)}},{key:"render",value:function(){var s=this.props,i=s.ticks,o=s.axisLine,l=s.tick;return!i||!i.length?null:Q.createElement(ot,{className:"recharts-polar-radius-axis"},o&&this.renderAxisLine(),l&&this.renderTicks(),Er.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(s,i,o){var l;return Q.isValidElement(s)?l=Q.cloneElement(s,i):De(s)?l=s(i):l=Q.createElement(Ni,Hl({},i,{className:"recharts-polar-radius-axis-tick-value"}),o),l}}]),r}(C.PureComponent);f0(h0,"displayName","PolarRadiusAxis");f0(h0,"axisType","radiusAxis");f0(h0,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function To(e){"@babel/helpers - typeof";return To=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},To(e)}function Js(){return Js=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Js.apply(this,arguments)}function Bb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function qs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bb(Object(r),!0).forEach(function(a){m0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function MV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ub(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,v_(a.key),a)}}function $V(e,t,r){return t&&Ub(e.prototype,t),r&&Ub(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LV(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lm(e,t)}function Lm(e,t){return Lm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Lm(e,t)}function BV(e){var t=HV();return function(){var a=Ku(e),s;if(t){var i=Ku(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return UV(this,s)}}function UV(e,t){if(t&&(To(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return WV(e)}function WV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function HV(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ku(e){return Ku=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ku(e)}function m0(e,t,r){return t=v_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v_(e){var t=zV(e,"string");return To(t)==="symbol"?t:String(t)}function zV(e,t){if(To(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(To(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var VV=Math.PI/180,Wb=1e-5,x0=function(e){LV(r,e);var t=BV(r);function r(){return MV(this,r),t.apply(this,arguments)}return $V(r,[{key:"getTickLineCoord",value:function(s){var i=this.props,o=i.cx,l=i.cy,c=i.radius,d=i.orientation,u=i.tickSize,f=u||8,h=Dt(o,l,c,s.coordinate),m=Dt(o,l,c+(d==="inner"?-1:1)*f,s.coordinate);return{x1:h.x,y1:h.y,x2:m.x,y2:m.y}}},{key:"getTickTextAnchor",value:function(s){var i=this.props.orientation,o=Math.cos(-s.coordinate*VV),l;return o>Wb?l=i==="outer"?"start":"end":o<-Wb?l=i==="outer"?"end":"start":l="middle",l}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.cx,o=s.cy,l=s.radius,c=s.axisLine,d=s.axisLineType,u=qs(qs({},Fe(this.props)),{},{fill:"none"},Fe(c));if(d==="circle")return Q.createElement(bd,Js({className:"recharts-polar-angle-axis-line"},u,{cx:i,cy:o,r:l}));var f=this.props.ticks,h=f.map(function(m){return Dt(i,o,l,m.coordinate)});return Q.createElement(nV,Js({className:"recharts-polar-angle-axis-line"},u,{points:h}))}},{key:"renderTicks",value:function(){var s=this,i=this.props,o=i.ticks,l=i.tick,c=i.tickLine,d=i.tickFormatter,u=i.stroke,f=Fe(this.props),h=Fe(l),m=qs(qs({},f),{},{fill:"none"},Fe(c)),x=o.map(function(p,g){var y=s.getTickLineCoord(p),b=s.getTickTextAnchor(p),v=qs(qs(qs({textAnchor:b},f),{},{stroke:"none",fill:u},h),{},{index:g,payload:p,x:y.x2,y:y.y2});return Q.createElement(ot,Js({className:"recharts-polar-angle-axis-tick",key:"tick-".concat(g)},ji(s.props,p,g)),c&&Q.createElement("line",Js({className:"recharts-polar-angle-axis-tick-line"},m,y)),l&&r.renderTickItem(l,v,d?d(p.value,g):p.value))});return Q.createElement(ot,{className:"recharts-polar-angle-axis-ticks"},x)}},{key:"render",value:function(){var s=this.props,i=s.ticks,o=s.radius,l=s.axisLine;return o<=0||!i||!i.length?null:Q.createElement(ot,{className:"recharts-polar-angle-axis"},l&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(s,i,o){var l;return Q.isValidElement(s)?l=Q.cloneElement(s,i):De(s)?l=s(i):l=Q.createElement(Ni,Js({},i,{className:"recharts-polar-angle-axis-tick-value"}),o),l}}]),r}(C.PureComponent);m0(x0,"displayName","PolarAngleAxis");m0(x0,"axisType","angleAxis");m0(x0,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var GV=ss,qV=is,KV="[object Boolean]";function XV(e){return e===!0||e===!1||qV(e)&&GV(e)==KV}var YV=XV;const y_=bt(YV);var JV=l2,ZV=JV(Object.getPrototypeOf,Object),QV=ZV,eG=ss,tG=QV,rG=is,aG="[object Object]",nG=Function.prototype,sG=Object.prototype,b_=nG.toString,iG=sG.hasOwnProperty,oG=b_.call(Object);function lG(e){if(!rG(e)||eG(e)!=aG)return!1;var t=tG(e);if(t===null)return!0;var r=iG.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&b_.call(r)==oG}var cG=lG;const dG=bt(cG);function Ic(e){"@babel/helpers - typeof";return Ic=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ic(e)}function Xu(){return Xu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Xu.apply(this,arguments)}function uG(e,t){return xG(e)||mG(e,t)||hG(e,t)||fG()}function fG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hG(e,t){if(e){if(typeof e=="string")return Hb(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Hb(e,t)}}function Hb(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function mG(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function xG(e){if(Array.isArray(e))return e}function zb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Vb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zb(Object(r),!0).forEach(function(a){pG(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function pG(e,t,r){return t=gG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gG(e){var t=vG(e,"string");return Ic(t)==="symbol"?t:String(t)}function vG(e,t){if(Ic(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ic(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gb=function(t,r,a,s,i){var o=a-s,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+a,",").concat(r),l+="L ".concat(t+a-o/2,",").concat(r+i),l+="L ".concat(t+a-o/2-s,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},yG={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},bG=function(t){var r=Vb(Vb({},yG),t),a=C.useRef(),s=C.useState(-1),i=uG(s,2),o=i[0],l=i[1];C.useEffect(function(){if(a.current&&a.current.getTotalLength)try{var v=a.current.getTotalLength();v&&l(v)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,f=r.lowerWidth,h=r.height,m=r.className,x=r.animationEasing,p=r.animationDuration,g=r.animationBegin,y=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||f!==+f||h!==+h||u===0&&f===0||h===0)return null;var b=pt("recharts-trapezoid",m);return y?Q.createElement(un,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:d},to:{upperWidth:u,lowerWidth:f,height:h,x:c,y:d},duration:p,animationEasing:x,isActive:y},function(v){var w=v.upperWidth,j=v.lowerWidth,N=v.height,_=v.x,E=v.y;return Q.createElement(un,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:g,duration:p,easing:x},Q.createElement("path",Xu({},Fe(r,!0),{className:b,d:Gb(_,E,w,j,N),ref:a})))}):Q.createElement("g",null,Q.createElement("path",Xu({},Fe(r,!0),{className:b,d:Gb(c,d,u,f,h)})))},wG=["option","shapeType","propTransformer","activeClassName","isActive"];function Dc(e){"@babel/helpers - typeof";return Dc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dc(e)}function jG(e,t){if(e==null)return{};var r=NG(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function NG(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function qb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Kb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qb(Object(r),!0).forEach(function(a){_G(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function _G(e,t,r){return t=SG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SG(e){var t=kG(e,"string");return Dc(t)==="symbol"?t:String(t)}function kG(e,t){if(Dc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Dc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EG(e,t){return Kb(Kb({},t),e)}function AG(e,t){return e==="symbols"}function Xb(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return Q.createElement(_p,r);case"trapezoid":return Q.createElement(bG,r);case"sector":return Q.createElement(p_,r);case"symbols":if(AG(t))return Q.createElement(Xx,r);break;default:return null}}function w_(e){var t=e.option,r=e.shapeType,a=e.propTransformer,s=a===void 0?EG:a,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,c=jG(e,wG),d;if(C.isValidElement(t))d=C.cloneElement(t,c);else if(De(t))d=t(c);else if(dG(t)&&!y_(t)){var u=c,f=s(t,u);d=Q.createElement(Xb,{shapeType:r,elementProps:f})}else{var h=c;d=Q.createElement(Xb,{shapeType:r,elementProps:h})}return l?Q.createElement(ot,{className:o},d):d}function p0(e,t){return"trapezoids"in e.props}function g0(e,t){return"sectors"in e.props}function Rc(e,t){return"points"in e.props}function TG(e,t){var r,a,s=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(a=t.labelViewBox)===null||a===void 0?void 0:a.y)||e.y===t.y;return s&&i}function CG(e,t){var r=e.endAngle===t.endAngle,a=e.startAngle===t.startAngle;return r&&a}function OG(e,t){var r=e.x===t.x,a=e.y===t.y,s=e.z===t.z;return r&&a&&s}function PG(e,t){var r;return p0(e)?r=TG:g0(e)?r=CG:Rc(e)&&(r=OG),r}function FG(e,t){var r;return p0(e)?r="trapezoids":g0(e)?r="sectors":Rc(e)&&(r="points"),r}function IG(e,t){if(p0(e)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(g0(e)){var a;return(a=t.tooltipPayload)===null||a===void 0||(a=a[0])===null||a===void 0||(a=a.payload)===null||a===void 0?void 0:a.payload}return Rc(e)?t.payload:{}}function DG(e){var t=e.activeTooltipItem,r=e.graphicalItem,a=e.itemData,s=FG(r),i=IG(r,t),o=a.filter(function(c,d){var u=_i(i,c),f=r.props[s].filter(function(x){var p=PG(r);return p(x,t)}),h=r.props[s].indexOf(f[f.length-1]),m=d===h;return u&&m}),l=a.indexOf(o[o.length-1]);return l}var ou;function Co(e){"@babel/helpers - typeof";return Co=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Co(e)}function so(){return so=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},so.apply(this,arguments)}function Yb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(r),!0).forEach(function(a){za(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function RG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jb(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,j_(a.key),a)}}function MG(e,t,r){return t&&Jb(e.prototype,t),r&&Jb(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $G(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bm(e,t)}function Bm(e,t){return Bm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Bm(e,t)}function LG(e){var t=UG();return function(){var a=Yu(e),s;if(t){var i=Yu(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return BG(this,s)}}function BG(e,t){if(t&&(Co(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return to(e)}function to(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UG(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Yu(e){return Yu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Yu(e)}function za(e,t,r){return t=j_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j_(e){var t=WG(e,"string");return Co(t)==="symbol"?t:String(t)}function WG(e,t){if(Co(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Co(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ls=function(e){$G(r,e);var t=LG(r);function r(a){var s;return RG(this,r),s=t.call(this,a),za(to(s),"pieRef",null),za(to(s),"sectorRefs",[]),za(to(s),"id",Ri("recharts-pie-")),za(to(s),"handleAnimationEnd",function(){var i=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),De(i)&&i()}),za(to(s),"handleAnimationStart",function(){var i=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),De(i)&&i()}),s.state={isAnimationFinished:!a.isAnimationActive,prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,sectorToFocus:0},s}return MG(r,[{key:"isActiveIndex",value:function(s){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(s)!==-1:s===i}},{key:"hasActiveIndex",value:function(){var s=this.props.activeIndex;return Array.isArray(s)?s.length!==0:s||s===0}},{key:"renderLabels",value:function(s){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.label,c=o.labelLine,d=o.dataKey,u=o.valueKey,f=Fe(this.props),h=Fe(l),m=Fe(c),x=l&&l.offsetRadius||20,p=s.map(function(g,y){var b=(g.startAngle+g.endAngle)/2,v=Dt(g.cx,g.cy,g.outerRadius+x,b),w=Ut(Ut(Ut(Ut({},f),g),{},{stroke:"none"},h),{},{index:y,textAnchor:r.getTextAnchor(v.x,g.cx)},v),j=Ut(Ut(Ut(Ut({},f),g),{},{fill:"none",stroke:g.fill},m),{},{index:y,points:[Dt(g.cx,g.cy,g.outerRadius,b),v],key:"line"}),N=d;return Pe(d)&&Pe(u)?N="value":Pe(d)&&(N=u),Q.createElement(ot,{key:"label-".concat(y)},c&&r.renderLabelLineItem(c,j),r.renderLabelItem(l,w,ur(g,N)))});return Q.createElement(ot,{className:"recharts-pie-labels"},p)}},{key:"renderSectorsStatically",value:function(s){var i=this,o=this.props,l=o.activeShape,c=o.blendStroke,d=o.inactiveShape;return s.map(function(u,f){var h=i.isActiveIndex(f),m=d&&i.hasActiveIndex()?d:null,x=h?l:m,p=Ut(Ut({},u),{},{stroke:c?u.fill:u.stroke,tabIndex:-1});return Q.createElement(ot,so({ref:function(y){y&&!i.sectorRefs.includes(y)&&i.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},ji(i.props,u,f),{key:"sector-".concat(f)}),Q.createElement(w_,so({option:x,isActive:h,shapeType:"sector"},p)))})}},{key:"renderSectorsWithAnimation",value:function(){var s=this,i=this.props,o=i.sectors,l=i.isAnimationActive,c=i.animationBegin,d=i.animationDuration,u=i.animationEasing,f=i.animationId,h=this.state,m=h.prevSectors,x=h.prevIsAnimationActive;return Q.createElement(un,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(f,"-").concat(x),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(p){var g=p.t,y=[],b=o&&o[0],v=b.startAngle;return o.forEach(function(w,j){var N=m&&m[j],_=j>0?Ar(w,"paddingAngle",0):0;if(N){var E=gr(N.endAngle-N.startAngle,w.endAngle-w.startAngle),S=Ut(Ut({},w),{},{startAngle:v+_,endAngle:v+E(g)+_});y.push(S),v=S.endAngle}else{var k=w.endAngle,O=w.startAngle,P=gr(0,k-O),A=P(g),R=Ut(Ut({},w),{},{startAngle:v+_,endAngle:v+A+_});y.push(R),v=R.endAngle}}),Q.createElement(ot,null,s.renderSectorsStatically(y))})}},{key:"attachKeyboardHandlers",value:function(s){var i=this;s.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var l=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[l].focus(),i.setState({sectorToFocus:l});break}case"ArrowRight":{var c=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[c].focus(),i.setState({sectorToFocus:c});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var s=this.props,i=s.sectors,o=s.isAnimationActive,l=this.state.prevSectors;return o&&i&&i.length&&(!l||!_i(l,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var s=this,i=this.props,o=i.hide,l=i.sectors,c=i.className,d=i.label,u=i.cx,f=i.cy,h=i.innerRadius,m=i.outerRadius,x=i.isAnimationActive,p=this.state.isAnimationFinished;if(o||!l||!l.length||!be(u)||!be(f)||!be(h)||!be(m))return null;var g=pt("recharts-pie",c);return Q.createElement(ot,{tabIndex:this.props.rootTabIndex,className:g,ref:function(b){s.pieRef=b}},this.renderSectors(),d&&this.renderLabels(l),Er.renderCallByParent(this.props,null,!1),(!x||p)&&En.renderCallByParent(this.props,l,!1))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return i.prevIsAnimationActive!==s.isAnimationActive?{prevIsAnimationActive:s.isAnimationActive,prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:[],isAnimationFinished:!0}:s.isAnimationActive&&s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:s.sectors!==i.curSectors?{curSectors:s.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(s,i){return s>i?"start":s<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(s,i){return Q.isValidElement(s)?Q.cloneElement(s,i):De(s)?s(i):Q.createElement(fi,so({},i,{type:"linear",className:"recharts-pie-label-line"}))}},{key:"renderLabelItem",value:function(s,i,o){if(Q.isValidElement(s))return Q.cloneElement(s,i);var l=o;return De(s)&&(l=s(i),Q.isValidElement(l))?l:Q.createElement(Ni,so({},i,{alignmentBaseline:"middle",className:"recharts-pie-label-text"}),l)}}]),r}(C.PureComponent);ou=ls;za(ls,"displayName","Pie");za(ls,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!$s.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});za(ls,"parseDeltaAngle",function(e,t){var r=ia(t-e),a=Math.min(Math.abs(t-e),360);return r*a});za(ls,"getRealPieData",function(e){var t=e.props,r=t.data,a=t.children,s=Fe(e.props),i=Ea(a,t0);return r&&r.length?r.map(function(o,l){return Ut(Ut(Ut({payload:o},s),o),i&&i[l]&&i[l].props)}):i&&i.length?i.map(function(o){return Ut(Ut({},s),o.props)}):[]});za(ls,"parseCoordinateOfPie",function(e,t){var r=t.top,a=t.left,s=t.width,i=t.height,o=h_(s,i),l=a+ma(e.props.cx,s,s/2),c=r+ma(e.props.cy,i,i/2),d=ma(e.props.innerRadius,o,0),u=ma(e.props.outerRadius,o,o*.8),f=e.props.maxRadius||Math.sqrt(s*s+i*i)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:f}});za(ls,"getComposedData",function(e){var t=e.item,r=e.offset,a=ou.getRealPieData(t);if(!a||!a.length)return null;var s=t.props,i=s.cornerRadius,o=s.startAngle,l=s.endAngle,c=s.paddingAngle,d=s.dataKey,u=s.nameKey,f=s.valueKey,h=s.tooltipType,m=Math.abs(t.props.minAngle),x=ou.parseCoordinateOfPie(t,r),p=ou.parseDeltaAngle(o,l),g=Math.abs(p),y=d;Pe(d)&&Pe(f)?(qn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y="value"):Pe(d)&&(qn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y=f);var b=a.filter(function(E){return ur(E,y,0)!==0}).length,v=(g>=360?b:b-1)*c,w=g-b*m-v,j=a.reduce(function(E,S){var k=ur(S,y,0);return E+(be(k)?k:0)},0),N;if(j>0){var _;N=a.map(function(E,S){var k=ur(E,y,0),O=ur(E,u,S),P=(be(k)?k:0)/j,A;S?A=_.endAngle+ia(p)*c*(k!==0?1:0):A=o;var R=A+ia(p)*((k!==0?m:0)+P*w),T=(A+R)/2,F=(x.innerRadius+x.outerRadius)/2,W=[{name:O,value:k,payload:E,dataKey:y,type:h}],K=Dt(x.cx,x.cy,F,T);return _=Ut(Ut(Ut({percent:P,cornerRadius:i,name:O,tooltipPayload:W,midAngle:T,middleRadius:F,tooltipPosition:K},E),x),{},{value:ur(E,y),startAngle:A,endAngle:R,payload:E,paddingAngle:ia(p)*c}),_})}return Ut(Ut({},x),{},{sectors:N,data:a})});var HG=Math.ceil,zG=Math.max;function VG(e,t,r,a){for(var s=-1,i=zG(HG((t-e)/(r||1)),0),o=Array(i);i--;)o[a?i:++s]=e,e+=r;return o}var GG=VG,qG=aN,Zb=1/0,KG=17976931348623157e292;function XG(e){if(!e)return e===0?e:0;if(e=qG(e),e===Zb||e===-Zb){var t=e<0?-1:1;return t*KG}return e===e?e:0}var N_=XG,YG=GG,JG=e0,sh=N_;function ZG(e){return function(t,r,a){return a&&typeof a!="number"&&JG(t,r,a)&&(r=a=void 0),t=sh(t),r===void 0?(r=t,t=0):r=sh(r),a=a===void 0?t<r?1:-1:sh(a),YG(t,r,a,e)}}var QG=ZG,eq=QG,tq=eq(),rq=tq;const Ju=bt(rq);function Mc(e){"@babel/helpers - typeof";return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mc(e)}function Qb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function e1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qb(Object(r),!0).forEach(function(a){__(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qb(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function __(e,t,r){return t=aq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aq(e){var t=nq(e,"string");return Mc(t)==="symbol"?t:String(t)}function nq(e,t){if(Mc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Mc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sq=["Webkit","Moz","O","ms"],iq=function(t,r){var a=t.replace(/(\w)/,function(i){return i.toUpperCase()}),s=sq.reduce(function(i,o){return e1(e1({},i),{},__({},o+a,r))},{});return s[t]=r,s};function Oo(e){"@babel/helpers - typeof";return Oo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oo(e)}function Zu(){return Zu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Zu.apply(this,arguments)}function t1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ih(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t1(Object(r),!0).forEach(function(a){wa(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function oq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,S_(a.key),a)}}function lq(e,t,r){return t&&r1(e.prototype,t),r&&r1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cq(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Um(e,t)}function Um(e,t){return Um=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Um(e,t)}function dq(e){var t=fq();return function(){var a=Qu(e),s;if(t){var i=Qu(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return uq(this,s)}}function uq(e,t){if(t&&(Oo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xn(e)}function xn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Qu(e){return Qu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Qu(e)}function wa(e,t,r){return t=S_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S_(e){var t=hq(e,"string");return Oo(t)==="symbol"?t:String(t)}function hq(e,t){if(Oo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Oo(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mq=function(t){var r=t.data,a=t.startIndex,s=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=Bl().domain(Ju(0,c)).range([i,i+o-l]),u=d.domain().map(function(f){return d(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(a),endX:d(s),scale:d,scaleValues:u}},a1=function(t){return t.changedTouches&&!!t.changedTouches.length},$c=function(e){cq(r,e);var t=dq(r);function r(a){var s;return oq(this,r),s=t.call(this,a),wa(xn(s),"handleDrag",function(i){s.leaveTimer&&(clearTimeout(s.leaveTimer),s.leaveTimer=null),s.state.isTravellerMoving?s.handleTravellerMove(i):s.state.isSlideMoving&&s.handleSlideDrag(i)}),wa(xn(s),"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&s.handleDrag(i.changedTouches[0])}),wa(xn(s),"handleDragEnd",function(){s.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=s.props,o=i.endIndex,l=i.onDragEnd,c=i.startIndex;l==null||l({endIndex:o,startIndex:c})}),s.detachDragEndListener()}),wa(xn(s),"handleLeaveWrapper",function(){(s.state.isTravellerMoving||s.state.isSlideMoving)&&(s.leaveTimer=window.setTimeout(s.handleDragEnd,s.props.leaveTimeOut))}),wa(xn(s),"handleEnterSlideOrTraveller",function(){s.setState({isTextActive:!0})}),wa(xn(s),"handleLeaveSlideOrTraveller",function(){s.setState({isTextActive:!1})}),wa(xn(s),"handleSlideDragStart",function(i){var o=a1(i)?i.changedTouches[0]:i;s.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:o.pageX}),s.attachDragEndListener()}),s.travellerDragStartHandlers={startX:s.handleTravellerDragStart.bind(xn(s),"startX"),endX:s.handleTravellerDragStart.bind(xn(s),"endX")},s.state={},s}return lq(r,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(s){var i=s.startX,o=s.endX,l=this.state.scaleValues,c=this.props,d=c.gap,u=c.data,f=u.length-1,h=Math.min(i,o),m=Math.max(i,o),x=r.getIndexInRange(l,h),p=r.getIndexInRange(l,m);return{startIndex:x-x%d,endIndex:p===f?f:p-p%d}}},{key:"getTextOfTick",value:function(s){var i=this.props,o=i.data,l=i.tickFormatter,c=i.dataKey,d=ur(o[s],c,s);return De(l)?l(d,s):d}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(s){var i=this.state,o=i.slideMoveStartX,l=i.startX,c=i.endX,d=this.props,u=d.x,f=d.width,h=d.travellerWidth,m=d.startIndex,x=d.endIndex,p=d.onChange,g=s.pageX-o;g>0?g=Math.min(g,u+f-h-c,u+f-h-l):g<0&&(g=Math.max(g,u-l,u-c));var y=this.getIndex({startX:l+g,endX:c+g});(y.startIndex!==m||y.endIndex!==x)&&p&&p(y),this.setState({startX:l+g,endX:c+g,slideMoveStartX:s.pageX})}},{key:"handleTravellerDragStart",value:function(s,i){var o=a1(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:s,brushMoveStartX:o.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(s){var i,o=this.state,l=o.brushMoveStartX,c=o.movingTravellerId,d=o.endX,u=o.startX,f=this.state[c],h=this.props,m=h.x,x=h.width,p=h.travellerWidth,g=h.onChange,y=h.gap,b=h.data,v={startX:this.state.startX,endX:this.state.endX},w=s.pageX-l;w>0?w=Math.min(w,m+x-p-f):w<0&&(w=Math.max(w,m-f)),v[c]=f+w;var j=this.getIndex(v),N=j.startIndex,_=j.endIndex,E=function(){var k=b.length-1;return c==="startX"&&(d>u?N%y===0:_%y===0)||d<u&&_===k||c==="endX"&&(d>u?_%y===0:N%y===0)||d>u&&_===k};this.setState((i={},wa(i,c,f+w),wa(i,"brushMoveStartX",s.pageX),i),function(){g&&E()&&g(j)})}},{key:"handleTravellerMoveKeyboard",value:function(s,i){var o=this,l=this.state,c=l.scaleValues,d=l.startX,u=l.endX,f=this.state[i],h=c.indexOf(f);if(h!==-1){var m=h+s;if(!(m===-1||m>=c.length)){var x=c[m];i==="startX"&&x>=u||i==="endX"&&x<=d||this.setState(wa({},i,x),function(){o.props.onChange(o.getIndex({startX:o.state.startX,endX:o.state.endX}))})}}}},{key:"renderBackground",value:function(){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,d=s.fill,u=s.stroke;return Q.createElement("rect",{stroke:u,fill:d,x:i,y:o,width:l,height:c})}},{key:"renderPanorama",value:function(){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,d=s.data,u=s.children,f=s.padding,h=C.Children.only(u);return h?Q.cloneElement(h,{x:i,y:o,width:l,height:c,margin:f,compact:!0,data:d}):null}},{key:"renderTravellerLayer",value:function(s,i){var o=this,l=this.props,c=l.y,d=l.travellerWidth,u=l.height,f=l.traveller,h=Math.max(s,this.props.x),m=ih(ih({},Fe(this.props)),{},{x:h,y:c,width:d,height:u});return Q.createElement(ot,{tabIndex:0,role:"slider",className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(p){["ArrowLeft","ArrowRight"].includes(p.key)&&(p.preventDefault(),p.stopPropagation(),o.handleTravellerMoveKeyboard(p.key==="ArrowRight"?1:-1,i))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},r.renderTraveller(f,m))}},{key:"renderSlide",value:function(s,i){var o=this.props,l=o.y,c=o.height,d=o.stroke,u=o.travellerWidth,f=Math.min(s,i)+u,h=Math.max(Math.abs(i-s)-u,0);return Q.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:d,fillOpacity:.2,x:f,y:l,width:h,height:c})}},{key:"renderText",value:function(){var s=this.props,i=s.startIndex,o=s.endIndex,l=s.y,c=s.height,d=s.travellerWidth,u=s.stroke,f=this.state,h=f.startX,m=f.endX,x=5,p={pointerEvents:"none",fill:u};return Q.createElement(ot,{className:"recharts-brush-texts"},Q.createElement(Ni,Zu({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,m)-x,y:l+c/2},p),this.getTextOfTick(i)),Q.createElement(Ni,Zu({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,m)+d+x,y:l+c/2},p),this.getTextOfTick(o)))}},{key:"render",value:function(){var s=this.props,i=s.data,o=s.className,l=s.children,c=s.x,d=s.y,u=s.width,f=s.height,h=s.alwaysShowText,m=this.state,x=m.startX,p=m.endX,g=m.isTextActive,y=m.isSlideMoving,b=m.isTravellerMoving,v=m.isTravellerFocused;if(!i||!i.length||!be(c)||!be(d)||!be(u)||!be(f)||u<=0||f<=0)return null;var w=pt("recharts-brush",o),j=Q.Children.count(l)===1,N=iq("userSelect","none");return Q.createElement(ot,{className:w,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:N},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(x,p),this.renderTravellerLayer(x,"startX"),this.renderTravellerLayer(p,"endX"),(g||y||b||v||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(s){var i=s.x,o=s.y,l=s.width,c=s.height,d=s.stroke,u=Math.floor(o+c/2)-1;return Q.createElement(Q.Fragment,null,Q.createElement("rect",{x:i,y:o,width:l,height:c,fill:d,stroke:"none"}),Q.createElement("line",{x1:i+1,y1:u,x2:i+l-1,y2:u,fill:"none",stroke:"#fff"}),Q.createElement("line",{x1:i+1,y1:u+2,x2:i+l-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(s,i){var o;return Q.isValidElement(s)?o=Q.cloneElement(s,i):De(s)?o=s(i):o=r.renderDefaultTraveller(i),o}},{key:"getDerivedStateFromProps",value:function(s,i){var o=s.data,l=s.width,c=s.x,d=s.travellerWidth,u=s.updateId,f=s.startIndex,h=s.endIndex;if(o!==i.prevData||u!==i.prevUpdateId)return ih({prevData:o,prevTravellerWidth:d,prevUpdateId:u,prevX:c,prevWidth:l},o&&o.length?mq({data:o,width:l,x:c,travellerWidth:d,startIndex:f,endIndex:h}):{scale:null,scaleValues:null});if(i.scale&&(l!==i.prevWidth||c!==i.prevX||d!==i.prevTravellerWidth)){i.scale.range([c,c+l-d]);var m=i.scale.domain().map(function(x){return i.scale(x)});return{prevData:o,prevTravellerWidth:d,prevUpdateId:u,prevX:c,prevWidth:l,startX:i.scale(s.startIndex),endX:i.scale(s.endIndex),scaleValues:m}}return null}},{key:"getIndexInRange",value:function(s,i){for(var o=s.length,l=0,c=o-1;c-l>1;){var d=Math.floor((l+c)/2);s[d]>i?c=d:l=d}return i>=s[c]?c:l}}]),r}(C.PureComponent);wa($c,"displayName","Brush");wa($c,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var xq=Jx;function pq(e,t){var r;return xq(e,function(a,s,i){return r=t(a,s,i),!r}),!!r}var gq=pq,vq=e2,yq=Fn,bq=gq,wq=da,jq=e0;function Nq(e,t,r){var a=wq(e)?vq:bq;return r&&jq(e,t,r)&&(t=void 0),a(e,yq(t))}var _q=Nq;const Sq=bt(_q);var An=function(t,r){var a=t.alwaysShow,s=t.ifOverflow;return a&&(s="extendDomain"),s===r};function kq(e,t){for(var r=-1,a=e==null?0:e.length;++r<a;)if(!t(e[r],r,e))return!1;return!0}var Eq=kq,Aq=Jx;function Tq(e,t){var r=!0;return Aq(e,function(a,s,i){return r=!!t(a,s,i),r}),r}var Cq=Tq,Oq=Eq,Pq=Cq,Fq=Fn,Iq=da,Dq=e0;function Rq(e,t,r){var a=Iq(e)?Oq:Pq;return r&&Dq(e,t,r)&&(t=void 0),a(e,Fq(t))}var Mq=Rq;const k_=bt(Mq);var n1=tN;function $q(e,t,r){t=="__proto__"&&n1?n1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Lq=$q,Bq=Lq,Uq=Q2,Wq=Fn;function Hq(e,t){var r={};return t=Wq(t),Uq(e,function(a,s,i){Bq(r,s,t(a,s,i))}),r}var zq=Hq;const Vq=bt(zq);function Lc(e){"@babel/helpers - typeof";return Lc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lc(e)}var Gq=["x","y"];function Wm(){return Wm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wm.apply(this,arguments)}function s1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function jl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s1(Object(r),!0).forEach(function(a){qq(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function qq(e,t,r){return t=Kq(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kq(e){var t=Xq(e,"string");return Lc(t)==="symbol"?t:String(t)}function Xq(e,t){if(Lc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Lc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yq(e,t){if(e==null)return{};var r=Jq(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function Jq(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Zq(e,t){var r=e.x,a=e.y,s=Yq(e,Gq),i="".concat(r),o=parseInt(i,10),l="".concat(a),c=parseInt(l,10),d="".concat(t.height||s.height),u=parseInt(d,10),f="".concat(t.width||s.width),h=parseInt(f,10);return jl(jl(jl(jl(jl({},t),s),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:h,name:t.name,radius:t.radius})}function i1(e){return Q.createElement(w_,Wm({shapeType:"rectangle",propTransformer:Zq,activeClassName:"recharts-active-bar"},e))}var Qq=["value","background"];function Po(e){"@babel/helpers - typeof";return Po=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Po(e)}function eK(e,t){if(e==null)return{};var r=tK(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function tK(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function ef(){return ef=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ef.apply(this,arguments)}function o1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function _r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o1(Object(r),!0).forEach(function(a){ws(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function rK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,E_(a.key),a)}}function aK(e,t,r){return t&&l1(e.prototype,t),r&&l1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function nK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hm(e,t)}function Hm(e,t){return Hm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Hm(e,t)}function sK(e){var t=oK();return function(){var a=tf(e),s;if(t){var i=tf(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return iK(this,s)}}function iK(e,t){if(t&&(Po(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Tl(e)}function Tl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function tf(e){return tf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},tf(e)}function ws(e,t,r){return t=E_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E_(e){var t=lK(e,"string");return Po(t)==="symbol"?t:String(t)}function lK(e,t){if(Po(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Po(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var As=function(e){nK(r,e);var t=sK(r);function r(){var a;rK(this,r);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=t.call.apply(t,[this].concat(i)),ws(Tl(a),"state",{isAnimationFinished:!1}),ws(Tl(a),"id",Ri("recharts-bar-")),ws(Tl(a),"handleAnimationEnd",function(){var l=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),l&&l()}),ws(Tl(a),"handleAnimationStart",function(){var l=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),l&&l()}),a}return aK(r,[{key:"renderRectanglesStatically",value:function(s){var i=this,o=this.props,l=o.shape,c=o.dataKey,d=o.activeIndex,u=o.activeBar,f=Fe(this.props);return s&&s.map(function(h,m){var x=m===d,p=x?u:l,g=_r(_r(_r({},f),h),{},{isActive:x,option:p,index:m,dataKey:c,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return Q.createElement(ot,ef({className:"recharts-bar-rectangle"},ji(i.props,h,m),{key:"rectangle-".concat(m)}),Q.createElement(i1,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var s=this,i=this.props,o=i.data,l=i.layout,c=i.isAnimationActive,d=i.animationBegin,u=i.animationDuration,f=i.animationEasing,h=i.animationId,m=this.state.prevData;return Q.createElement(un,{begin:d,duration:u,isActive:c,easing:f,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var p=x.t,g=o.map(function(y,b){var v=m&&m[b];if(v){var w=gr(v.x,y.x),j=gr(v.y,y.y),N=gr(v.width,y.width),_=gr(v.height,y.height);return _r(_r({},y),{},{x:w(p),y:j(p),width:N(p),height:_(p)})}if(l==="horizontal"){var E=gr(0,y.height),S=E(p);return _r(_r({},y),{},{y:y.y+y.height-S,height:S})}var k=gr(0,y.width),O=k(p);return _r(_r({},y),{},{width:O})});return Q.createElement(ot,null,s.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var s=this.props,i=s.data,o=s.isAnimationActive,l=this.state.prevData;return o&&i&&i.length&&(!l||!_i(l,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var s=this,i=this.props,o=i.data,l=i.dataKey,c=i.activeIndex,d=Fe(this.props.background);return o.map(function(u,f){u.value;var h=u.background,m=eK(u,Qq);if(!h)return null;var x=_r(_r(_r(_r(_r({},m),{},{fill:"#eee"},h),d),ji(s.props,u,f)),{},{onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd,dataKey:l,index:f,key:"background-bar-".concat(f),className:"recharts-bar-background-rectangle"});return Q.createElement(i1,ef({option:s.props.background,isActive:f===c},x))})}},{key:"renderErrorBar",value:function(s,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.data,c=o.xAxis,d=o.yAxis,u=o.layout,f=o.children,h=Ea(f,yd);if(!h)return null;var m=u==="vertical"?l[0].height/2:l[0].width/2,x=function(y,b){var v=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:v,errorVal:ur(y,b)}},p={clipPath:s?"url(#clipPath-".concat(i,")"):null};return Q.createElement(ot,p,h.map(function(g,y){return Q.cloneElement(g,{key:"error-bar-".concat(y),data:l,xAxis:c,yAxis:d,layout:u,offset:m,dataPointFormatter:x})}))}},{key:"render",value:function(){var s=this.props,i=s.hide,o=s.data,l=s.className,c=s.xAxis,d=s.yAxis,u=s.left,f=s.top,h=s.width,m=s.height,x=s.isAnimationActive,p=s.background,g=s.id;if(i||!o||!o.length)return null;var y=this.state.isAnimationFinished,b=pt("recharts-bar",l),v=c&&c.allowDataOverflow,w=d&&d.allowDataOverflow,j=v||w,N=Pe(g)?this.id:g;return Q.createElement(ot,{className:b},v||w?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(N)},Q.createElement("rect",{x:v?u:u-h/2,y:w?f:f-m/2,width:v?h:h*2,height:w?m:m*2}))):null,Q.createElement(ot,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(N,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,N),(!x||y)&&En.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curData:s.data,prevData:i.curData}:s.data!==i.curData?{curData:s.data}:null}}]),r}(C.PureComponent);ws(As,"displayName","Bar");ws(As,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!0,isAnimationActive:!$s.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});ws(As,"getComposedData",function(e){var t=e.props,r=e.item,a=e.barPosition,s=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=NH(a,r);if(!m)return null;var x=t.layout,p=r.props,g=p.dataKey,y=p.children,b=p.minPointSize,v=x==="horizontal"?o:i,w=d?v.scale.domain():null,j=CH({numericAxis:v}),N=Ea(y,t0),_=f.map(function(E,S){var k,O,P,A,R,T;if(d?k=_H(d[u+S],w):(k=ur(E,g),hr(k)||(k=[j,k])),x==="horizontal"){var F,W=[o.scale(k[0]),o.scale(k[1])],K=W[0],B=W[1];O=mb({axis:i,ticks:l,bandSize:s,offset:m.offset,entry:E,index:S}),P=(F=B??K)!==null&&F!==void 0?F:void 0,A=m.size;var L=K-B;if(R=Number.isNaN(L)?0:L,T={x:O,y:o.y,width:A,height:o.height},Math.abs(b)>0&&Math.abs(R)<Math.abs(b)){var ee=ia(R||b)*(Math.abs(b)-Math.abs(R));P-=ee,R+=ee}}else{var M=[i.scale(k[0]),i.scale(k[1])],G=M[0],V=M[1];if(O=G,P=mb({axis:o,ticks:c,bandSize:s,offset:m.offset,entry:E,index:S}),A=V-G,R=m.size,T={x:i.x,y:P,width:i.width,height:R},Math.abs(b)>0&&Math.abs(A)<Math.abs(b)){var H=ia(A||b)*(Math.abs(b)-Math.abs(A));A+=H}}return _r(_r(_r({},E),{},{x:O,y:P,width:A,height:R,value:d?k:k[1],payload:E,background:T},N&&N[S]&&N[S].props),{},{tooltipPayload:[u_(r,E)],tooltipPosition:{x:O+A/2,y:P+R/2}})});return _r({data:_,layout:x},h)});function Bc(e){"@babel/helpers - typeof";return Bc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bc(e)}function cK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,A_(a.key),a)}}function dK(e,t,r){return t&&c1(e.prototype,t),r&&c1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function d1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d1(Object(r),!0).forEach(function(a){v0(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function v0(e,t,r){return t=A_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A_(e){var t=uK(e,"string");return Bc(t)==="symbol"?t:String(t)}function uK(e,t){if(Bc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Bc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sp=function(t,r,a,s,i){var o=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),f={left:a.left,leftMirror:a.left,right:o-a.right,rightMirror:o-a.right,top:a.top,topMirror:a.top,bottom:l-a.bottom,bottomMirror:l-a.bottom},h=!!Un(d,As);return u.reduce(function(m,x){var p=r[x],g=p.orientation,y=p.domain,b=p.padding,v=b===void 0?{}:b,w=p.mirror,j=p.reversed,N="".concat(g).concat(w?"Mirror":""),_,E,S,k,O;if(p.type==="number"&&(p.padding==="gap"||p.padding==="no-gap")){var P=y[1]-y[0],A=1/0,R=p.categoricalDomain.sort();R.forEach(function(V,H){H>0&&(A=Math.min((V||0)-(R[H-1]||0),A))});var T=A/P,F=p.layout==="vertical"?a.height:a.width;if(p.padding==="gap"&&(_=T*F/2),p.padding==="no-gap"){var W=ma(t.barCategoryGap,T*F),K=T*F/2;_=K-W-(K-W)/F*W}}s==="xAxis"?E=[a.left+(v.left||0)+(_||0),a.left+a.width-(v.right||0)-(_||0)]:s==="yAxis"?E=c==="horizontal"?[a.top+a.height-(v.bottom||0),a.top+(v.top||0)]:[a.top+(v.top||0)+(_||0),a.top+a.height-(v.bottom||0)-(_||0)]:E=p.range,j&&(E=[E[1],E[0]]);var B=o_(p,i,h),L=B.scale,ee=B.realScaleType;L.domain(y).range(E),l_(L);var M=c_(L,tn(tn({},p),{},{realScaleType:ee}));s==="xAxis"?(O=g==="top"&&!w||g==="bottom"&&w,S=a.left,k=f[N]-O*p.height):s==="yAxis"&&(O=g==="left"&&!w||g==="right"&&w,S=f[N]-O*p.width,k=a.top);var G=tn(tn(tn({},p),M),{},{realScaleType:ee,x:S,y:k,scale:L,width:s==="xAxis"?a.width:p.width,height:s==="yAxis"?a.height:p.height});return G.bandSize=Hu(G,M),!p.hide&&s==="xAxis"?f[N]+=(O?-1:1)*G.height:p.hide||(f[N]+=(O?-1:1)*G.width),tn(tn({},m),{},v0({},x,G))},{})},T_=function(t,r){var a=t.x,s=t.y,i=r.x,o=r.y;return{x:Math.min(a,i),y:Math.min(s,o),width:Math.abs(i-a),height:Math.abs(o-s)}},fK=function(t){var r=t.x1,a=t.y1,s=t.x2,i=t.y2;return T_({x:r,y:a},{x:s,y:i})},C_=function(){function e(t){cK(this,e),this.scale=t}return dK(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=a.bandAware,i=a.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var a=this.range(),s=a[0],i=a[a.length-1];return s<=i?r>=s&&r<=i:r>=i&&r<=s}}],[{key:"create",value:function(r){return new e(r)}}]),e}();v0(C_,"EPS",1e-4);var kp=function(t){var r=Object.keys(t).reduce(function(a,s){return tn(tn({},a),{},v0({},s,C_.create(t[s])))},{});return tn(tn({},r),{},{apply:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return Vq(s,function(c,d){return r[d].apply(c,{bandAware:o,position:l})})},isInRange:function(s){return k_(s,function(i,o){return r[o].isInRange(i)})}})};function hK(e){return(e%180+180)%180}var mK=function(t){var r=t.width,a=t.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=hK(s),o=i*Math.PI/180,l=Math.atan(a/r),c=o>l&&o<Math.PI-l?a/Math.sin(o):r/Math.cos(o);return Math.abs(c)};function Uc(e){"@babel/helpers - typeof";return Uc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uc(e)}function u1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function f1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u1(Object(r),!0).forEach(function(a){xK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function xK(e,t,r){return t=pK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pK(e){var t=gK(e,"string");return Uc(t)==="symbol"?t:String(t)}function gK(e,t){if(Uc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Uc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vK(e,t){return jK(e)||wK(e,t)||bK(e,t)||yK()}function yK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bK(e,t){if(e){if(typeof e=="string")return h1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h1(e,t)}}function h1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function wK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function jK(e){if(Array.isArray(e))return e}function zm(){return zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},zm.apply(this,arguments)}var NK=function(t,r){var a;return Q.isValidElement(t)?a=Q.cloneElement(t,r):De(t)?a=t(r):a=Q.createElement("line",zm({},r,{className:"recharts-reference-line-line"})),a},_K=function(t,r,a,s,i){var o=i.viewBox,l=o.x,c=o.y,d=o.width,u=o.height,f=i.position;if(a){var h=i.y,m=i.yAxis.orientation,x=t.y.apply(h,{position:f});if(An(i,"discard")&&!t.y.isInRange(x))return null;var p=[{x:l+d,y:x},{x:l,y:x}];return m==="left"?p.reverse():p}if(r){var g=i.x,y=i.xAxis.orientation,b=t.x.apply(g,{position:f});if(An(i,"discard")&&!t.x.isInRange(b))return null;var v=[{x:b,y:c+u},{x:b,y:c}];return y==="top"?v.reverse():v}if(s){var w=i.segment,j=w.map(function(N){return t.apply(N,{position:f})});return An(i,"discard")&&Sq(j,function(N){return!t.isInRange(N)})?null:j}return null};function Ep(e){var t=e.x,r=e.y,a=e.segment,s=e.xAxis,i=e.yAxis,o=e.shape,l=e.className,c=e.alwaysShow,d=e.clipPathId;qn(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var u=kp({x:s.scale,y:i.scale}),f=br(t),h=br(r),m=a&&a.length===2,x=_K(u,f,h,m,e);if(!x)return null;var p=vK(x,2),g=p[0],y=g.x,b=g.y,v=p[1],w=v.x,j=v.y,N=An(e,"hidden")?"url(#".concat(d,")"):void 0,_=f1(f1({clipPath:N},Fe(e,!0)),{},{x1:y,y1:b,x2:w,y2:j});return Q.createElement(ot,{className:pt("recharts-reference-line",l)},NK(o,_),Er.renderCallByParent(e,fK({x1:y,y1:b,x2:w,y2:j})))}Ep.displayName="ReferenceLine";Ep.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"};function Wc(e){"@babel/helpers - typeof";return Wc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wc(e)}function Vm(){return Vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Vm.apply(this,arguments)}function m1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function x1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m1(Object(r),!0).forEach(function(a){SK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function SK(e,t,r){return t=kK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kK(e){var t=EK(e,"string");return Wc(t)==="symbol"?t:String(t)}function EK(e,t){if(Wc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Wc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AK=function(t){var r=t.x,a=t.y,s=t.xAxis,i=t.yAxis,o=kp({x:s.scale,y:i.scale}),l=o.apply({x:r,y:a},{bandAware:!0});return An(t,"discard")&&!o.isInRange(l)?null:l};function wd(e){var t=e.x,r=e.y,a=e.r,s=e.alwaysShow,i=e.clipPathId,o=br(t),l=br(r);if(qn(s===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!o||!l)return null;var c=AK(e);if(!c)return null;var d=c.x,u=c.y,f=e.shape,h=e.className,m=An(e,"hidden")?"url(#".concat(i,")"):void 0,x=x1(x1({clipPath:m},Fe(e,!0)),{},{cx:d,cy:u});return Q.createElement(ot,{className:pt("recharts-reference-dot",h)},wd.renderDot(f,x),Er.renderCallByParent(e,{x:d-a,y:u-a,width:2*a,height:2*a}))}wd.displayName="ReferenceDot";wd.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1};wd.renderDot=function(e,t){var r;return Q.isValidElement(e)?r=Q.cloneElement(e,t):De(e)?r=e(t):r=Q.createElement(bd,Vm({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r};function Hc(e){"@babel/helpers - typeof";return Hc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hc(e)}function Gm(){return Gm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gm.apply(this,arguments)}function p1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function g1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p1(Object(r),!0).forEach(function(a){TK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function TK(e,t,r){return t=CK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CK(e){var t=OK(e,"string");return Hc(t)==="symbol"?t:String(t)}function OK(e,t){if(Hc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Hc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PK=function(t,r,a,s,i){var o=i.x1,l=i.x2,c=i.y1,d=i.y2,u=i.xAxis,f=i.yAxis;if(!u||!f)return null;var h=kp({x:u.scale,y:f.scale}),m={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:a?h.y.apply(c,{position:"start"}):h.y.rangeMin},x={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:s?h.y.apply(d,{position:"end"}):h.y.rangeMax};return An(i,"discard")&&(!h.isInRange(m)||!h.isInRange(x))?null:T_(m,x)};function jd(e){var t=e.x1,r=e.x2,a=e.y1,s=e.y2,i=e.className,o=e.alwaysShow,l=e.clipPathId;qn(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var c=br(t),d=br(r),u=br(a),f=br(s),h=e.shape;if(!c&&!d&&!u&&!f&&!h)return null;var m=PK(c,d,u,f,e);if(!m&&!h)return null;var x=An(e,"hidden")?"url(#".concat(l,")"):void 0;return Q.createElement(ot,{className:pt("recharts-reference-area",i)},jd.renderRect(h,g1(g1({clipPath:x},Fe(e,!0)),m)),Er.renderCallByParent(e,m))}jd.displayName="ReferenceArea";jd.defaultProps={isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1};jd.renderRect=function(e,t){var r;return Q.isValidElement(e)?r=Q.cloneElement(e,t):De(e)?r=e(t):r=Q.createElement(_p,Gm({},t,{className:"recharts-reference-area-rect"})),r};function O_(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var a=[],s=0;s<e.length;s+=t)a.push(e[s]);return a}function FK(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return mK(a,r)}function IK(e,t,r){var a=r==="width",s=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:a?s:i,end:a?s+o:i+l}:{start:a?s+o:i+l,end:a?s:i}}function rf(e,t,r,a,s){return e*(t-e*r/2-a)>=0&&e*(t+e*r/2-s)<=0}function DK(e,t){return O_(e,t+1)}function RK(e,t,r,a,s){for(var i=(a||[]).slice(),o=t.start,l=t.end,c=0,d=1,u=o;d<=i.length;){var f=a==null?void 0:a[c];if(f===void 0)return O_(a,d);var h=r(f,c),m=f.coordinate,x=c===0||rf(e,m,h,u,l);x||(c=0,u=o,d+=1),x&&(u=m+e*(h/2+s),c+=d)}return[]}function zc(e){"@babel/helpers - typeof";return zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zc(e)}function v1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Gr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v1(Object(r),!0).forEach(function(a){MK(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function MK(e,t,r){return t=$K(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $K(e){var t=LK(e,"string");return zc(t)==="symbol"?t:String(t)}function LK(e,t){if(zc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(zc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BK(e,t,r,a,s){for(var i=(a||[]).slice(),o=i.length,l=t.start,c=t.end,d=o-1;d>=0;d--){var u=i[d],f=r(u,d);if(d===o-1){var h=e*(u.coordinate+e*f/2-c);i[d]=u=Gr(Gr({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate})}else i[d]=u=Gr(Gr({},u),{},{tickCoord:u.coordinate});var m=rf(e,u.tickCoord,f,l,c);m&&(c=u.tickCoord-e*(f/2+s),i[d]=Gr(Gr({},u),{},{isShow:!0}))}return i}function UK(e,t,r,a,s,i){var o=(a||[]).slice(),l=o.length,c=t.start,d=t.end;if(i){var u=a[l-1],f=r(u,l-1),h=e*(u.coordinate+e*f/2-d);o[l-1]=u=Gr(Gr({},u),{},{tickCoord:h>0?u.coordinate-h*e:u.coordinate});var m=rf(e,u.tickCoord,f,c,d);m&&(d=u.tickCoord-e*(f/2+s),o[l-1]=Gr(Gr({},u),{},{isShow:!0}))}for(var x=i?l-1:l,p=0;p<x;p++){var g=o[p],y=r(g,p);if(p===0){var b=e*(g.coordinate-e*y/2-c);o[p]=g=Gr(Gr({},g),{},{tickCoord:b<0?g.coordinate-b*e:g.coordinate})}else o[p]=g=Gr(Gr({},g),{},{tickCoord:g.coordinate});var v=rf(e,g.tickCoord,y,c,d);v&&(c=g.tickCoord+e*(y/2+s),o[p]=Gr(Gr({},g),{},{isShow:!0}))}return o}function qm(e,t,r){var a=e.tick,s=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,d=e.tickFormatter,u=e.unit,f=e.angle;if(!s||!s.length||!a)return[];if(be(c)||$s.isSsr)return DK(s,typeof c=="number"&&be(c)?c:0);var h=[],m=l==="top"||l==="bottom"?"width":"height",x=u&&m==="width"?Ll(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},p=function(v,w){var j=De(d)?d(v.value,w):v.value;return m==="width"?FK(Ll(j,{fontSize:t,letterSpacing:r}),x,f):Ll(j,{fontSize:t,letterSpacing:r})[m]},g=s.length>=2?ia(s[1].coordinate-s[0].coordinate):1,y=IK(i,g,m);return c==="equidistantPreserveStart"?RK(g,y,p,s,o):(c==="preserveStart"||c==="preserveStartEnd"?h=UK(g,y,p,s,o,c==="preserveStartEnd"):h=BK(g,y,p,s,o),h.filter(function(b){return b.isShow}))}var WK=["viewBox"],HK=["viewBox"],zK=["ticks"];function Fo(e){"@babel/helpers - typeof";return Fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fo(e)}function io(){return io=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},io.apply(this,arguments)}function y1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function aa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y1(Object(r),!0).forEach(function(a){Ap(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function oh(e,t){if(e==null)return{};var r=VK(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function VK(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function GK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,P_(a.key),a)}}function qK(e,t,r){return t&&b1(e.prototype,t),r&&b1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function KK(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Km(e,t)}function Km(e,t){return Km=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Km(e,t)}function XK(e){var t=ZK();return function(){var a=af(e),s;if(t){var i=af(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return YK(this,s)}}function YK(e,t){if(t&&(Fo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return JK(e)}function JK(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function af(e){return af=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},af(e)}function Ap(e,t,r){return t=P_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P_(e){var t=QK(e,"string");return Fo(t)==="symbol"?t:String(t)}function QK(e,t){if(Fo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Fo(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var zl=function(e){KK(r,e);var t=XK(r);function r(a){var s;return GK(this,r),s=t.call(this,a),s.state={fontSize:"",letterSpacing:""},s}return qK(r,[{key:"shouldComponentUpdate",value:function(s,i){var o=s.viewBox,l=oh(s,WK),c=this.props,d=c.viewBox,u=oh(c,HK);return!uo(o,d)||!uo(l,u)||!uo(i,this.state)}},{key:"componentDidMount",value:function(){var s=this.layerReference;if(s){var i=s.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(s){var i=this.props,o=i.x,l=i.y,c=i.width,d=i.height,u=i.orientation,f=i.tickSize,h=i.mirror,m=i.tickMargin,x,p,g,y,b,v,w=h?-1:1,j=s.tickSize||f,N=be(s.tickCoord)?s.tickCoord:s.coordinate;switch(u){case"top":x=p=s.coordinate,y=l+ +!h*d,g=y-w*j,v=g-w*m,b=N;break;case"left":g=y=s.coordinate,p=o+ +!h*c,x=p-w*j,b=x-w*m,v=N;break;case"right":g=y=s.coordinate,p=o+ +h*c,x=p+w*j,b=x+w*m,v=N;break;default:x=p=s.coordinate,y=l+ +h*d,g=y+w*j,v=g+w*m,b=N;break}return{line:{x1:x,y1:g,x2:p,y2:y},tick:{x:b,y:v}}}},{key:"getTickTextAnchor",value:function(){var s=this.props,i=s.orientation,o=s.mirror,l;switch(i){case"left":l=o?"start":"end";break;case"right":l=o?"end":"start";break;default:l="middle";break}return l}},{key:"getTickVerticalAnchor",value:function(){var s=this.props,i=s.orientation,o=s.mirror,l="end";switch(i){case"left":case"right":l="middle";break;case"top":l=o?"start":"end";break;default:l=o?"end":"start";break}return l}},{key:"renderAxisLine",value:function(){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,d=s.orientation,u=s.mirror,f=s.axisLine,h=aa(aa(aa({},Fe(this.props)),Fe(f)),{},{fill:"none"});if(d==="top"||d==="bottom"){var m=+(d==="top"&&!u||d==="bottom"&&u);h=aa(aa({},h),{},{x1:i,y1:o+m*c,x2:i+l,y2:o+m*c})}else{var x=+(d==="left"&&!u||d==="right"&&u);h=aa(aa({},h),{},{x1:i+x*l,y1:o,x2:i+x*l,y2:o+c})}return Q.createElement("line",io({},h,{className:pt("recharts-cartesian-axis-line",Ar(f,"className"))}))}},{key:"renderTicks",value:function(s,i,o){var l=this,c=this.props,d=c.tickLine,u=c.stroke,f=c.tick,h=c.tickFormatter,m=c.unit,x=qm(aa(aa({},this.props),{},{ticks:s}),i,o),p=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),y=Fe(this.props),b=Fe(f),v=aa(aa({},y),{},{fill:"none"},Fe(d)),w=x.map(function(j,N){var _=l.getTickLineCoord(j),E=_.line,S=_.tick,k=aa(aa(aa(aa({textAnchor:p,verticalAnchor:g},y),{},{stroke:"none",fill:u},b),S),{},{index:N,payload:j,visibleTicksCount:x.length,tickFormatter:h});return Q.createElement(ot,io({className:"recharts-cartesian-axis-tick",key:"tick-".concat(N)},ji(l.props,j,N)),d&&Q.createElement("line",io({},v,E,{className:pt("recharts-cartesian-axis-tick-line",Ar(d,"className"))})),f&&r.renderTickItem(f,k,"".concat(De(h)?h(j.value,N):j.value).concat(m||"")))});return Q.createElement("g",{className:"recharts-cartesian-axis-ticks"},w)}},{key:"render",value:function(){var s=this,i=this.props,o=i.axisLine,l=i.width,c=i.height,d=i.ticksGenerator,u=i.className,f=i.hide;if(f)return null;var h=this.props,m=h.ticks,x=oh(h,zK),p=m;return De(d)&&(p=m&&m.length>0?d(this.props):d(x)),l<=0||c<=0||!p||!p.length?null:Q.createElement(ot,{className:pt("recharts-cartesian-axis",u),ref:function(y){s.layerReference=y}},o&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Er.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(s,i,o){var l;return Q.isValidElement(s)?l=Q.cloneElement(s,i):De(s)?l=s(i):l=Q.createElement(Ni,io({},i,{className:"recharts-cartesian-axis-tick-value"}),o),l}}]),r}(C.Component);Ap(zl,"displayName","CartesianAxis");Ap(zl,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var eX=["x1","y1","x2","y2","key"],tX=["offset"];function Io(e){"@babel/helpers - typeof";return Io=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Io(e)}function Xm(){return Xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Xm.apply(this,arguments)}function w1(e,t){if(e==null)return{};var r=rX(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function rX(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function j1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function hs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j1(Object(r),!0).forEach(function(a){Tp(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function aX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,F_(a.key),a)}}function nX(e,t,r){return t&&N1(e.prototype,t),r&&N1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ym(e,t)}function Ym(e,t){return Ym=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Ym(e,t)}function iX(e){var t=cX();return function(){var a=nf(e),s;if(t){var i=nf(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return oX(this,s)}}function oX(e,t){if(t&&(Io(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lX(e)}function lX(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function nf(e){return nf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},nf(e)}function Tp(e,t,r){return t=F_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F_(e){var t=dX(e,"string");return Io(t)==="symbol"?t:String(t)}function dX(e,t){if(Io(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Io(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var oo=function(e){sX(r,e);var t=iX(r);function r(){return aX(this,r),t.apply(this,arguments)}return nX(r,[{key:"renderHorizontal",value:function(s){var i=this,o=this.props,l=o.x,c=o.width,d=o.horizontal;if(!s||!s.length)return null;var u=s.map(function(f,h){var m=hs(hs({},i.props),{},{x1:l,y1:f,x2:l+c,y2:f,key:"line-".concat(h),index:h});return r.renderLineItem(d,m)});return Q.createElement("g",{className:"recharts-cartesian-grid-horizontal"},u)}},{key:"renderVertical",value:function(s){var i=this,o=this.props,l=o.y,c=o.height,d=o.vertical;if(!s||!s.length)return null;var u=s.map(function(f,h){var m=hs(hs({},i.props),{},{x1:f,y1:l,x2:f,y2:l+c,key:"line-".concat(h),index:h});return r.renderLineItem(d,m)});return Q.createElement("g",{className:"recharts-cartesian-grid-vertical"},u)}},{key:"renderVerticalStripes",value:function(s){var i=this.props.verticalFill;if(!i||!i.length)return null;var o=this.props,l=o.fillOpacity,c=o.x,d=o.y,u=o.width,f=o.height,h=s.map(function(x){return Math.round(x+c-c)}).sort(function(x,p){return x-p});c!==h[0]&&h.unshift(0);var m=h.map(function(x,p){var g=!h[p+1],y=g?c+u-x:h[p+1]-x;if(y<=0)return null;var b=p%i.length;return Q.createElement("rect",{key:"react-".concat(p),x,y:d,width:y,height:f,stroke:"none",fill:i[b],fillOpacity:l,className:"recharts-cartesian-grid-bg"})});return Q.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},m)}},{key:"renderHorizontalStripes",value:function(s){var i=this.props.horizontalFill;if(!i||!i.length)return null;var o=this.props,l=o.fillOpacity,c=o.x,d=o.y,u=o.width,f=o.height,h=s.map(function(x){return Math.round(x+d-d)}).sort(function(x,p){return x-p});d!==h[0]&&h.unshift(0);var m=h.map(function(x,p){var g=!h[p+1],y=g?d+f-x:h[p+1]-x;if(y<=0)return null;var b=p%i.length;return Q.createElement("rect",{key:"react-".concat(p),y:x,x:c,height:y,width:u,stroke:"none",fill:i[b],fillOpacity:l,className:"recharts-cartesian-grid-bg"})});return Q.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},m)}},{key:"renderBackground",value:function(){var s=this.props.fill;if(!s||s==="none")return null;var i=this.props,o=i.fillOpacity,l=i.x,c=i.y,d=i.width,u=i.height;return Q.createElement("rect",{x:l,y:c,width:d,height:u,stroke:"none",fill:s,fillOpacity:o,className:"recharts-cartesian-grid-bg"})}},{key:"render",value:function(){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,d=s.horizontal,u=s.vertical,f=s.horizontalCoordinatesGenerator,h=s.verticalCoordinatesGenerator,m=s.xAxis,x=s.yAxis,p=s.offset,g=s.chartWidth,y=s.chartHeight,b=s.syncWithTicks,v=s.horizontalValues,w=s.verticalValues;if(!be(l)||l<=0||!be(c)||c<=0||!be(i)||i!==+i||!be(o)||o!==+o)return null;var j=this.props,N=j.horizontalPoints,_=j.verticalPoints;if((!N||!N.length)&&De(f)){var E=v&&v.length;N=f({yAxis:x?hs(hs({},x),{},{ticks:E?v:x.ticks}):void 0,width:g,height:y,offset:p},E?!0:b)}if((!_||!_.length)&&De(h)){var S=w&&w.length;_=h({xAxis:m?hs(hs({},m),{},{ticks:S?w:m.ticks}):void 0,width:g,height:y,offset:p},S?!0:b)}return Q.createElement("g",{className:"recharts-cartesian-grid"},this.renderBackground(),d&&this.renderHorizontal(N),u&&this.renderVertical(_),d&&this.renderHorizontalStripes(N),u&&this.renderVerticalStripes(_))}}],[{key:"renderLineItem",value:function(s,i){var o;if(Q.isValidElement(s))o=Q.cloneElement(s,i);else if(De(s))o=s(i);else{var l=i.x1,c=i.y1,d=i.x2,u=i.y2,f=i.key,h=w1(i,eX),m=Fe(h);m.offset;var x=w1(m,tX);o=Q.createElement("line",Xm({},x,{x1:l,y1:c,x2:d,y2:u,fill:"none",key:f}))}return o}}]),r}(C.PureComponent);Tp(oo,"displayName","CartesianGrid");Tp(oo,"defaultProps",{horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]});var uX=["type","layout","connectNulls","ref"];function Do(e){"@babel/helpers - typeof";return Do=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Do(e)}function fX(e,t){if(e==null)return{};var r=hX(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function hX(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Vl(){return Vl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Vl.apply(this,arguments)}function _1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function ya(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_1(Object(r),!0).forEach(function(a){rn(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Xi(e){return gX(e)||pX(e)||xX(e)||mX()}function mX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xX(e,t){if(e){if(typeof e=="string")return Jm(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jm(e,t)}}function pX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gX(e){if(Array.isArray(e))return Jm(e)}function Jm(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function vX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,I_(a.key),a)}}function yX(e,t,r){return t&&S1(e.prototype,t),r&&S1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function bX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zm(e,t)}function Zm(e,t){return Zm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Zm(e,t)}function wX(e){var t=NX();return function(){var a=sf(e),s;if(t){var i=sf(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return jX(this,s)}}function jX(e,t){if(t&&(Do(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gs(e)}function gs(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function NX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function sf(e){return sf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},sf(e)}function rn(e,t,r){return t=I_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I_(e){var t=_X(e,"string");return Do(t)==="symbol"?t:String(t)}function _X(e,t){if(Do(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Do(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yn=function(e){bX(r,e);var t=wX(r);function r(){var a;vX(this,r);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=t.call.apply(t,[this].concat(i)),rn(gs(a),"state",{isAnimationFinished:!0,totalLength:0}),rn(gs(a),"generateSimpleStrokeDasharray",function(l,c){return"".concat(c,"px ").concat(l-c,"px")}),rn(gs(a),"getStrokeDasharray",function(l,c,d){var u=d.reduce(function(b,v){return b+v});if(!u)return a.generateSimpleStrokeDasharray(c,l);for(var f=Math.floor(l/u),h=l%u,m=c-l,x=[],p=0,g=0;p<d.length;g+=d[p],++p)if(g+d[p]>h){x=[].concat(Xi(d.slice(0,p)),[h-g]);break}var y=x.length%2===0?[0,m]:[m];return[].concat(Xi(r.repeat(d,f)),Xi(x),y).map(function(b){return"".concat(b,"px")}).join(", ")}),rn(gs(a),"id",Ri("recharts-line-")),rn(gs(a),"pathRef",function(l){a.mainCurve=l}),rn(gs(a),"handleAnimationEnd",function(){a.setState({isAnimationFinished:!0}),a.props.onAnimationEnd&&a.props.onAnimationEnd()}),rn(gs(a),"handleAnimationStart",function(){a.setState({isAnimationFinished:!1}),a.props.onAnimationStart&&a.props.onAnimationStart()}),a}return yX(r,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();this.setState({totalLength:s})}}},{key:"getTotalLength",value:function(){var s=this.mainCurve;try{return s&&s.getTotalLength&&s.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(s,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var o=this.props,l=o.points,c=o.xAxis,d=o.yAxis,u=o.layout,f=o.children,h=Ea(f,yd);if(!h)return null;var m=function(g,y){return{x:g.x,y:g.y,value:g.value,errorVal:ur(g.payload,y)}},x={clipPath:s?"url(#clipPath-".concat(i,")"):null};return Q.createElement(ot,x,h.map(function(p,g){return Q.cloneElement(p,{key:"bar-".concat(g),data:l,xAxis:c,yAxis:d,layout:u,dataPointFormatter:m})}))}},{key:"renderDots",value:function(s,i,o){var l=this.props.isAnimationActive;if(l&&!this.state.isAnimationFinished)return null;var c=this.props,d=c.dot,u=c.points,f=c.dataKey,h=Fe(this.props),m=Fe(d,!0),x=u.map(function(g,y){var b=ya(ya(ya({key:"dot-".concat(y),r:3},h),m),{},{value:g.value,dataKey:f,cx:g.x,cy:g.y,index:y,payload:g.payload});return r.renderDotItem(d,b)}),p={clipPath:s?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return Q.createElement(ot,Vl({className:"recharts-line-dots",key:"dots"},p),x)}},{key:"renderCurveStatically",value:function(s,i,o,l){var c=this.props,d=c.type,u=c.layout,f=c.connectNulls;c.ref;var h=fX(c,uX),m=ya(ya(ya({},Fe(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:i?"url(#clipPath-".concat(o,")"):null,points:s},l),{},{type:d,layout:u,connectNulls:f});return Q.createElement(fi,Vl({},m,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(s,i){var o=this,l=this.props,c=l.points,d=l.strokeDasharray,u=l.isAnimationActive,f=l.animationBegin,h=l.animationDuration,m=l.animationEasing,x=l.animationId,p=l.animateNewValues,g=l.width,y=l.height,b=this.state,v=b.prevPoints,w=b.totalLength;return Q.createElement(un,{begin:f,duration:h,isActive:u,easing:m,from:{t:0},to:{t:1},key:"line-".concat(x),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(j){var N=j.t;if(v){var _=v.length/c.length,E=c.map(function(A,R){var T=Math.floor(R*_);if(v[T]){var F=v[T],W=gr(F.x,A.x),K=gr(F.y,A.y);return ya(ya({},A),{},{x:W(N),y:K(N)})}if(p){var B=gr(g*2,A.x),L=gr(y/2,A.y);return ya(ya({},A),{},{x:B(N),y:L(N)})}return ya(ya({},A),{},{x:A.x,y:A.y})});return o.renderCurveStatically(E,s,i)}var S=gr(0,w),k=S(N),O;if(d){var P="".concat(d).split(/[,\s]+/gim).map(function(A){return parseFloat(A)});O=o.getStrokeDasharray(k,w,P)}else O=o.generateSimpleStrokeDasharray(w,k);return o.renderCurveStatically(c,s,i,{strokeDasharray:O})})}},{key:"renderCurve",value:function(s,i){var o=this.props,l=o.points,c=o.isAnimationActive,d=this.state,u=d.prevPoints,f=d.totalLength;return c&&l&&l.length&&(!u&&f>0||!_i(u,l))?this.renderCurveWithAnimation(s,i):this.renderCurveStatically(l,s,i)}},{key:"render",value:function(){var s,i=this.props,o=i.hide,l=i.dot,c=i.points,d=i.className,u=i.xAxis,f=i.yAxis,h=i.top,m=i.left,x=i.width,p=i.height,g=i.isAnimationActive,y=i.id;if(o||!c||!c.length)return null;var b=this.state.isAnimationFinished,v=c.length===1,w=pt("recharts-line",d),j=u&&u.allowDataOverflow,N=f&&f.allowDataOverflow,_=j||N,E=Pe(y)?this.id:y,S=(s=Fe(l))!==null&&s!==void 0?s:{r:3,strokeWidth:2},k=S.r,O=k===void 0?3:k,P=S.strokeWidth,A=P===void 0?2:P,R=Yj(l)?l:{},T=R.clipDot,F=T===void 0?!0:T,W=O*2+A;return Q.createElement(ot,{className:w},j||N?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(E)},Q.createElement("rect",{x:j?m:m-x/2,y:N?h:h-p/2,width:j?x:x*2,height:N?p:p*2})),!F&&Q.createElement("clipPath",{id:"clipPath-dots-".concat(E)},Q.createElement("rect",{x:m-W/2,y:h-W/2,width:x+W,height:p+W}))):null,!v&&this.renderCurve(_,E),this.renderErrorBar(_,E),(v||l)&&this.renderDots(_,F,E),(!g||b)&&En.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:i.curPoints}:s.points!==i.curPoints?{curPoints:s.points}:null}},{key:"repeat",value:function(s,i){for(var o=s.length%2!==0?[].concat(Xi(s),[0]):s,l=[],c=0;c<i;++c)l=[].concat(Xi(l),Xi(o));return l}},{key:"renderDotItem",value:function(s,i){var o;if(Q.isValidElement(s))o=Q.cloneElement(s,i);else if(De(s))o=s(i);else{var l=pt("recharts-line-dot",s?s.className:"");o=Q.createElement(bd,Vl({},i,{className:l}))}return o}}]),r}(C.PureComponent);rn(yn,"displayName","Line");rn(yn,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!$s.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});rn(yn,"getComposedData",function(e){var t=e.props,r=e.xAxis,a=e.yAxis,s=e.xAxisTicks,i=e.yAxisTicks,o=e.dataKey,l=e.bandSize,c=e.displayedData,d=e.offset,u=t.layout,f=c.map(function(h,m){var x=ur(h,o);return u==="horizontal"?{x:Wu({axis:r,ticks:s,bandSize:l,entry:h,index:m}),y:Pe(x)?null:a.scale(x),value:x,payload:h}:{x:Pe(x)?null:r.scale(x),y:Wu({axis:a,ticks:i,bandSize:l,entry:h,index:m}),value:x,payload:h}});return ya({points:f,layout:u},d)});var SX=["layout","type","stroke","connectNulls","isRange","ref"],D_;function Ro(e){"@babel/helpers - typeof";return Ro=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ro(e)}function kX(e,t){if(e==null)return{};var r=EX(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function EX(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function ii(){return ii=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ii.apply(this,arguments)}function k1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function vs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k1(Object(r),!0).forEach(function(a){jn(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function AX(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E1(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,R_(a.key),a)}}function TX(e,t,r){return t&&E1(e.prototype,t),r&&E1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function CX(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qm(e,t)}function Qm(e,t){return Qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Qm(e,t)}function OX(e){var t=FX();return function(){var a=of(e),s;if(t){var i=of(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return PX(this,s)}}function PX(e,t){if(t&&(Ro(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cl(e)}function Cl(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function of(e){return of=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},of(e)}function jn(e,t,r){return t=R_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R_(e){var t=IX(e,"string");return Ro(t)==="symbol"?t:String(t)}function IX(e,t){if(Ro(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Ro(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tn=function(e){CX(r,e);var t=OX(r);function r(){var a;AX(this,r);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return a=t.call.apply(t,[this].concat(i)),jn(Cl(a),"state",{isAnimationFinished:!0}),jn(Cl(a),"id",Ri("recharts-area-")),jn(Cl(a),"handleAnimationEnd",function(){var l=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),De(l)&&l()}),jn(Cl(a),"handleAnimationStart",function(){var l=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),De(l)&&l()}),a}return TX(r,[{key:"renderDots",value:function(s,i,o){var l=this.props.isAnimationActive,c=this.state.isAnimationFinished;if(l&&!c)return null;var d=this.props,u=d.dot,f=d.points,h=d.dataKey,m=Fe(this.props),x=Fe(u,!0),p=f.map(function(y,b){var v=vs(vs(vs({key:"dot-".concat(b),r:3},m),x),{},{dataKey:h,cx:y.x,cy:y.y,index:b,value:y.value,payload:y.payload});return r.renderDotItem(u,v)}),g={clipPath:s?"url(#clipPath-".concat(i?"":"dots-").concat(o,")"):null};return Q.createElement(ot,ii({className:"recharts-area-dots"},g),p)}},{key:"renderHorizontalRect",value:function(s){var i=this.props,o=i.baseLine,l=i.points,c=i.strokeWidth,d=l[0].x,u=l[l.length-1].x,f=s*Math.abs(d-u),h=bs(l.map(function(m){return m.y||0}));return be(o)&&typeof o=="number"?h=Math.max(o,h):o&&hr(o)&&o.length&&(h=Math.max(bs(o.map(function(m){return m.y||0})),h)),be(h)?Q.createElement("rect",{x:d<u?d:d-f,y:0,width:f,height:Math.floor(h+(c?parseInt("".concat(c),10):1))}):null}},{key:"renderVerticalRect",value:function(s){var i=this.props,o=i.baseLine,l=i.points,c=i.strokeWidth,d=l[0].y,u=l[l.length-1].y,f=s*Math.abs(d-u),h=bs(l.map(function(m){return m.x||0}));return be(o)&&typeof o=="number"?h=Math.max(o,h):o&&hr(o)&&o.length&&(h=Math.max(bs(o.map(function(m){return m.x||0})),h)),be(h)?Q.createElement("rect",{x:0,y:d<u?d:d-f,width:h+(c?parseInt("".concat(c),10):1),height:Math.floor(f)}):null}},{key:"renderClipRect",value:function(s){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(s):this.renderHorizontalRect(s)}},{key:"renderAreaStatically",value:function(s,i,o,l){var c=this.props,d=c.layout,u=c.type,f=c.stroke,h=c.connectNulls,m=c.isRange;c.ref;var x=kX(c,SX);return Q.createElement(ot,{clipPath:o?"url(#clipPath-".concat(l,")"):null},Q.createElement(fi,ii({},Fe(x,!0),{points:s,connectNulls:h,type:u,baseLine:i,layout:d,stroke:"none",className:"recharts-area-area"})),f!=="none"&&Q.createElement(fi,ii({},Fe(this.props),{className:"recharts-area-curve",layout:d,type:u,connectNulls:h,fill:"none",points:s})),f!=="none"&&m&&Q.createElement(fi,ii({},Fe(this.props),{className:"recharts-area-curve",layout:d,type:u,connectNulls:h,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(s,i){var o=this,l=this.props,c=l.points,d=l.baseLine,u=l.isAnimationActive,f=l.animationBegin,h=l.animationDuration,m=l.animationEasing,x=l.animationId,p=this.state,g=p.prevPoints,y=p.prevBaseLine;return Q.createElement(un,{begin:f,duration:h,isActive:u,easing:m,from:{t:0},to:{t:1},key:"area-".concat(x),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(b){var v=b.t;if(g){var w=g.length/c.length,j=c.map(function(S,k){var O=Math.floor(k*w);if(g[O]){var P=g[O],A=gr(P.x,S.x),R=gr(P.y,S.y);return vs(vs({},S),{},{x:A(v),y:R(v)})}return S}),N;if(be(d)&&typeof d=="number"){var _=gr(y,d);N=_(v)}else if(Pe(d)||Yo(d)){var E=gr(y,0);N=E(v)}else N=d.map(function(S,k){var O=Math.floor(k*w);if(y[O]){var P=y[O],A=gr(P.x,S.x),R=gr(P.y,S.y);return vs(vs({},S),{},{x:A(v),y:R(v)})}return S});return o.renderAreaStatically(j,N,s,i)}return Q.createElement(ot,null,Q.createElement("defs",null,Q.createElement("clipPath",{id:"animationClipPath-".concat(i)},o.renderClipRect(v))),Q.createElement(ot,{clipPath:"url(#animationClipPath-".concat(i,")")},o.renderAreaStatically(c,d,s,i)))})}},{key:"renderArea",value:function(s,i){var o=this.props,l=o.points,c=o.baseLine,d=o.isAnimationActive,u=this.state,f=u.prevPoints,h=u.prevBaseLine,m=u.totalLength;return d&&l&&l.length&&(!f&&m>0||!_i(f,l)||!_i(h,c))?this.renderAreaWithAnimation(s,i):this.renderAreaStatically(l,c,s,i)}},{key:"render",value:function(){var s,i=this.props,o=i.hide,l=i.dot,c=i.points,d=i.className,u=i.top,f=i.left,h=i.xAxis,m=i.yAxis,x=i.width,p=i.height,g=i.isAnimationActive,y=i.id;if(o||!c||!c.length)return null;var b=this.state.isAnimationFinished,v=c.length===1,w=pt("recharts-area",d),j=h&&h.allowDataOverflow,N=m&&m.allowDataOverflow,_=j||N,E=Pe(y)?this.id:y,S=(s=Fe(l))!==null&&s!==void 0?s:{r:3,strokeWidth:2},k=S.r,O=k===void 0?3:k,P=S.strokeWidth,A=P===void 0?2:P,R=Yj(l)?l:{},T=R.clipDot,F=T===void 0?!0:T,W=O*2+A;return Q.createElement(ot,{className:w},j||N?Q.createElement("defs",null,Q.createElement("clipPath",{id:"clipPath-".concat(E)},Q.createElement("rect",{x:j?f:f-x/2,y:N?u:u-p/2,width:j?x:x*2,height:N?p:p*2})),!F&&Q.createElement("clipPath",{id:"clipPath-dots-".concat(E)},Q.createElement("rect",{x:f-W/2,y:u-W/2,width:x+W,height:p+W}))):null,v?null:this.renderArea(_,E),(l||v)&&this.renderDots(_,F,E),(!g||b)&&En.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(s,i){return s.animationId!==i.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,curBaseLine:s.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:s.points!==i.curPoints||s.baseLine!==i.curBaseLine?{curPoints:s.points,curBaseLine:s.baseLine}:null}}]),r}(C.PureComponent);D_=Tn;jn(Tn,"displayName","Area");jn(Tn,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!$s.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});jn(Tn,"getBaseValue",function(e,t,r,a){var s=e.layout,i=e.baseValue,o=t.props.baseValue,l=o??i;if(be(l)&&typeof l=="number")return l;var c=s==="horizontal"?a:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),f=Math.min(d[0],d[1]);return l==="dataMin"?f:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});jn(Tn,"getComposedData",function(e){var t=e.props,r=e.item,a=e.xAxis,s=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,c=e.dataKey,d=e.stackedData,u=e.dataStartIndex,f=e.displayedData,h=e.offset,m=t.layout,x=d&&d.length,p=D_.getBaseValue(t,r,a,s),g=!1,y=f.map(function(v,w){var j=ur(v,c),N;x?N=d[u+w]:(N=j,hr(N)?g=!0:N=[p,N]);var _=Pe(N[1])||x&&Pe(j);return m==="horizontal"?{x:Wu({axis:a,ticks:i,bandSize:l,entry:v,index:w}),y:_?null:s.scale(N[1]),value:N,payload:v}:{x:_?null:a.scale(N[1]),y:Wu({axis:s,ticks:o,bandSize:l,entry:v,index:w}),value:N,payload:v}}),b;return x||g?b=y.map(function(v){return m==="horizontal"?{x:v.x,y:!Pe(Ar(v,"value[0]"))&&!Pe(Ar(v,"y"))?s.scale(Ar(v,"value[0]")):null}:{x:Pe(Ar(v,"value[0]"))?null:a.scale(Ar(v,"value[0]")),y:v.y}}):m==="horizontal"?b=s.scale(p):b=a.scale(p),vs({points:y,baseLine:b,layout:m,isRange:g},h)});jn(Tn,"renderDotItem",function(e,t){var r;return Q.isValidElement(e)?r=Q.cloneElement(e,t):De(e)?r=e(t):r=Q.createElement(bd,ii({},t,{className:"recharts-area-dot"})),r});var zn=function(){return null};zn.displayName="XAxis";zn.defaultProps={allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0};var Vn=function(){return null};Vn.displayName="YAxis";Vn.defaultProps={allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1};var DX=Fn,RX=md,MX=Kf;function $X(e){return function(t,r,a){var s=Object(t);if(!RX(t)){var i=DX(r);t=MX(t),r=function(l){return i(s[l],l,s)}}var o=e(t,r,a);return o>-1?s[i?t[o]:o]:void 0}}var LX=$X,BX=N_;function UX(e){var t=BX(e),r=t%1;return t===t?r?t-r:t:0}var WX=UX,HX=m2,zX=Fn,VX=WX,GX=Math.max;function qX(e,t,r){var a=e==null?0:e.length;if(!a)return-1;var s=r==null?0:VX(r);return s<0&&(s=GX(a+s,0)),HX(e,zX(t),s)}var KX=qX,XX=LX,YX=KX,JX=XX(YX),ZX=JX;const QX=bt(ZX);var eY="Invariant failed";function tY(e,t){throw new Error(eY)}function M_(e){var t=e.cx,r=e.cy,a=e.radius,s=e.startAngle,i=e.endAngle,o=Dt(t,r,a,s),l=Dt(t,r,a,i);return{points:[o,l],cx:t,cy:r,radius:a,startAngle:s,endAngle:i}}function A1(e){return sY(e)||nY(e)||aY(e)||rY()}function rY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aY(e,t){if(e){if(typeof e=="string")return ex(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ex(e,t)}}function nY(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sY(e){if(Array.isArray(e))return ex(e)}function ex(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}var tx=function(t,r,a,s,i){var o=Ea(t,Ep),l=Ea(t,wd),c=[].concat(A1(o),A1(l)),d=Ea(t,jd),u="".concat(s,"Id"),f=s[0],h=r;if(c.length&&(h=c.reduce(function(p,g){if(g.props[u]===a&&An(g.props,"extendDomain")&&be(g.props[f])){var y=g.props[f];return[Math.min(p[0],y),Math.max(p[1],y)]}return p},h)),d.length){var m="".concat(f,"1"),x="".concat(f,"2");h=d.reduce(function(p,g){if(g.props[u]===a&&An(g.props,"extendDomain")&&be(g.props[m])&&be(g.props[x])){var y=g.props[m],b=g.props[x];return[Math.min(p[0],y,b),Math.max(p[1],y,b)]}return p},h)}return i&&i.length&&(h=i.reduce(function(p,g){return be(g)?[Math.min(p[0],g),Math.max(p[1],g)]:p},h)),h},$_={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function s(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,f,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,f||c,h),x=r?r+d:d;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],m]:c._events[x].push(m):(c._events[x]=m,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new a:delete c._events[d]}function l(){this._events=new a,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,m=f.length,x=new Array(m);h<m;h++)x[h]=f[h].fn;return x},l.prototype.listenerCount=function(d){var u=r?r+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,h,m,x){var p=r?r+d:d;if(!this._events[p])return!1;var g=this._events[p],y=arguments.length,b,v;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),y){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,h),!0;case 5:return g.fn.call(g.context,u,f,h,m),!0;case 6:return g.fn.call(g.context,u,f,h,m,x),!0}for(v=1,b=new Array(y-1);v<y;v++)b[v-1]=arguments[v];g.fn.apply(g.context,b)}else{var w=g.length,j;for(v=0;v<w;v++)switch(g[v].once&&this.removeListener(d,g[v].fn,void 0,!0),y){case 1:g[v].fn.call(g[v].context);break;case 2:g[v].fn.call(g[v].context,u);break;case 3:g[v].fn.call(g[v].context,u,f);break;case 4:g[v].fn.call(g[v].context,u,f,h);break;default:if(!b)for(j=1,b=new Array(y-1);j<y;j++)b[j-1]=arguments[j];g[v].fn.apply(g[v].context,b)}}return!0},l.prototype.on=function(d,u,f){return i(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return i(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,h){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return o(this,m),this;var x=this._events[m];if(x.fn)x.fn===u&&(!h||x.once)&&(!f||x.context===f)&&o(this,m);else{for(var p=0,g=[],y=x.length;p<y;p++)(x[p].fn!==u||h&&!x[p].once||f&&x[p].context!==f)&&g.push(x[p]);g.length?this._events[m]=g.length===1?g[0]:g:o(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})($_);var iY=$_.exports;const oY=bt(iY);var ba=new oY;ba.setMaxListeners&&ba.setMaxListeners(10);var lh="recharts.syncMouseEvents";function Vc(e){"@babel/helpers - typeof";return Vc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vc(e)}function lY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cY(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,L_(a.key),a)}}function dY(e,t,r){return t&&cY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ch(e,t,r){return t=L_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L_(e){var t=uY(e,"string");return Vc(t)==="symbol"?t:String(t)}function uY(e,t){if(Vc(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Vc(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fY=function(){function e(){lY(this,e),ch(this,"activeIndex",0),ch(this,"coordinateList",[]),ch(this,"layout","horizontal")}return dY(e,[{key:"setDetails",value:function(r){var a=r.coordinateList,s=a===void 0?[]:a,i=r.container,o=i===void 0?null:i,l=r.layout,c=l===void 0?null:l,d=r.offset,u=d===void 0?null:d,f=r.mouseHandlerCallback,h=f===void 0?null:f;this.coordinateList=s??this.coordinateList,this.container=o??this.container,this.layout=c??this.layout,this.offset=u??this.offset,this.mouseHandlerCallback=h??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"spoofMouse",value:function(){if(this.layout==="horizontal"&&this.coordinateList.length!==0){var r=this.container.getBoundingClientRect(),a=r.x,s=r.y,i=r.height,o=this.coordinateList[this.activeIndex].coordinate,l=a+o,c=s+this.offset.top+i/2;this.mouseHandlerCallback({pageX:l,pageY:c})}}}]),e}();function hY(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var a=e==null?void 0:e[0],s=e==null?void 0:e[1];if(a&&s&&be(a)&&be(s))return!0}return!1}function mY(e){if(typeof requestAnimationFrame=="function"){var t=requestAnimationFrame(e);return function(){return cancelAnimationFrame(t)}}if(typeof setImmediate=="function"){var r=setImmediate(e);return function(){return clearImmediate(r)}}var a=setTimeout(e);return function(){return clearTimeout(a)}}function xY(e,t,r){var a,s,i,o;if(e==="horizontal")a=t.x,i=a,s=r.top,o=r.top+r.height;else if(e==="vertical")s=t.y,o=s,a=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,f=t.angle,h=Dt(l,c,d,f),m=Dt(l,c,u,f);a=h.x,s=h.y,i=m.x,o=m.y}else return M_(t);return[{x:a,y:s},{x:i,y:o}]}function pY(e,t,r,a){var s=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}var gY=["item"],vY=["children","className","width","height","style","compact","title","desc"];function Mo(e){"@babel/helpers - typeof";return Mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mo(e)}function T1(e,t){return wY(e)||bY(e,t)||B_(e,t)||yY()}function yY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var a,s,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(a=i.call(r)).done)&&(l.push(a.value),l.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw s}}return l}}function wY(e){if(Array.isArray(e))return e}function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lo.apply(this,arguments)}function C1(e,t){if(e==null)return{};var r=jY(e,t),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)a=i[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function jY(e,t){if(e==null)return{};var r={},a=Object.keys(e),s,i;for(i=0;i<a.length;i++)s=a[i],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function NY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _Y(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,U_(a.key),a)}}function SY(e,t,r){return t&&_Y(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rx(e,t)}function rx(e,t){return rx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},rx(e,t)}function EY(e){var t=TY();return function(){var a=lf(e),s;if(t){var i=lf(this).constructor;s=Reflect.construct(a,arguments,i)}else s=a.apply(this,arguments);return AY(this,s)}}function AY(e,t){if(t&&(Mo(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return it(e)}function it(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function lf(e){return lf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},lf(e)}function $o(e){return PY(e)||OY(e)||B_(e)||CY()}function CY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B_(e,t){if(e){if(typeof e=="string")return ax(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ax(e,t)}}function OY(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PY(e){if(Array.isArray(e))return ax(e)}function ax(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}function O1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function he(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O1(Object(r),!0).forEach(function(a){$e(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O1(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function $e(e,t,r){return t=U_(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U_(e){var t=FY(e,"string");return Mo(t)==="symbol"?t:String(t)}function FY(e,t){if(Mo(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Mo(a)!=="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var IY={xAxis:["bottom","top"],yAxis:["left","right"]},W_={x:0,y:0},DY=Number.isFinite?Number.isFinite:isFinite,RY=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},MY=function(t,r,a,s){var i=r.find(function(u){return u&&u.index===a});if(i){if(t==="horizontal")return{x:i.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=s.radius;return he(he(he({},s),Dt(s.cx,s.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,d=s.angle;return he(he(he({},s),Dt(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return W_},y0=function(t,r,a){var s=r.graphicalItems,i=r.dataStartIndex,o=r.dataEndIndex,l=(s||[]).reduce(function(c,d){var u=d.props.data;return u&&u.length?[].concat($o(c),$o(u)):c},[]);return l&&l.length>0?l:a&&a.props&&a.props.data&&a.props.data.length>0?a.props.data:t&&t.length&&be(i)&&be(o)?t.slice(i,o+1):[]};function H_(e){return e==="number"?[0,"auto"]:void 0}var z_=function(t,r,a,s){var i=t.graphicalItems,o=t.tooltipAxis,l=y0(r,t);return a<0||!i||!i.length||a>=l.length?null:i.reduce(function(c,d){var u,f=d.props.hide;if(f)return c;var h=((u=d.props.data)!==null&&u!==void 0?u:r).slice(t.dataStartIndex,t.dataEndIndex+1),m;if(o.dataKey&&!o.allowDuplicatedCategory){var x=h===void 0?l:h;m=uu(x,o.dataKey,s)}else m=h&&h[a]||l[a];return m?[].concat($o(c),[u_(d,m)]):c},[])},P1=function(t,r,a,s){var i=s||{x:t.chartX,y:t.chartY},o=RY(i,a),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=gH(o,l,d,c);if(u>=0&&d){var f=d[u]&&d[u].value,h=z_(t,r,u,f),m=MY(a,l,u,i);return{activeTooltipIndex:u,activeLabel:f,activePayload:h,activeCoordinate:m}}return null},$Y=function(t,r){var a=r.axes,s=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=t.stackOffset,m=i_(u,i),x=a.reduce(function(p,g){var y,b=g.props,v=b.type,w=b.dataKey,j=b.allowDataOverflow,N=b.allowDuplicatedCategory,_=b.scale,E=b.ticks,S=b.includeHidden,k=g.props[o];if(p[k])return p;var O=y0(t.data,{graphicalItems:s.filter(function(G){return G.props[o]===k}),dataStartIndex:c,dataEndIndex:d}),P=O.length,A,R,T;hY(g.props.domain,j,v)&&(A=Cm(g.props.domain,null,j),m&&(v==="number"||_!=="auto")&&(T=Ul(O,w,"category")));var F=H_(v);if(!A||A.length===0){var W,K=(W=g.props.domain)!==null&&W!==void 0?W:F;if(w){if(A=Ul(O,w,v),v==="category"&&m){var B=PT(A);N&&B?(R=A,A=Ju(0,P)):N||(A=gb(K,A,g).reduce(function(G,V){return G.indexOf(V)>=0?G:[].concat($o(G),[V])},[]))}else if(v==="category")N?A=A.filter(function(G){return G!==""&&!Pe(G)}):A=gb(K,A,g).reduce(function(G,V){return G.indexOf(V)>=0||V===""||Pe(V)?G:[].concat($o(G),[V])},[]);else if(v==="number"){var L=jH(O,s.filter(function(G){return G.props[o]===k&&(S||!G.props.hide)}),w,i,u);L&&(A=L)}m&&(v==="number"||_!=="auto")&&(T=Ul(O,w,"category"))}else m?A=Ju(0,P):l&&l[k]&&l[k].hasStack&&v==="number"?A=h==="expand"?[0,1]:d_(l[k].stackGroups,c,d):A=s_(O,s.filter(function(G){return G.props[o]===k&&(S||!G.props.hide)}),v,u,!0);if(v==="number")A=tx(f,A,k,i,E),K&&(A=Cm(K,A,j));else if(v==="category"&&K){var ee=K,M=A.every(function(G){return ee.indexOf(G)>=0});M&&(A=ee)}}return he(he({},p),{},$e({},k,he(he({},g.props),{},{axisType:i,domain:A,categoricalDomain:T,duplicateDomain:R,originalDomain:(y=g.props.domain)!==null&&y!==void 0?y:F,isCategorical:m,layout:u})))},{});return x},LY=function(t,r){var a=r.graphicalItems,s=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,f=t.children,h=y0(t.data,{graphicalItems:a,dataStartIndex:c,dataEndIndex:d}),m=h.length,x=i_(u,i),p=-1,g=a.reduce(function(y,b){var v=b.props[o],w=H_("number");if(!y[v]){p++;var j;return x?j=Ju(0,m):l&&l[v]&&l[v].hasStack?(j=d_(l[v].stackGroups,c,d),j=tx(f,j,v,i)):(j=Cm(w,s_(h,a.filter(function(N){return N.props[o]===v&&!N.props.hide}),"number",u),s.defaultProps.allowDataOverflow),j=tx(f,j,v,i)),he(he({},y),{},$e({},v,he(he({axisType:i},s.defaultProps),{},{hide:!0,orientation:Ar(IY,"".concat(i,".").concat(p%2),null),domain:j,originalDomain:w,isCategorical:x,layout:u})))}return y},{});return g},BY=function(t,r){var a=r.axisType,s=a===void 0?"xAxis":a,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,f="".concat(s,"Id"),h=Ea(u,i),m={};return h&&h.length?m=$Y(t,{axes:h,graphicalItems:o,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(m=LY(t,{Axis:i,graphicalItems:o,axisType:s,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),m},UY=function(t){var r=xs(t),a=ps(r,!1,!0);return{tooltipTicks:a,orderedTooltipTicks:Zx(a,function(s){return s.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Hu(r,a)}},F1=function(t){var r,a,s=t.children,i=t.defaultShowTooltip,o=Un(s,$c),l=o&&o.props&&o.props.startIndex||0,c=(o==null||(r=o.props)===null||r===void 0?void 0:r.endIndex)!==void 0?o==null||(a=o.props)===null||a===void 0?void 0:a.endIndex:t.data&&t.data.length-1||0;return{chartX:0,chartY:0,dataStartIndex:l,dataEndIndex:c,activeTooltipIndex:-1,isTooltipActive:Pe(i)?!1:i}},WY=function(t){return!t||!t.length?!1:t.some(function(r){var a=ks(r&&r.type);return a&&a.indexOf("Bar")>=0})},I1=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},HY=function(t,r){var a=t.props,s=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=a.width,u=a.height,f=a.children,h=a.margin||{},m=Un(f,$c),x=Un(f,dc),p=Object.keys(c).reduce(function(v,w){var j=c[w],N=j.orientation;return!j.mirror&&!j.hide?he(he({},v),{},$e({},N,v[N]+j.width)):v},{left:h.left||0,right:h.right||0}),g=Object.keys(o).reduce(function(v,w){var j=o[w],N=j.orientation;return!j.mirror&&!j.hide?he(he({},v),{},$e({},N,Ar(v,"".concat(N))+j.height)):v},{top:h.top||0,bottom:h.bottom||0}),y=he(he({},g),p),b=y.bottom;return m&&(y.bottom+=m.props.height||$c.defaultProps.height),x&&r&&(y=bH(y,s,a,r)),he(he({brushBottom:b},y),{},{width:d-y.left-y.right,height:u-y.top-y.bottom})},b0=function(t){var r,a=t.chartName,s=t.GraphicalChild,i=t.defaultTooltipEventType,o=i===void 0?"axis":i,l=t.validateTooltipEventTypes,c=l===void 0?["axis"]:l,d=t.axisComponents,u=t.legendContent,f=t.formatAxisMap,h=t.defaultProps,m=function(g,y){var b=y.graphicalItems,v=y.stackGroups,w=y.offset,j=y.updateId,N=y.dataStartIndex,_=y.dataEndIndex,E=g.barSize,S=g.layout,k=g.barGap,O=g.barCategoryGap,P=g.maxBarSize,A=I1(S),R=A.numericAxisName,T=A.cateAxisName,F=WY(b),W=F&&vH({barSize:E,stackGroups:v}),K=[];return b.forEach(function(B,L){var ee=y0(g.data,{dataStartIndex:N,dataEndIndex:_},B),M=B.props,G=M.dataKey,V=M.maxBarSize,H=B.props["".concat(R,"Id")],re=B.props["".concat(T,"Id")],me={},xe=d.reduce(function(lt,Ft){var Vt,Jt=y["".concat(Ft.axisType,"Map")],ra=B.props["".concat(Ft.axisType,"Id")];Jt&&Jt[ra]||Ft.axisType==="zAxis"||tY();var Dr=Jt[ra];return he(he({},lt),{},(Vt={},$e(Vt,Ft.axisType,Dr),$e(Vt,"".concat(Ft.axisType,"Ticks"),ps(Dr)),Vt))},me),Z=xe[T],q=xe["".concat(T,"Ticks")],ie=v&&v[H]&&v[H].hasStack&&OH(B,v[H].stackGroups),I=ks(B.type).indexOf("Bar")>=0,ve=Hu(Z,q),we=[];if(I){var Ee,ce,fe=Pe(V)?P:V,oe=(Ee=(ce=Hu(Z,q,!0))!==null&&ce!==void 0?ce:fe)!==null&&Ee!==void 0?Ee:0;we=yH({barGap:k,barCategoryGap:O,bandSize:oe!==ve?oe:ve,sizeList:W[re],maxBarSize:fe}),oe!==ve&&(we=we.map(function(lt){return he(he({},lt),{},{position:he(he({},lt.position),{},{offset:lt.position.offset-oe/2})})}))}var qe=B&&B.type&&B.type.getComposedData;if(qe){var st;K.push({props:he(he({},qe(he(he({},xe),{},{displayedData:ee,props:g,dataKey:G,item:B,bandSize:ve,barPosition:we,offset:w,stackedData:ie,layout:S,dataStartIndex:N,dataEndIndex:_}))),{},(st={key:B.key||"item-".concat(L)},$e(st,R,xe[R]),$e(st,T,xe[T]),$e(st,"animationId",j),st)),childIndex:HT(B,g.children),item:B})}}),K},x=function(g,y){var b=g.props,v=g.dataStartIndex,w=g.dataEndIndex,j=g.updateId;if(!qg({props:b}))return null;var N=b.children,_=b.layout,E=b.stackOffset,S=b.data,k=b.reverseStackOrder,O=I1(_),P=O.numericAxisName,A=O.cateAxisName,R=Ea(N,s),T=TH(S,R,"".concat(P,"Id"),"".concat(A,"Id"),E,k),F=d.reduce(function(ee,M){var G="".concat(M.axisType,"Map");return he(he({},ee),{},$e({},G,BY(b,he(he({},M),{},{graphicalItems:R,stackGroups:M.axisType===P&&T,dataStartIndex:v,dataEndIndex:w}))))},{}),W=HY(he(he({},F),{},{props:b,graphicalItems:R}),y==null?void 0:y.legendBBox);Object.keys(F).forEach(function(ee){F[ee]=f(b,F[ee],W,ee.replace("Map",""),a)});var K=F["".concat(A,"Map")],B=UY(K),L=m(b,he(he({},F),{},{dataStartIndex:v,dataEndIndex:w,updateId:j,graphicalItems:R,stackGroups:T,offset:W}));return he(he({formattedGraphicalItems:L,graphicalItems:R,offset:W,stackGroups:T},B),F)};return r=function(p){kY(y,p);var g=EY(y);function y(b){var v;return NY(this,y),v=g.call(this,b),$e(it(v),"accessibilityManager",new fY),$e(it(v),"clearDefer",function(){v.cancelDefer&&(v.cancelDefer(),v.cancelDefer=null)}),$e(it(v),"handleLegendBBoxUpdate",function(w){if(w){var j=v.state,N=j.dataStartIndex,_=j.dataEndIndex,E=j.updateId;v.setState(he({legendBBox:w},x({props:v.props,dataStartIndex:N,dataEndIndex:_,updateId:E},he(he({},v.state),{},{legendBBox:w}))))}}),$e(it(v),"handleReceiveSyncEvent",function(w,j,N){var _=v.props.syncId;_===w&&j!==v.uniqueChartId&&(v.clearDefer(),v.cancelDefer=mY(v.applySyncEvent.bind(it(v),N)))}),$e(it(v),"handleBrushChange",function(w){var j=w.startIndex,N=w.endIndex;if(j!==v.state.dataStartIndex||N!==v.state.dataEndIndex){var _=v.state.updateId;v.setState(function(){return he({dataStartIndex:j,dataEndIndex:N},x({props:v.props,dataStartIndex:j,dataEndIndex:N,updateId:_},v.state))}),v.triggerSyncEvent({dataStartIndex:j,dataEndIndex:N})}}),$e(it(v),"handleMouseEnter",function(w){var j=v.props.onMouseEnter,N=v.getMouseInfo(w);if(N){var _=he(he({},N),{},{isTooltipActive:!0});v.setState(_),v.triggerSyncEvent(_),De(j)&&j(_,w)}}),$e(it(v),"triggeredAfterMouseMove",function(w){var j=v.props.onMouseMove,N=v.getMouseInfo(w),_=N?he(he({},N),{},{isTooltipActive:!0}):{isTooltipActive:!1};v.setState(_),v.triggerSyncEvent(_),De(j)&&j(_,w)}),$e(it(v),"handleItemMouseEnter",function(w){v.setState(function(){return{isTooltipActive:!0,activeItem:w,activePayload:w.tooltipPayload,activeCoordinate:w.tooltipPosition||{x:w.cx,y:w.cy}}})}),$e(it(v),"handleItemMouseLeave",function(){v.setState(function(){return{isTooltipActive:!1}})}),$e(it(v),"handleMouseMove",function(w){w&&De(w.persist)&&w.persist(),v.triggeredAfterMouseMove(w)}),$e(it(v),"handleMouseLeave",function(w){var j=v.props.onMouseLeave,N={isTooltipActive:!1};v.setState(N),v.triggerSyncEvent(N),De(j)&&j(N,w),v.cancelThrottledTriggerAfterMouseMove()}),$e(it(v),"handleOuterEvent",function(w){var j=WT(w),N=Ar(v.props,"".concat(j));if(j&&De(N)){var _;/.*touch.*/i.test(j)?_=v.getMouseInfo(w.changedTouches[0]):_=v.getMouseInfo(w);var E=N;E(_,w)}}),$e(it(v),"handleClick",function(w){var j=v.props.onClick,N=v.getMouseInfo(w);if(N){var _=he(he({},N),{},{isTooltipActive:!0});v.setState(_),v.triggerSyncEvent(_),De(j)&&j(_,w)}}),$e(it(v),"handleMouseDown",function(w){var j=v.props.onMouseDown;if(De(j)){var N=v.getMouseInfo(w);j(N,w)}}),$e(it(v),"handleMouseUp",function(w){var j=v.props.onMouseUp;if(De(j)){var N=v.getMouseInfo(w);j(N,w)}}),$e(it(v),"handleTouchMove",function(w){w.changedTouches!=null&&w.changedTouches.length>0&&v.handleMouseMove(w.changedTouches[0])}),$e(it(v),"handleTouchStart",function(w){w.changedTouches!=null&&w.changedTouches.length>0&&v.handleMouseDown(w.changedTouches[0])}),$e(it(v),"handleTouchEnd",function(w){w.changedTouches!=null&&w.changedTouches.length>0&&v.handleMouseUp(w.changedTouches[0])}),$e(it(v),"verticalCoordinatesGenerator",function(w,j){var N=w.xAxis,_=w.width,E=w.height,S=w.offset;return fb(qm(he(he(he({},zl.defaultProps),N),{},{ticks:ps(N,!0),viewBox:{x:0,y:0,width:_,height:E}})),S.left,S.left+S.width,j)}),$e(it(v),"horizontalCoordinatesGenerator",function(w,j){var N=w.yAxis,_=w.width,E=w.height,S=w.offset;return fb(qm(he(he(he({},zl.defaultProps),N),{},{ticks:ps(N,!0),viewBox:{x:0,y:0,width:_,height:E}})),S.top,S.top+S.height,j)}),$e(it(v),"axesTicksGenerator",function(w){return ps(w,!0)}),$e(it(v),"renderCursor",function(w){var j=v.state,N=j.isTooltipActive,_=j.activeCoordinate,E=j.activePayload,S=j.offset,k=j.activeTooltipIndex,O=j.tooltipAxisBandSize,P=v.getTooltipEventType();if(!w||!w.props.cursor||!N||!_||a!=="ScatterChart"&&P!=="axis")return null;var A=v.props.layout,R,T=fi;if(a==="ScatterChart")R=_,T=hV;else if(a==="BarChart")R=pY(A,_,S,O),T=_p;else if(A==="radial"){var F=M_(_),W=F.cx,K=F.cy,B=F.radius,L=F.startAngle,ee=F.endAngle;R={cx:W,cy:K,startAngle:L,endAngle:ee,innerRadius:B,outerRadius:B},T=p_}else R={points:xY(A,_,S)},T=fi;var M=w.key||"_recharts-cursor",G=he(he(he(he({stroke:"#ccc",pointerEvents:"none"},S),R),Fe(w.props.cursor)),{},{payload:E,payloadIndex:k,key:M,className:"recharts-tooltip-cursor"});return C.isValidElement(w.props.cursor)?C.cloneElement(w.props.cursor,G):C.createElement(T,G)}),$e(it(v),"renderPolarAxis",function(w,j,N){var _=Ar(w,"type.axisType"),E=Ar(v.state,"".concat(_,"Map")),S=E&&E[w.props["".concat(_,"Id")]];return C.cloneElement(w,he(he({},S),{},{className:_,key:w.key||"".concat(j,"-").concat(N),ticks:ps(S,!0)}))}),$e(it(v),"renderXAxis",function(w,j,N){var _=v.state.xAxisMap,E=_[w.props.xAxisId];return v.renderAxis(E,w,j,N)}),$e(it(v),"renderYAxis",function(w,j,N){var _=v.state.yAxisMap,E=_[w.props.yAxisId];return v.renderAxis(E,w,j,N)}),$e(it(v),"renderGrid",function(w){var j=v.state,N=j.xAxisMap,_=j.yAxisMap,E=j.offset,S=v.props,k=S.width,O=S.height,P=xs(N),A=QX(_,function(F){return k_(F.domain,DY)}),R=A||xs(_),T=w.props||{};return C.cloneElement(w,{key:w.key||"grid",x:be(T.x)?T.x:E.left,y:be(T.y)?T.y:E.top,width:be(T.width)?T.width:E.width,height:be(T.height)?T.height:E.height,xAxis:P,yAxis:R,offset:E,chartWidth:k,chartHeight:O,verticalCoordinatesGenerator:T.verticalCoordinatesGenerator||v.verticalCoordinatesGenerator,horizontalCoordinatesGenerator:T.horizontalCoordinatesGenerator||v.horizontalCoordinatesGenerator})}),$e(it(v),"renderPolarGrid",function(w){var j=w.props,N=j.radialLines,_=j.polarAngles,E=j.polarRadius,S=v.state,k=S.radiusAxisMap,O=S.angleAxisMap,P=xs(k),A=xs(O),R=A.cx,T=A.cy,F=A.innerRadius,W=A.outerRadius;return C.cloneElement(w,{polarAngles:hr(_)?_:ps(A,!0).map(function(K){return K.coordinate}),polarRadius:hr(E)?E:ps(P,!0).map(function(K){return K.coordinate}),cx:R,cy:T,innerRadius:F,outerRadius:W,key:w.key||"polar-grid",radialLines:N})}),$e(it(v),"renderLegend",function(){var w=v.state.formattedGraphicalItems,j=v.props,N=j.children,_=j.width,E=j.height,S=v.props.margin||{},k=_-(S.left||0)-(S.right||0),O=a_({children:N,formattedGraphicalItems:w,legendWidth:k,legendContent:u});if(!O)return null;var P=O.item,A=C1(O,gY);return C.cloneElement(P,he(he({},A),{},{chartWidth:_,chartHeight:E,margin:S,onBBoxUpdate:v.handleLegendBBoxUpdate}))}),$e(it(v),"renderTooltip",function(){var w=v.props.children,j=Un(w,nn);if(!j)return null;var N=v.state,_=N.isTooltipActive,E=N.activeCoordinate,S=N.activePayload,k=N.activeLabel,O=N.offset;return C.cloneElement(j,{viewBox:he(he({},O),{},{x:O.left,y:O.top}),active:_,label:k,payload:_?S:[],coordinate:E})}),$e(it(v),"renderBrush",function(w){var j=v.props,N=j.margin,_=j.data,E=v.state,S=E.offset,k=E.dataStartIndex,O=E.dataEndIndex,P=E.updateId;return C.cloneElement(w,{key:w.key||"_recharts-brush",onChange:Wd(v.handleBrushChange,null,w.props.onChange),data:_,x:be(w.props.x)?w.props.x:S.left,y:be(w.props.y)?w.props.y:S.top+S.height+S.brushBottom-(N.bottom||0),width:be(w.props.width)?w.props.width:S.width,startIndex:k,endIndex:O,updateId:"brush-".concat(P)})}),$e(it(v),"renderReferenceElement",function(w,j,N){if(!w)return null;var _=it(v),E=_.clipPathId,S=v.state,k=S.xAxisMap,O=S.yAxisMap,P=S.offset,A=w.props,R=A.xAxisId,T=A.yAxisId;return C.cloneElement(w,{key:w.key||"".concat(j,"-").concat(N),xAxis:k[R],yAxis:O[T],viewBox:{x:P.left,y:P.top,width:P.width,height:P.height},clipPathId:E})}),$e(it(v),"renderActivePoints",function(w){var j=w.item,N=w.activePoint,_=w.basePoint,E=w.childIndex,S=w.isRange,k=[],O=j.props.key,P=j.item.props,A=P.activeDot,R=P.dataKey,T=he(he({index:E,dataKey:R,cx:N.x,cy:N.y,r:4,fill:Np(j.item),strokeWidth:2,stroke:"#fff",payload:N.payload,value:N.value,key:"".concat(O,"-activePoint-").concat(E)},Fe(A)),fu(A));return k.push(y.renderActiveDot(A,T)),_?k.push(y.renderActiveDot(A,he(he({},T),{},{cx:_.x,cy:_.y,key:"".concat(O,"-basePoint-").concat(E)}))):S&&k.push(null),k}),$e(it(v),"renderGraphicChild",function(w,j,N){var _=v.filterFormatItem(w,j,N);if(!_)return null;var E=v.getTooltipEventType(),S=v.state,k=S.isTooltipActive,O=S.tooltipAxis,P=S.activeTooltipIndex,A=S.activeLabel,R=v.props.children,T=Un(R,nn),F=_.props,W=F.points,K=F.isRange,B=F.baseLine,L=_.item.props,ee=L.activeDot,M=L.hide,G=L.activeBar,V=L.activeShape,H=!!(!M&&k&&T&&(ee||G||V)),re={};E!=="axis"&&T&&T.props.trigger==="click"?re={onClick:Wd(v.handleItemMouseEnter,null,w.props.onCLick)}:E!=="axis"&&(re={onMouseLeave:Wd(v.handleItemMouseLeave,null,w.props.onMouseLeave),onMouseEnter:Wd(v.handleItemMouseEnter,null,w.props.onMouseEnter)});var me=C.cloneElement(w,he(he({},_.props),re));function xe(st){return typeof O.dataKey=="function"?O.dataKey(st.payload):null}if(H)if(P>=0){var Z,q;if(O.dataKey&&!O.allowDuplicatedCategory){var ie=typeof O.dataKey=="function"?xe:"payload.".concat(O.dataKey.toString());Z=uu(W,ie,A),q=K&&B&&uu(B,ie,A)}else Z=W==null?void 0:W[P],q=K&&B&&B[P];if(V||G){var I=w.props.activeIndex!==void 0?w.props.activeIndex:P;return[C.cloneElement(w,he(he(he({},_.props),re),{},{activeIndex:I})),null,null]}if(!Pe(Z))return[me].concat($o(v.renderActivePoints({item:_,activePoint:Z,basePoint:q,childIndex:P,isRange:K})))}else{var ve,we=(ve=v.getItemByXY(v.state.activeCoordinate))!==null&&ve!==void 0?ve:{graphicalItem:me},Ee=we.graphicalItem,ce=Ee.item,fe=ce===void 0?w:ce,oe=Ee.childIndex,qe=he(he(he({},_.props),re),{},{activeIndex:oe});return[C.cloneElement(fe,qe),null,null]}return K?[me,null,null]:[me,null]}),$e(it(v),"renderCustomized",function(w,j,N){return C.cloneElement(w,he(he({key:"recharts-customized-".concat(N)},v.props),v.state))}),v.uniqueChartId=Pe(b.id)?Ri("recharts"):b.id,v.clipPathId="".concat(v.uniqueChartId,"-clip"),b.throttleDelay&&(v.triggeredAfterMouseMove=sN(v.triggeredAfterMouseMove,b.throttleDelay)),v.state={},v}return SY(y,[{key:"componentDidMount",value:function(){var v,w;Pe(this.props.syncId)||this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(v=this.props.margin.left)!==null&&v!==void 0?v:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.handleMouseMove,layout:this.props.layout})}},{key:"getSnapshotBeforeUpdate",value:function(v,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==v.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==v.margin){var j,N;this.accessibilityManager.setDetails({offset:{left:(j=this.props.margin.left)!==null&&j!==void 0?j:0,top:(N=this.props.margin.top)!==null&&N!==void 0?N:0}})}return null}},{key:"componentDidUpdate",value:function(v){Pe(v.syncId)&&!Pe(this.props.syncId)&&this.addListener(),!Pe(v.syncId)&&Pe(this.props.syncId)&&this.removeListener()}},{key:"componentWillUnmount",value:function(){this.clearDefer(),Pe(this.props.syncId)||this.removeListener(),this.cancelThrottledTriggerAfterMouseMove()}},{key:"cancelThrottledTriggerAfterMouseMove",value:function(){typeof this.triggeredAfterMouseMove.cancel=="function"&&this.triggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var v=Un(this.props.children,nn);if(v&&y_(v.props.shared)){var w=v.props.shared?"axis":"item";return c.indexOf(w)>=0?w:o}return o}},{key:"getMouseInfo",value:function(v){var w;if(!this.container)return null;var j=Q7(this.container),N=eB(v,j),_=this.container,E=_==null||(w=_.getBoundingClientRect())===null||w===void 0?void 0:w.width,S=_.offsetWidth,k=E/S||1,O=this.inRange(N.chartX,N.chartY,k);if(!O)return null;var P=this.state,A=P.xAxisMap,R=P.yAxisMap,T=this.getTooltipEventType();if(T!=="axis"&&A&&R){var F=xs(A).scale,W=xs(R).scale,K=F&&F.invert?F.invert(N.chartX):null,B=W&&W.invert?W.invert(N.chartY):null;return he(he({},N),{},{xValue:K,yValue:B})}var L=P1(this.state,this.props.data,this.props.layout,O);return L?he(he({},N),L):null}},{key:"inRange",value:function(v,w){var j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,N=this.props.layout,_=v/j,E=w/j;if(N==="horizontal"||N==="vertical"){var S=this.state.offset,k=_>=S.left&&_<=S.left+S.width&&E>=S.top&&E<=S.top+S.height;return k?{x:_,y:E}:null}var O=this.state,P=O.angleAxisMap,A=O.radiusAxisMap;if(P&&A){var R=xs(P);return bb({x:_,y:E},R)}return null}},{key:"parseEventsOfWrapper",value:function(){var v=this.props.children,w=this.getTooltipEventType(),j=Un(v,nn),N={};j&&w==="axis"&&(j.props.trigger==="click"?N={onClick:this.handleClick}:N={onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd});var _=fu(this.props,this.handleOuterEvent);return he(he({},_),N)}},{key:"addListener",value:function(){ba.on(lh,this.handleReceiveSyncEvent),ba.setMaxListeners&&ba._maxListeners&&ba.setMaxListeners(ba._maxListeners+1)}},{key:"removeListener",value:function(){ba.removeListener(lh,this.handleReceiveSyncEvent),ba.setMaxListeners&&ba._maxListeners&&ba.setMaxListeners(ba._maxListeners-1)}},{key:"triggerSyncEvent",value:function(v){var w=this.props.syncId;Pe(w)||ba.emit(lh,w,this.uniqueChartId,v)}},{key:"applySyncEvent",value:function(v){var w=this.props,j=w.layout,N=w.syncMethod,_=this.state.updateId,E=v.dataStartIndex,S=v.dataEndIndex;if(!Pe(v.dataStartIndex)||!Pe(v.dataEndIndex))this.setState(he({dataStartIndex:E,dataEndIndex:S},x({props:this.props,dataStartIndex:E,dataEndIndex:S,updateId:_},this.state)));else if(Pe(v.activeTooltipIndex))this.setState(v);else{var k=v.chartX,O=v.chartY,P=v.activeTooltipIndex,A=this.state,R=A.offset,T=A.tooltipTicks;if(!R)return;if(typeof N=="function")P=N(T,v);else if(N==="value"){P=-1;for(var F=0;F<T.length;F++)if(T[F].value===v.activeLabel){P=F;break}}var W=he(he({},R),{},{x:R.left,y:R.top}),K=Math.min(k,W.x+W.width),B=Math.min(O,W.y+W.height),L=T[P]&&T[P].value,ee=z_(this.state,this.props.data,P),M=T[P]?{x:j==="horizontal"?T[P].coordinate:K,y:j==="horizontal"?B:T[P].coordinate}:W_;this.setState(he(he({},v),{},{activeLabel:L,activeCoordinate:M,activePayload:ee,activeTooltipIndex:P}))}}},{key:"filterFormatItem",value:function(v,w,j){for(var N=this.state.formattedGraphicalItems,_=0,E=N.length;_<E;_++){var S=N[_];if(S.item===v||S.props.key===v.key||w===ks(S.item.type)&&j===S.childIndex)return S}return null}},{key:"renderAxis",value:function(v,w,j,N){var _=this.props,E=_.width,S=_.height;return Q.createElement(zl,lo({},v,{className:pt("recharts-".concat(v.axisType," ").concat(v.axisType),v.className),key:w.key||"".concat(j,"-").concat(N),viewBox:{x:0,y:0,width:E,height:S},ticksGenerator:this.axesTicksGenerator}))}},{key:"renderClipPath",value:function(){var v=this.clipPathId,w=this.state.offset,j=w.left,N=w.top,_=w.height,E=w.width;return Q.createElement("defs",null,Q.createElement("clipPath",{id:v},Q.createElement("rect",{x:j,y:N,height:_,width:E})))}},{key:"getXScales",value:function(){var v=this.state.xAxisMap;return v?Object.entries(v).reduce(function(w,j){var N=T1(j,2),_=N[0],E=N[1];return he(he({},w),{},$e({},_,E.scale))},{}):null}},{key:"getYScales",value:function(){var v=this.state.yAxisMap;return v?Object.entries(v).reduce(function(w,j){var N=T1(j,2),_=N[0],E=N[1];return he(he({},w),{},$e({},_,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(v){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[v])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(v){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[v])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(v){var w=this.state,j=w.formattedGraphicalItems,N=w.activeItem;if(j&&j.length)for(var _=0,E=j.length;_<E;_++){var S=j[_],k=S.props,O=S.item,P=ks(O.type);if(P==="Bar"){var A=(k.data||[]).find(function(W){return qz(v,W)});if(A)return{graphicalItem:S,payload:A}}else if(P==="RadialBar"){var R=(k.data||[]).find(function(W){return bb(v,W)});if(R)return{graphicalItem:S,payload:R}}else if(p0(S)||g0(S)||Rc(S)){var T=DG({graphicalItem:S,activeTooltipItem:N,itemData:O.props.data}),F=O.props.activeIndex===void 0?T:O.props.activeIndex;return{graphicalItem:he(he({},S),{},{childIndex:F}),payload:Rc(S)?O.props.data[T]:S.props.data[T]}}}return null}},{key:"render",value:function(){var v=this;if(!qg(this))return null;var w=this.props,j=w.children,N=w.className,_=w.width,E=w.height,S=w.style,k=w.compact,O=w.title,P=w.desc,A=C1(w,vY),R=Fe(A),T={CartesianGrid:{handler:this.renderGrid,once:!0},ReferenceArea:{handler:this.renderReferenceElement},ReferenceLine:{handler:this.renderReferenceElement},ReferenceDot:{handler:this.renderReferenceElement},XAxis:{handler:this.renderXAxis},YAxis:{handler:this.renderYAxis},Brush:{handler:this.renderBrush,once:!0},Bar:{handler:this.renderGraphicChild},Line:{handler:this.renderGraphicChild},Area:{handler:this.renderGraphicChild},Radar:{handler:this.renderGraphicChild},RadialBar:{handler:this.renderGraphicChild},Scatter:{handler:this.renderGraphicChild},Pie:{handler:this.renderGraphicChild},Funnel:{handler:this.renderGraphicChild},Tooltip:{handler:this.renderCursor,once:!0},PolarGrid:{handler:this.renderPolarGrid,once:!0},PolarAngleAxis:{handler:this.renderPolarAxis},PolarRadiusAxis:{handler:this.renderPolarAxis},Customized:{handler:this.renderCustomized}};if(k)return Q.createElement(Lh,lo({},R,{width:_,height:E,title:O,desc:P}),this.renderClipPath(),Xg(j,T));if(this.props.accessibilityLayer){var F,W;R.tabIndex=(F=0)!==null&&F!==void 0?F:this.props.tabIndex,R.role=(W="img")!==null&&W!==void 0?W:this.props.role,R.onKeyDown=function(B){v.accessibilityManager.keyboardEvent(B)},R.onFocus=function(){v.accessibilityManager.focus()}}var K=this.parseEventsOfWrapper();return Q.createElement("div",lo({className:pt("recharts-wrapper",N),style:he({position:"relative",cursor:"default",width:_,height:E},S)},K,{ref:function(L){v.container=L},role:"region"}),Q.createElement(Lh,lo({},R,{width:_,height:E,title:O,desc:P}),this.renderClipPath(),Xg(j,T)),this.renderLegend(),this.renderTooltip())}}]),y}(C.Component),$e(r,"displayName",a),$e(r,"defaultProps",he({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),$e(r,"getDerivedStateFromProps",function(p,g){var y=p.data,b=p.children,v=p.width,w=p.height,j=p.layout,N=p.stackOffset,_=p.margin;if(Pe(g.updateId)){var E=F1(p);return he(he(he({},E),{},{updateId:0},x(he(he({props:p},E),{},{updateId:0}),g)),{},{prevData:y,prevWidth:v,prevHeight:w,prevLayout:j,prevStackOffset:N,prevMargin:_,prevChildren:b})}if(y!==g.prevData||v!==g.prevWidth||w!==g.prevHeight||j!==g.prevLayout||N!==g.prevStackOffset||!uo(_,g.prevMargin)){var S=F1(p),k={chartX:g.chartX,chartY:g.chartY,isTooltipActive:g.isTooltipActive},O=he(he({},P1(g,y,j)),{},{updateId:g.updateId+1}),P=he(he(he({},S),k),O);return he(he(he({},P),x(he({props:p},P),g)),{},{prevData:y,prevWidth:v,prevHeight:w,prevLayout:j,prevStackOffset:N,prevMargin:_,prevChildren:b})}if(!Jj(b,g.prevChildren)){var A=!Pe(y),R=A?g.updateId:g.updateId+1;return he(he({updateId:R},x(he(he({props:p},g),{},{updateId:R}),g)),{},{prevChildren:b})}return null}),$e(r,"renderActiveDot",function(p,g){var y;return C.isValidElement(p)?y=C.cloneElement(p,g):De(p)?y=p(g):y=Q.createElement(bd,g),Q.createElement(ot,{className:"recharts-active-dot",key:g.key},y)}),r},D1=b0({chartName:"LineChart",GraphicalChild:yn,axisComponents:[{axisType:"xAxis",AxisComp:zn},{axisType:"yAxis",AxisComp:Vn}],formatAxisMap:Sp}),zY=b0({chartName:"BarChart",GraphicalChild:As,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:zn},{axisType:"yAxis",AxisComp:Vn}],formatAxisMap:Sp}),VY=b0({chartName:"PieChart",GraphicalChild:ls,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:x0},{axisType:"radiusAxis",AxisComp:h0}],formatAxisMap:UH,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),GY=b0({chartName:"AreaChart",GraphicalChild:Tn,axisComponents:[{axisType:"xAxis",AxisComp:zn},{axisType:"yAxis",AxisComp:Vn}],formatAxisMap:Sp});const qY=({defaultEmail:e=""})=>{const[t,r]=C.useState(e),[a,s]=C.useState(e),[i,o]=C.useState(null),[l,c]=C.useState(!1),[d,u]=C.useState(null),f=async()=>{if(!a.trim()){u("الرجاء إدخال البريد الإلكتروني للمدرسة");return}c(!0),u(null),o(null);try{const h=await v3(a);o(h),h.found||u(h.message)}catch(h){console.error("Error fetching school projects:",h),u(h instanceof Error?h.message:"حدث خطأ أثناء البحث عن المدرسة")}finally{c(!1)}};return C.useEffect(()=>{e&&f()},[e]),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(bn,{className:"w-6 h-6 text-indigo-600"}),"استعلام عن مشاريع المدرسة"]}),n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"email",value:t,onChange:h=>r(h.target.value),placeholder:"أدخل البريد الإلكتروني للمدرسة",className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),n.jsx("button",{onClick:()=>{s(t),f()},disabled:l,className:"px-6 py-3 bg-indigo-500 text-white rounded-xl hover:bg-indigo-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:l?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري البحث..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ft,{className:"w-5 h-5"}),"بحث"]})})]})}),d&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-center gap-2",children:[n.jsx(Br,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:d})]}),i&&i.found&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[n.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-xl p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-16 h-16 bg-indigo-100 rounded-xl flex items-center justify-center",children:n.jsx(bn,{className:"w-8 h-8 text-indigo-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:i.school.name}),n.jsx("p",{className:"text-gray-600",children:i.school.email})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:i.count}),n.jsx("div",{className:"text-sm text-gray-600",children:"إجمالي المشاريع"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.projects.filter(h=>h.status==="completed").length}),n.jsx("div",{className:"text-sm text-gray-600",children:"مشاريع مكتملة"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.projects.filter(h=>h.status==="active").length}),n.jsx("div",{className:"text-sm text-gray-600",children:"مشاريع نشطة"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:i.projects.filter(h=>h.status==="draft").length}),n.jsx("div",{className:"text-sm text-gray-600",children:"مشاريع في المسودة"})]})]})]}),i.projects.length>0?n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"قائمة المشاريع"}),n.jsx("div",{className:"space-y-4",children:i.projects.map(h=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${h.status==="completed"?"bg-green-100 text-green-600":h.status==="active"?"bg-blue-100 text-blue-600":"bg-yellow-100 text-yellow-600"}`,children:n.jsx(Ml,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:h.title}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h.status==="completed"?"bg-green-100 text-green-800":h.status==="active"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:h.status==="completed"?"مكتمل":h.status==="active"?"نشط":"مسودة"})]}),n.jsx("p",{className:"text-gray-600 text-sm line-clamp-2",children:h.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),Ze(h.created_at)]}),h.due_date&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),"تاريخ الاستحقاق: ",Ze(h.due_date)]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(dt,{className:"w-4 h-4"}),"الحد الأقصى: ",h.max_students," طلاب"]})]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-sm font-medium text-gray-800",children:"درجة الإنجاز"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:n.jsx("div",{className:"h-2 rounded-full bg-indigo-600",style:{width:`${h.progress||0}%`}})}),n.jsx("span",{className:"text-sm",children:h.progress||0})]})]})]})},h.id))})]}):n.jsxs("div",{className:"text-center py-8",children:[n.jsx(ze,{className:"w-16 h-16 text-indigo-500 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"تم العثور على المدرسة"}),n.jsx("p",{className:"text-gray-600",children:"لا توجد مشاريع مسجلة لهذه المدرسة حتى الآن"})]})]}),!l&&!i&&!d&&n.jsxs("div",{className:"text-center py-8",children:[n.jsx(ca,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"استعلام عن مشاريع المدرسة"}),n.jsx("p",{className:"text-gray-600",children:"أدخل البريد الإلكتروني للمدرسة للبحث عن المشاريع المرتبطة بها"})]})]})},KY=[{id:"overview",name:"نظرة عامة",icon:Zn},{id:"projects",name:"تقارير المشاريع",icon:Nt},{id:"users",name:"تقارير المستخدمين",icon:dt},{id:"performance",name:"تقارير الأداء",icon:yi},{id:"school-query",name:"استعلام المدارس",icon:bn}],XY=[{id:"week",name:"الأسبوع الماضي"},{id:"month",name:"الشهر الماضي"},{id:"quarter",name:"الربع الماضي"},{id:"year",name:"السنة الماضية"}],R1=[{name:"يناير",مكتملة:12,نشطة:8,مسودة:3},{name:"فبراير",مكتملة:15,نشطة:12,مسودة:5},{name:"مارس",مكتملة:18,نشطة:15,مسودة:4},{name:"أبريل",مكتملة:22,نشطة:18,مسودة:6},{name:"مايو",مكتملة:25,نشطة:20,مسودة:7},{name:"يونيو",مكتملة:28,نشطة:22,مسودة:5}],M1=[{name:"العلوم والتقنية",value:45,color:"#3B82F6"},{name:"ريادة الأعمال",value:25,color:"#10B981"},{name:"التطوع",value:20,color:"#F59E0B"},{name:"الأخلاق",value:10,color:"#EF4444"}],YY=[{name:"يناير",طلاب:120,معلمين:15,مدارس:3},{name:"فبراير",طلاب:145,معلمين:18,مدارس:4},{name:"مارس",طلاب:180,معلمين:22,مدارس:5},{name:"أبريل",طلاب:220,معلمين:28,مدارس:6},{name:"مايو",طلاب:265,معلمين:32,مدارس:7},{name:"يونيو",طلاب:310,معلمين:38,مدارس:8}],JY=[{name:"الأسبوع 1",معدل_الإنجاز:85,رضا_المستخدمين:92,نشاط_المنصة:78},{name:"الأسبوع 2",معدل_الإنجاز:88,رضا_المستخدمين:94,نشاط_المنصة:82},{name:"الأسبوع 3",معدل_الإنجاز:92,رضا_المستخدمين:96,نشاط_المنصة:85},{name:"الأسبوع 4",معدل_الإنجاز:89,رضا_المستخدمين:93,نشاط_المنصة:88}],ZY=[{title:"إجمالي المشاريع",value:"156",change:"+12%",trend:"up",icon:Nt,color:"from-blue-500 to-blue-600"},{title:"المستخدمون النشطون",value:"2,847",change:"+8%",trend:"up",icon:dt,color:"from-green-500 to-green-600"},{title:"معدل الإنجاز",value:"89%",change:"+5%",trend:"up",icon:ar,color:"from-purple-500 to-purple-600"},{title:"متوسط التقييم",value:"4.8",change:"+0.2",trend:"up",icon:yi,color:"from-orange-500 to-orange-600"}],QY=()=>{const[e,t]=C.useState("school-query"),[r,a]=C.useState("month"),[s,i]=C.useState("muo4sa@gmail.com");return C.useEffect(()=>{t("school-query")},[]),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Zn,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"التقارير والإحصائيات"}),n.jsx("p",{className:"opacity-90",children:"تحليل شامل لأداء المنصة والمشاريع"})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[e!=="school-query"&&n.jsx("select",{value:r,onChange:o=>a(o.target.value),className:"px-4 py-2 bg-white bg-opacity-20 text-white rounded-xl border border-white border-opacity-30 focus:outline-none focus:ring-2 focus:ring-white focus:ring-opacity-50",children:XY.map(o=>n.jsx("option",{value:o.id,className:"text-gray-800",children:o.name},o.id))}),n.jsxs("button",{className:"bg-white text-indigo-600 px-6 py-2 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5"}),"تصدير"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"156"}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع نشط"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"2,847"}),n.jsx("div",{className:"text-sm opacity-80",children:"مستخدم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"89%"}),n.jsx("div",{className:"text-sm opacity-80",children:"معدل النجاح"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"4.8"}),n.jsx("div",{className:"text-sm opacity-80",children:"متوسط التقييم"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("div",{className:"border-b border-gray-200 mb-6",children:n.jsx("nav",{className:"flex space-x-8",children:KY.map(o=>n.jsxs("button",{onClick:()=>t(o.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm transition-colors ${e===o.id?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[n.jsx(o.icon,{className:"w-4 h-4"}),o.name]},o.id))})}),e==="school-query"&&n.jsx("div",{className:"space-y-6",children:n.jsx(qY,{defaultEmail:s})}),e==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:ZY.map((o,l)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:l*.1},className:"bg-white border border-gray-200 rounded-2xl p-6 hover:shadow-lg transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:`w-12 h-12 bg-gradient-to-r ${o.color} rounded-xl flex items-center justify-center`,children:n.jsx(o.icon,{className:"w-6 h-6 text-white"})}),n.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${o.trend==="up"?"text-green-600":"text-red-600"}`,children:[n.jsx(yi,{className:"w-4 h-4"}),o.change]})]}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-1",children:o.value}),n.jsx("p",{className:"text-gray-600 text-sm",children:o.title})]},o.title))}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"تطور المشاريع"}),n.jsx(xl,{width:"100%",height:300,children:n.jsxs(zY,{data:R1,children:[n.jsx(oo,{strokeDasharray:"3 3"}),n.jsx(zn,{dataKey:"name"}),n.jsx(Vn,{}),n.jsx(nn,{}),n.jsx(As,{dataKey:"مكتملة",fill:"#10B981"}),n.jsx(As,{dataKey:"نشطة",fill:"#3B82F6"}),n.jsx(As,{dataKey:"مسودة",fill:"#F59E0B"})]})})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"توزيع المشاريع حسب الفئة"}),n.jsx(xl,{width:"100%",height:300,children:n.jsxs(VY,{children:[n.jsx(ls,{data:M1,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:({name:o,percent:l})=>`${o} ${(l*100).toFixed(0)}%`,children:M1.map((o,l)=>n.jsx(t0,{fill:o.color},`cell-${l}`))}),n.jsx(nn,{})]})})]})]})]}),e==="projects"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"إحصائيات المشاريع الشهرية"}),n.jsx(xl,{width:"100%",height:400,children:n.jsxs(GY,{data:R1,children:[n.jsx(oo,{strokeDasharray:"3 3"}),n.jsx(zn,{dataKey:"name"}),n.jsx(Vn,{}),n.jsx(nn,{}),n.jsx(Tn,{type:"monotone",dataKey:"مكتملة",stackId:"1",stroke:"#10B981",fill:"#10B981"}),n.jsx(Tn,{type:"monotone",dataKey:"نشطة",stackId:"1",stroke:"#3B82F6",fill:"#3B82F6"}),n.jsx(Tn,{type:"monotone",dataKey:"مسودة",stackId:"1",stroke:"#F59E0B",fill:"#F59E0B"})]})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"89"}),n.jsx("p",{className:"text-gray-600",children:"مشاريع مكتملة"}),n.jsx("p",{className:"text-green-600 text-sm mt-1",children:"+15% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Ng,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"67"}),n.jsx("p",{className:"text-gray-600",children:"مشاريع نشطة"}),n.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"+8% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Nt,{className:"w-8 h-8 text-yellow-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"23"}),n.jsx("p",{className:"text-gray-600",children:"مشاريع في المسودة"}),n.jsx("p",{className:"text-yellow-600 text-sm mt-1",children:"-5% من الشهر الماضي"})]})]})]}),e==="users"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"نمو المستخدمين"}),n.jsx(xl,{width:"100%",height:400,children:n.jsxs(D1,{data:YY,children:[n.jsx(oo,{strokeDasharray:"3 3"}),n.jsx(zn,{dataKey:"name"}),n.jsx(Vn,{}),n.jsx(nn,{}),n.jsx(yn,{type:"monotone",dataKey:"طلاب",stroke:"#3B82F6",strokeWidth:3}),n.jsx(yn,{type:"monotone",dataKey:"معلمين",stroke:"#10B981",strokeWidth:3}),n.jsx(yn,{type:"monotone",dataKey:"مدارس",stroke:"#F59E0B",strokeWidth:3})]})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"2,456"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي الطلاب"}),n.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"+18% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Nt,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"312"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي المعلمين"}),n.jsx("p",{className:"text-green-600 text-sm mt-1",children:"+12% من الشهر الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-yellow-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"79"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي المدارس"}),n.jsx("p",{className:"text-yellow-600 text-sm mt-1",children:"+25% من الشهر الماضي"})]})]})]}),e==="performance"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"مؤشرات الأداء الأسبوعية"}),n.jsx(xl,{width:"100%",height:400,children:n.jsxs(D1,{data:JY,children:[n.jsx(oo,{strokeDasharray:"3 3"}),n.jsx(zn,{dataKey:"name"}),n.jsx(Vn,{domain:[0,100]}),n.jsx(nn,{}),n.jsx(yn,{type:"monotone",dataKey:"معدل_الإنجاز",stroke:"#3B82F6",strokeWidth:3}),n.jsx(yn,{type:"monotone",dataKey:"رضا_المستخدمين",stroke:"#10B981",strokeWidth:3}),n.jsx(yn,{type:"monotone",dataKey:"نشاط_المنصة",stroke:"#F59E0B",strokeWidth:3})]})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(yi,{className:"w-8 h-8 text-blue-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"89%"}),n.jsx("p",{className:"text-gray-600",children:"معدل الإنجاز"}),n.jsx("p",{className:"text-blue-600 text-sm mt-1",children:"+3% من الأسبوع الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(ar,{className:"w-8 h-8 text-green-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"94%"}),n.jsx("p",{className:"text-gray-600",children:"رضا المستخدمين"}),n.jsx("p",{className:"text-green-600 text-sm mt-1",children:"+1% من الأسبوع الماضي"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-6 text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:n.jsx(Ng,{className:"w-8 h-8 text-yellow-600"})}),n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:"85%"}),n.jsx("p",{className:"text-gray-600",children:"نشاط المنصة"}),n.jsx("p",{className:"text-yellow-600 text-sm mt-1",children:"+7% من الأسبوع الماضي"})]})]})]})]}),e!=="school-query"&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"خيارات التصدير"}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(Cr,{className:"w-5 h-5 text-blue-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"تصدير PDF"}),n.jsx("p",{className:"text-sm text-gray-600",children:"تقرير شامل"})]})]}),n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(Cr,{className:"w-5 h-5 text-green-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"تصدير Excel"}),n.jsx("p",{className:"text-sm text-gray-600",children:"بيانات خام"})]})]}),n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(nr,{className:"w-5 h-5 text-purple-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"عرض مفصل"}),n.jsx("p",{className:"text-sm text-gray-600",children:"تحليل متقدم"})]})]}),n.jsxs("button",{className:"flex items-center gap-3 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[n.jsx(tt,{className:"w-5 h-5 text-orange-600"}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium text-gray-800",children:"تقرير مجدول"}),n.jsx("p",{className:"text-sm text-gray-600",children:"إرسال دوري"})]})]})]})]})]})},eJ=()=>{const{t:e}=jt(),{consultants:t,loading:r,error:a}=Ds(),[s,i]=C.useState(""),[o,l]=C.useState("all"),[c,d]=C.useState(0),[u,f]=C.useState(!1),[h,m]=C.useState(!1),[x,p]=C.useState(null),g=["all",...new Set(t.flatMap(b=>b.specialties))],y=t.filter(b=>{const v=b.name.toLowerCase().includes(s.toLowerCase())||b.title.toLowerCase().includes(s.toLowerCase())||b.specialties.some(N=>N.toLowerCase().includes(s.toLowerCase())),w=o==="all"||b.specialties.includes(o),j=b.rating>=c;return v&&w&&j});return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ft,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("search.title")}),n.jsx("p",{className:"opacity-90",children:e("search.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.availableConsultants")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:g.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.specialties")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"24/7"}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.support")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:"100%"}),n.jsx("div",{className:"text-sm opacity-80",children:e("search.stats.satisfaction")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("search.searchPlaceholder"),value:s,onChange:b=>i(b.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>f(!u),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(zo,{className:"w-5 h-5"}),e("common.filter")]})]}),n.jsxs("div",{className:`mt-4 space-y-4 ${u?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("search.specialty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:g.map(b=>n.jsx("button",{onClick:()=>l(b),className:`px-4 py-2 rounded-xl transition-all ${o===b?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:b==="all"?e("search.allSpecialties"):b},b))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("search.rating")}),n.jsx("div",{className:"flex items-center gap-2",children:[0,3,3.5,4,4.5].map(b=>n.jsx("button",{onClick:()=>d(b),className:`flex items-center gap-1 px-4 py-2 rounded-xl transition-all ${c===b?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:b===0?e("common.all"):n.jsxs(n.Fragment,{children:[n.jsx(at,{className:"w-4 h-4"}),b,"+"]})},b))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("search.showing")," ",y.length," ",e("search.of")," ",t.length," ",e("search.consultant")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((b,v)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:v*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("img",{src:b.avatar,alt:b.name,className:"w-24 h-24 rounded-full object-cover mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:b.name}),n.jsx("p",{className:"text-gray-600 mb-2",children:b.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:b.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",b.reviews," ",e("search.reviews"),")"]})]}),n.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:b.availability})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("search.specialties"),":"]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:b.specialties.map((w,j)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:w},j))})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.experience"),":"]}),n.jsx("span",{className:"font-medium",children:b.experience})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("search.price"),":"]}),n.jsxs("span",{className:"font-medium text-emerald-600",children:[b.hourlyRate," ",e("search.pricePerHour")]})]}),n.jsxs("div",{children:[n.jsxs("span",{className:"text-gray-600 text-sm",children:[e("search.languages"),": "]}),n.jsx("span",{className:"text-sm",children:b.languages.join(", ")})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:()=>{p(b.id),m(!0)},className:"flex-1 bg-emerald-500 text-white py-2 px-4 rounded-xl hover:bg-emerald-600 transition-colors font-medium",children:e("search.bookConsultation")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(zt,{className:"w-4 h-4"})})]})]},b.id))}),y.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ft,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("search.noConsultantsFound")}),n.jsx("p",{className:"text-gray-600 mb-4",children:e("search.tryChangingFilters")}),n.jsx("button",{onClick:()=>{l("all"),d(0),i("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("common.resetFilters")})]}),h&&x&&n.jsx(Fj,{consultant:t.find(b=>b.id===x),onClose:()=>{m(!1),p(null)},onSubmit:b=>{console.log("Booking consultation:",b),m(!1),p(null)}})]})},tJ=[{id:"1",name:"د. محمد العتيبي",title:"مستشار تقني",specialties:["الذكاء الاصطناعي","تعلم الآلة","الروبوتات"],rating:4.9,reviews:124,experience:"10+ سنوات",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:200,availability:"متاح",languages:["العربية","الإنجليزية"],location:"الرياض، السعودية"},{id:"2",name:"أ. سارة الشمري",title:"مستشارة أكاديمية",specialties:["التعليم","المناهج الدراسية","تطوير المهارات"],rating:4.8,reviews:98,experience:"8+ سنوات",avatar:"https://images.pexels.com/photos/774909/pexels-photo-774909.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:150,availability:"متاح",languages:["العربية","الإنجليزية","الفرنسية"],location:"جدة، السعودية"},{id:"3",name:"م. خالد الدوسري",title:"مستشار هندسي",specialties:["الهندسة الميكانيكية","الطاقة المتجددة","التصميم الهندسي"],rating:4.7,reviews:87,experience:"12+ سنوات",avatar:"https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:250,availability:"متاح",languages:["العربية","الإنجليزية"],location:"الدمام، السعودية"},{id:"4",name:"د. نورة القحطاني",title:"مستشارة تعليمية",specialties:["التعليم الإلكتروني","تطوير المناهج","التقييم التربوي"],rating:4.9,reviews:112,experience:"15+ سنوات",avatar:"https://images.pexels.com/photos/415829/pexels-photo-415829.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:180,availability:"متاح",languages:["العربية","الإنجليزية"],location:"الرياض، السعودية"},{id:"5",name:"أ. فهد العنزي",title:"مستشار مالي",specialties:["التخطيط المالي","الاستثمار","إدارة الميزانية"],rating:4.6,reviews:76,experience:"7+ سنوات",avatar:"https://images.pexels.com/photos/1222271/pexels-photo-1222271.jpeg?auto=compress&cs=tinysrgb&w=150",hourlyRate:220,availability:"متاح",languages:["العربية","الإنجليزية"],location:"جدة، السعودية"}],rJ=()=>{const{t:e}=jt(),[t,r]=C.useState(tJ),[a,s]=C.useState(""),[i,o]=C.useState("all"),l=["all",...new Set(t.flatMap(u=>u.specialties))],c=t.filter(u=>{const f=u.name.toLowerCase().includes(a.toLowerCase())||u.title.toLowerCase().includes(a.toLowerCase())||u.specialties.some(m=>m.toLowerCase().includes(a.toLowerCase())),h=i==="all"||u.specialties.includes(i);return f&&h}),d=u=>{r(f=>f.filter(h=>h.id!==u))};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(at,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("favorites.title")}),n.jsx("p",{className:"opacity-90",children:e("favorites.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.length}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.favoriteConsultants")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:l.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.differentSpecialties")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:Math.round(t.reduce((u,f)=>u+f.rating,0)/t.length*10)/10}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.averageRating")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:Math.round(t.reduce((u,f)=>u+f.hourlyRate,0)/t.length)}),n.jsx("div",{className:"text-sm opacity-80",children:e("favorites.stats.averagePrice")})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("favorites.searchPlaceholder"),value:a,onChange:u=>s(u.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:e("favorites.specialty")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(u=>n.jsx("button",{onClick:()=>o(u),className:`px-4 py-2 rounded-xl transition-all ${i===u?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:u==="all"?e("favorites.allSpecialties"):u},u))})]})})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:[e("favorites.showing")," ",c.length," ",e("favorites.of")," ",t.length," ",e("favorites.consultant")]})}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((u,f)=>n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:f*.1},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all duration-300",children:[n.jsxs("div",{className:"text-center mb-4 relative",children:[n.jsx("button",{onClick:()=>d(u.id),className:"absolute top-0 left-0 p-2 bg-red-100 text-red-600 rounded-full hover:bg-red-200 transition-colors",children:n.jsx(ha,{className:"w-5 h-5 fill-current"})}),n.jsx("img",{src:u.avatar,alt:u.name,className:"w-24 h-24 rounded-full object-cover mx-auto mb-4"}),n.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-1",children:u.name}),n.jsx("p",{className:"text-gray-600 mb-2",children:u.title}),n.jsxs("div",{className:"flex items-center justify-center gap-1 mb-2",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsx("span",{className:"font-medium",children:u.rating}),n.jsxs("span",{className:"text-gray-500 text-sm",children:["(",u.reviews," ",e("favorites.reviews"),")"]})]}),n.jsx("span",{className:"inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium flex items-center gap-1",children:u.availability})]}),n.jsxs("div",{className:"space-y-3 mb-4",children:[n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-gray-800 mb-2",children:[e("favorites.specialties"),":"]}),n.jsx("div",{className:"flex flex-wrap gap-1",children:u.specialties.map((h,m)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:h},m))})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.experience"),":"]}),n.jsx("span",{className:"font-medium",children:u.experience})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.price"),":"]}),n.jsxs("span",{className:"font-medium text-emerald-600",children:[u.hourlyRate," ",e("favorites.pricePerHour")]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"text-gray-600",children:[e("favorites.location"),":"]}),n.jsx("span",{className:"font-medium",children:u.location})]}),n.jsxs("div",{children:[n.jsxs("span",{className:"text-gray-600 text-sm",children:[e("favorites.languages"),": "]}),n.jsx("span",{className:"text-sm",children:u.languages.join(", ")})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Ae,{to:`/consultations?consultant=${u.id}`,className:"flex-1 bg-emerald-500 text-white py-2 px-4 rounded-xl hover:bg-emerald-600 transition-colors font-medium",children:e("favorites.bookConsultation")}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:n.jsx(zt,{className:"w-4 h-4"})})]})]},u.id))}),c.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(at,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("favorites.noFavorites")}),n.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?e("favorites.noFavoritesAdded"):e("favorites.noFavoritesMatch")}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsx(Ae,{to:"/search",className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:e("favorites.searchConsultants")}),t.length>0&&n.jsx("button",{onClick:()=>{o("all"),s("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:e("common.resetFilters")})]})]})]})},aJ=()=>{const{user:e}=wt(),{consultations:t,loading:r,error:a,acceptConsultation:s}=Ds(),[i,o]=C.useState("all"),[l,c]=C.useState(""),[d,u]=C.useState(!1),f=t.filter(v=>v.status==="pending"&&v.mentor_id===null),h=t.filter(v=>v.mentor_id===(e==null?void 0:e.id)),m=h.filter(v=>{const w=i==="all"||v.status===i,j=v.topic.toLowerCase().includes(l.toLowerCase())||v.description.toLowerCase().includes(l.toLowerCase());return w&&j}),x=async v=>{try{u(!0),await s(v)}catch(w){console.error("Error accepting consultation:",w)}finally{u(!1)}},p=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800";case"scheduled":return"bg-blue-100 text-blue-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=v=>{switch(v){case"pending":return"في الانتظار";case"scheduled":return"مجدولة";case"completed":return"مكتملة";case"cancelled":return"ملغية";default:return v}},y=v=>{switch(v){case"video":return n.jsx(wr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Wr,{className:"w-4 h-4"});default:return n.jsx(zt,{className:"w-4 h-4"})}},b=v=>{switch(v){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return v}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(vi,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"لوحة تحكم المستشار"}),n.jsxs("p",{className:"opacity-90",children:["مرحباً ",e==null?void 0:e.name,"، إدارة الاستشارات والمواعيد"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي الاستشارات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.filter(v=>v.status==="scheduled").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مجدولة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:h.filter(v=>v.status==="completed").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مكتملة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:f.length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلبات جديدة"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(zt,{className:"w-6 h-6 text-emerald-600"}),"طلبات الاستشارة الجديدة"]}),f.length>0?n.jsx("div",{className:"space-y-4",children:f.map(v=>n.jsx(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:v.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${p(v.status)}`,children:g(v.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:v.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[y(v.method),b(v.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),v.duration," دقيقة"]}),v.preferredDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"التاريخ المفضل: ",Ze(v.preferredDate)]})]})]}),n.jsx("button",{onClick:()=>x(v.id),disabled:d,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"جاري القبول...":"قبول الطلب"})]})},v.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(zt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد طلبات جديدة"}),n.jsx("p",{className:"text-gray-600",children:"ستظهر هنا طلبات الاستشارة الجديدة التي يمكنك قبولها"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ae,{to:"/consultation-requests",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض جميع الطلبات",n.jsx(ac,{className:"w-4 h-4"})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-6 h-6 text-emerald-600"}),"استشاراتي"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في الاستشارات...",value:l,onChange:v=>c(v.target.value),className:"w-64 pr-12 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("select",{value:i,onChange:v=>o(v.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الحالات"}),n.jsx("option",{value:"scheduled",children:"مجدولة"}),n.jsx("option",{value:"completed",children:"مكتملة"}),n.jsx("option",{value:"cancelled",children:"ملغية"})]})]})]}),m.length>0?n.jsx("div",{className:"space-y-4",children:m.map(v=>n.jsxs(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:v.topic}),n.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${p(v.status)}`,children:g(v.status)})]}),n.jsx("p",{className:"text-gray-600 mb-2",children:v.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[y(v.method),b(v.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),v.duration," دقيقة"]}),v.scheduledDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"موعد الاستشارة: ",Ze(v.scheduledDate)]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[v.status==="scheduled"&&n.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",onClick:()=>window.open("https://meet.google.com/new","_blank"),children:"بدء الاستشارة"}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"عرض التفاصيل"})]})]}),v.status==="completed"&&v.rating&&n.jsxs("div",{className:"mt-2 flex items-center gap-1",children:[n.jsx("span",{className:"text-sm text-gray-600",children:"التقييم:"}),n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(w=>n.jsx(at,{className:`w-4 h-4 ${w<=v.rating?"text-yellow-400 fill-current":"text-gray-300"}`},w))}),v.feedback&&n.jsxs("span",{className:"text-sm text-gray-600 mr-2",children:['"',v.feedback,'"']})]})]},v.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد استشارات"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم العثور على استشارات تطابق معايير البحث"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ae,{to:"/consultant-schedule",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض جدول المواعيد",n.jsx(ac,{className:"w-4 h-4"})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:n.jsx(at,{className:"w-6 h-6 text-emerald-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"التقييمات"}),n.jsx("p",{className:"text-gray-600",children:"متوسط تقييم استشاراتك"})]})]}),n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(v=>n.jsx(at,{className:`w-6 h-6 ${v<=4.5?"text-yellow-400 fill-current":"text-gray-300"}`},v))}),n.jsx("span",{className:"text-2xl font-bold text-gray-800",children:"4.5"})]}),n.jsxs("p",{className:"text-sm text-gray-600",children:["من ",h.filter(v=>v.rating).length," تقييم"]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:n.jsx(dt,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"العملاء"}),n.jsx("p",{className:"text-gray-600",children:"عدد العملاء الذين قدمت لهم استشارات"})]})]}),n.jsx("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:new Set(h.map(v=>v.student_id)).size}),n.jsx("p",{className:"text-sm text-gray-600",children:"عميل فريد"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:n.jsx(yi,{className:"w-6 h-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"الإيرادات"}),n.jsx("p",{className:"text-gray-600",children:"إجمالي الإيرادات من الاستشارات"})]})]}),n.jsxs("div",{className:"text-2xl font-bold text-gray-800 mb-2",children:[h.filter(v=>v.status==="completed").reduce((v,w)=>v+w.duration/60*((e==null?void 0:e.hourly_rate)||150),0).toFixed(0)," ر.س"]}),n.jsxs("p",{className:"text-sm text-gray-600",children:["من ",h.filter(v=>v.status==="completed").length," استشارة مكتملة"]})]})]})]})},nJ=()=>{const{user:e}=wt(),{consultations:t,loading:r,error:a,acceptConsultation:s}=Ds(),[i,o]=C.useState(""),[l,c]=C.useState("all"),[d,u]=C.useState(!1),[f,h]=C.useState(1),m=5,x=t.filter(j=>j.status==="pending"&&j.mentor_id===null),p=x.filter(j=>{const N=l==="all"||j.type===l,_=j.topic.toLowerCase().includes(i.toLowerCase())||j.description.toLowerCase().includes(i.toLowerCase());return N&&_}),g=Math.ceil(p.length/m),y=p.slice((f-1)*m,f*m),b=async j=>{try{u(!0),await s(j)}catch(N){console.error("Error accepting consultation:",N)}finally{u(!1)}},v=j=>{switch(j){case"video":return n.jsx(wr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Wr,{className:"w-4 h-4"});default:return n.jsx(zt,{className:"w-4 h-4"})}},w=j=>{switch(j){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return j}};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(zt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"طلبات الاستشارة"}),n.jsx("p",{className:"opacity-90",children:"اختر الطلبات التي ترغب في قبولها"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.length}),n.jsx("div",{className:"text-sm opacity-80",children:"طلب استشارة متاح"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(j=>j.type==="technical").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة تقنية"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(j=>j.type==="academic").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة أكاديمية"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x.filter(j=>j.type==="project").length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة مشروع"})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في طلبات الاستشارة...",value:i,onChange:j=>o(j.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("select",{value:l,onChange:j=>c(j.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الأنواع"}),n.jsx("option",{value:"technical",children:"استشارة تقنية"}),n.jsx("option",{value:"academic",children:"استشارة أكاديمية"}),n.jsx("option",{value:"career",children:"استشارة مهنية"}),n.jsx("option",{value:"project",children:"استشارة مشروع"})]})]})}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",p.length," من أصل ",x.length," طلب استشارة"]})}),n.jsx("div",{className:"space-y-4",children:y.length>0?y.map(j=>n.jsxs(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-6 hover:shadow-xl transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:j.topic}),n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"في الانتظار"})]}),n.jsx("p",{className:"text-gray-600 mb-3",children:j.description}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[v(j.method),w(j.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),j.duration," دقيقة"]}),j.preferredDate&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"التاريخ المفضل: ",Ze(j.preferredDate)]})]})]}),n.jsx("button",{onClick:()=>b(j.id),disabled:d,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:d?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري القبول..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ze,{className:"w-5 h-5"}),"قبول الطلب"]})})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[n.jsx(xr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:"الطالب"}),n.jsxs("p",{className:"text-xs text-gray-600",children:["معرف الطالب: ",j.student_id]})]})]})]},j.id)):n.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(zt,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد طلبات استشارة"}),n.jsx("p",{className:"text-gray-600 mb-4",children:"لم يتم العثور على طلبات استشارة تطابق معايير البحث"}),n.jsx("button",{onClick:()=>{c("all"),o("")},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:"إعادة تعيين الفلاتر"})]})}),g>1&&n.jsx("div",{className:"flex justify-center mt-6",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>h(j=>Math.max(j-1,1)),disabled:f===1,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(Qn,{className:"w-5 h-5"})}),n.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:g},(j,N)=>N+1).map(j=>n.jsx("button",{onClick:()=>h(j),className:`w-8 h-8 rounded-lg ${f===j?"bg-emerald-500 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:j},j))}),n.jsx("button",{onClick:()=>h(j=>Math.min(j+1,g)),disabled:f===g,className:"p-2 rounded-lg border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:n.jsx(ac,{className:"w-5 h-5"})})]})}),n.jsx("div",{className:"text-center mt-6",children:n.jsxs(Ae,{to:"/consultant-dashboard",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:[n.jsx(Qn,{className:"w-5 h-5"}),"العودة إلى لوحة التحكم"]})})]})},sJ=()=>{const{user:e}=wt(),{consultations:t,loading:r,error:a}=Ds(),[s,i]=C.useState(new Date),[o,l]=C.useState("week"),c=t.filter(y=>y.status==="scheduled"&&y.consultant_id===(e==null?void 0:e.id)),d=y=>{switch(y){case"video":return n.jsx(wr,{className:"w-4 h-4"});case"phone":return n.jsx(Pr,{className:"w-4 h-4"});case"chat":return n.jsx(Wr,{className:"w-4 h-4"});default:return n.jsx(Wr,{className:"w-4 h-4"})}},u=y=>{switch(y){case"video":return"مكالمة فيديو";case"phone":return"مكالمة صوتية";case"chat":return"محادثة نصية";default:return y}},h=(()=>{const y=[],b=new Date(s);b.setDate(s.getDate()-s.getDay());for(let v=0;v<7;v++){const w=new Date(b);w.setDate(b.getDate()+v),y.push(w)}return y})(),m=y=>c.filter(b=>{if(!b.scheduledDate)return!1;const v=new Date(b.scheduledDate);return v.getDate()===y.getDate()&&v.getMonth()===y.getMonth()&&v.getFullYear()===y.getFullYear()}),x=()=>{const y=new Date(s);y.setDate(s.getDate()-7),i(y)},p=()=>{const y=new Date(s);y.setDate(s.getDate()+7),i(y)},g=()=>{i(new Date)};return r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:a})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(tt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"جدول المواعيد"}),n.jsx("p",{className:"opacity-90",children:"إدارة مواعيد الاستشارات الخاصة بك"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.length}),n.jsx("div",{className:"text-sm opacity-80",children:"استشارة مجدولة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(y=>{if(!y.scheduledDate)return!1;const b=new Date;b.setHours(0,0,0,0);const v=new Date(y.scheduledDate);return v.setHours(0,0,0,0),v.getTime()===b.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"اليوم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(y=>{if(!y.scheduledDate)return!1;const b=new Date;b.setHours(0,0,0,0);const v=new Date(b);v.setDate(b.getDate()+1);const w=new Date(y.scheduledDate);return w.setHours(0,0,0,0),w.getTime()===v.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"غداً"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(y=>{if(!y.scheduledDate)return!1;const b=new Date;b.setHours(0,0,0,0);const v=new Date(b);v.setDate(b.getDate()+7);const w=new Date(y.scheduledDate);return w.setHours(0,0,0,0),w.getTime()>b.getTime()&&w.getTime()<=v.getTime()}).length}),n.jsx("div",{className:"text-sm opacity-80",children:"هذا الأسبوع"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:x,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Dl,{className:"w-5 h-5 text-gray-600"})}),n.jsx("button",{onClick:g,className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"اليوم"}),n.jsx("button",{onClick:p,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Rl,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[Ze(h[0])," - ",Ze(h[6])]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>l("day"),className:`px-4 py-2 rounded-lg ${o==="day"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"يوم"}),n.jsx("button",{onClick:()=>l("week"),className:`px-4 py-2 rounded-lg ${o==="week"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"أسبوع"}),n.jsx("button",{onClick:()=>l("month"),className:`px-4 py-2 rounded-lg ${o==="month"?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"شهر"})]})]}),o==="week"&&n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("div",{className:"grid grid-cols-7 gap-4 min-w-[800px]",children:[h.map((y,b)=>n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:`mb-2 font-medium ${y.getDate()===new Date().getDate()&&y.getMonth()===new Date().getMonth()&&y.getFullYear()===new Date().getFullYear()?"text-emerald-600":"text-gray-800"}`,children:y.toLocaleDateString("ar-SA",{weekday:"long"})}),n.jsx("div",{className:`w-10 h-10 rounded-full mx-auto flex items-center justify-center ${y.getDate()===new Date().getDate()&&y.getMonth()===new Date().getMonth()&&y.getFullYear()===new Date().getFullYear()?"bg-emerald-500 text-white":"bg-gray-100 text-gray-800"}`,children:y.getDate()})]},b)),h.map((y,b)=>n.jsx("div",{className:"mt-4 space-y-2",children:m(y).length>0?m(y).map(v=>n.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"text-sm font-medium text-emerald-800",children:v.scheduledDate&&R0(v.scheduledDate)}),n.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-600",children:[d(v.method),u(v.method)]})]}),n.jsx("h4",{className:"font-medium text-gray-800 mb-1 line-clamp-1",children:v.topic}),n.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:v.description}),n.jsx("div",{className:"mt-2 flex justify-end",children:n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-3 py-1 bg-emerald-500 text-white text-xs rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})})]},v.id)):n.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 text-center text-gray-500 text-sm",children:"لا توجد مواعيد"})},`consultations-${b}`))]})}),o==="day"&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"text-center mb-4",children:n.jsx("h3",{className:"text-xl font-bold text-gray-800",children:Ze(s)})}),m(s).length>0?m(s).map(y=>n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:y.topic}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"مجدولة"})]}),n.jsx("p",{className:"text-gray-600 text-sm mb-2",children:y.description}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),y.scheduledDate&&R0(y.scheduledDate)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[d(y.method),u(y.method)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),y.duration," دقيقة"]})]})]}),n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[n.jsx(xr,{className:"w-5 h-5 text-gray-500"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-gray-800",children:"الطالب"}),n.jsxs("p",{className:"text-xs text-gray-600",children:["معرف الطالب: ",y.student_id]})]})]})]},y.id)):n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد مواعيد لهذا اليوم"}),n.jsx("p",{className:"text-gray-600",children:"يمكنك قبول طلبات استشارة جديدة من صفحة طلبات الاستشارة"})]})]}),o==="month"&&n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"عرض الشهر قيد التطوير"}),n.jsx("p",{className:"text-gray-600",children:"يرجى استخدام عرض اليوم أو الأسبوع في الوقت الحالي"})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(_t,{className:"w-6 h-6 text-emerald-600"}),"الاستشارات القادمة"]}),c.length>0?n.jsx("div",{className:"space-y-4",children:c.filter(y=>{if(!y.scheduledDate)return!1;const b=new Date;return new Date(y.scheduledDate)>b}).sort((y,b)=>!y.scheduledDate||!b.scheduledDate?0:new Date(y.scheduledDate).getTime()-new Date(b.scheduledDate).getTime()).slice(0,3).map(y=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-gray-800",children:y.topic}),n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs",children:"مجدولة"})]}),n.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),y.scheduledDate&&Ze(y.scheduledDate)]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-4 h-4"}),y.scheduledDate&&R0(y.scheduledDate)]})]})]}),n.jsx("button",{onClick:()=>window.open("https://meet.google.com/new","_blank"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors",children:"بدء الاستشارة"})]})},y.id))}):n.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(tt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد استشارات قادمة"}),n.jsx("p",{className:"text-gray-600",children:"يمكنك قبول طلبات استشارة جديدة من صفحة طلبات الاستشارة"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs(Ae,{to:"/consultation-requests",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:["عرض طلبات الاستشارة",n.jsx(ac,{className:"w-4 h-4"})]})})]}),n.jsx("div",{className:"text-center mt-6",children:n.jsxs(Ae,{to:"/consultant-dashboard",className:"inline-flex items-center gap-2 text-emerald-600 font-medium hover:text-emerald-800 transition-colors",children:[n.jsx(Qn,{className:"w-5 h-5"}),"العودة إلى لوحة التحكم"]})})]})},iJ=()=>{const{user:e}=wt(),[t,r]=C.useState(!1),[a,s]=C.useState({name:(e==null?void 0:e.name)||"",bio:(e==null?void 0:e.bio)||"",phone:(e==null?void 0:e.phone)||"",specializations:(e==null?void 0:e.specializations)||[],experience:(e==null?void 0:e.experience)||"",hourlyRate:(e==null?void 0:e.hourlyRate)||0,languages:(e==null?void 0:e.languages)||[]}),[i,o]=C.useState(!1),l=["الاستشارات الهندسية","الاستشارات القانونية","الاستشارات الإدارية","الاستشارات التقنية","الاستشارات المالية","الاستشارات التسويقية","الاستشارات الطبية","الاستشارات التعليمية","الاستشارات البيئية","الاستشارات الأمنية"],c=["العربية","الإنجليزية","الفرنسية","الإسبانية","الألمانية","الصينية","اليابانية","الروسية","الهندية","البرتغالية"],d=(m,x)=>{s(p=>({...p,[m]:x}))},u=m=>{s(x=>({...x,specializations:x.specializations.includes(m)?x.specializations.filter(p=>p!==m):[...x.specializations,m]}))},f=m=>{s(x=>({...x,languages:x.languages.includes(m)?x.languages.filter(p=>p!==m):[...x.languages,m]}))},h=async()=>{o(!0),setTimeout(()=>{o(!1),r(!1)},1e3)};return n.jsxs("div",{className:"space-y-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:n.jsxs("div",{className:"flex items-center gap-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:(e==null?void 0:e.avatar)||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:e==null?void 0:e.name,className:"w-24 h-24 rounded-full object-cover border-4 border-white"}),n.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-white text-emerald-600 rounded-full flex items-center justify-center hover:bg-gray-100 transition-colors",children:n.jsx(bi,{className:"w-4 h-4"})})]}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold mb-2",children:e==null?void 0:e.name}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(vi,{className:"w-4 h-4"}),n.jsx("span",{children:(e==null?void 0:e.role)==="consultant"?"مستشار":e==null?void 0:e.role})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4"}),n.jsxs("span",{children:[(e==null?void 0:e.rating)||5," (",(e==null?void 0:e.reviewsCount)||0," تقييم)"]})]})]})]})]})}),n.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"lg:col-span-2",children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(xr,{className:"w-6 h-6 text-emerald-600"}),"المعلومات الشخصية"]}),n.jsx("button",{onClick:()=>r(!t),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors flex items-center gap-2",children:t?n.jsxs(n.Fragment,{children:[n.jsx(es,{className:"w-4 h-4"}),"حفظ"]}):n.jsxs(n.Fragment,{children:[n.jsx(Ca,{className:"w-4 h-4"}),"تعديل"]})})]}),t?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الاسم الكامل"}),n.jsx("input",{type:"text",value:a.name,onChange:m=>d("name",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"نبذة مهنية"}),n.jsx("textarea",{value:a.bio,onChange:m=>d("bio",m.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اكتب نبذة مختصرة عن خبرتك المهنية..."})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رقم الهاتف"}),n.jsx("input",{type:"tel",value:a.phone,onChange:m=>d("phone",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"05xxxxxxxx"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"التخصصات"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:l.map(m=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${a.specializations.includes(m)?"bg-emerald-50 border-emerald-500 text-emerald-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:a.specializations.includes(m),onChange:()=>u(m),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:m})]},m))})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"اللغات"}),n.jsx("div",{className:"grid grid-cols-2 gap-2",children:c.map(m=>n.jsxs("label",{className:`flex items-center gap-2 p-3 border rounded-lg cursor-pointer transition-colors ${a.languages.includes(m)?"bg-emerald-50 border-emerald-500 text-emerald-700":"border-gray-300 hover:bg-gray-50"}`,children:[n.jsx("input",{type:"checkbox",checked:a.languages.includes(m),onChange:()=>f(m),className:"sr-only"}),n.jsx("span",{className:"text-sm",children:m})]},m))})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سنوات الخبرة"}),n.jsx("input",{type:"text",value:a.experience,onChange:m=>d("experience",m.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"مثال: 5 سنوات"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"السعر بالساعة (ريال سعودي)"}),n.jsx("input",{type:"number",value:a.hourlyRate,onChange:m=>d("hourlyRate",parseInt(m.target.value)||0),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"200",min:"0"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"button",onClick:h,disabled:i,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:i?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(es,{className:"w-5 h-5"}),"حفظ التغييرات"]})})]})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"البريد الإلكتروني"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:e==null?void 0:e.email})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"رقم الهاتف"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:(e==null?void 0:e.phone)||"غير محدد"})]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"نبذة مهنية"}),n.jsx("p",{className:"text-gray-800 leading-relaxed",children:(e==null?void 0:e.bio)||"لا توجد نبذة مهنية. قم بتعديل ملفك الشخصي لإضافة نبذة عن خبرتك المهنية."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-2",children:"التخصصات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e!=null&&e.specializations&&e.specializations.length>0?e.specializations.map((m,x)=>n.jsx("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-sm",children:m},x)):n.jsx("span",{className:"text-gray-500",children:"لم يتم تحديد تخصصات"})})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"سنوات الخبرة"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_t,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:(e==null?void 0:e.experience)||"غير محدد"})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"السعر بالساعة"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(lu,{className:"w-5 h-5 text-gray-400"}),n.jsxs("span",{className:"text-gray-800",children:[(e==null?void 0:e.hourlyRate)||0," ر.س"]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-1",children:"اللغات"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(a3,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:e!=null&&e.languages&&e.languages.length>0?e.languages.join("، "):"غير محدد"})]})]})]})]})]})}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:[n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(ar,{className:"w-5 h-5 text-emerald-600"}),"الإحصائيات"]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"التقييم"}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("div",{className:"flex",children:[1,2,3,4,5].map(m=>n.jsx(at,{className:`w-4 h-4 ${m<=((e==null?void 0:e.rating)||5)?"text-yellow-400 fill-current":"text-gray-300"}`},m))}),n.jsx("span",{className:"font-medium",children:(e==null?void 0:e.rating)||5})]})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"عدد التقييمات"}),n.jsx("span",{className:"font-medium",children:(e==null?void 0:e.reviewsCount)||0})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الاستشارات المكتملة"}),n.jsx("span",{className:"font-medium",children:"0"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"معدل الاستجابة"}),n.jsx("span",{className:"font-medium",children:"100%"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(tt,{className:"w-5 h-5 text-emerald-600"}),"أوقات الدوام"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الأحد"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الإثنين"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الثلاثاء"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الأربعاء"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الخميس"}),n.jsx("span",{className:"font-medium",children:"9:00 ص - 5:00 م"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"الجمعة"}),n.jsx("span",{className:"text-gray-400",children:"مغلق"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"السبت"}),n.jsx("span",{className:"text-gray-400",children:"مغلق"})]})]}),n.jsx("button",{className:"w-full mt-4 px-4 py-2 border border-emerald-500 text-emerald-600 rounded-lg hover:bg-emerald-50 transition-colors",children:"تعديل أوقات الدوام"})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"روابط سريعة"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("a",{href:"/consultant-dashboard",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(vi,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"لوحة التحكم"})]}),n.jsxs("a",{href:"/consultation-requests",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(zt,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"طلبات الاستشارة"})]}),n.jsxs("a",{href:"/consultant-schedule",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(tt,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"جدول المواعيد"})]}),n.jsxs("a",{href:"/reviews",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(at,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"التقييمات"})]}),n.jsxs("a",{href:"/settings",className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg transition-colors",children:[n.jsx(yr,{className:"w-5 h-5 text-emerald-600"}),n.jsx("span",{className:"text-gray-700",children:"الإعدادات"})]})]})]})]})]})]})},oJ=()=>{const{user:e}=wt(),[t,r]=C.useState([]),[a,s]=C.useState(!0),[i,o]=C.useState(null),[l,c]=C.useState(null),[d,u]=C.useState(""),[f,h]=C.useState("latest");C.useEffect(()=>{(async()=>{if(e)try{s(!0),o(null);const b=Me(pe,"reviews"),v=et(b,We("consultant_id","==",e.id),Fi("created_at","desc"),_s(50)),w=await Je(v);if(w.empty){r([]),s(!1);return}const j=await Promise.all(w.docs.map(async N=>{const _=N.data();let E={name:"طالب غير معروف",avatar:"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150"};if(_.student_id){const k=Re(pe,"users",_.student_id),O=await fr(k);if(O.exists()){const P=O.data();E={name:P.name||"طالب غير معروف",avatar:P.avatar_url||E.avatar}}}let S={topic:"استشارة",type:"عامة",date:new Date().toISOString()};if(_.consultation_id){const k=Re(pe,"consultations",_.consultation_id),O=await fr(k);if(O.exists()){const P=O.data();S={topic:P.topic||"استشارة",type:P.type||"عامة",date:P.completed_at?new Date(P.completed_at.toDate()).toISOString():new Date().toISOString()}}}return{id:N.id,consultation_id:_.consultation_id,student_id:_.student_id,consultant_id:_.consultant_id,rating:_.rating||5,feedback:_.feedback||"",created_at:_.created_at?new Date(_.created_at.toDate()).toISOString():new Date().toISOString(),student:E,consultation:S}}));r(j)}catch(b){console.error("Error fetching reviews:",b),o(b instanceof Error?b.message:"حدث خطأ في تحميل التقييمات")}finally{s(!1)}})()},[e]);const m=t.filter(y=>{var w,j;const b=l===null||y.rating===l,v=y.feedback.toLowerCase().includes(d.toLowerCase())||((w=y.student)==null?void 0:w.name.toLowerCase().includes(d.toLowerCase()))||((j=y.consultation)==null?void 0:j.topic.toLowerCase().includes(d.toLowerCase()));return b&&v}).sort((y,b)=>f==="latest"?new Date(b.created_at).getTime()-new Date(y.created_at).getTime():f==="oldest"?new Date(y.created_at).getTime()-new Date(b.created_at).getTime():f==="highest"?b.rating-y.rating:f==="lowest"?y.rating-b.rating:0),x=t.length,p=x>0?t.reduce((y,b)=>y+b.rating,0)/x:0,g=[5,4,3,2,1].map(y=>({rating:y,count:t.filter(b=>b.rating===y).length,percentage:x>0?t.filter(b=>b.rating===y).length/x*100:0}));return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(ca,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-yellow-500 to-amber-500 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(at,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"التقييمات"}),n.jsx("p",{className:"opacity-90",children:"تقييمات الطلاب لاستشاراتك"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:x}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي التقييمات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:p.toFixed(1)}),n.jsx("div",{className:"text-sm opacity-80",children:"متوسط التقييم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:g[0].count}),n.jsx("div",{className:"text-sm opacity-80",children:"تقييم 5 نجوم"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:t.filter(y=>y.rating>=4).length}),n.jsx("div",{className:"text-sm opacity-80",children:"تقييمات إيجابية"})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"grid lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"lg:col-span-2 bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(Zn,{className:"w-6 h-6 text-yellow-500"}),"توزيع التقييمات"]}),n.jsx("div",{className:"space-y-4",children:g.map(y=>n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-1 w-24",children:[n.jsx("span",{className:"font-medium",children:y.rating}),n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"})]}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:n.jsx("div",{className:"bg-yellow-400 h-2.5 rounded-full",style:{width:`${y.percentage}%`}})})}),n.jsx("div",{className:"w-16 text-right",children:n.jsx("span",{className:"text-sm text-gray-600",children:y.count})}),n.jsx("div",{className:"w-16 text-right",children:n.jsxs("span",{className:"text-sm text-gray-600",children:[y.percentage.toFixed(0),"%"]})})]},y.rating))})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[n.jsx(yi,{className:"w-6 h-6 text-yellow-500"}),"إحصائيات التقييم"]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"text-5xl font-bold text-gray-800 mb-2",children:p.toFixed(1)}),n.jsx("div",{className:"flex items-center justify-center gap-1 mb-2",children:[1,2,3,4,5].map(y=>n.jsx(at,{className:`w-6 h-6 ${y<=Math.round(p)?"text-yellow-400 fill-current":"text-gray-300"}`},y))}),n.jsxs("p",{className:"text-gray-600",children:["من ",x," تقييم"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"نسبة الرضا"}),n.jsxs("span",{className:"font-medium text-green-600",children:[x>0?(t.filter(y=>y.rating>=4).length/x*100).toFixed(0):0,"%"]})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"متوسط التقييم الشهري"}),n.jsx("span",{className:"font-medium text-blue-600",children:t.filter(y=>{const b=new Date(y.created_at),v=new Date;return b.getMonth()===v.getMonth()&&b.getFullYear()===v.getFullYear()}).length})]}),n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-gray-600",children:"أعلى تقييم"}),n.jsx("span",{className:"font-medium text-yellow-600",children:"5.0"})]})]})]})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Wr,{className:"w-6 h-6 text-yellow-500"}),"التقييمات والمراجعات"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في التقييمات...",value:d,onChange:y=>u(y.target.value),className:"w-64 pr-12 pl-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),n.jsxs("select",{value:f,onChange:y=>h(y.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent",children:[n.jsx("option",{value:"latest",children:"الأحدث"}),n.jsx("option",{value:"oldest",children:"الأقدم"}),n.jsx("option",{value:"highest",children:"الأعلى تقييماً"}),n.jsx("option",{value:"lowest",children:"الأقل تقييماً"})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(zo,{className:"w-5 h-5 text-gray-500"}),n.jsx("span",{className:"font-medium text-gray-700",children:"تصفية حسب التقييم:"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("button",{onClick:()=>c(null),className:`px-4 py-2 rounded-lg transition-colors ${l===null?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"الكل"}),[5,4,3,2,1].map(y=>n.jsxs("button",{onClick:()=>c(y),className:`flex items-center gap-1 px-4 py-2 rounded-lg transition-colors ${l===y?"bg-yellow-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx("span",{children:y}),n.jsx(at,{className:"w-4 h-4"})]},y))]})]}),n.jsx("div",{className:"space-y-6",children:m.length>0?m.map(y=>{var b,v,w,j,N,_,E,S,k,O;return n.jsxs(te.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[n.jsx("img",{src:(b=y.student)==null?void 0:b.avatar,alt:(v=y.student)==null?void 0:v.name,className:"w-12 h-12 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-semibold text-gray-800",children:(w=y.student)==null?void 0:w.name}),n.jsx("p",{className:"text-sm text-gray-500",children:(j=y.consultation)==null?void 0:j.topic})]}),n.jsxs("div",{className:"flex flex-col items-end",children:[n.jsx("div",{className:"flex items-center gap-1 mb-1",children:[1,2,3,4,5].map(P=>n.jsx(at,{className:`w-4 h-4 ${P<=y.rating?"text-yellow-400 fill-current":"text-gray-300"}`},P))}),n.jsx("span",{className:"text-xs text-gray-500",children:Ze(y.created_at)})]})]}),n.jsx("p",{className:"text-gray-700 leading-relaxed",children:y.feedback}),n.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm text-gray-500",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(tt,{className:"w-4 h-4"}),"تاريخ الاستشارة: ",Ze(((N=y.consultation)==null?void 0:N.date)||"")]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Wr,{className:"w-4 h-4"}),"نوع الاستشارة: ",((_=y.consultation)==null?void 0:_.type)==="technical"?"تقنية":((E=y.consultation)==null?void 0:E.type)==="academic"?"أكاديمية":((S=y.consultation)==null?void 0:S.type)==="career"?"مهنية":((k=y.consultation)==null?void 0:k.type)==="project"?"مشروع":(O=y.consultation)==null?void 0:O.type]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t border-gray-200",children:[n.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[n.jsx(n3,{className:"w-4 h-4"}),"مفيد"]}),n.jsxs("button",{className:"flex items-center gap-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[n.jsx(Wr,{className:"w-4 h-4"}),"رد"]})]})]},y.id)}):n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(Wr,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد تقييمات"}),n.jsx("p",{className:"text-gray-600",children:t.length===0?"لم تتلق أي تقييمات بعد":"لم يتم العثور على تقييمات تطابق معايير البحث"}),t.length>0&&n.jsx("button",{onClick:()=>{c(null),u(""),h("latest")},className:"mt-4 px-6 py-2 bg-yellow-500 text-white rounded-xl hover:bg-yellow-600 transition-colors",children:"إعادة تعيين الفلاتر"})]})})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-gradient-to-r from-yellow-50 to-amber-50 rounded-2xl p-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[n.jsx(ar,{className:"w-6 h-6 text-yellow-500"}),"نصائح لتحسين تقييماتك"]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"الاستماع الجيد"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"استمع جيداً لاحتياجات الطالب وافهم مشكلته قبل تقديم الحلول"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"التواصل الفعال"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"حافظ على تواصل واضح ومباشر، واستخدم لغة مفهومة للطالب"})]}),n.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[n.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"المتابعة بعد الاستشارة"}),n.jsx("p",{className:"text-gray-600 text-sm",children:"تواصل مع الطالب بعد الاستشارة للتأكد من استفادته وتقديم دعم إضافي"})]})]})]})]})},lJ=()=>{const{user:e}=wt(),[t,r]=C.useState("overview"),[a,s]=C.useState([]),[i,o]=C.useState([]),[l,c]=C.useState(""),[d,u]=C.useState("all"),[f,h]=C.useState("all"),[m,x]=C.useState(!0),[p,g]=C.useState(null),[y,b]=C.useState(!1),[v,w]=C.useState({total:0,pending:0,approved:0,rejected:0});C.useEffect(()=>{j(),N()},[]);const j=async()=>{try{x(!0),g(null),console.log("Fetching users from Firestore...");const A=Me(pe,"users"),R=et(A,Fi("createdAt","desc"),_s(100)),T=await Je(R);console.log(`Found ${T.docs.length} users in Firestore`);const F=T.docs.map(K=>{var L,ee;const B=K.data();return{id:K.id,...B,createdAt:((ee=(L=B.createdAt)==null?void 0:L.toDate)==null?void 0:ee.call(L))||new Date,name:B.name||"مستخدم بدون اسم",email:B.email||"بدون بريد إلكتروني",role:B.role||"student",status:B.status||"active",avatar_url:B.avatar_url||B.avatar}});console.log("Processed user data:",F),o(F);const W=F.filter(K=>(K.role==="school"||K.role==="consultant")&&K.status==="pending");console.log(`Found ${W.length} pending users`),s(W)}catch(A){console.error("Error fetching users:",A),g(A instanceof Error?A.message:"حدث خطأ في تحميل بيانات المستخدمين")}finally{x(!1)}},N=async()=>{try{const A=Me(pe,"summer_program_registrations"),R=await Je(A),T=R.size,F=R.docs.filter(B=>B.data().status==="pending").length,W=R.docs.filter(B=>B.data().status==="approved").length,K=R.docs.filter(B=>B.data().status==="rejected").length;w({total:T,pending:F,approved:W,rejected:K})}catch(A){console.error("Error fetching summer program stats:",A)}},_=async A=>{try{b(!0);const R=Re(pe,"users",A);await Ht(R,{status:"active",approved_at:Ve(),approved_by:e==null?void 0:e.id}),console.log(`User ${A} approved successfully`),await j(),alert("تم تفعيل الحساب بنجاح")}catch(R){console.error("Error approving user:",R),alert("حدث خطأ أثناء تفعيل الحساب")}finally{b(!1)}},E=async A=>{try{b(!0);const R=Re(pe,"users",A);await Ht(R,{status:"rejected",rejected_at:Ve(),rejected_by:e==null?void 0:e.id}),console.log(`User ${A} rejected successfully`),await j(),alert("تم رفض الحساب بنجاح")}catch(R){console.error("Error rejecting user:",R),alert("حدث خطأ أثناء رفض الحساب")}finally{b(!1)}},S=async A=>{if(confirm("هل أنت متأكد من حذف هذا المستخدم؟ هذا الإجراء لا يمكن التراجع عنه."))try{b(!0);const R=Re(pe,"users",A);await qa(R),console.log(`User ${A} deleted successfully`),await j(),alert("تم حذف المستخدم بنجاح")}catch(R){console.error("Error deleting user:",R),alert("حدث خطأ أثناء حذف المستخدم")}finally{b(!1)}},k=i.filter(A=>{var W,K;const R=(((W=A.name)==null?void 0:W.toLowerCase())||"").includes(l.toLowerCase())||(((K=A.email)==null?void 0:K.toLowerCase())||"").includes(l.toLowerCase()),T=d==="all"||A.role===d,F=f==="all"||A.status===f;return R&&T&&F}),O=A=>{switch(A){case"student":return"طالب";case"teacher":return"معلم";case"school":return"مدرسة";case"consultant":return"مستشار";case"admin":return"مدير";default:return A}},P=A=>{switch(A){case"active":return{text:"نشط",color:"bg-green-100 text-green-800",icon:ze};case"pending":return{text:"في انتظار التفعيل",color:"bg-yellow-100 text-yellow-800",icon:ei};case"rejected":return{text:"مرفوض",color:"bg-red-100 text-red-800",icon:Br};case"suspended":return{text:"موقوف",color:"bg-gray-100 text-gray-800",icon:Br};default:return{text:A,color:"bg-gray-100 text-gray-800",icon:vt}}};return m?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-red-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(Th,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"لوحة تحكم المدير"}),n.jsxs("p",{className:"opacity-90",children:["مرحباً ",e==null?void 0:e.name,"، إدارة المنصة والمستخدمين"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:i.length}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المستخدمين"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:a.length}),n.jsx("div",{className:"text-sm opacity-80",children:"في انتظار التفعيل"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:i.filter(A=>A.role==="school").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مدرسة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:i.filter(A=>A.role==="consultant").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مستشار"})]})]})]}),n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:[n.jsx("div",{className:"border-b border-gray-200",children:n.jsxs("nav",{className:"flex overflow-x-auto",children:[n.jsx("button",{onClick:()=>r("overview"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="overview"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Th,{className:"w-4 h-4"}),"نظرة عامة"]})}),n.jsx("button",{onClick:()=>r("pending-approvals"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="pending-approvals"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ei,{className:"w-4 h-4"}),"طلبات التفعيل",a.length>0&&n.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:a.length})]})}),n.jsx("button",{onClick:()=>r("users-management"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="users-management"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dt,{className:"w-4 h-4"}),"إدارة المستخدمين"]})}),n.jsx("button",{onClick:()=>r("schools-management"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="schools-management"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(bn,{className:"w-4 h-4"}),"إدارة المدارس"]})}),n.jsx("button",{onClick:()=>r("content-management"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="content-management"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(yr,{className:"w-4 h-4"}),"إدارة المحتوى"]})}),n.jsx("button",{onClick:()=>r("summer-program"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="summer-program"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(tt,{className:"w-4 h-4"}),"البرنامج الصيفي",v.pending>0&&n.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:v.pending})]})}),n.jsx("button",{onClick:()=>r("system-settings"),className:`px-4 py-4 font-medium text-sm border-b-2 whitespace-nowrap ${t==="system-settings"?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(vo,{className:"w-4 h-4"}),"إعدادات النظام"]})})]})}),n.jsxs("div",{className:"p-6",children:[t==="overview"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"نظرة عامة على المنصة"}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(dt,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المستخدمين"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:i.length})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["نشط: ",i.filter(A=>A.status==="active").length]}),n.jsxs("span",{children:["جديد: +",i.filter(A=>{const R=new Date(A.createdAt),F=Math.abs(new Date().getTime()-R.getTime());return Math.ceil(F/(1e3*60*60*24))<=7}).length," هذا الأسبوع"]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:n.jsx(bn,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المدارس"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:i.filter(A=>A.role==="school").length})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["نشط: ",i.filter(A=>A.role==="school"&&A.status==="active").length]}),n.jsxs("span",{children:["في الانتظار: ",i.filter(A=>A.role==="school"&&A.status==="pending").length]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:n.jsx(zt,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"المستشارين"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:i.filter(A=>A.role==="consultant").length})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["نشط: ",i.filter(A=>A.role==="consultant"&&A.status==="active").length]}),n.jsxs("span",{children:["في الانتظار: ",i.filter(A=>A.role==="consultant"&&A.status==="pending").length]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:n.jsx(tt,{className:"w-5 h-5 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"البرنامج الصيفي"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.total})]})]}),n.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[n.jsxs("span",{children:["مقبول: ",v.approved]}),n.jsxs("span",{children:["في الانتظار: ",v.pending]})]})]})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"النشاط الأخير"}),n.jsxs("div",{className:"space-y-4",children:[a.slice(0,5).map(A=>n.jsxs("div",{className:"flex items-start gap-3 p-3 border border-gray-100 rounded-lg hover:bg-gray-50 transition-colors",children:[n.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${A.role==="school"?"bg-green-100":"bg-purple-100"}`,children:A.role==="school"?n.jsx(bn,{className:`w-5 h-5 ${A.role==="school"?"text-green-600":"text-purple-600"}`}):n.jsx(vi,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-gray-800",children:A.name}),n.jsx("p",{className:"text-sm text-gray-500",children:A.email})]}),n.jsx("span",{className:"text-xs text-gray-500",children:Ze(A.createdAt)})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",children:"في انتظار التفعيل"}),n.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:O(A.role)})]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx("button",{onClick:()=>_(A.id),disabled:y,className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",children:n.jsx(ze,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>E(A.id),disabled:y,className:"p-2 bg-red-100 text-red-600 rounded-lg hover:bg-red-200 transition-colors",children:n.jsx(Br,{className:"w-4 h-4"})})]})]},A.id)),a.length===0&&n.jsx("div",{className:"text-center py-6",children:n.jsx("p",{className:"text-gray-500",children:"لا توجد طلبات تفعيل جديدة"})})]}),a.length>5&&n.jsx("div",{className:"mt-4 text-center",children:n.jsxs("button",{onClick:()=>r("pending-approvals"),className:"text-red-600 hover:text-red-800 font-medium text-sm",children:["عرض كل الطلبات (",a.length,")"]})})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-5 h-5 text-yellow-600"}),'البرنامج الصيفي "صيفي تك"']}),n.jsxs(Ae,{to:"/admin/summer-program-registrations",className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center gap-1",children:["إدارة التسجيلات",n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left",children:[n.jsx("path",{d:"m12 19-7-7 7-7"}),n.jsx("path",{d:"M19 12H5"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-gray-800",children:v.total}),n.jsx("div",{className:"text-xs text-gray-500",children:"إجمالي التسجيلات"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-yellow-600",children:v.pending}),n.jsx("div",{className:"text-xs text-gray-500",children:"قيد المراجعة"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-green-600",children:v.approved}),n.jsx("div",{className:"text-xs text-gray-500",children:"تمت الموافقة"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-3 text-center",children:[n.jsx("div",{className:"text-xl font-bold text-red-600",children:v.rejected}),n.jsx("div",{className:"text-xs text-gray-500",children:"مرفوض"})]})]}),v.pending>0?n.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-start gap-3",children:[n.jsx(ei,{className:"w-5 h-5 text-yellow-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-yellow-800",children:["يوجد ",v.pending," طلب تسجيل في انتظار المراجعة"]}),n.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"يرجى مراجعة طلبات التسجيل في البرنامج الصيفي واتخاذ الإجراء المناسب."}),n.jsxs(Ae,{to:"/admin/summer-program-registrations",className:"mt-2 inline-flex items-center gap-1 text-sm font-medium text-yellow-800 hover:text-yellow-900",children:["عرض الطلبات",n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left",children:[n.jsx("path",{d:"m12 19-7-7 7-7"}),n.jsx("path",{d:"M19 12H5"})]})]})]})]}):n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-5 h-5 text-green-600 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-800",children:"لا توجد طلبات تسجيل في انتظار المراجعة"}),n.jsx("p",{className:"text-sm text-green-700 mt-1",children:"جميع طلبات التسجيل في البرنامج الصيفي تمت مراجعتها."})]})]})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:n.jsx(sc,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"إضافة مستخدم"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إنشاء حساب جديد"})]})]}),n.jsx("button",{className:"w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"إضافة مستخدم"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:n.jsx(Zn,{className:"w-6 h-6 text-green-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"التقارير"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إحصائيات وتحليلات"})]})]}),n.jsx(Ae,{to:"/reports",className:"block w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-center",children:"عرض التقارير"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:n.jsx(nu,{className:"w-6 h-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"النسخ الاحتياطي"}),n.jsx("p",{className:"text-sm text-gray-500",children:"حماية بيانات المنصة"})]})]}),n.jsx("button",{className:"w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:"إنشاء نسخة احتياطية"})]})]})]}),t==="pending-approvals"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"طلبات التفعيل"}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("select",{value:d,onChange:A=>u(A.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الأنواع"}),n.jsx("option",{value:"school",children:"المدارس"}),n.jsx("option",{value:"consultant",children:"المستشارين"})]})})]}),a.length>0?n.jsx("div",{className:"space-y-4",children:a.filter(A=>d==="all"||A.role===d).map(A=>n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("img",{src:A.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:A.name,className:"w-16 h-16 rounded-full object-cover"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:A.name}),n.jsx("p",{className:"text-gray-600",children:A.email})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"في انتظار التفعيل"}),n.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-xs font-medium",children:O(A.role)})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"تاريخ التسجيل:"}),n.jsx("p",{className:"text-sm font-medium",children:Ze(A.createdAt)})]}),A.phone&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"رقم الهاتف:"}),n.jsx("p",{className:"text-sm font-medium",children:A.phone})]}),A.role==="school"&&n.jsxs(n.Fragment,{children:[A.type&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"نوع المدرسة:"}),n.jsx("p",{className:"text-sm font-medium",children:A.type})]}),A.location&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"الموقع:"}),n.jsx("p",{className:"text-sm font-medium",children:A.location})]})]}),A.role==="consultant"&&n.jsxs(n.Fragment,{children:[A.subject&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"التخصص:"}),n.jsx("p",{className:"text-sm font-medium",children:A.subject})]}),A.experience_years&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"سنوات الخبرة:"}),n.jsxs("p",{className:"text-sm font-medium",children:[A.experience_years," سنوات"]})]})]})]}),A.bio&&n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"نبذة:"}),n.jsx("p",{className:"text-sm text-gray-700",children:A.bio})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{onClick:()=>_(A.id),disabled:y,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(ze,{className:"w-4 h-4"}),"تفعيل الحساب"]}),n.jsxs("button",{onClick:()=>E(A.id),disabled:y,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Br,{className:"w-4 h-4"}),"رفض"]}),n.jsx("button",{className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"عرض التفاصيل"})]})]})]})},A.id))}):n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ei,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا توجد طلبات تفعيل"}),n.jsx("p",{className:"text-gray-600",children:"جميع طلبات التفعيل تمت معالجتها"})]})]}),t==="users-management"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"إدارة المستخدمين"}),n.jsxs("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(sc,{className:"w-4 h-4"}),"إضافة مستخدم"]})]}),n.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في المستخدمين...",value:l,onChange:A=>c(A.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),n.jsxs("select",{value:d,onChange:A=>u(A.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الأنواع"}),n.jsx("option",{value:"student",children:"طلاب"}),n.jsx("option",{value:"teacher",children:"معلمين"}),n.jsx("option",{value:"school",children:"مدارس"}),n.jsx("option",{value:"consultant",children:"مستشارين"}),n.jsx("option",{value:"admin",children:"مديرين"})]}),n.jsxs("select",{value:f,onChange:A=>h(A.target.value),className:"px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:"جميع الحالات"}),n.jsx("option",{value:"active",children:"نشط"}),n.jsx("option",{value:"pending",children:"في الانتظار"}),n.jsx("option",{value:"rejected",children:"مرفوض"}),n.jsx("option",{value:"suspended",children:"موقوف"})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستخدم"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"النوع"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ التسجيل"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(A=>{const R=P(A.status);return n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:A.avatar_url||"https://images.pexels.com/photos/220453/pexels-photo-220453.jpeg?auto=compress&cs=tinysrgb&w=150",alt:A.name,className:"w-10 h-10 rounded-full object-cover"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-gray-800",children:A.name}),n.jsx("div",{className:"text-sm text-gray-500",children:A.email})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-full text-xs font-medium",children:O(A.role)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("span",{className:`px-3 py-1 ${R.color} rounded-full text-xs font-medium flex items-center gap-1 w-fit`,children:[n.jsx(R.icon,{className:"w-3 h-3"}),R.text]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ze(A.createdAt)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{className:"p-1 text-blue-600 hover:text-blue-800 transition-colors",children:n.jsx(nr,{className:"w-4 h-4"})}),n.jsx("button",{className:"p-1 text-green-600 hover:text-green-800 transition-colors",children:n.jsx(Ca,{className:"w-4 h-4"})}),n.jsx("button",{onClick:()=>S(A.id),className:"p-1 text-red-600 hover:text-red-800 transition-colors",children:n.jsx(sr,{className:"w-4 h-4"})})]})})]},A.id)})})]})}),k.length===0&&n.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-xl",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(dt,{className:"w-8 h-8 text-gray-400"})}),n.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"لا يوجد مستخدمين"}),n.jsx("p",{className:"text-gray-600",children:"لم يتم العثور على مستخدمين يطابقون معايير البحث"})]})]}),t==="summer-program"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(tt,{className:"w-6 h-6 text-yellow-600"}),'إدارة البرنامج الصيفي "صيفي تك"']}),n.jsxs(Ae,{to:"/admin/summer-program-registrations",className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors flex items-center gap-2",children:[n.jsx(nr,{className:"w-4 h-4"}),"عرض جميع التسجيلات"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(dt,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"إجمالي التسجيلات"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.total})]})]})}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center",children:n.jsx(_t,{className:"w-5 h-5 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"قيد المراجعة"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.pending})]})]})}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"تمت الموافقة"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.approved})]})]})}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 shadow-sm",children:n.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[n.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:n.jsx(Br,{className:"w-5 h-5 text-red-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-gray-500",children:"مرفوض"}),n.jsx("p",{className:"text-xl font-bold text-gray-800",children:v.rejected})]})]})})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"معلومات البرنامج الصيفي"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:n.jsx(Cn,{className:"w-5 h-5 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-blue-800",children:'البرنامج الصيفي "صيفي تك"'}),n.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"برنامج تدريبي صيفي للطلاب في مجالات التكنولوجيا والابتكار"}),n.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"الفترة: 15 يونيو - 15 أغسطس 2025"})]})]}),n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:n.jsx(ze,{className:"w-5 h-5 text-green-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-800",children:"رابط التسجيل في البرنامج"}),n.jsx("p",{className:"text-sm text-green-700 mt-1",children:"يمكن للطلاب التسجيل في البرنامج من خلال الرابط التالي:"}),n.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[n.jsx("code",{className:"px-3 py-1 bg-green-100 rounded-lg text-green-800 text-sm",children:"/summer-program-enrollment"}),n.jsx("button",{className:"p-1 bg-green-200 text-green-700 rounded-lg hover:bg-green-300 transition-colors",children:n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-copy",children:[n.jsx("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),n.jsx("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})]})})]})]})]}),n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-purple-50 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:n.jsx(vo,{className:"w-5 h-5 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-purple-800",children:"إدارة التسجيلات"}),n.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"يمكنك إدارة جميع طلبات التسجيل في البرنامج الصيفي من خلال لوحة التحكم الخاصة بالبرنامج."}),n.jsxs(Ae,{to:"/admin/summer-program-registrations",className:"mt-2 inline-flex items-center gap-1 px-3 py-1 bg-purple-200 text-purple-800 rounded-lg hover:bg-purple-300 transition-colors text-sm",children:["الانتقال إلى لوحة التحكم",n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-arrow-left",children:[n.jsx("path",{d:"m12 19-7-7 7-7"}),n.jsx("path",{d:"M19 12H5"})]})]})]})]})]})]})]}),t==="schools-management"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"إدارة المدارس"}),n.jsxs("button",{className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(bn,{className:"w-4 h-4"}),"إضافة مدرسة"]})]}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:n.jsx("p",{className:"text-center text-gray-600",children:"قريباً - سيتم إضافة واجهة إدارة المدارس"})})]}),t==="content-management"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"إدارة المحتوى"}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:n.jsx(ga,{className:"w-6 h-6 text-blue-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"أفكار المشاريع"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة مكتبة أفكار المشاريع"})]})]}),n.jsx(Ae,{to:"/admin/manage-project-ideas",className:"block w-full px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-center",children:"إدارة الأفكار"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:n.jsx(Nt,{className:"w-6 h-6 text-purple-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"المصادر التعليمية"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة المصادر والمواد التعليمية"})]})]}),n.jsx(Ae,{to:"/resources",className:"block w-full px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-center",children:"إدارة المصادر"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:n.jsx(wr,{className:"w-6 h-6 text-emerald-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"الفيديوهات التعليمية"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة الفيديوهات التعليمية"})]})]}),n.jsx(Ae,{to:"/admin/manage-videos",className:"block w-full px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-center",children:"إدارة الفيديوهات"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-pink-100 rounded-xl flex items-center justify-center",children:n.jsx(Hr,{className:"w-6 h-6 text-pink-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"المتجر"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة منتجات المتجر"})]})]}),n.jsx(Ae,{to:"/store",className:"block w-full px-4 py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600 transition-colors text-center",children:"إدارة المتجر"})]}),n.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm hover:shadow-md transition-all",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:n.jsx(tt,{className:"w-6 h-6 text-yellow-600"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold text-gray-800",children:"البرنامج الصيفي"}),n.jsx("p",{className:"text-sm text-gray-500",children:"إدارة تسجيلات البرنامج الصيفي"})]})]}),n.jsx(Ae,{to:"/admin/summer-program-registrations",className:"block w-full px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 transition-colors text-center",children:"إدارة التسجيلات"})]})]})]}),t==="system-settings"&&n.jsxs("div",{className:"space-y-6",children:[n.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"إعدادات النظام"}),n.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:n.jsx("p",{className:"text-center text-gray-600",children:"قريباً - سيتم إضافة واجهة إعدادات النظام"})})]})]})]})]})},cJ=({isOpen:e,onClose:t,onConfirm:r,title:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(vt,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف فكرة المشروع التالية؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(sr,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var cf={};cf.version="0.18.5";var V_=1252,dJ=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Cp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Op=function(e){dJ.indexOf(e)!=-1&&(V_=Cp[0]=e)};function uJ(){Op(1252)}var on=function(e){Op(e)};function Pp(){on(1200),uJ()}function $1(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function fJ(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function G_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ol=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?fJ(e.slice(2)):t==254&&r==255?G_(e.slice(2)):t==65279?e.slice(1):e},Vd=function(t){return String.fromCharCode(t)},L1=function(t){return String.fromCharCode(t)},Gc,js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function qc(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,a=e.charCodeAt(d++),o=(r&3)<<4|a>>4,s=e.charCodeAt(d++),l=(a&15)<<2|s>>6,c=s&63,isNaN(a)?l=c=64:isNaN(s)&&(c=64),t+=js.charAt(i)+js.charAt(o)+js.charAt(l)+js.charAt(c);return t}function Oa(e){var t="",r=0,a=0,s=0,i=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=js.indexOf(e.charAt(d++)),o=js.indexOf(e.charAt(d++)),r=i<<2|o>>4,t+=String.fromCharCode(r),l=js.indexOf(e.charAt(d++)),a=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(a)),c=js.indexOf(e.charAt(d++)),s=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var rt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Cs(e){return rt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function B1(e){return rt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Sa=function(t){return rt?cs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function w0(e){if(typeof ArrayBuffer>"u")return Sa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Us(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function hJ(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Fp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Fp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Tr=rt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:cs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function mJ(e){for(var t=[],r=0,a=e.length+250,s=Cs(e.length+255),i=0;i<e.length;++i){var o=e.charCodeAt(i);if(o<128)s[r++]=o;else if(o<2048)s[r++]=192|o>>6&31,s[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++i)&1023;s[r++]=240|o>>8&7,s[r++]=128|o>>2&63,s[r++]=128|l>>6&15|(o&3)<<4,s[r++]=128|l&63}else s[r++]=224|o>>12&15,s[r++]=128|o>>6&63,s[r++]=128|o&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Cs(65535),a=65530)}return t.push(s.slice(0,r)),Tr(t)}var la=/\u0000/g,Pl=/[\u0001-\u0006]/g;function mo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ln(e,t){var r=""+e;return r.length>=t?r:Zt("0",t-r.length)+r}function Ip(e,t){var r=""+e;return r.length>=t?r:Zt(" ",t-r.length)+r}function df(e,t){var r=""+e;return r.length>=t?r:r+Zt(" ",t-r.length)}function xJ(e,t){var r=""+Math.round(e);return r.length>=t?r:Zt("0",t-r.length)+r}function pJ(e,t){var r=""+e;return r.length>=t?r:Zt("0",t-r.length)+r}var U1=Math.pow(2,32);function Yi(e,t){if(e>U1||e<-U1)return xJ(e,t);var r=Math.round(e);return pJ(r,t)}function uf(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var W1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],dh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function gJ(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Le={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},H1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},vJ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ff(e,t,r){for(var a=e<0?-1:1,s=e*a,i=0,o=1,l=0,c=1,d=0,u=0,f=Math.floor(s);d<t&&(f=Math.floor(s),l=f*o+i,u=f*d+c,!(s-f<5e-8));)s=1/(s-f),i=o,o=l,c=d,d=u;if(u>t&&(d>t?(u=c,l=i):(u=d,l=o)),!r)return[0,a*l,u];var h=Math.floor(a*l/u);return[h,a*l-h*u,u]}function oi(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),i=0,o=[],l={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>.9999&&(l.u=0,++s==86400&&(l.T=s=0,++a,++l.D)),a===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),a<60&&(i=(i+6)%7),r&&(i=_J(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=s%60,s=Math.floor(s/60),l.M=s%60,s=Math.floor(s/60),l.H=s,l.q=i,l}var q_=new Date(1899,11,31,0,0,0),yJ=q_.getTime(),bJ=new Date(1900,2,1,0,0,0);function K_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=bJ&&(r+=24*60*60*1e3),(r-(yJ+(e.getTimezoneOffset()-q_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Dp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function wJ(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jJ(e){var t=e<0?12:11,r=Dp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function NJ(e){var t=Dp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Kc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jJ(e):t===10?r=e.toFixed(10).substr(0,12):r=NJ(e),Dp(wJ(r.toUpperCase()))}function ki(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Kc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ya(14,K_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _J(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function SJ(e,t,r,a){var s="",i=0,o=0,l=r.y,c,d=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return dh[r.m-1][1];case 5:return dh[r.m-1][0];default:return dh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return W1[r.q][0];default:return W1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ln(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),t==="s"?i===0?"0":""+i/o:(s=ln(i,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=l,d=1;break}var u=d>0?ln(c,d):"";return u}function Ns(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var X_=/%/g;function kJ(e,t,r){var a=t.replace(X_,""),s=t.length-a.length;return Xn(e,a,r*Math.pow(10,2*s))+Zt("%",s)}function EJ(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Xn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Y_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Y_(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var J_=/# (\?+)( ?)\/( ?)(\d+)/;function AJ(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),i=Math.floor(s/a),o=s-i*a,l=a;return r+(i===0?"":""+i)+" "+(o===0?Zt(" ",e[1].length+1+e[4].length):Ip(o,e[1].length)+e[2]+"/"+e[3]+ln(l,e[4].length))}function TJ(e,t,r){return r+(t===0?"":""+t)+Zt(" ",e[1].length+2+e[4].length)}var Z_=/^#*0*\.([0#]+)/,Q_=/\).*[0#]/,eS=/\(###\) ###\\?-####/;function na(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function z1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function V1(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function CJ(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function OJ(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function $a(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Q_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$a("n",a,r):"("+$a("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return EJ(e,t,r);if(t.indexOf("%")!==-1)return kJ(e,t,r);if(t.indexOf("E")!==-1)return Y_(t,r);if(t.charCodeAt(0)===36)return"$"+$a(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Yi(c,t.length);if(t.match(/^[#?]+$/))return s=Yi(r,0),s==="0"&&(s=""),s.length>t.length?s:na(t.substr(0,t.length-s.length))+s;if(i=t.match(J_))return AJ(i,c,d);if(t.match(/^#+0+$/))return d+Yi(c,t.length-t.indexOf("0"));if(i=t.match(Z_))return s=z1(r,i[1].length).replace(/^([^\.]+)$/,"$1."+na(i[1])).replace(/\.$/,"."+na(i[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Zt("0",na(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+z1(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ns(Yi(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$a(e,t,-r):Ns(""+(Math.floor(r)+CJ(r,i[1].length)))+"."+ln(V1(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return $a(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=mo($a(e,t.replace(/[\\-]/g,""),r)),o=0,mo(mo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(eS))return s=$a(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ff(c,Math.pow(10,o)-1,!1),s=""+d,u=Xn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=df(l[2],o),u.length<i[4].length&&(u=na(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ff(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ip(l[1],o)+i[2]+"/"+i[3]+df(l[2],o):Zt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=Yi(r,0),t.length<=s.length?s:na(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return na(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return o=V1(r,i[1].length),r<0?"-"+$a(e,t,-r):Ns(OJ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ln(0,3-x.length):"")+x})+"."+ln(o,i[1].length);switch(t){case"###,##0.00":return $a(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=Ns(Yi(c,0));return m!=="0"?d+m:"";case"###,###.00":return $a(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $a(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function PJ(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Xn(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function FJ(e,t,r){var a=t.replace(X_,""),s=t.length-a.length;return Xn(e,a,r*Math.pow(10,2*s))+Zt("%",s)}function tS(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tS(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(t/Math.pow(10,i)).toPrecision(a+1+(s+i)%s),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,u){return c+d+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function pn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Q_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?pn("n",a,r):"("+pn("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return PJ(e,t,r);if(t.indexOf("%")!==-1)return FJ(e,t,r);if(t.indexOf("E")!==-1)return tS(t,r);if(t.charCodeAt(0)===36)return"$"+pn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,i,o,l,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+ln(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:na(t.substr(0,t.length-s.length))+s;if(i=t.match(J_))return TJ(i,c,d);if(t.match(/^#+0+$/))return d+ln(c,t.length-t.indexOf("0"));if(i=t.match(Z_))return s=(""+r).replace(/^([^\.]+)$/,"$1."+na(i[1])).replace(/\.$/,"."+na(i[1])),s=s.replace(/\.(\d*)$/,function(x,p){return"."+p+Zt("0",na(i[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+Ns(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+pn(e,t,-r):Ns(""+r)+"."+Zt("0",i[1].length);if(i=t.match(/^#,#*,#0/))return pn(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=mo(pn(e,t.replace(/[\\-]/g,""),r)),o=0,mo(mo(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return o<s.length?s.charAt(o++):x==="0"?"0":""}));if(t.match(eS))return s=pn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=ff(c,Math.pow(10,o)-1,!1),s=""+d,u=Xn("n",i[1],l[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=df(l[2],o),u.length<i[4].length&&(u=na(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=ff(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Ip(l[1],o)+i[2]+"/"+i[3]+df(l[2],o):Zt(" ",2*o+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:na(t.substr(0,t.length-s.length))+s;if(i=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=s.indexOf(".");var f=t.indexOf(".")-o,h=t.length-s.length-f;return na(t.substr(0,f)+s+t.substr(t.length-h))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+pn(e,t,-r):Ns(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ln(0,3-x.length):"")+x})+"."+ln(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=Ns(""+c);return m!=="0"?d+m:"";default:if(t.match(/\.[0#?]*$/))return pn(e,t.slice(0,t.lastIndexOf(".")),r)+na(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Xn(e,t,r){return(r|0)===r?pn(e,t,r):$a(e,t,r)}function IJ(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function al(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":uf(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(rS))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function DJ(e,t,r,a){for(var s=[],i="",o=0,l="",c="t",d,u,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!uf(e,o))throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=e.charCodeAt(++o))!==34&&o<e.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++o;break;case"\\":var m=e.charAt(++o),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++o;break;case"_":s[s.length]={t:"t",v:" "},o+=2;break;case"@":s[s.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(d==null&&(d=oi(t,r,e.charAt(o+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=oi(t,r),d==null))return"";for(i=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),s[s.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var p={t:l,v:l};if(d==null&&(d=oi(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(p.v=d.H>=12?"下午":"上午"),p.t="T",o+=5,h="h"):(p.t="t",++o),d==null&&p.t==="T")return"";s[s.length]=p,c=l;break;case"[":for(i=l;e.charAt(o++)!=="]"&&o<e.length;)i+=e.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(rS)){if(d==null&&(d=oi(t,r),d==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",al(e)||(s[s.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<e.length&&(l=e.charAt(o))==="0";)i+=l;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)i+=l;s[s.length]={t:"n",v:i};break;case"?":for(i=l;e.charAt(++o)===l;)i+=l;s[s.length]={t:l,v:i},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":s[s.length]={t:a===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)i+=e.charAt(o);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:l,v:l},++o;break;case"$":s[s.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);s[s.length]={t:"t",v:l},++o;break}var g=0,y=0,b;for(o=s.length-1,c="t";o>=0;--o)switch(s[o].t){case"h":case"H":s[o].t=h,c="h",g<1&&(g=1);break;case"s":(b=s[o].v.match(/\.0+$/))&&(y=Math.max(y,b[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[o].t;break;case"m":c==="s"&&(s[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[o].v.match(/[Hh]/)&&(g=1),g<2&&s[o].v.match(/[Mm]/)&&(g=2),g<3&&s[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var v="",w;for(o=0;o<s.length;++o)switch(s[o].t){case"t":case"T":case" ":case"D":break;case"X":s[o].v="",s[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[o].v=SJ(s[o].t.charCodeAt(0),s[o].v,d,y),s[o].t="t";break;case"n":case"?":for(w=o+1;s[w]!=null&&((l=s[w].t)==="?"||l==="D"||(l===" "||l==="t")&&s[w+1]!=null&&(s[w+1].t==="?"||s[w+1].t==="t"&&s[w+1].v==="/")||s[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(s[w].v==="/"||s[w].v===" "&&s[w+1]!=null&&s[w+1].t=="?"));)s[o].v+=s[w].v,s[w]={v:"",t:";"},++w;v+=s[o].v,o=w-1;break;case"G":s[o].t="t",s[o].v=ki(t,r);break}var j="",N,_;if(v.length>0){v.charCodeAt(0)==40?(N=t<0&&v.charCodeAt(0)===45?-t:t,_=Xn("n",v,N)):(N=t<0&&a>1?-t:t,_=Xn("n",v,N),N<0&&s[0]&&s[0].t=="t"&&(_=_.substr(1),s[0].v="-"+s[0].v)),w=_.length-1;var E=s.length;for(o=0;o<s.length;++o)if(s[o]!=null&&s[o].t!="t"&&s[o].v.indexOf(".")>-1){E=o;break}var S=s.length;if(E===s.length&&_.indexOf("E")===-1){for(o=s.length-1;o>=0;--o)s[o]==null||"n?".indexOf(s[o].t)===-1||(w>=s[o].v.length-1?(w-=s[o].v.length,s[o].v=_.substr(w+1,s[o].v.length)):w<0?s[o].v="":(s[o].v=_.substr(0,w+1),w=-1),s[o].t="t",S=o);w>=0&&S<s.length&&(s[S].v=_.substr(0,w+1)+s[S].v)}else if(E!==s.length&&_.indexOf("E")===-1){for(w=_.indexOf(".")-1,o=E;o>=0;--o)if(!(s[o]==null||"n?".indexOf(s[o].t)===-1)){for(u=s[o].v.indexOf(".")>-1&&o===E?s[o].v.indexOf(".")-1:s[o].v.length-1,j=s[o].v.substr(u+1);u>=0;--u)w>=0&&(s[o].v.charAt(u)==="0"||s[o].v.charAt(u)==="#")&&(j=_.charAt(w--)+j);s[o].v=j,s[o].t="t",S=o}for(w>=0&&S<s.length&&(s[S].v=_.substr(0,w+1)+s[S].v),w=_.indexOf(".")+1,o=E;o<s.length;++o)if(!(s[o]==null||"n?(".indexOf(s[o].t)===-1&&o!==E)){for(u=s[o].v.indexOf(".")>-1&&o===E?s[o].v.indexOf(".")+1:0,j=s[o].v.substr(0,u);u<s[o].v.length;++u)w<_.length&&(j+=_.charAt(w++));s[o].v=j,s[o].t="t",S=o}}}for(o=0;o<s.length;++o)s[o]!=null&&"n?".indexOf(s[o].t)>-1&&(N=a>1&&t<0&&o>0&&s[o-1].v==="-"?-t:t,s[o].v=Xn(s[o].t,s[o].v,N),s[o].t="t");var k="";for(o=0;o!==s.length;++o)s[o]!=null&&(k+=s[o].v);return k}var G1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function q1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function RJ(e,t){var r=IJ(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(G1),l=r[1].match(G1);return q1(t,o)?[a,r[0]]:q1(t,l)?[a,r[1]]:[a,r[o!=null&&l!=null?2:1]]}return[a,i]}function Ya(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Le)[e],a==null&&(a=r.table&&r.table[H1[e]]||Le[H1[e]]),a==null&&(a=vJ[e]||"General");break}if(uf(a,0))return ki(t,r);t instanceof Date&&(t=K_(t,r.date1904));var s=RJ(a,t);if(uf(s[1]))return ki(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return DJ(s[1],t,r,s[0])}function Yn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Le[r]==null){t<0&&(t=r);continue}if(Le[r]==e){t=r;break}}t<0&&(t=391)}return Le[t]=e,t}function j0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Yn(e[t],t)}function nl(){Le=gJ()}var MJ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},aS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $J(e){var t=typeof e=="number"?Le[e]:e;return t=t.replace(aS,"(\\d+)"),new RegExp("^"+t+"$")}function LJ(e,t,r){var a=-1,s=-1,i=-1,o=-1,l=-1,c=-1;(t.match(aS)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":a=m;break;case"d":i=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:s=m;break}}),c>=0&&l==-1&&s>=0&&(l=s,s=-1);var d=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:a==-1&&s==-1&&i==-1?u:d+"T"+u}var BJ=function(){var e={};e.version="1.2.0";function t(){for(var _=0,E=new Array(256),S=0;S!=256;++S)_=S,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,_=_&1?-306674912^_>>>1:_>>>1,E[S]=_;return typeof Int32Array<"u"?new Int32Array(E):E}var r=t();function a(_){var E=0,S=0,k=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(k=0;k!=256;++k)O[k]=_[k];for(k=0;k!=256;++k)for(S=_[k],E=256+k;E<4096;E+=256)S=O[E]=S>>>8^_[S&255];var P=[];for(k=1;k!=16;++k)P[k-1]=typeof Int32Array<"u"?O.subarray(k*256,k*256+256):O.slice(k*256,k*256+256);return P}var s=a(r),i=s[0],o=s[1],l=s[2],c=s[3],d=s[4],u=s[5],f=s[6],h=s[7],m=s[8],x=s[9],p=s[10],g=s[11],y=s[12],b=s[13],v=s[14];function w(_,E){for(var S=E^-1,k=0,O=_.length;k<O;)S=S>>>8^r[(S^_.charCodeAt(k++))&255];return~S}function j(_,E){for(var S=E^-1,k=_.length-15,O=0;O<k;)S=v[_[O++]^S&255]^b[_[O++]^S>>8&255]^y[_[O++]^S>>16&255]^g[_[O++]^S>>>24]^p[_[O++]]^x[_[O++]]^m[_[O++]]^h[_[O++]]^f[_[O++]]^u[_[O++]]^d[_[O++]]^c[_[O++]]^l[_[O++]]^o[_[O++]]^i[_[O++]]^r[_[O++]];for(k+=15;O<k;)S=S>>>8^r[(S^_[O++])&255];return~S}function N(_,E){for(var S=E^-1,k=0,O=_.length,P=0,A=0;k<O;)P=_.charCodeAt(k++),P<128?S=S>>>8^r[(S^P)&255]:P<2048?(S=S>>>8^r[(S^(192|P>>6&31))&255],S=S>>>8^r[(S^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,A=_.charCodeAt(k++)&1023,S=S>>>8^r[(S^(240|P>>8&7))&255],S=S>>>8^r[(S^(128|P>>2&63))&255],S=S>>>8^r[(S^(128|A>>6&15|(P&3)<<4))&255],S=S>>>8^r[(S^(128|A&63))&255]):(S=S>>>8^r[(S^(224|P>>12&15))&255],S=S>>>8^r[(S^(128|P>>6&63))&255],S=S>>>8^r[(S^(128|P&63))&255]);return~S}return e.table=r,e.bstr=w,e.buf=j,e.str=N,e}(),Ie=function(){var t={};t.version="1.2.1";function r(D,X){for(var U=D.split("/"),z=X.split("/"),Y=0,J=0,ne=Math.min(U.length,z.length);Y<ne;++Y){if(J=U[Y].length-z[Y].length)return J;if(U[Y]!=z[Y])return U[Y]<z[Y]?-1:1}return U.length-z.length}function a(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:a(D.slice(0,-1));var X=D.lastIndexOf("/");return X===-1?D:D.slice(0,X+1)}function s(D){if(D.charAt(D.length-1)=="/")return s(D.slice(0,-1));var X=D.lastIndexOf("/");return X===-1?D:D.slice(X+1)}function i(D,X){typeof X=="string"&&(X=new Date(X));var U=X.getHours();U=U<<6|X.getMinutes(),U=U<<5|X.getSeconds()>>>1,D.write_shift(2,U);var z=X.getFullYear()-1980;z=z<<4|X.getMonth()+1,z=z<<5|X.getDate(),D.write_shift(2,z)}function o(D){var X=D.read_shift(2)&65535,U=D.read_shift(2)&65535,z=new Date,Y=U&31;U>>>=5;var J=U&15;U>>>=4,z.setMilliseconds(0),z.setFullYear(U+1980),z.setMonth(J-1),z.setDate(Y);var ne=X&31;X>>>=5;var ue=X&63;return X>>>=6,z.setHours(X),z.setMinutes(ue),z.setSeconds(ne<<1),z}function l(D){Lr(D,0);for(var X={},U=0;D.l<=D.length-4;){var z=D.read_shift(2),Y=D.read_shift(2),J=D.l+Y,ne={};switch(z){case 21589:U=D.read_shift(1),U&1&&(ne.mtime=D.read_shift(4)),Y>5&&(U&2&&(ne.atime=D.read_shift(4)),U&4&&(ne.ctime=D.read_shift(4))),ne.mtime&&(ne.mt=new Date(ne.mtime*1e3));break}D.l=J,X[z]=ne}return X}var c;function d(){return c||(c={})}function u(D,X){if(D[0]==80&&D[1]==75)return Fd(D,X);if((D[0]|32)==109&&(D[1]|32)==105)return bk(D,X);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var U=3,z=512,Y=0,J=0,ne=0,ue=0,ae=0,se=[],le=D.slice(0,512);Lr(le,0);var ye=f(le);switch(U=ye[0],U){case 3:z=512;break;case 4:z=4096;break;case 0:if(ye[1]==0)return Fd(D,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}z!==512&&(le=D.slice(0,z),Lr(le,28));var ke=D.slice(0,z);h(le,U);var Ce=le.read_shift(4,"i");if(U===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);le.l+=4,ne=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ue=le.read_shift(4,"i"),Y=le.read_shift(4,"i"),ae=le.read_shift(4,"i"),J=le.read_shift(4,"i");for(var Ne=-1,Te=0;Te<109&&(Ne=le.read_shift(4,"i"),!(Ne<0));++Te)se[Te]=Ne;var Ge=m(D,z);g(ae,J,Ge,z,se);var qt=b(Ge,ne,se,z);qt[ne].name="!Directory",Y>0&&ue!==A&&(qt[ue].name="!MiniFAT"),qt[se[0]].name="!FAT",qt.fat_addrs=se,qt.ssz=z;var Kt={},zr=[],ol=[],ll=[];v(ne,qt,Ge,zr,Y,Kt,ol,ue),x(ol,ll,zr),zr.shift();var cl={FileIndex:ol,FullPaths:ll};return X&&X.raw&&(cl.raw={header:ke,sectors:Ge}),cl}function f(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(R,"Header Signature: "),D.l+=16;var X=D.read_shift(2,"u");return[D.read_shift(2,"u"),X]}function h(D,X){var U=9;switch(D.l+=2,U=D.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function m(D,X){for(var U=Math.ceil(D.length/X)-1,z=[],Y=1;Y<U;++Y)z[Y-1]=D.slice(Y*X,(Y+1)*X);return z[U-1]=D.slice(U*X),z}function x(D,X,U){for(var z=0,Y=0,J=0,ne=0,ue=0,ae=U.length,se=[],le=[];z<ae;++z)se[z]=le[z]=z,X[z]=U[z];for(;ue<le.length;++ue)z=le[ue],Y=D[z].L,J=D[z].R,ne=D[z].C,se[z]===z&&(Y!==-1&&se[Y]!==Y&&(se[z]=se[Y]),J!==-1&&se[J]!==J&&(se[z]=se[J])),ne!==-1&&(se[ne]=z),Y!==-1&&z!=se[z]&&(se[Y]=se[z],le.lastIndexOf(Y)<ue&&le.push(Y)),J!==-1&&z!=se[z]&&(se[J]=se[z],le.lastIndexOf(J)<ue&&le.push(J));for(z=1;z<ae;++z)se[z]===z&&(J!==-1&&se[J]!==J?se[z]=se[J]:Y!==-1&&se[Y]!==Y&&(se[z]=se[Y]));for(z=1;z<ae;++z)if(D[z].type!==0){if(ue=z,ue!=se[ue])do ue=se[ue],X[z]=X[ue]+"/"+X[z];while(ue!==0&&se[ue]!==-1&&ue!=se[ue]);se[z]=-1}for(X[0]+="/",z=1;z<ae;++z)D[z].type!==2&&(X[z]+="/")}function p(D,X,U){for(var z=D.start,Y=D.size,J=[],ne=z;U&&Y>0&&ne>=0;)J.push(X.slice(ne*P,ne*P+P)),Y-=P,ne=Zs(U,ne*4);return J.length===0?de(0):Tr(J).slice(0,D.size)}function g(D,X,U,z,Y){var J=A;if(D===A){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var ne=U[D],ue=(z>>>2)-1;if(!ne)return;for(var ae=0;ae<ue&&(J=Zs(ne,ae*4))!==A;++ae)Y.push(J);g(Zs(ne,z-4),X-1,U,z,Y)}}function y(D,X,U,z,Y){var J=[],ne=[];Y||(Y=[]);var ue=z-1,ae=0,se=0;for(ae=X;ae>=0;){Y[ae]=!0,J[J.length]=ae,ne.push(D[ae]);var le=U[Math.floor(ae*4/z)];if(se=ae*4&ue,z<4+se)throw new Error("FAT boundary crossed: "+ae+" 4 "+z);if(!D[le])break;ae=Zs(D[le],se)}return{nodes:J,data:sw([ne])}}function b(D,X,U,z){var Y=D.length,J=[],ne=[],ue=[],ae=[],se=z-1,le=0,ye=0,ke=0,Ce=0;for(le=0;le<Y;++le)if(ue=[],ke=le+X,ke>=Y&&(ke-=Y),!ne[ke]){ae=[];var Ne=[];for(ye=ke;ye>=0;){Ne[ye]=!0,ne[ye]=!0,ue[ue.length]=ye,ae.push(D[ye]);var Te=U[Math.floor(ye*4/z)];if(Ce=ye*4&se,z<4+Ce)throw new Error("FAT boundary crossed: "+ye+" 4 "+z);if(!D[Te]||(ye=Zs(D[Te],Ce),Ne[ye]))break}J[ke]={nodes:ue,data:sw([ae])}}return J}function v(D,X,U,z,Y,J,ne,ue){for(var ae=0,se=z.length?2:0,le=X[D].data,ye=0,ke=0,Ce;ye<le.length;ye+=128){var Ne=le.slice(ye,ye+128);Lr(Ne,64),ke=Ne.read_shift(2),Ce=Wp(Ne,0,ke-se),z.push(Ce);var Te={name:Ce,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},Ge=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Ge!==0&&(Te.ct=w(Ne,Ne.l-8));var qt=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);qt!==0&&(Te.mt=w(Ne,Ne.l-8)),Te.start=Ne.read_shift(4,"i"),Te.size=Ne.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=A,Te.name=""),Te.type===5?(ae=Te.start,Y>0&&ae!==A&&(X[ae].name="!StreamData")):Te.size>=4096?(Te.storage="fat",X[Te.start]===void 0&&(X[Te.start]=y(U,Te.start,X.fat_addrs,X.ssz)),X[Te.start].name=Te.name,Te.content=X[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:ae!==A&&Te.start!==A&&X[ae]&&(Te.content=p(Te,X[ae].data,(X[ue]||{}).data))),Te.content&&Lr(Te.content,0),J[Ce]=Te,ne.push(Te)}}function w(D,X){return new Date((Na(D,X+4)/1e7*Math.pow(2,32)+Na(D,X)/1e7-11644473600)*1e3)}function j(D,X){return d(),u(c.readFileSync(D),X)}function N(D,X){var U=X&&X.type;switch(U||rt&&Buffer.isBuffer(D)&&(U="buffer"),U||"base64"){case"file":return j(D,X);case"base64":return u(Sa(Oa(D)),X);case"binary":return u(Sa(D),X)}return u(D,X)}function _(D,X){var U=X||{},z=U.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=z+"/",D.FileIndex[0]={name:z,type:5}),U.CLSID&&(D.FileIndex[0].clsid=U.CLSID),E(D)}function E(D){var X="Sh33tJ5";if(!Ie.find(D,"/"+X)){var U=de(4);U[0]=55,U[1]=U[3]=50,U[2]=54,D.FileIndex.push({name:X,type:2,content:U,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+X),S(D)}}function S(D,X){_(D);for(var U=!1,z=!1,Y=D.FullPaths.length-1;Y>=0;--Y){var J=D.FileIndex[Y];switch(J.type){case 0:z?U=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(J.R*J.L*J.C)&&(U=!0),J.R>-1&&J.L>-1&&J.R==J.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!X)){var ne=new Date(1987,1,19),ue=0,ae=Object.create?Object.create(null):{},se=[];for(Y=0;Y<D.FullPaths.length;++Y)ae[D.FullPaths[Y]]=!0,D.FileIndex[Y].type!==0&&se.push([D.FullPaths[Y],D.FileIndex[Y]]);for(Y=0;Y<se.length;++Y){var le=a(se[Y][0]);z=ae[le],z||(se.push([le,{name:s(le).replace("/",""),type:1,clsid:F,ct:ne,mt:ne,content:null}]),ae[le]=!0)}for(se.sort(function(Ce,Ne){return r(Ce[0],Ne[0])}),D.FullPaths=[],D.FileIndex=[],Y=0;Y<se.length;++Y)D.FullPaths[Y]=se[Y][0],D.FileIndex[Y]=se[Y][1];for(Y=0;Y<se.length;++Y){var ye=D.FileIndex[Y],ke=D.FullPaths[Y];if(ye.name=s(ke).replace("/",""),ye.L=ye.R=ye.C=-(ye.color=1),ye.size=ye.content?ye.content.length:0,ye.start=0,ye.clsid=ye.clsid||F,Y===0)ye.C=se.length>1?1:-1,ye.size=0,ye.type=5;else if(ke.slice(-1)=="/"){for(ue=Y+1;ue<se.length&&a(D.FullPaths[ue])!=ke;++ue);for(ye.C=ue>=se.length?-1:ue,ue=Y+1;ue<se.length&&a(D.FullPaths[ue])!=a(ke);++ue);ye.R=ue>=se.length?-1:ue,ye.type=1}else a(D.FullPaths[Y+1]||"")==a(ke)&&(ye.R=Y+1),ye.type=2}}}function k(D,X){var U=X||{};if(U.fileType=="mad")return wk(D,U);switch(S(D),U.fileType){case"zip":return mk(D,U)}var z=function(Ce){for(var Ne=0,Te=0,Ge=0;Ge<Ce.FileIndex.length;++Ge){var qt=Ce.FileIndex[Ge];if(qt.content){var Kt=qt.content.length;Kt>0&&(Kt<4096?Ne+=Kt+63>>6:Te+=Kt+511>>9)}}for(var zr=Ce.FullPaths.length+3>>2,ol=Ne+7>>3,ll=Ne+127>>7,cl=ol+Te+zr+ll,Vs=cl+127>>7,P0=Vs<=109?0:Math.ceil((Vs-109)/127);cl+Vs+P0+127>>7>Vs;)P0=++Vs<=109?0:Math.ceil((Vs-109)/127);var Mn=[1,P0,Vs,ll,zr,Te,Ne,0];return Ce.FileIndex[0].size=Ne<<6,Mn[7]=(Ce.FileIndex[0].start=Mn[0]+Mn[1]+Mn[2]+Mn[3]+Mn[4]+Mn[5])+(Mn[6]+7>>3),Mn}(D),Y=de(z[7]<<9),J=0,ne=0;{for(J=0;J<8;++J)Y.write_shift(1,T[J]);for(J=0;J<8;++J)Y.write_shift(2,0);for(Y.write_shift(2,62),Y.write_shift(2,3),Y.write_shift(2,65534),Y.write_shift(2,9),Y.write_shift(2,6),J=0;J<3;++J)Y.write_shift(2,0);for(Y.write_shift(4,0),Y.write_shift(4,z[2]),Y.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),Y.write_shift(4,0),Y.write_shift(4,4096),Y.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:A),Y.write_shift(4,z[3]),Y.write_shift(-4,z[1]?z[0]-1:A),Y.write_shift(4,z[1]),J=0;J<109;++J)Y.write_shift(-4,J<z[2]?z[1]+J:-1)}if(z[1])for(ne=0;ne<z[1];++ne){for(;J<236+ne*127;++J)Y.write_shift(-4,J<z[2]?z[1]+J:-1);Y.write_shift(-4,ne===z[1]-1?A:ne+1)}var ue=function(Ce){for(ne+=Ce;J<ne-1;++J)Y.write_shift(-4,J+1);Ce&&(++J,Y.write_shift(-4,A))};for(ne=J=0,ne+=z[1];J<ne;++J)Y.write_shift(-4,W.DIFSECT);for(ne+=z[2];J<ne;++J)Y.write_shift(-4,W.FATSECT);ue(z[3]),ue(z[4]);for(var ae=0,se=0,le=D.FileIndex[0];ae<D.FileIndex.length;++ae)le=D.FileIndex[ae],le.content&&(se=le.content.length,!(se<4096)&&(le.start=ne,ue(se+511>>9)));for(ue(z[6]+7>>3);Y.l&511;)Y.write_shift(-4,W.ENDOFCHAIN);for(ne=J=0,ae=0;ae<D.FileIndex.length;++ae)le=D.FileIndex[ae],le.content&&(se=le.content.length,!(!se||se>=4096)&&(le.start=ne,ue(se+63>>6)));for(;Y.l&511;)Y.write_shift(-4,W.ENDOFCHAIN);for(J=0;J<z[4]<<2;++J){var ye=D.FullPaths[J];if(!ye||ye.length===0){for(ae=0;ae<17;++ae)Y.write_shift(4,0);for(ae=0;ae<3;++ae)Y.write_shift(4,-1);for(ae=0;ae<12;++ae)Y.write_shift(4,0);continue}le=D.FileIndex[J],J===0&&(le.start=le.size?le.start-1:A);var ke=J===0&&U.root||le.name;if(se=2*(ke.length+1),Y.write_shift(64,ke,"utf16le"),Y.write_shift(2,se),Y.write_shift(1,le.type),Y.write_shift(1,le.color),Y.write_shift(-4,le.L),Y.write_shift(-4,le.R),Y.write_shift(-4,le.C),le.clsid)Y.write_shift(16,le.clsid,"hex");else for(ae=0;ae<4;++ae)Y.write_shift(4,0);Y.write_shift(4,le.state||0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(4,le.start),Y.write_shift(4,le.size),Y.write_shift(4,0)}for(J=1;J<D.FileIndex.length;++J)if(le=D.FileIndex[J],le.size>=4096)if(Y.l=le.start+1<<9,rt&&Buffer.isBuffer(le.content))le.content.copy(Y,Y.l,0,le.size),Y.l+=le.size+511&-512;else{for(ae=0;ae<le.size;++ae)Y.write_shift(1,le.content[ae]);for(;ae&511;++ae)Y.write_shift(1,0)}for(J=1;J<D.FileIndex.length;++J)if(le=D.FileIndex[J],le.size>0&&le.size<4096)if(rt&&Buffer.isBuffer(le.content))le.content.copy(Y,Y.l,0,le.size),Y.l+=le.size+63&-64;else{for(ae=0;ae<le.size;++ae)Y.write_shift(1,le.content[ae]);for(;ae&63;++ae)Y.write_shift(1,0)}if(rt)Y.l=Y.length;else for(;Y.l<Y.length;)Y.write_shift(1,0);return Y}function O(D,X){var U=D.FullPaths.map(function(ae){return ae.toUpperCase()}),z=U.map(function(ae){var se=ae.split("/");return se[se.length-(ae.slice(-1)=="/"?2:1)]}),Y=!1;X.charCodeAt(0)===47?(Y=!0,X=U[0].slice(0,-1)+X):Y=X.indexOf("/")!==-1;var J=X.toUpperCase(),ne=Y===!0?U.indexOf(J):z.indexOf(J);if(ne!==-1)return D.FileIndex[ne];var ue=!J.match(Pl);for(J=J.replace(la,""),ue&&(J=J.replace(Pl,"!")),ne=0;ne<U.length;++ne)if((ue?U[ne].replace(Pl,"!"):U[ne]).replace(la,"")==J||(ue?z[ne].replace(Pl,"!"):z[ne]).replace(la,"")==J)return D.FileIndex[ne];return null}var P=64,A=-2,R="d0cf11e0a1b11ae1",T=[208,207,17,224,161,177,26,225],F="00000000000000000000000000000000",W={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:A,FREESECT:-1,HEADER_SIGNATURE:R,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:F,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(D,X,U){d();var z=k(D,U);c.writeFileSync(X,z)}function B(D){for(var X=new Array(D.length),U=0;U<D.length;++U)X[U]=String.fromCharCode(D[U]);return X.join("")}function L(D,X){var U=k(D,X);switch(X&&X.type||"buffer"){case"file":return d(),c.writeFileSync(X.filename,U),U;case"binary":return typeof U=="string"?U:B(U);case"base64":return qc(typeof U=="string"?U:B(U));case"buffer":if(rt)return Buffer.isBuffer(U)?U:cs(U);case"array":return typeof U=="string"?Sa(U):U}return U}var ee;function M(D){try{var X=D.InflateRaw,U=new X;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)ee=D;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function G(D,X){if(!ee)return fs(D,X);var U=ee.InflateRaw,z=new U,Y=z._processChunk(D.slice(D.l),z._finishFlushFlag);return D.l+=z.bytesRead,Y}function V(D){return ee?ee.deflateRawSync(D):Qe(D)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(D){var X=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(X>>16|X>>8|X)&255}for(var Z=typeof Uint8Array<"u",q=Z?new Uint8Array(256):[],ie=0;ie<256;++ie)q[ie]=xe(ie);function I(D,X){var U=q[D&255];return X<=8?U>>>8-X:(U=U<<8|q[D>>8&255],X<=16?U>>>16-X:(U=U<<8|q[D>>16&255],U>>>24-X))}function ve(D,X){var U=X&7,z=X>>>3;return(D[z]|(U<=6?0:D[z+1]<<8))>>>U&3}function we(D,X){var U=X&7,z=X>>>3;return(D[z]|(U<=5?0:D[z+1]<<8))>>>U&7}function Ee(D,X){var U=X&7,z=X>>>3;return(D[z]|(U<=4?0:D[z+1]<<8))>>>U&15}function ce(D,X){var U=X&7,z=X>>>3;return(D[z]|(U<=3?0:D[z+1]<<8))>>>U&31}function fe(D,X){var U=X&7,z=X>>>3;return(D[z]|(U<=1?0:D[z+1]<<8))>>>U&127}function oe(D,X,U){var z=X&7,Y=X>>>3,J=(1<<U)-1,ne=D[Y]>>>z;return U<8-z||(ne|=D[Y+1]<<8-z,U<16-z)||(ne|=D[Y+2]<<16-z,U<24-z)||(ne|=D[Y+3]<<24-z),ne&J}function qe(D,X,U){var z=X&7,Y=X>>>3;return z<=5?D[Y]|=(U&7)<<z:(D[Y]|=U<<z&255,D[Y+1]=(U&7)>>8-z),X+3}function st(D,X,U){var z=X&7,Y=X>>>3;return U=(U&1)<<z,D[Y]|=U,X+1}function lt(D,X,U){var z=X&7,Y=X>>>3;return U<<=z,D[Y]|=U&255,U>>>=8,D[Y+1]=U,X+8}function Ft(D,X,U){var z=X&7,Y=X>>>3;return U<<=z,D[Y]|=U&255,U>>>=8,D[Y+1]=U&255,D[Y+2]=U>>>8,X+16}function Vt(D,X){var U=D.length,z=2*U>X?2*U:X+5,Y=0;if(U>=X)return D;if(rt){var J=B1(z);if(D.copy)D.copy(J);else for(;Y<D.length;++Y)J[Y]=D[Y];return J}else if(Z){var ne=new Uint8Array(z);if(ne.set)ne.set(D);else for(;Y<U;++Y)ne[Y]=D[Y];return ne}return D.length=z,D}function Jt(D){for(var X=new Array(D),U=0;U<D;++U)X[U]=0;return X}function ra(D,X,U){var z=1,Y=0,J=0,ne=0,ue=0,ae=D.length,se=Z?new Uint16Array(32):Jt(32);for(J=0;J<32;++J)se[J]=0;for(J=ae;J<U;++J)D[J]=0;ae=D.length;var le=Z?new Uint16Array(ae):Jt(ae);for(J=0;J<ae;++J)se[Y=D[J]]++,z<Y&&(z=Y),le[J]=0;for(se[0]=0,J=1;J<=z;++J)se[J+16]=ue=ue+se[J-1]<<1;for(J=0;J<ae;++J)ue=D[J],ue!=0&&(le[J]=se[ue+16]++);var ye=0;for(J=0;J<ae;++J)if(ye=D[J],ye!=0)for(ue=I(le[J],z)>>z-ye,ne=(1<<z+4-ye)-1;ne>=0;--ne)X[ue|ne<<ye]=ye&15|J<<4;return z}var Dr=Z?new Uint16Array(512):Jt(512),zs=Z?new Uint16Array(32):Jt(32);if(!Z){for(var Rr=0;Rr<512;++Rr)Dr[Rr]=0;for(Rr=0;Rr<32;++Rr)zs[Rr]=0}(function(){for(var D=[],X=0;X<32;X++)D.push(5);ra(D,zs,32);var U=[];for(X=0;X<=143;X++)U.push(8);for(;X<=255;X++)U.push(9);for(;X<=279;X++)U.push(7);for(;X<=287;X++)U.push(8);ra(U,Dr,288)})();var Fa=function(){for(var X=Z?new Uint8Array(32768):[],U=0,z=0;U<me.length-1;++U)for(;z<me[U+1];++z)X[z]=U;for(;z<32768;++z)X[z]=29;var Y=Z?new Uint8Array(259):[];for(U=0,z=0;U<re.length-1;++U)for(;z<re[U+1];++z)Y[z]=U;function J(ue,ae){for(var se=0;se<ue.length;){var le=Math.min(65535,ue.length-se),ye=se+le==ue.length;for(ae.write_shift(1,+ye),ae.write_shift(2,le),ae.write_shift(2,~le&65535);le-- >0;)ae[ae.l++]=ue[se++]}return ae.l}function ne(ue,ae){for(var se=0,le=0,ye=Z?new Uint16Array(32768):[];le<ue.length;){var ke=Math.min(65535,ue.length-le);if(ke<10){for(se=qe(ae,se,+(le+ke==ue.length)),se&7&&(se+=8-(se&7)),ae.l=se/8|0,ae.write_shift(2,ke),ae.write_shift(2,~ke&65535);ke-- >0;)ae[ae.l++]=ue[le++];se=ae.l*8;continue}se=qe(ae,se,+(le+ke==ue.length)+2);for(var Ce=0;ke-- >0;){var Ne=ue[le];Ce=(Ce<<5^Ne)&32767;var Te=-1,Ge=0;if((Te=ye[Ce])&&(Te|=le&-32768,Te>le&&(Te-=32768),Te<le))for(;ue[Te+Ge]==ue[le+Ge]&&Ge<250;)++Ge;if(Ge>2){Ne=Y[Ge],Ne<=22?se=lt(ae,se,q[Ne+1]>>1)-1:(lt(ae,se,3),se+=5,lt(ae,se,q[Ne-23]>>5),se+=3);var qt=Ne<8?0:Ne-4>>2;qt>0&&(Ft(ae,se,Ge-re[Ne]),se+=qt),Ne=X[le-Te],se=lt(ae,se,q[Ne]>>3),se-=3;var Kt=Ne<4?0:Ne-2>>1;Kt>0&&(Ft(ae,se,le-Te-me[Ne]),se+=Kt);for(var zr=0;zr<Ge;++zr)ye[Ce]=le&32767,Ce=(Ce<<5^ue[le])&32767,++le;ke-=Ge-1}else Ne<=143?Ne=Ne+48:se=st(ae,se,1),se=lt(ae,se,q[Ne]),ye[Ce]=le&32767,++le}se=lt(ae,se,0)-1}return ae.l=(se+7)/8|0,ae.l}return function(ae,se){return ae.length<8?J(ae,se):ne(ae,se)}}();function Qe(D){var X=de(50+Math.floor(D.length*1.1)),U=Fa(D,X);return X.slice(0,U)}var Gt=Z?new Uint16Array(32768):Jt(32768),ua=Z?new Uint16Array(32768):Jt(32768),tr=Z?new Uint16Array(128):Jt(128),Rn=1,Od=1;function je(D,X){var U=ce(D,X)+257;X+=5;var z=ce(D,X)+1;X+=5;var Y=Ee(D,X)+4;X+=4;for(var J=0,ne=Z?new Uint8Array(19):Jt(19),ue=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,se=Z?new Uint8Array(8):Jt(8),le=Z?new Uint8Array(8):Jt(8),ye=ne.length,ke=0;ke<Y;++ke)ne[H[ke]]=J=we(D,X),ae<J&&(ae=J),se[J]++,X+=3;var Ce=0;for(se[0]=0,ke=1;ke<=ae;++ke)le[ke]=Ce=Ce+se[ke-1]<<1;for(ke=0;ke<ye;++ke)(Ce=ne[ke])!=0&&(ue[ke]=le[Ce]++);var Ne=0;for(ke=0;ke<ye;++ke)if(Ne=ne[ke],Ne!=0){Ce=q[ue[ke]]>>8-Ne;for(var Te=(1<<7-Ne)-1;Te>=0;--Te)tr[Ce|Te<<Ne]=Ne&7|ke<<3}var Ge=[];for(ae=1;Ge.length<U+z;)switch(Ce=tr[fe(D,X)],X+=Ce&7,Ce>>>=3){case 16:for(J=3+ve(D,X),X+=2,Ce=Ge[Ge.length-1];J-- >0;)Ge.push(Ce);break;case 17:for(J=3+we(D,X),X+=3;J-- >0;)Ge.push(0);break;case 18:for(J=11+fe(D,X),X+=7;J-- >0;)Ge.push(0);break;default:Ge.push(Ce),ae<Ce&&(ae=Ce);break}var qt=Ge.slice(0,U),Kt=Ge.slice(U);for(ke=U;ke<286;++ke)qt[ke]=0;for(ke=z;ke<30;++ke)Kt[ke]=0;return Rn=ra(qt,Gt,286),Od=ra(Kt,ua,30),X}function hn(D,X){if(D[0]==3&&!(D[1]&3))return[Cs(X),2];for(var U=0,z=0,Y=B1(X||1<<18),J=0,ne=Y.length>>>0,ue=0,ae=0;!(z&1);){if(z=we(D,U),U+=3,z>>>1)z>>1==1?(ue=9,ae=5):(U=je(D,U),ue=Rn,ae=Od);else{U&7&&(U+=8-(U&7));var se=D[U>>>3]|D[(U>>>3)+1]<<8;if(U+=32,se>0)for(!X&&ne<J+se&&(Y=Vt(Y,J+se),ne=Y.length);se-- >0;)Y[J++]=D[U>>>3],U+=8;continue}for(;;){!X&&ne<J+32767&&(Y=Vt(Y,J+32767),ne=Y.length);var le=oe(D,U,ue),ye=z>>>1==1?Dr[le]:Gt[le];if(U+=ye&15,ye>>>=4,!(ye>>>8&255))Y[J++]=ye;else{if(ye==256)break;ye-=257;var ke=ye<8?0:ye-4>>2;ke>5&&(ke=0);var Ce=J+re[ye];ke>0&&(Ce+=oe(D,U,ke),U+=ke),le=oe(D,U,ae),ye=z>>>1==1?zs[le]:ua[le],U+=ye&15,ye>>>=4;var Ne=ye<4?0:ye-2>>1,Te=me[ye];for(Ne>0&&(Te+=oe(D,U,Ne),U+=Ne),!X&&ne<Ce&&(Y=Vt(Y,Ce+100),ne=Y.length);J<Ce;)Y[J]=Y[J-Te],++J}}}return X?[Y,U+7>>>3]:[Y.slice(0,J),U+7>>>3]}function fs(D,X){var U=D.slice(D.l||0),z=hn(U,X);return D.l+=z[1],z[0]}function Pd(D,X){if(D)typeof console<"u"&&console.error(X);else throw new Error(X)}function Fd(D,X){var U=D;Lr(U,0);var z=[],Y=[],J={FileIndex:z,FullPaths:Y};_(J,{root:X.root});for(var ne=U.length-4;(U[ne]!=80||U[ne+1]!=75||U[ne+2]!=5||U[ne+3]!=6)&&ne>=0;)--ne;U.l=ne+4,U.l+=4;var ue=U.read_shift(2);U.l+=6;var ae=U.read_shift(4);for(U.l=ae,ne=0;ne<ue;++ne){U.l+=20;var se=U.read_shift(4),le=U.read_shift(4),ye=U.read_shift(2),ke=U.read_shift(2),Ce=U.read_shift(2);U.l+=8;var Ne=U.read_shift(4),Te=l(U.slice(U.l+ye,U.l+ye+ke));U.l+=ye+ke+Ce;var Ge=U.l;U.l=Ne+4,hk(U,se,le,J,Te),U.l=Ge}return J}function hk(D,X,U,z,Y){D.l+=2;var J=D.read_shift(2),ne=D.read_shift(2),ue=o(D);if(J&8257)throw new Error("Unsupported ZIP encryption");for(var ae=D.read_shift(4),se=D.read_shift(4),le=D.read_shift(4),ye=D.read_shift(2),ke=D.read_shift(2),Ce="",Ne=0;Ne<ye;++Ne)Ce+=String.fromCharCode(D[D.l++]);if(ke){var Te=l(D.slice(D.l,D.l+ke));(Te[21589]||{}).mt&&(ue=Te[21589].mt),((Y||{})[21589]||{}).mt&&(ue=Y[21589].mt)}D.l+=ke;var Ge=D.slice(D.l,D.l+se);switch(ne){case 8:Ge=G(D,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ne)}var qt=!1;J&8&&(ae=D.read_shift(4),ae==134695760&&(ae=D.read_shift(4),qt=!0),se=D.read_shift(4),le=D.read_shift(4)),se!=X&&Pd(qt,"Bad compressed size: "+X+" != "+se),le!=U&&Pd(qt,"Bad uncompressed size: "+U+" != "+le),O0(z,Ce,Ge,{unsafe:!0,mt:ue})}function mk(D,X){var U=X||{},z=[],Y=[],J=de(1),ne=U.compression?8:0,ue=0,ae=0,se=0,le=0,ye=0,ke=D.FullPaths[0],Ce=ke,Ne=D.FileIndex[0],Te=[],Ge=0;for(ae=1;ae<D.FullPaths.length;++ae)if(Ce=D.FullPaths[ae].slice(ke.length),Ne=D.FileIndex[ae],!(!Ne.size||!Ne.content||Ce=="Sh33tJ5")){var qt=le,Kt=de(Ce.length);for(se=0;se<Ce.length;++se)Kt.write_shift(1,Ce.charCodeAt(se)&127);Kt=Kt.slice(0,Kt.l),Te[ye]=BJ.buf(Ne.content,0);var zr=Ne.content;ne==8&&(zr=V(zr)),J=de(30),J.write_shift(4,67324752),J.write_shift(2,20),J.write_shift(2,ue),J.write_shift(2,ne),Ne.mt?i(J,Ne.mt):J.write_shift(4,0),J.write_shift(-4,Te[ye]),J.write_shift(4,zr.length),J.write_shift(4,Ne.content.length),J.write_shift(2,Kt.length),J.write_shift(2,0),le+=J.length,z.push(J),le+=Kt.length,z.push(Kt),le+=zr.length,z.push(zr),J=de(46),J.write_shift(4,33639248),J.write_shift(2,0),J.write_shift(2,20),J.write_shift(2,ue),J.write_shift(2,ne),J.write_shift(4,0),J.write_shift(-4,Te[ye]),J.write_shift(4,zr.length),J.write_shift(4,Ne.content.length),J.write_shift(2,Kt.length),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(4,0),J.write_shift(4,qt),Ge+=J.l,Y.push(J),Ge+=Kt.length,Y.push(Kt),++ye}return J=de(22),J.write_shift(4,101010256),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(2,ye),J.write_shift(2,ye),J.write_shift(4,Ge),J.write_shift(4,le),J.write_shift(2,0),Tr([Tr(z),Tr(Y),J])}var Id={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xk(D,X){if(D.ctype)return D.ctype;var U=D.name||"",z=U.match(/\.([^\.]+)$/);return z&&Id[z[1]]||X&&(z=(U=X).match(/[\.\\]([^\.\\])+$/),z&&Id[z[1]])?Id[z[1]]:"application/octet-stream"}function pk(D){for(var X=qc(D),U=[],z=0;z<X.length;z+=76)U.push(X.slice(z,z+76));return U.join(`\r
`)+`\r
`}function gk(D){var X=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var le=se.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],z=X.split(`\r
`),Y=0;Y<z.length;++Y){var J=z[Y];if(J.length==0){U.push("");continue}for(var ne=0;ne<J.length;){var ue=76,ae=J.slice(ne,ne+ue);ae.charAt(ue-1)=="="?ue--:ae.charAt(ue-2)=="="?ue-=2:ae.charAt(ue-3)=="="&&(ue-=3),ae=J.slice(ne,ne+ue),ne+=ue,ne<J.length&&(ae+="="),U.push(ae)}}return U.join(`\r
`)}function vk(D){for(var X=[],U=0;U<D.length;++U){for(var z=D[U];U<=D.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+D[++U];X.push(z)}for(var Y=0;Y<X.length;++Y)X[Y]=X[Y].replace(/[=][0-9A-Fa-f]{2}/g,function(J){return String.fromCharCode(parseInt(J.slice(1),16))});return Sa(X.join(`\r
`))}function yk(D,X,U){for(var z="",Y="",J="",ne,ue=0;ue<10;++ue){var ae=X[ue];if(!ae||ae.match(/^\s*$/))break;var se=ae.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":z=se[2].trim();break;case"content-type":J=se[2].trim();break;case"content-transfer-encoding":Y=se[2].trim();break}}switch(++ue,Y.toLowerCase()){case"base64":ne=Sa(Oa(X.slice(ue).join("")));break;case"quoted-printable":ne=vk(X.slice(ue));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Y)}var le=O0(D,z.slice(U.length),ne,{unsafe:!0});J&&(le.ctype=J)}function bk(D,X){if(B(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=X&&X.root||"",z=(rt&&Buffer.isBuffer(D)?D.toString("binary"):B(D)).split(`\r
`),Y=0,J="";for(Y=0;Y<z.length;++Y)if(J=z[Y],!!/^Content-Location:/i.test(J)&&(J=J.slice(J.indexOf("file")),U||(U=J.slice(0,J.lastIndexOf("/")+1)),J.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),J.slice(0,U.length)!=U););var ne=(z[1]||"").match(/boundary="(.*?)"/);if(!ne)throw new Error("MAD cannot find boundary");var ue="--"+(ne[1]||""),ae=[],se=[],le={FileIndex:ae,FullPaths:se};_(le);var ye,ke=0;for(Y=0;Y<z.length;++Y){var Ce=z[Y];Ce!==ue&&Ce!==ue+"--"||(ke++&&yk(le,z.slice(ye,Y),U),ye=Y)}return le}function wk(D,X){var U=X||{},z=U.boundary||"SheetJS";z="------="+z;for(var Y=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],J=D.FullPaths[0],ne=J,ue=D.FileIndex[0],ae=1;ae<D.FullPaths.length;++ae)if(ne=D.FullPaths[ae].slice(J.length),ue=D.FileIndex[ae],!(!ue.size||!ue.content||ne=="Sh33tJ5")){ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var se=ue.content,le=rt&&Buffer.isBuffer(se)?se.toString("binary"):B(se),ye=0,ke=Math.min(1024,le.length),Ce=0,Ne=0;Ne<=ke;++Ne)(Ce=le.charCodeAt(Ne))>=32&&Ce<128&&++ye;var Te=ye>=ke*4/5;Y.push(z),Y.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+ne),Y.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),Y.push("Content-Type: "+xk(ue,ne)),Y.push(""),Y.push(Te?gk(le):pk(le))}return Y.push(z+`--\r
`),Y.join(`\r
`)}function jk(D){var X={};return _(X,D),X}function O0(D,X,U,z){var Y=z&&z.unsafe;Y||_(D);var J=!Y&&Ie.find(D,X);if(!J){var ne=D.FullPaths[0];X.slice(0,ne.length)==ne?ne=X:(ne.slice(-1)!="/"&&(ne+="/"),ne=(ne+X).replace("//","/")),J={name:s(X),type:2},D.FileIndex.push(J),D.FullPaths.push(ne),Y||Ie.utils.cfb_gc(D)}return J.content=U,J.size=U?U.length:0,z&&(z.CLSID&&(J.clsid=z.CLSID),z.mt&&(J.mt=z.mt),z.ct&&(J.ct=z.ct)),J}function Nk(D,X){_(D);var U=Ie.find(D,X);if(U){for(var z=0;z<D.FileIndex.length;++z)if(D.FileIndex[z]==U)return D.FileIndex.splice(z,1),D.FullPaths.splice(z,1),!0}return!1}function _k(D,X,U){_(D);var z=Ie.find(D,X);if(z){for(var Y=0;Y<D.FileIndex.length;++Y)if(D.FileIndex[Y]==z)return D.FileIndex[Y].name=s(U),D.FullPaths[Y]=U,!0}return!1}function Sk(D){S(D,!0)}return t.find=O,t.read=N,t.parse=u,t.write=L,t.writeFile=K,t.utils={cfb_new:jk,cfb_add:O0,cfb_del:Nk,cfb_mov:_k,cfb_gc:Sk,ReadShift:Gl,CheckField:SS,prep_blob:Lr,bconcat:Tr,use_zlib:M,_deflateRaw:Qe,_inflateRaw:fs,consts:W},t}();function UJ(e){return typeof e=="string"?w0(e):Array.isArray(e)?hJ(e):e}function Nd(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=w0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Nn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var s=new Blob([UJ(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=Us(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function WJ(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function er(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function K1(e,t){for(var r=[],a=er(e),s=0;s!==a.length;++s)r[e[a[s]][t]]==null&&(r[e[a[s]][t]]=a[s]);return r}function N0(e){for(var t=[],r=er(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function _0(e){for(var t=[],r=er(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function HJ(e){for(var t=[],r=er(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var hf=new Date(1899,11,30,0,0,0);function jr(e,t){var r=e.getTime(),a=hf.getTime()+(e.getTimezoneOffset()-hf.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var nS=new Date,zJ=hf.getTime()+(nS.getTimezoneOffset()-hf.getTimezoneOffset())*6e4,X1=nS.getTimezoneOffset();function S0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+zJ),t.getTimezoneOffset()!==X1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-X1)*6e4),t}function VJ(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(a=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[i],10)}return t}var Y1=new Date("2017-02-19T19:06:09.000Z"),sS=isNaN(Y1.getFullYear())?new Date("2/19/17"):Y1,GJ=sS.getFullYear()==2017;function Lt(e,t){var r=new Date(e);if(GJ)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(sS.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Ei(e,t){if(rt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Nn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Nn(G_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Nn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Nn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function Bt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Bt(e[r]));return t}function Zt(e,t){for(var r="";r.length<t;)r+=e;return r}function cn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var qJ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lo(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&qJ.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var KJ=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),o=[i[0]],l=1;l<i.length;++l)o.push(s),o.push(i[l]);return o}}();function iS(e){return e?e.content&&e.type?Ei(e.content,!0):e.data?Ol(e.data):e.asNodeBuffer&&rt?Ol(e.asNodeBuffer().toString("binary")):e.asBinary?Ol(e.asBinary()):e._data&&e._data.getContent?Ol(Ei(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function oS(e){if(!e)return null;if(e.data)return $1(e.data);if(e.asNodeBuffer&&rt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?$1(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function XJ(e){return e&&e.name.slice(-4)===".bin"?oS(e):iS(e)}function Ua(e,t){for(var r=e.FullPaths||er(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||s==o)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function Rp(e,t){var r=Ua(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function cr(e,t,r){if(!r)return XJ(Rp(e,t));if(!t)return null;try{return cr(e,t)}catch{return null}}function ka(e,t,r){if(!r)return iS(Rp(e,t));if(!t)return null;try{return ka(e,t)}catch{return null}}function YJ(e,t,r){return oS(Rp(e,t))}function J1(e){for(var t=e.FullPaths||er(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Ye(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return rt?a=cs(r):a=mJ(r),Ie.utils.cfb_add(e,t,a)}Ie.utils.cfb_add(e,t,r)}else e.file(t,r)}function Mp(){return Ie.utils.cfb_new()}function lS(e,t){switch(t.type){case"base64":return Ie.read(e,{type:"base64"});case"binary":return Ie.read(e,{type:"binary"});case"buffer":case"array":return Ie.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Fl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var or=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,JJ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Z1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ZJ=/<[^>]*>/g,ea=or.match(Z1)?Z1:ZJ,QJ=/<\w*:/,eZ=/<(\/?)\w+:/;function Ue(e,t,r){for(var a={},s=0,i=0;s!==e.length&&!((i=e.charCodeAt(s))===32||i===10||i===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var o=e.match(JJ),l=0,c="",d=0,u="",f="",h=1;if(o)for(d=0;d!=o.length;++d){for(f=o[d],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,c=f.slice(i+1+h,f.length-h),l=0;l!=u.length&&u.charCodeAt(l)!==58;++l);if(l===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),a[u]=c,a[u.toLowerCase()]=c;else{var m=(l===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(l+1);if(a[m]&&u.slice(l-3,l)=="ext")continue;a[m]=c,a[m.toLowerCase()]=c}}return a}function In(e){return e.replace(eZ,"<$1")}var cS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},$p=N0(cS),ut=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(e,function(l,c){return cS[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,o)+r(s.slice(o+3))}}(),Lp=/[&<>'"]/g,tZ=/[\u0000-\u0008\u000b-\u001f]/g;function Et(e){var t=e+"";return t.replace(Lp,function(r){return $p[r]}).replace(tZ,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Q1(e){return Et(e).replace(/ /g,"_x0020_")}var dS=/[\u0000-\u001f]/g;function Bp(e){var t=e+"";return t.replace(Lp,function(r){return $p[r]}).replace(/\n/g,"<br/>").replace(dS,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function rZ(e){var t=e+"";return t.replace(Lp,function(r){return $p[r]}).replace(dS,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ew=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function aZ(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function $t(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function uh(e){for(var t="",r=0,a=0,s=0,i=0,o=0,l=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=s&63,t+=String.fromCharCode(o);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|i&63);continue}o=e.charCodeAt(r++),l=((a&7)<<18|(s&63)<<12|(i&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function tw(e){var t=Cs(2*e.length),r,a,s=1,i=0,o=0,l;for(a=0;a<e.length;a+=s)s=1,(l=e.charCodeAt(a))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(a+1)&63),s=2):l<240?(r=(l&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(l&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[i++]=o&255,t[i++]=o>>>8,o=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function rw(e){return cs(e,"binary").toString("utf8")}var Gd="foo bar bazâð£",Ct=rt&&(rw(Gd)==uh(Gd)&&rw||tw(Gd)==uh(Gd)&&tw)||uh,Nn=rt?function(e){return cs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},Xc=function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),uS=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}}(),nZ=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),sZ=/<\/?(?:vt:)?variant>/g,iZ=/<(?:vt:)([^>]*)>([\s\S]*)</;function aw(e,t){var r=Ue(e),a=e.match(nZ(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(i){var o=i.replace(sZ,"").match(iZ);o&&s.push({v:Ct(o[2]),t:o[1]})}),s}var fS=/(^\s|\s$|\n)/;function Ur(e,t){return"<"+e+(t.match(fS)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Yc(e){return er(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function _e(e,t,r){return"<"+e+(r!=null?Yc(r):"")+(t!=null?(t.match(fS)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function nx(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function oZ(e,t){switch(typeof e){case"string":var r=_e("vt:lpwstr",Et(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return _e((e|0)==e?"vt:i4":"vt:r8",Et(String(e)));case"boolean":return _e("vt:bool",e?"true":"false")}if(e instanceof Date)return _e("vt:filetime",nx(e));throw new Error("Unable to serialize "+e)}function Up(e){if(rt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ct(Us(Fp(e)));throw new Error("Bad input format: expected Buffer or string")}var Jc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,vr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Bi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ja={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function lZ(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,i=5;i>=0;--i)s=s*256+e[t+i];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function cZ(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,i=0,o=a?-t:t;isFinite(o)?o==0?s=i=0:(s=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(t)?26985:0);for(var l=0;l<=5;++l,i/=256)e[r+l]=i&255;e[r+6]=(s&15)<<4|i&15,e[r+7]=s>>4|a}var nw=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,i=e[0][a].length;s<i;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},sw=rt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:cs(t)})):nw(e)}:nw,iw=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(Gn(e,s)));return a.join("").replace(la,"")},Wp=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(la,""):iw(e,t,r)}:iw,ow=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},hS=rt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ow(e,t,r)}:ow,lw=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(ro(e,s)));return a.join("")},_d=rt?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):lw(t,r,a)}:lw,mS=function(e,t){var r=Na(e,t);return r>0?_d(e,t+4,t+4+r-1):""},xS=mS,pS=function(e,t){var r=Na(e,t);return r>0?_d(e,t+4,t+4+r-1):""},gS=pS,vS=function(e,t){var r=2*Na(e,t);return r>0?_d(e,t+4,t+4+r-1):""},yS=vS,bS=function(t,r){var a=Na(t,r);return a>0?Wp(t,r+4,r+4+a):""},wS=bS,jS=function(e,t){var r=Na(e,t);return r>0?_d(e,t+4,t+4+r):""},NS=jS,_S=function(e,t){return lZ(e,t)},mf=_S,Hp=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rt&&(xS=function(t,r){if(!Buffer.isBuffer(t))return mS(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},gS=function(t,r){if(!Buffer.isBuffer(t))return pS(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},yS=function(t,r){if(!Buffer.isBuffer(t))return vS(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},wS=function(t,r){if(!Buffer.isBuffer(t))return bS(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},NS=function(t,r){if(!Buffer.isBuffer(t))return jS(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},mf=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):_S(t,r)},Hp=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ro=function(e,t){return e[t]},Gn=function(e,t){return e[t+1]*256+e[t]},dZ=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Na=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},uZ=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Gl(e,t){var r="",a,s,i=[],o,l,c,d;switch(t){case"dbcs":if(d=this.l,rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Gn(this,d)),d+=2;e*=2;break;case"utf8":r=_d(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Wp(this,this.l,this.l+e);break;case"wstr":return Gl.call(this,e,"dbcs");case"lpstr-ansi":r=xS(this,this.l),e=4+Na(this,this.l);break;case"lpstr-cp":r=gS(this,this.l),e=4+Na(this,this.l);break;case"lpwstr":r=yS(this,this.l),e=4+2*Na(this,this.l);break;case"lpp4":e=4+Na(this,this.l),r=wS(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Na(this,this.l),r=NS(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=ro(this,this.l+e++))!==0;)i.push(Vd(o));r=i.join("");break;case"_wstr":for(e=0,r="";(o=Gn(this,this.l+e))!==0;)i.push(Vd(o)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ro(this,d),this.l=d+1,l=Gl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Vd(Gn(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ro(this,d),this.l=d+1,l=Gl.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Vd(ro(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return a=ro(this,this.l),this.l++,a;case 2:return a=(t==="i"?dZ:Gn)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Zs:uZ)(this,this.l),this.l+=4,a):(s=Na(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=mf(this,this.l):s=mf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=hS(this,this.l,e);break}}return this.l+=e,r}var fZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},hZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},mZ=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function xZ(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)mZ(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var o=t.charCodeAt(s);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,fZ(this,t,this.l);break;case 8:if(a=8,r==="f"){cZ(this,t,this.l);break}case 16:break;case-4:a=4,hZ(this,t,this.l);break}return this.l+=a,this}function SS(e,t){var r=hS(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Lr(e,t){e.l=t,e.read_shift=Gl,e.chk=SS,e.write_shift=xZ}function Zr(e,t){e.l+=t}function de(e){var t=Cs(e);return Lr(t,0),t}function ds(e,t,r){if(e){var a,s,i;Lr(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var d=ad[l]||ad[65535];for(a=e.read_shift(1),i=a&127,s=1;s<4&&a&128;++s)i+=((a=e.read_shift(1))&127)<<7*s;c=e.l+i;var u=d.f&&d.f(e,i,r);if(e.l=c,t(u,d,l))return}}}function pa(){var e=[],t=rt?256:2048,r=function(d){var u=de(d);return Lr(u,0),u},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(d){return a&&d<a.length-a.l?a:(s(),a=r(Math.max(d+1,t)))},o=function(){return s(),Tr(e)},l=function(d){s(),a=d,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:l,end:o,_bufs:e}}function ge(e,t,r,a){var s=+t,i;if(!isNaN(s)){a||(a=ad[s].p||(r||[]).length||0),i=1+(s>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var o=e.next(i);s<=127?o.write_shift(1,s):(o.write_shift(1,(s&127)+128),o.write_shift(1,s>>7));for(var l=0;l!=4;++l)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Hp(r)&&e.push(r)}}function ql(e,t,r){var a=Bt(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function cw(e,t,r){var a=Bt(e);return a.s=ql(a.s,t.s,r),a.e=ql(a.e,t.s,r),a}function Kl(e,t){if(e.cRel&&e.c<0)for(e=Bt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Bt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Be(e);return!e.cRel&&e.cRel!=null&&(r=vZ(r)),!e.rRel&&e.rRel!=null&&(r=pZ(r)),r}function fh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Xt(e.s.c)+":"+(e.e.cRel?"":"$")+Xt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ir(e.s.r)+":"+(e.e.rRel?"":"$")+ir(e.e.r):Kl(e.s,t.biff)+":"+Kl(e.e,t.biff)}function zp(e){return parseInt(gZ(e),10)-1}function ir(e){return""+(e+1)}function pZ(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function gZ(e){return e.replace(/\$(\d+)$/,"$1")}function Vp(e){for(var t=yZ(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Xt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function vZ(e){return e.replace(/^([A-Z])/,"$$$1")}function yZ(e){return e.replace(/^\$([A-Z])/,"$1")}function bZ(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Yt(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function va(e){var t=e.indexOf(":");return t==-1?{s:Yt(e),e:Yt(e)}:{s:Yt(e.slice(0,t)),e:Yt(e.slice(t+1))}}function Ke(e,t){return typeof t>"u"||typeof t=="number"?Ke(e.s,e.e):(typeof e!="string"&&(e=Be(e)),typeof t!="string"&&(t=Be(t)),e==t?e:e+":"+t)}function ht(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,i=e.length;for(r=0;a<i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===i||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=i&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function dw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ya(e.z,r?jr(t):t)}catch{}try{return e.w=Ya((e.XF||{}).numFmtId||(r?14:0),r?jr(t):t)}catch{return""+t}}function ns(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?us[e.v]||e.v:t==null?dw(e,e.v):dw(e,t))}function Ws(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function kS(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,i=e||(s?[]:{}),o=0,l=0;if(i&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Yt(a.origin):a.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=ht(i["!ref"]);d.s.c=u.s.c,d.s.r=u.s.r,d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),o==-1&&(d.e.r=o=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=o+f,p=l+h;if(d.s.r>x&&(d.s.r=x),d.s.c>p&&(d.s.c=p),d.e.r<x&&(d.e.r=x),d.e.c<p&&(d.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(a.nullError)m.t="e",m.v=0;else if(a.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=a.dateNF||Le[14],a.cellDates?(m.t="d",m.w=Ya(m.z,jr(m.v))):(m.t="n",m.v=jr(m.v),m.w=Ya(m.z,m.v))):m.t="s";if(s)i[x]||(i[x]=[]),i[x][p]&&i[x][p].z&&(m.z=i[x][p].z),i[x][p]=m;else{var g=Be({c:p,r:x});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return d.s.c<1e7&&(i["!ref"]=Ke(d)),i}function sl(e,t){return kS(null,e,t)}function wZ(e){return e.read_shift(4,"i")}function dn(e,t){return t||(t=de(4)),t.write_shift(4,e),t}function Jr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Or(e,t){var r=!1;return t==null&&(r=!0,t=de(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function jZ(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function NZ(e,t){return t||(t=de(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Gp(e,t){var r=e.l,a=e.read_shift(1),s=Jr(e),i=[],o={t:s,h:s};if(a&1){for(var l=e.read_shift(4),c=0;c!=l;++c)i.push(jZ(e));o.r=i}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function _Z(e,t){var r=!1;return t==null&&(r=!0,t=de(15+4*e.t.length)),t.write_shift(1,0),Or(e.t,t),r?t.slice(0,t.l):t}var SZ=Gp;function kZ(e,t){var r=!1;return t==null&&(r=!0,t=de(23+4*e.t.length)),t.write_shift(1,1),Or(e.t,t),t.write_shift(4,1),NZ({},t),r?t.slice(0,t.l):t}function Za(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ui(e,t){return t==null&&(t=de(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Wi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Hi(e,t){return t==null&&(t=de(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var EZ=Jr,ES=Or;function qp(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function xf(e,t){var r=!1;return t==null&&(r=!0,t=de(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var AZ=Jr,sx=qp,Kp=xf;function Xp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?mf([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zs(t,0)>>2;return r?s/100:s}function AS(e,t){t==null&&(t=de(4));var r=0,a=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function TS(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function TZ(e,t){return t||(t=de(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var zi=TS,il=TZ;function Yr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ai(e,t){return(t||de(8)).write_shift(8,e,"f")}function CZ(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var d=hi[s];d&&(t.rgb=Qc(d));break;case 2:t.rgb=Qc([o,l,c]);break;case 3:t.theme=s;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function pf(e,t){if(t||(t=de(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function OZ(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function PZ(e,t){t||(t=de(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function CS(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function FZ(e){return CS(e,1)}function IZ(e){return CS(e,2)}var Yp=2,fa=3,qd=11,uw=12,gf=19,Kd=64,DZ=65,RZ=71,MZ=4108,$Z=4126,kr=80,OS=81,LZ=[kr,OS],ix={1:{n:"CodePage",t:Yp},2:{n:"Category",t:kr},3:{n:"PresentationFormat",t:kr},4:{n:"ByteCount",t:fa},5:{n:"LineCount",t:fa},6:{n:"ParagraphCount",t:fa},7:{n:"SlideCount",t:fa},8:{n:"NoteCount",t:fa},9:{n:"HiddenCount",t:fa},10:{n:"MultimediaClipCount",t:fa},11:{n:"ScaleCrop",t:qd},12:{n:"HeadingPairs",t:MZ},13:{n:"TitlesOfParts",t:$Z},14:{n:"Manager",t:kr},15:{n:"Company",t:kr},16:{n:"LinksUpToDate",t:qd},17:{n:"CharacterCount",t:fa},19:{n:"SharedDoc",t:qd},22:{n:"HyperlinksChanged",t:qd},23:{n:"AppVersion",t:fa,p:"version"},24:{n:"DigSig",t:DZ},26:{n:"ContentType",t:kr},27:{n:"ContentStatus",t:kr},28:{n:"Language",t:kr},29:{n:"Version",t:kr},255:{},2147483648:{n:"Locale",t:gf},2147483651:{n:"Behavior",t:gf},1919054434:{}},ox={1:{n:"CodePage",t:Yp},2:{n:"Title",t:kr},3:{n:"Subject",t:kr},4:{n:"Author",t:kr},5:{n:"Keywords",t:kr},6:{n:"Comments",t:kr},7:{n:"Template",t:kr},8:{n:"LastAuthor",t:kr},9:{n:"RevNumber",t:kr},10:{n:"EditTime",t:Kd},11:{n:"LastPrinted",t:Kd},12:{n:"CreatedDate",t:Kd},13:{n:"ModifiedDate",t:Kd},14:{n:"PageCount",t:fa},15:{n:"WordCount",t:fa},16:{n:"CharCount",t:fa},17:{n:"Thumbnail",t:RZ},18:{n:"Application",t:kr},19:{n:"DocSecurity",t:fa},255:{},2147483648:{n:"Locale",t:gf},2147483651:{n:"Behavior",t:gf},1919054434:{}},fw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},BZ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function UZ(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var WZ=UZ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),hi=Bt(WZ),us={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},PS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},lx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Xd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Jp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function HZ(e){var t=Jp();if(!e||!e.match)return t;var r={};if((e.match(ea)||[]).forEach(function(a){var s=Ue(a);switch(s[0].replace(QJ,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[lx[s.ContentType]]!==void 0&&t[lx[s.ContentType]].push(s.PartName);break}}),t.xmlns!==vr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function FS(e,t){var r=HJ(lx),a=[],s;a[a.length]=or,a[a.length]=_e("Types",null,{xmlns:vr.CT,"xmlns:xsd":vr.xsd,"xmlns:xsi":vr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return _e("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(s=e[c][0],a[a.length]=_e("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Xd[c][t.bookType]||Xd[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(d){a[a.length]=_e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Xd[c][t.bookType]||Xd[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(d){a[a.length]=_e("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var nt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Zc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Xl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ea)||[]).forEach(function(s){var i=Ue(s);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var l=i.TargetMode==="External"?i.Target:Fl(i.Target,t);r[l]=o,a[i.Id]=o}}),r["!id"]=a,r}function xo(e){var t=[or,_e("Relationships",null,{xmlns:vr.RELS})];return er(e["!id"]).forEach(function(r){t[t.length]=_e("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function kt(e,t,r,a,s,i){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=a,s.Target=r,[nt.HLINK,nt.XPATH,nt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var zZ="application/vnd.oasis.opendocument.spreadsheet";function VZ(e,t){for(var r=Up(e),a,s;a=Jc.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=Ue(a[0],!1),s.path=="/"&&s.type!==zZ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function GZ(e){var t=[or];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function hw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function qZ(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function KZ(e){var t=[or];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(hw(e[r][0],e[r][1])),t.push(qZ("",e[r][0]));return t.push(hw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function IS(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+cf.version+"</meta:generator></office:meta></office:document-meta>"}var Ga=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],XZ=function(){for(var e=new Array(Ga.length),t=0;t<Ga.length;++t){var r=Ga[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function DS(e){var t={};e=Ct(e);for(var r=0;r<Ga.length;++r){var a=Ga[r],s=e.match(XZ[r]);s!=null&&s.length>0&&(t[a[1]]=ut(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Lt(t[a[1]]))}return t}function hh(e,t,r,a,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Et(t),a[a.length]=r?_e(e,t,r):Ur(e,t))}function RS(e,t){var r=t||{},a=[or,_e("cp:coreProperties",null,{"xmlns:cp":vr.CORE_PROPS,"xmlns:dc":vr.dc,"xmlns:dcterms":vr.dcterms,"xmlns:dcmitype":vr.dcmitype,"xmlns:xsi":vr.xsi})],s={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&hh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:nx(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),e.ModifiedDate!=null&&hh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:nx(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var i=0;i!=Ga.length;++i){var o=Ga[i],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&hh(o[0],l,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var mi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],MS=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function $S(e,t,r,a){var s=[];if(typeof e=="string")s=aw(e,a);else for(var i=0;i<e.length;++i)s=s.concat(e[i].map(function(u){return{v:u}}));var o=typeof t=="string"?aw(t,a).map(function(u){return u.v}):t,l=0,c=0;if(o.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function YZ(e,t,r){var a={};return t||(t={}),e=Ct(e),mi.forEach(function(s){var i=(e.match(Xc(s[0]))||[])[1];switch(s[2]){case"string":i&&(t[s[1]]=ut(i));break;case"bool":t[s[1]]=i==="true";break;case"raw":var o=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));o&&o.length>0&&(a[s[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&$S(a.HeadingPairs,a.TitlesOfParts,t,r),t}function LS(e){var t=[],r=_e;return e||(e={}),e.Application="SheetJS",t[t.length]=or,t[t.length]=_e("Properties",null,{xmlns:vr.EXT_PROPS,"xmlns:vt":vr.vt}),mi.forEach(function(a){if(e[a[1]]!==void 0){var s;switch(a[2]){case"string":s=Et(String(e[a[1]]));break;case"bool":s=e[a[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(a[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Et(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var JZ=/<[^>]+>[^<]*/g;function ZZ(e,t){var r={},a="",s=e.match(JZ);if(s)for(var i=0;i!=s.length;++i){var o=s[i],l=Ue(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":a=ut(l.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),d=c[0].slice(4),u=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[a]=ut(u);break;case"bool":r[a]=$t(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(u);break;case"filetime":case"date":r[a]=Lt(u);break;case"cy":case"error":r[a]=ut(u);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function BS(e){var t=[or,_e("Properties",null,{xmlns:vr.CUST_PROPS,"xmlns:vt":vr.vt})];if(!e)return t.join("");var r=1;return er(e).forEach(function(s){++r,t[t.length]=_e("property",oZ(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Et(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var cx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},mh;function QZ(e,t,r){mh||(mh=N0(cx)),t=mh[t]||t,e[t]=r}function eQ(e,t){var r=[];return er(cx).map(function(a){for(var s=0;s<Ga.length;++s)if(Ga[s][1]==a)return Ga[s];for(s=0;s<mi.length;++s)if(mi[s][1]==a)return mi[s];throw a}).forEach(function(a){if(e[a[1]]!=null){var s=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Ur(cx[a[1]]||a[1],s))}}),_e("DocumentProperties",r.join(""),{xmlns:ja.o})}function tQ(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return e&&er(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var o=0;o<Ga.length;++o)if(i==Ga[o][1])return;for(o=0;o<mi.length;++o)if(i==mi[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var l=e[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),s.push(_e(Q1(i),l,{"dt:dt":c}))}}),t&&er(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var o=t[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),s.push(_e(Q1(i),o,{"dt:dt":l}))}}),"<"+a+' xmlns="'+ja.o+'">'+s.join("")+"</"+a+">"}function Zp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function rQ(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),s=(r-a)/Math.pow(2,32);a*=1e7,s*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),s+=i);var o=de(8);return o.write_shift(4,a),o.write_shift(4,s),o}function US(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function WS(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function HS(e,t,r){return t===31?WS(e):US(e,t,r)}function dx(e,t,r){return HS(e,t,r===!1?0:4)}function aQ(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return HS(e,t,0)}function nQ(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(la,""),e.l-s&2&&(e.l+=2)}return r}function sQ(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(la,"");return r}function iQ(e){var t=e.l,r=vf(e,OS);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=vf(e,fa);return[r,a]}function oQ(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(iQ(e));return r}function mw(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var i=e.read_shift(4),o=e.read_shift(4);a[i]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(la,"").replace(Pl,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function zS(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function lQ(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function vf(e,t,r){var a=e.read_shift(2),s,i=r||{};if(e.l+=2,t!==uw&&a!==t&&LZ.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===uw?a:t){case 2:return s=e.read_shift(2,"i"),i.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return US(e,a,4).replace(la,"");case 31:return WS(e);case 64:return Zp(e);case 65:return zS(e);case 71:return lQ(e);case 80:return dx(e,a,!i.raw).replace(la,"");case 81:return aQ(e,a).replace(la,"");case 4108:return oQ(e);case 4126:case 4127:return a==4127?nQ(e):sQ(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function xw(e,t){var r=de(4),a=de(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=de(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=rQ(t);break;case 31:case 80:for(a=de(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Tr([r,a])}function pw(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0,l=0,c=-1,d={};for(o=0;o!=s;++o){var u=e.read_shift(4),f=e.read_shift(4);i[o]=[u,f+r]}i.sort(function(b,v){return b[1]-v[1]});var h={};for(o=0;o!=s;++o){if(e.l!==i[o][1]){var m=!0;if(o>0&&t)switch(t[i[o-1][0]].t){case 2:e.l+2===i[o][1]&&(e.l+=2,m=!1);break;case 80:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break;case 4108:e.l<=i[o][1]&&(e.l=i[o][1],m=!1);break}if((!t||o==0)&&e.l<=i[o][1]&&(m=!1,e.l=i[o][1]),m)throw new Error("Read Error: Expected address "+i[o][1]+" at "+e.l+" :"+o)}if(t){var x=t[i[o][0]];if(h[x.n]=vf(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:on(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(i[o][0]===1){if(l=h.CodePage=vf(e,Yp),on(l),c!==-1){var p=e.l;e.l=i[c][1],d=mw(e,l),e.l=p}}else if(i[o][0]===0){if(l===0){c=o,e.l=i[o+1][1];continue}d=mw(e,l)}else{var g=d[i[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=zS(e);break;case 30:e.l+=4,y=dx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=dx(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=rr(e,4);break;case 64:e.l+=4,y=Lt(Zp(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+a,h}var VS=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function cQ(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function gw(e,t,r){var a=de(8),s=[],i=[],o=8,l=0,c=de(8),d=de(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),s.push(d),o+=8+c.length,!t){d=de(8),d.write_shift(4,0),s.unshift(d);var u=[de(4)];for(u[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=de(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);u.push(c)}c=Tr(u),i.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(VS.indexOf(e[l][0])>-1||MS.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],m=0;if(t){m=+t[e[l][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=xw(x.t,h)}else{var g=cQ(h);g==-1&&(g=31,h=String(h)),c=xw(g,h)}i.push(c),d=de(8),d.write_shift(4,t?m:2+l),s.push(d),o+=8+c.length}var y=8*(i.length+1);for(l=0;l<i.length;++l)s[l].write_shift(4,y),y+=i[l].length;return a.write_shift(4,o),a.write_shift(4,i.length),Tr([a].concat(s).concat(i))}function vw(e,t,r){var a=e.content;if(!a)return{};Lr(a,0);var s,i,o,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var d=a.read_shift(4),u=a.read_shift(16);if(u!==Ie.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=a.read_shift(16),l=a.read_shift(4),s===1&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);s===2&&(o=a.read_shift(16),c=a.read_shift(4));var f=pw(a,t),h={SystemIdentifier:d};for(var m in f)h[m]=f[m];if(h.FMTID=i,s===1)return h;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);var x;try{x=pw(a,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[i,o],h}function yw(e,t,r,a,s,i){var o=de(s?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Ie.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,s?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,s?68:48);var c=gw(e,r,a);if(l.push(c),s){var d=gw(s,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return Tr(l)}function ms(e,t){return e.read_shift(t),null}function dQ(e,t){t||(t=de(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function uQ(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function rr(e,t){return e.read_shift(t)===1}function sa(e,t){return t||(t=de(2)),t.write_shift(2,+!!e),t}function dr(e){return e.read_shift(2,"u")}function Wa(e,t){return t||(t=de(2)),t.write_shift(2,e),t}function GS(e,t){return uQ(e,t,dr)}function fQ(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function qS(e,t,r){return r||(r=de(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Sd(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var o=a?e.read_shift(a,s):"";return o}function hQ(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,i=1+(r&1),o=0,l,c={};s&&(o=e.read_shift(2)),a&&(l=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*o),a&&(e.l+=l),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function mQ(e){var t=e.t||"",r=de(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=de(2*t.length);a.write_shift(2*t.length,t,"utf16le");var s=[r,a];return Tr(s)}function Ti(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function kd(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Ti(e,a,r)}function Vi(e,t,r){if(r.biff>5)return kd(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function KS(e,t,r){return r||(r=de(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function xQ(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function pQ(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(la,"");return a&&(e.l+=24),s}function gQ(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(i>>1,"utf16le").replace(la,"");return r+o}function vQ(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return pQ(e);case"0303000000000000c000000000000046":return gQ(e);default:throw new Error("Unsupported Moniker "+r)}}function Yd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(la,""):"";return r}function bw(e,t){t||(t=de(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function yQ(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var i,o,l,c,d="",u,f;s&16&&(i=Yd(e,r-e.l)),s&128&&(o=Yd(e,r-e.l)),(s&257)===257&&(l=Yd(e,r-e.l)),(s&257)===1&&(c=vQ(e,r-e.l)),s&8&&(d=Yd(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(f=Zp(e)),e.l=r;var h=o||l||c||"";h&&d&&(h+="#"+d),h||(h="#"+d),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return u&&(m.guid=u),f&&(m.time=f),i&&(m.Tooltip=i),m}function bQ(e){var t=de(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),i=s>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(i==28)a=a.slice(1),bw(a,t);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=s>-1?a.slice(0,s):a;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),i&8&&bw(s>-1?a.slice(s+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;a.slice(c*3,c*3+3)=="../"||a.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,a.length-3*c+1),r=0;r<a.length-3*c;++r)t.write_shift(1,a.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function XS(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function YS(e,t){var r=XS(e);return r[3]=0,r}function Dn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Ci(e,t,r,a){return a||(a=de(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function wQ(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function jQ(e,t,r){return t===0?"":Vi(e,t,r)}function NQ(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),i=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[s,i,o]}function JS(e){var t=e.read_shift(2),r=Xp(e);return[t,r]}function _Q(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=Sd(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,s}function k0(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function ZS(e,t){return t||(t=de(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function QS(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var SQ=QS;function e4(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function kQ(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function EQ(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Vr(e){e.l+=2,e.l+=e.read_shift(2)}var AQ={0:Vr,4:Vr,5:Vr,6:Vr,7:EQ,8:Vr,9:Vr,10:Vr,11:Vr,12:Vr,13:kQ,14:Vr,15:Vr,16:Vr,17:Vr,18:Vr,19:Vr,20:Vr,21:e4};function TQ(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(AQ[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Jd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Qp(e,t,r){var a=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=de(s);return i.write_shift(2,a),i.write_shift(2,t),s>4&&i.write_shift(2,29282),s>6&&i.write_shift(2,1997),s>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function CQ(e,t){return t===0||e.read_shift(2),1200}function OQ(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Vi(e,0,r);return e.read_shift(t+a-e.l),s}function PQ(e,t){var r=!t||t.biff==8,a=de(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function FQ(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function IQ(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=Sd(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:s,dt:i,name:o}}function DQ(e,t){var r=!t||t.biff>=8?2:1,a=de(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function RQ(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),i=[],o=0;o!=s&&e.l<r;++o)i.push(hQ(e));return i.Count=a,i.Unique=s,i}function MQ(e,t){var r=de(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],s=0;s<e.length;++s)a[s]=mQ(e[s]);var i=Tr([r].concat(a));return i.parts=[r.length].concat(a.map(function(o){return o.length})),i}function $Q(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function LQ(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function BQ(e){var t=wQ(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function UQ(e){return e.read_shift(2),e.read_shift(4)}function ww(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,s]}function WQ(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:i,CurTab:o,FirstTab:l,Selected:c,TabRatio:d}}function HQ(){var e=de(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function zQ(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function VQ(e){var t=de(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function GQ(){}function qQ(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Sd(e,0,r),a}function KQ(e,t){var r=e.name||"Arial",a=t&&t.biff==5,s=a?15+r.length:16+2*r.length,i=de(s);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function XQ(e){var t=Dn(e);return t.isst=e.read_shift(4),t}function YQ(e,t,r,a){var s=de(10);return Ci(e,t,a,s),s.write_shift(4,r),s}function JQ(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=Dn(e);r.biff==2&&e.l++;var i=kd(e,a-e.l,r);return s.val=i,s}function ZQ(e,t,r,a,s){var i=!s||s.biff==8,o=de(8+ +i+(1+i)*r.length);return Ci(e,t,a,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function QQ(e,t,r){var a=e.read_shift(2),s=Vi(e,0,r);return[a,s]}function eee(e,t,r,a){var s=r&&r.biff==5;a||(a=de(s?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(s?1:2,t.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var tee=Vi;function jw(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,i=e.read_shift(s),o=e.read_shift(s),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:i,c:l},e:{r:o,c}}}function ree(e,t){var r=t.biff==8||!t.biff?4:2,a=de(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function aee(e){var t=e.read_shift(2),r=e.read_shift(2),a=JS(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function nee(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(JS(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:o,rkrec:i}}function see(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(i.length!=o-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:o,ixfe:i}}function iee(e,t,r,a){var s={},i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return s.patternType=BZ[l>>26],a.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=o&15,s.dgRight=o>>4&15,s.dgTop=o>>8&15,s.dgBottom=o>>12&15,s.icvLeft=o>>16&127,s.icvRight=o>>23&127,s.grbitDiag=o>>30&3,s.icvTop=l&127,s.icvBottom=l>>7&127,s.icvDiag=l>>14&127,s.dgDiag=l>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function oee(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=iee(e,t,a.fStyle,r),a}function Nw(e,t,r,a){var s=r&&r.biff==5;a||(a=de(s?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&s&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function lee(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function cee(e){var t=de(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function _w(e,t,r){var a=Dn(e);(r.biff==2||t==9)&&++e.l;var s=fQ(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function dee(e,t,r,a,s,i){var o=de(8);return Ci(e,t,a,o),qS(r,i,o),o}function uee(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Dn(e),s=Yr(e);return a.val=s,a}function fee(e,t,r,a){var s=de(14);return Ci(e,t,a,s),Ai(r,s),s}var Sw=jQ;function hee(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Ti(e,i),l=[];a>e.l;)l.push(kd(e));return[i,s,o,l]}function kw(e,t,r){var a=e.read_shift(2),s,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=_Q(e,t-2,r)),i.body=s||e.read_shift(t-2),typeof s=="string"&&(i.Name=s),i}var mee=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ew(e,t,r){var a=e.l+t,s=e.read_shift(2),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Ti(e,o,r);s&32&&(d=mee[d.charCodeAt(0)]);var u=a-e.l;r&&r.biff==2&&--u;var f=a==e.l||l===0||!(u>0)?[]:Tne(e,u,r,l);return{chKey:i,Name:d,itab:c,rgce:f}}function t4(e,t,r){if(r.biff<8)return xee(e,t,r);for(var a=[],s=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(NQ(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function xee(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Sd(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function pee(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),i=Ti(e,a,r),o=Ti(e,s,r);return[i,o]}function gee(e,t,r){var a=QS(e);e.l++;var s=e.read_shift(1);return t-=8,[Cne(e,t,r),s,a]}function Aw(e,t,r){var a=SQ(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Ene(e,t,r)]}function vee(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function yee(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=Vi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},l,o,i]}}function bee(e,t,r){return yee(e,t,r)}function wee(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(k0(e));return r}function jee(e){var t=de(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)ZS(e[r],t);return t}function Nee(e,t,r){if(r&&r.biff<8)return See(e,t,r);var a=e4(e),s=TQ(e,t-22,a[1]);return{cmo:a,ft:s}}var _ee={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function See(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((_ee[a]||Zr)(e,t,r)),{cmo:[s,a,i],ft:o}}function kee(e,t,r){var a=e.l,s="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:o=xQ(e,6,r);var l=e.read_shift(2);e.read_shift(2),dr(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-a!=e.lens[d])throw new Error("TxO: bad continue record");var u=e[e.l],f=Ti(e,e.lens[d+1]-e.lens[d]-1);if(s+=f,s.length>=(u?l:2*l))break}if(s.length!==l&&s.length!==l*2)throw new Error("cchText: "+l+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function Eee(e,t){var r=k0(e);e.l+=16;var a=yQ(e,t-24);return[r,a]}function Aee(e){var t=de(24),r=Yt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(a[s],16));return Tr([t,bQ(e[1])])}function Tee(e,t){e.read_shift(2);var r=k0(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(la,""),[r,a]}function Cee(e){var t=e[1].Tooltip,r=de(10+2*(t.length+1));r.write_shift(2,2048);var a=Yt(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Oee(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=fw[r]||r,r=e.read_shift(2),t[1]=fw[r]||r,t}function Pee(e){return e||(e=de(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Fee(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(YS(e));return r}function Iee(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(YS(e));return r}function Dee(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function r4(e,t,r){if(!r.cellStyles)return Zr(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);a==2&&(e.l+=2);var d={s,e:i,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function Ree(e,t){var r=de(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function Mee(e,t){var r={};return t<32||(e.l+=16,r.header=Yr(e),r.footer=Yr(e),e.l+=2),r}function $ee(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}function Lee(e){for(var t=de(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Bee=Dn,Uee=GS,Wee=kd;function Hee(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function zee(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Dn(e);++e.l;var s=Vi(e,t-7,r);return a.t="str",a.val=s,a}function Vee(e){var t=Dn(e);++e.l;var r=Yr(e);return t.t="n",t.val=r,t}function Gee(e,t,r){var a=de(15);return Cd(a,e,t),a.write_shift(8,r,"f"),a}function qee(e){var t=Dn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Kee(e,t,r){var a=de(9);return Cd(a,e,t),a.write_shift(2,r),a}function Xee(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Yee(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Jee(e,t,r){var a=e.l+t,s=Dn(e),i=e.read_shift(2),o=Ti(e,i,r);return e.l=a,s.t="str",s.val=o,s}var Zee=[2,3,48,49,131,139,140,245],ux=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=N0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var d=[],u=Cs(1);switch(c.type){case"base64":u=Sa(Oa(l));break;case"binary":u=Sa(l);break;case"buffer":case"array":u=l;break}Lr(u,0);var f=u.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=u.read_shift(2)),u.l+=3,f!=2&&(p=u.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=u.read_shift(2));var y=u.read_shift(2),b=c.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),x&&(u.l+=36);for(var v=[],w={},j=Math.min(u.length,f==2?521:g-10-(m?264:0)),N=x?32:11;u.l<j&&u[u.l]!=13;)switch(w={},w.name=Gc.utils.decode(b,u.slice(u.l,u.l+N)).replace(/[\u0000\r\n].*$/g,""),u.l+=N,w.type=String.fromCharCode(u.read_shift(1)),f!=2&&!x&&(w.offset=u.read_shift(4)),w.len=u.read_shift(1),f==2&&(w.offset=u.read_shift(2)),w.dec=u.read_shift(1),w.name.length&&v.push(w),f!=2&&(u.l+=x?13:14),w.type){case"B":(!m||w.len!=8)&&c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var _=0,E=0;for(d[0]=[],E=0;E!=v.length;++E)d[0][E]=v[E].name;for(;p-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,d[++_]=[],E=0,E=0;E!=v.length;++E){var S=u.slice(u.l,u.l+v[E].len);u.l+=v[E].len,Lr(S,0);var k=Gc.utils.decode(b,S);switch(v[E].type){case"C":k.trim().length&&(d[_][E]=k.replace(/\s+$/,""));break;case"D":k.length===8?d[_][E]=new Date(+k.slice(0,4),+k.slice(4,6)-1,+k.slice(6,8)):d[_][E]=k;break;case"F":d[_][E]=parseFloat(k.trim());break;case"+":case"I":d[_][E]=x?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(k.trim().toUpperCase()){case"Y":case"T":d[_][E]=!0;break;case"N":case"F":d[_][E]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+k+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[_][E]="##MEMO##"+(x?parseInt(k.trim(),10):S.read_shift(4));break;case"N":k=k.replace(/\u0000/g,"").trim(),k&&k!="."&&(d[_][E]=+k||0);break;case"@":d[_][E]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":d[_][E]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":d[_][E]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[_][E]=-S.read_shift(-8,"f");break;case"B":if(m&&v[E].len==8){d[_][E]=S.read_shift(8,"f");break}case"G":case"P":S.l+=v[E].len;break;case"0":if(v[E].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[E].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=v,d}function a(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var u=sl(r(l,d),d);return u["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,u}function s(l,c){try{return Ws(a(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&on(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var u=pa(),f=wf(l,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=l["!cols"]||[],p=0,g=0,y=0,b=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=ht(l["!ref"]),w=[],j=[],N=[];for(p=0;p<=v.e.c-v.s.c;++p){var _="",E="",S=0,k=[];for(g=0;g<m.length;++g)m[g][p]!=null&&k.push(m[g][p]);if(k.length==0||h[p]==null){w[p]="?";continue}for(g=0;g<k.length;++g){switch(typeof k[g]){case"number":E="B";break;case"string":E="C";break;case"boolean":E="L";break;case"object":E=k[g]instanceof Date?"D":"C";break;default:E="C"}S=Math.max(S,String(k[g]).length),_=_&&_!=E?"C":E}S>250&&(S=250),E=((x[p]||{}).DBF||{}).type,E=="C"&&x[p].DBF.len>S&&(S=x[p].DBF.len),_=="B"&&E=="N"&&(_="N",N[p]=x[p].DBF.dec,S=x[p].DBF.len),j[p]=_=="C"||E=="N"?S:i[_]||0,b+=j[p],w[p]=_}var O=u.next(32);for(O.write_shift(4,318902576),O.write_shift(4,m.length),O.write_shift(2,296+32*y),O.write_shift(2,b),p=0;p<4;++p)O.write_shift(4,0);for(O.write_shift(4,0|(+t[V_]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var P=u.next(32),A=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,A,"sbcs"),P.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),P.write_shift(4,g),P.write_shift(1,j[p]||i[w[p]]||0),P.write_shift(1,N[p]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),g+=j[p]||i[w[p]]||0}var R=u.next(264);for(R.write_shift(4,13),p=0;p<65;++p)R.write_shift(4,0);for(p=0;p<m.length;++p){var T=u.next(b);for(T.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(w[g]){case"L":T.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":T.write_shift(8,m[p][g]||0,"f");break;case"N":var F="0";for(typeof m[p][g]=="number"&&(F=m[p][g].toFixed(N[g]||0)),y=0;y<j[g]-F.length;++y)T.write_shift(1,32);T.write_shift(1,F,"sbcs");break;case"D":m[p][g]?(T.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var W=String(m[p][g]!=null?m[p][g]:"").slice(0,j[g]);for(T.write_shift(1,W,"sbcs"),y=0;y<j[g]-W.length;++y)T.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:a,from_sheet:o}}(),a4=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+er(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?L1(x):x},a=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:L1(p)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return i(Oa(h),m);case"binary":return i(h,m);case"buffer":return i(rt&&Buffer.isBuffer(h)?h.toString("binary"):Us(h),m);case"array":return i(Ei(h),m)}throw new Error("Unrecognized type "+m.type)}function i(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,y=0,b=0,v=[],w=[],j=null,N={},_=[],E=[],S=[],k=0,O;for(+m.codepage>=0&&on(+m.codepage);y!==x.length;++y){k=0;var P=x[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),A=P.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),R=A[0],T;if(P.length>0)switch(R){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":A[1].charAt(0)=="P"&&w.push(P.slice(3).replace(/;;/g,";"));break;case"C":var F=!1,W=!1,K=!1,B=!1,L=-1,ee=-1;for(b=1;b<A.length;++b)switch(A[b].charAt(0)){case"A":break;case"X":g=parseInt(A[b].slice(1))-1,W=!0;break;case"Y":for(p=parseInt(A[b].slice(1))-1,W||(g=0),O=v.length;O<=p;++O)v[O]=[];break;case"K":T=A[b].slice(1),T.charAt(0)==='"'?T=T.slice(1,T.length-1):T==="TRUE"?T=!0:T==="FALSE"?T=!1:isNaN(cn(T))?isNaN(Lo(T).getDate())||(T=Lt(T)):(T=cn(T),j!==null&&al(j)&&(T=S0(T))),F=!0;break;case"E":B=!0;var M=po(A[b].slice(1),{r:p,c:g});v[p][g]=[v[p][g],M];break;case"S":K=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":L=parseInt(A[b].slice(1))-1;break;case"C":ee=parseInt(A[b].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}if(F&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=T:v[p][g]=T,j=null),K){if(B)throw new Error("SYLK shared formula cannot have own formula");var G=L>-1&&v[L][ee];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=w4(G[1],{r:p-L,c:g-ee})}break;case"F":var V=0;for(b=1;b<A.length;++b)switch(A[b].charAt(0)){case"X":g=parseInt(A[b].slice(1))-1,++V;break;case"Y":for(p=parseInt(A[b].slice(1))-1,O=v.length;O<=p;++O)v[O]=[];break;case"M":k=parseInt(A[b].slice(1))/20;break;case"F":break;case"G":break;case"P":j=w[parseInt(A[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=A[b].slice(1).split(" "),O=parseInt(S[0],10);O<=parseInt(S[1],10);++O)k=parseInt(S[2],10),E[O-1]=k===0?{hidden:!0}:{wch:k},Os(E[O-1]);break;case"C":g=parseInt(A[b].slice(1))-1,E[g]||(E[g]={});break;case"R":p=parseInt(A[b].slice(1))-1,_[p]||(_[p]={}),k>0?(_[p].hpt=k,_[p].hpx=Uo(k)):k===0&&(_[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}V<1&&(j=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+P)}}return _.length>0&&(N["!rows"]=_),E.length>0&&(N["!cols"]=E),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,N]}function o(h,m){var x=s(h,m),p=x[0],g=x[1],y=sl(p,m);return er(g).forEach(function(b){y[b]=g[b]}),y}function l(h,m){return Ws(o(h,m),m)}function c(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+sg(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=ed(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=td(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function u(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*rd(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=ht(h["!ref"]),y,b=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&d(x,h["!cols"]),h["!rows"]&&u(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var w=g.s.r;w<=g.e.r;++w)for(var j=g.s.c;j<=g.e.c;++j){var N=Be({r:w,c:j});y=b?(h[w]||[])[j]:h[N],!(!y||y.v==null&&(!y.f||y.F))&&p.push(c(y,h,w,j))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),n4=function(){function e(i,o){switch(o.type){case"base64":return t(Oa(i),o);case"binary":return t(i,o);case"buffer":return t(rt&&Buffer.isBuffer(i)?i.toString("binary"):Us(i),o);case"array":return t(Ei(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){for(var l=i.split(`
`),c=-1,d=-1,u=0,f=[];u!==l.length;++u){if(l[u].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var h=l[u].trim().split(","),m=h[0],x=h[1];++u;for(var p=l[u]||"";(p.match(/["]/g)||[]).length&1&&u<l.length-1;)p+=`
`+l[++u];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][d]=!0:p==="FALSE"?f[c][d]=!1:isNaN(cn(x))?isNaN(Lo(x).getDate())?f[c][d]=x:f[c][d]=Lt(x):f[c][d]=cn(x),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][d++]=p!==""?p:null;break}if(p==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(i,o){return sl(e(i,o),o)}function a(i,o){return Ws(r(i,o),o)}var s=function(){var i=function(c,d,u,f,h){c.push(d),c.push(u+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,d,u,f){c.push(d+","+u),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],u=ht(c["!ref"]),f,h=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,u.e.r-u.s.r+1,""),i(d,"TUPLES",0,u.e.c-u.s.c+1,""),i(d,"DATA",0,0,"");for(var m=u.s.r;m<=u.e.r;++m){o(d,-1,0,"BOT");for(var x=u.s.c;x<=u.e.c;++x){var p=Be({r:m,c:x});if(f=h?(c[m]||[])[x]:c[p],!f){o(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ya(f.z||Le[14],jr(Lt(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var y=`\r
`,b=d.join(y);return b}}();return{to_workbook:a,to_sheet:r,from_sheet:s}}(),s4=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,y=[];g!==m.length;++g){var b=m[g].trim().split(":");if(b[0]==="cell"){var v=Yt(b[1]);if(y.length<=v.r)for(x=y.length;x<=v.r;++x)y[x]||(y[x]=[]);switch(x=v.r,p=v.c,b[2]){case"t":y[x][p]=e(b[3]);break;case"v":y[x][p]=+b[3];break;case"vtf":var w=b[b.length-1];case"vtc":switch(b[3]){case"nl":y[x][p]=!!+b[4];break;default:y[x][p]=+b[4];break}b[2]=="vtf"&&(y[x][p]=[y[x][p],w])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function a(f,h){return sl(r(f,h),h)}function s(f,h){return Ws(a(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=va(f["!ref"]),y=Array.isArray(f),b=g.s.r;b<=g.e.r;++b)for(var v=g.s.c;v<=g.e.c;++v)if(p=Be({r:b,c:v}),x=y?(f[b]||[])[v]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var w=jr(Lt(x.v));m[2]="vtc",m[3]="nd",m[4]=""+w,m[5]=x.w||Ya(x.z||Le[14],w);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,o,l,o,d(f),c].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:u}}(),Bo=function(){function e(u,f,h,m,x){x.raw?f[h][m]=u:u===""||(u==="TRUE"?f[h][m]=!0:u==="FALSE"?f[h][m]=!1:isNaN(cn(u))?isNaN(Lo(u).getDate())?f[h][m]=u:f[h][m]=Lt(u):f[h][m]=cn(u))}function t(u,f){var h=f||{},m=[];if(!u||u.length===0)return m;for(var x=u.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,y=0,b=0;b<=p;++b)y=x[b].indexOf(" "),y==-1?y=x[b].length:y++,g=Math.max(g,y);for(b=0;b<=p;++b){m[b]=[];var v=0;for(e(x[b].slice(0,g).trim(),m,b,v,h),v=1;v<=(x[b].length-g)/10+1;++v)e(x[b].slice(g+(v-1)*10,g+v*10).trim(),m,b,v,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,m=0,x=0;m<u.length;++m)(x=u.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=a;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||a[p[1]]-a[g[1]]}),r[x.pop()[1]]||44}function i(u,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(m=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(m=u.charAt(4),u=u.slice(6)):m=s(u.slice(0,1024)):h&&h.FS?m=h.FS:m=s(u.slice(0,1024));var g=0,y=0,b=0,v=0,w=0,j=m.charCodeAt(0),N=!1,_=0,E=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var S=h.dateNF!=null?$J(h.dateNF):null;function k(){var O=u.slice(v,w),P={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)P.t="z";else if(h.raw)P.t="s",P.v=O;else if(O.trim().length===0)P.t="s",P.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(P.t="s",P.v=O.slice(2,-1).replace(/""/g,'"')):hae(O)?(P.t="n",P.f=O.slice(1)):(P.t="s",P.v=O);else if(O=="TRUE")P.t="b",P.v=!0;else if(O=="FALSE")P.t="b",P.v=!1;else if(!isNaN(b=cn(O)))P.t="n",h.cellText!==!1&&(P.w=O),P.v=b;else if(!isNaN(Lo(O).getDate())||S&&O.match(S)){P.z=h.dateNF||Le[14];var A=0;S&&O.match(S)&&(O=LJ(O,h.dateNF,O.match(S)||[]),A=1),h.cellDates?(P.t="d",P.v=Lt(O,A)):(P.t="n",P.v=jr(Lt(O,A))),h.cellText!==!1&&(P.w=Ya(P.z,P.v instanceof Date?jr(P.v):P.v)),h.cellNF||delete P.z}else P.t="s",P.v=O;if(P.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][y]=P):x[Be({c:y,r:g})]=P),v=w+1,E=u.charCodeAt(v),p.e.c<y&&(p.e.c=y),p.e.r<g&&(p.e.r=g),_==j)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;w<u.length;++w)switch(_=u.charCodeAt(w)){case 34:E===34&&(N=!N);break;case j:case 10:case 13:if(!N&&k())break e;break}return w-v>0&&k(),x["!ref"]=Ke(p),x}function o(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):sl(t(u,f),f)}function l(u,f){var h="",m=f.type=="string"?[0,0,0,0]:hg(u,f);switch(f.type){case"base64":h=Oa(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Gc<"u"||(h=rt&&Buffer.isBuffer(u)?u.toString("binary"):Us(u));break;case"array":h=Ei(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=Ct(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Ct(h):f.type=="binary"&&typeof Gc<"u",h.slice(0,19)=="socialcalc:version:"?s4.to_sheet(f.type=="string"?h:Ct(h),f):o(h,f)}function c(u,f){return Ws(l(u,f),f)}function d(u){for(var f=[],h=ht(u["!ref"]),m,x=Array.isArray(u),p=h.s.r;p<=h.e.r;++p){for(var g=[],y=h.s.c;y<=h.e.c;++y){var b=Be({r:p,c:y});if(m=x?(u[p]||[])[y]:u[b],!m||m.v==null){g.push("          ");continue}for(var v=(m.w||(ns(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(y===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}();function Qee(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=a4.to_workbook(e,r);return r.WTF=a,s}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Bo.to_workbook(e,t)}}var xi=function(){function e(M,G,V){if(M){Lr(M,M.l||0);for(var H=V.Enum||L;M.l<M.length;){var re=M.read_shift(2),me=H[re]||H[65535],xe=M.read_shift(2),Z=M.l+xe,q=me.f&&me.f(M,xe,V);if(M.l=Z,G(q,me,re))return}}}function t(M,G){switch(G.type){case"base64":return r(Sa(Oa(M)),G);case"binary":return r(Sa(M),G);case"buffer":case"array":return r(M,G)}throw"Unsupported type "+G.type}function r(M,G){if(!M)return M;var V=G||{},H=V.dense?[]:{},re="Sheet1",me="",xe=0,Z={},q=[],ie=[],I={s:{r:0,c:0},e:{r:0,c:0}},ve=V.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)V.Enum=L,e(M,function(fe,oe,qe){switch(qe){case 0:V.vers=fe,fe>=4096&&(V.qpro=!0);break;case 6:I=fe;break;case 204:fe&&(me=fe);break;case 222:me=fe;break;case 15:case 51:V.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:qe==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=V.dateNF||Le[14],V.cellDates&&(fe[1].t="d",fe[1].v=S0(fe[1].v))),V.qpro&&fe[3]>xe&&(H["!ref"]=Ke(I),Z[re]=H,q.push(re),H=V.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},xe=fe[3],re=me||"Sheet"+(xe+1),me="");var st=V.dense?(H[fe[0].r]||[])[fe[0].c]:H[Be(fe[0])];if(st){st.t=fe[1].t,st.v=fe[1].v,fe[1].z!=null&&(st.z=fe[1].z),fe[1].f!=null&&(st.f=fe[1].f);break}V.dense?(H[fe[0].r]||(H[fe[0].r]=[]),H[fe[0].r][fe[0].c]=fe[1]):H[Be(fe[0])]=fe[1];break}},V);else if(M[2]==26||M[2]==14)V.Enum=ee,M[2]==14&&(V.qpro=!0,M.l=0),e(M,function(fe,oe,qe){switch(qe){case 204:re=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>xe&&(H["!ref"]=Ke(I),Z[re]=H,q.push(re),H=V.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},xe=fe[3],re="Sheet"+(xe+1)),ve>0&&fe[0].r>=ve)break;V.dense?(H[fe[0].r]||(H[fe[0].r]=[]),H[fe[0].r][fe[0].c]=fe[1]):H[Be(fe[0])]=fe[1],I.e.c<fe[0].c&&(I.e.c=fe[0].c),I.e.r<fe[0].r&&(I.e.r=fe[0].r);break;case 27:fe[14e3]&&(ie[fe[14e3][0]]=fe[14e3][1]);break;case 1537:ie[fe[0]]=fe[1],fe[0]==xe&&(re=fe[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(H["!ref"]=Ke(I),Z[me||re]=H,q.push(me||re),!ie.length)return{SheetNames:q,Sheets:Z};for(var we={},Ee=[],ce=0;ce<ie.length;++ce)Z[q[ce]]?(Ee.push(ie[ce]||q[ce]),we[ie[ce]]=Z[ie[ce]]||Z[q[ce]]):(Ee.push(ie[ce]),we[ie[ce]]={"!ref":"A1"});return{SheetNames:Ee,Sheets:we}}function a(M,G){var V=G||{};if(+V.codepage>=0&&on(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var H=pa(),re=ht(M["!ref"]),me=Array.isArray(M),xe=[];Se(H,0,i(1030)),Se(H,6,c(re));for(var Z=Math.min(re.e.r,8191),q=re.s.r;q<=Z;++q)for(var ie=ir(q),I=re.s.c;I<=re.e.c;++I){q===re.s.r&&(xe[I]=Xt(I));var ve=xe[I]+ie,we=me?(M[q]||[])[I]:M[ve];if(!(!we||we.t=="z"))if(we.t=="n")(we.v|0)==we.v&&we.v>=-32768&&we.v<=32767?Se(H,13,m(q,I,we.v)):Se(H,14,p(q,I,we.v));else{var Ee=ns(we);Se(H,15,f(q,I,Ee.slice(0,239)))}}return Se(H,1),H.end()}function s(M,G){var V=G||{};if(+V.codepage>=0&&on(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var H=pa();Se(H,0,o(M));for(var re=0,me=0;re<M.SheetNames.length;++re)(M.Sheets[M.SheetNames[re]]||{})["!ref"]&&Se(H,27,B(M.SheetNames[re],me++));var xe=0;for(re=0;re<M.SheetNames.length;++re){var Z=M.Sheets[M.SheetNames[re]];if(!(!Z||!Z["!ref"])){for(var q=ht(Z["!ref"]),ie=Array.isArray(Z),I=[],ve=Math.min(q.e.r,8191),we=q.s.r;we<=ve;++we)for(var Ee=ir(we),ce=q.s.c;ce<=q.e.c;++ce){we===q.s.r&&(I[ce]=Xt(ce));var fe=I[ce]+Ee,oe=ie?(Z[we]||[])[ce]:Z[fe];if(!(!oe||oe.t=="z"))if(oe.t=="n")Se(H,23,k(we,ce,xe,oe.v));else{var qe=ns(oe);Se(H,22,_(we,ce,xe,qe.slice(0,239)))}}++xe}}return Se(H,1),H.end()}function i(M){var G=de(2);return G.write_shift(2,M),G}function o(M){var G=de(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var V=0,H=0,re=0,me=0;me<M.SheetNames.length;++me){var xe=M.SheetNames[me],Z=M.Sheets[xe];if(!(!Z||!Z["!ref"])){++re;var q=va(Z["!ref"]);V<q.e.r&&(V=q.e.r),H<q.e.c&&(H=q.e.c)}}return V>8191&&(V=8191),G.write_shift(2,V),G.write_shift(1,re),G.write_shift(1,H),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function l(M,G,V){var H={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&V.qpro?(H.s.c=M.read_shift(1),M.l++,H.s.r=M.read_shift(2),H.e.c=M.read_shift(1),M.l++,H.e.r=M.read_shift(2),H):(H.s.c=M.read_shift(2),H.s.r=M.read_shift(2),G==12&&V.qpro&&(M.l+=2),H.e.c=M.read_shift(2),H.e.r=M.read_shift(2),G==12&&V.qpro&&(M.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function c(M){var G=de(8);return G.write_shift(2,M.s.c),G.write_shift(2,M.s.r),G.write_shift(2,M.e.c),G.write_shift(2,M.e.r),G}function d(M,G,V){var H=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(H[0].c=M.read_shift(1),H[3]=M.read_shift(1),H[0].r=M.read_shift(2),M.l+=2):(H[2]=M.read_shift(1),H[0].c=M.read_shift(2),H[0].r=M.read_shift(2)),H}function u(M,G,V){var H=M.l+G,re=d(M,G,V);if(re[1].t="s",V.vers==20768){M.l++;var me=M.read_shift(1);return re[1].v=M.read_shift(me,"utf8"),re}return V.qpro&&M.l++,re[1].v=M.read_shift(H-M.l,"cstr"),re}function f(M,G,V){var H=de(7+V.length);H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(1,39);for(var re=0;re<H.length;++re){var me=V.charCodeAt(re);H.write_shift(1,me>=128?95:me)}return H.write_shift(1,0),H}function h(M,G,V){var H=d(M,G,V);return H[1].v=M.read_shift(2,"i"),H}function m(M,G,V){var H=de(7);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(2,V,"i"),H}function x(M,G,V){var H=d(M,G,V);return H[1].v=M.read_shift(8,"f"),H}function p(M,G,V){var H=de(13);return H.write_shift(1,255),H.write_shift(2,G),H.write_shift(2,M),H.write_shift(8,V,"f"),H}function g(M,G,V){var H=M.l+G,re=d(M,G,V);if(re[1].v=M.read_shift(8,"f"),V.qpro)M.l=H;else{var me=M.read_shift(2);w(M.slice(M.l,M.l+me),re),M.l+=me}return re}function y(M,G,V){var H=G&32768;return G&=-32769,G=(H?M:0)+(G>=8192?G-16384:G),(H?"":"$")+(V?Xt(G):ir(G))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(M,G){Lr(M,0);for(var V=[],H=0,re="",me="",xe="",Z="";M.l<M.length;){var q=M[M.l++];switch(q){case 0:V.push(M.read_shift(8,"f"));break;case 1:me=y(G[0].c,M.read_shift(2),!0),re=y(G[0].r,M.read_shift(2),!1),V.push(me+re);break;case 2:{var ie=y(G[0].c,M.read_shift(2),!0),I=y(G[0].r,M.read_shift(2),!1);me=y(G[0].c,M.read_shift(2),!0),re=y(G[0].r,M.read_shift(2),!1),V.push(ie+I+":"+me+re)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(M.read_shift(2));break;case 6:{for(var ve="";q=M[M.l++];)ve+=String.fromCharCode(q);V.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Z=V.pop(),xe=V.pop(),V.push(["AND","OR"][q-20]+"("+xe+","+Z+")");break;default:if(q<32&&v[q])Z=V.pop(),xe=V.pop(),V.push(xe+v[q]+Z);else if(b[q]){if(H=b[q][1],H==69&&(H=M[M.l++]),H>V.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+V.join("|")+"|");return}var we=V.slice(-H);V.length-=H,V.push(b[q][0]+"("+we.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}V.length==1?G[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function j(M){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=M.read_shift(2),G[3]=M[M.l++],G[0].c=M[M.l++],G}function N(M,G){var V=j(M);return V[1].t="s",V[1].v=M.read_shift(G-4,"cstr"),V}function _(M,G,V,H){var re=de(6+H.length);re.write_shift(2,M),re.write_shift(1,V),re.write_shift(1,G),re.write_shift(1,39);for(var me=0;me<H.length;++me){var xe=H.charCodeAt(me);re.write_shift(1,xe>=128?95:xe)}return re.write_shift(1,0),re}function E(M,G){var V=j(M);V[1].v=M.read_shift(2);var H=V[1].v>>1;if(V[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return V[1].v=H,V}function S(M,G){var V=j(M),H=M.read_shift(4),re=M.read_shift(4),me=M.read_shift(2);if(me==65535)return H===0&&re===3221225472?(V[1].t="e",V[1].v=15):H===0&&re===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var xe=me&32768;return me=(me&32767)-16446,V[1].v=(1-xe*2)*(re*Math.pow(2,me+32)+H*Math.pow(2,me)),V}function k(M,G,V,H){var re=de(14);if(re.write_shift(2,M),re.write_shift(1,V),re.write_shift(1,G),H==0)return re.write_shift(4,0),re.write_shift(4,0),re.write_shift(2,65535),re;var me=0,xe=0,Z=0,q=0;return H<0&&(me=1,H=-H),xe=Math.log2(H)|0,H/=Math.pow(2,xe-31),q=H>>>0,q&2147483648||(H/=2,++xe,q=H>>>0),H-=q,q|=2147483648,q>>>=0,H*=Math.pow(2,32),Z=H>>>0,re.write_shift(4,Z),re.write_shift(4,q),xe+=16383+(me?32768:0),re.write_shift(2,xe),re}function O(M,G){var V=S(M);return M.l+=G-14,V}function P(M,G){var V=j(M),H=M.read_shift(4);return V[1].v=H>>6,V}function A(M,G){var V=j(M),H=M.read_shift(8,"f");return V[1].v=H,V}function R(M,G){var V=A(M);return M.l+=G-10,V}function T(M,G){return M[M.l+G-1]==0?M.read_shift(G,"cstr"):""}function F(M,G){var V=M[M.l++];V>G-1&&(V=G-1);for(var H="";H.length<V;)H+=String.fromCharCode(M[M.l++]);return H}function W(M,G,V){if(!(!V.qpro||G<21)){var H=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var re=M.read_shift(G-21,"cstr");return[H,re]}}function K(M,G){for(var V={},H=M.l+G;M.l<H;){var re=M.read_shift(2);if(re==14e3){for(V[re]=[0,""],V[re][0]=M.read_shift(2);M[M.l];)V[re][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return V}function B(M,G){var V=de(5+M.length);V.write_shift(2,14e3),V.write_shift(2,G);for(var H=0;H<M.length;++H){var re=M.charCodeAt(H);V[V.l++]=re>127?95:re}return V[V.l++]=0,V}var L={0:{n:"BOF",f:dr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:T},222:{n:"SHEETNAMELP",f:F},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:N},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:E},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:A},40:{n:"FORMULA28",f:R},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:T},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:W},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}}();function ete(e){var t={},r=e.match(ea),a=0,s=!1;if(r)for(;a!=r.length;++a){var i=Ue(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Cp[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return t}var tte=function(){var e=Xc("t"),t=Xc("rPr");function r(i){var o=i.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:ut(o[1])},c=i.match(t);return c&&(l.s=ete(c[1])),l}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(s).map(r).filter(function(l){return l.v})}}(),rte=function(){var t=/(\r\n|\n)/g;function r(s,i,o){var l=[];s.u&&l.push("text-decoration: underline;"),s.uval&&l.push("text-underline-style:"+s.uval+";"),s.sz&&l.push("font-size:"+s.sz+"pt;"),s.outline&&l.push("text-effect: outline;"),s.shadow&&l.push("text-shadow: auto;"),i.push('<span style="'+l.join("")+'">'),s.b&&(i.push("<b>"),o.push("</b>")),s.i&&(i.push("<i>"),o.push("</i>")),s.strike&&(i.push("<s>"),o.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(i.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),s}function a(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),ate=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,nte=/<(?:\w+:)?r>/,ste=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function eg(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=ut(Ct(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Ct(e),r&&(a.h=Bp(a.t))):e.match(nte)&&(a.r=Ct(e),a.t=ut(Ct((e.replace(ste,"").match(ate)||[]).join("").replace(ea,""))),r&&(a.h=rte(tte(a.r)))),a):{t:""}}var ite=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ote=/<(?:\w+:)?(?:si|sstItem)>/g,lte=/<\/(?:\w+:)?(?:si|sstItem)>/;function cte(e,t){var r=[],a="";if(!e)return r;var s=e.match(ite);if(s){a=s[2].replace(ote,"").split(lte);for(var i=0;i!=a.length;++i){var o=eg(a[i].trim(),t);o!=null&&(r[r.length]=o)}s=Ue(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var dte=/^\s|\s$|[\t\n\r]/;function i4(e,t){if(!t.bookSST)return"";var r=[or];r[r.length]=_e("sst",null,{xmlns:Bi[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var s=e[a],i="<si>";s.r?i+=s.r:(i+="<t",s.t||(s.t=""),s.t.match(dte)&&(i+=' xml:space="preserve"'),i+=">"+Et(s.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function ute(e){return[e.read_shift(4),e.read_shift(4)]}function fte(e,t){var r=[],a=!1;return ds(e,function(i,o,l){switch(l){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function hte(e,t){return t||(t=de(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var mte=_Z;function xte(e){var t=pa();ge(t,159,hte(e));for(var r=0;r<e.length;++r)ge(t,19,mte(e[r]));return ge(t,160),t.end()}function o4(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Jn(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function pte(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function gte(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),i=[];s-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function vte(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(gte(e));return t}function yte(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function bte(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Jn(e,4),t.U=Jn(e,4),t.W=Jn(e,4),t}function wte(e){var t=bte(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function l4(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function c4(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function jte(e){var t=Jn(e);switch(t.Minor){case 2:return[t.Minor,Nte(e)];case 3:return[t.Minor,_te()];case 4:return[t.Minor,Ste(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Nte(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=l4(e,r),s=c4(e,e.length-e.l);return{t:"Std",h:a,v:s}}function _te(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Ste(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ea,function(i){var o=Ue(i);switch(In(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){a[l]=o[l]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function kte(e,t){var r={},a=r.EncryptionVersionInfo=Jn(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=l4(e,s),t-=s,r.EncryptionVerifier=c4(e,t),r}function Ete(e){var t={},r=t.EncryptionVersionInfo=Jn(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function tg(e){var t=0,r,a=o4(e),s=a.length+1,i,o,l,c,d;for(r=Cs(s),r[0]=a.length,i=1;i!=s;++i)r[i]=a[i-1];for(i=s-1;i>=0;--i)o=r[i],l=t&16384?1:0,c=t<<1&32767,d=l|c,t=d^o;return t^52811}var d4=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},s=function(o,l){return a(o^l)},i=function(o){for(var l=t[o.length-1],c=104,d=o.length-1;d>=0;--d)for(var u=o[d],f=0;f!=7;++f)u&64&&(l^=r[c]),u*=2,--c;return l};return function(o){for(var l=o4(o),c=i(l),d=l.length,u=Cs(16),f=0;f!=16;++f)u[f]=0;var h,m,x;for((d&1)===1&&(h=c>>8,u[d]=s(e[0],h),--d,h=c&255,m=l[l.length-1],u[d]=s(m,h));d>0;)--d,h=c>>8,u[d]=s(l[d],h),--d,h=c&255,u[d]=s(l[d],h);for(d=15,x=15-l.length;x>0;)h=c>>8,u[d]=s(e[x],h),--d,--x,h=c&255,u[d]=s(l[d],h),--d,--x;return u}}(),Ate=function(e,t,r,a,s){s||(s=t),a||(a=d4(e));var i,o;for(i=0;i!=t.length;++i)o=t[i],o^=a[r],o=(o>>5|o<<3)&255,s[i]=o,++r;return[s,r,a]},Tte=function(e){var t=0,r=d4(e);return function(a){var s=Ate("",a,t,r);return t=s[1],s[0]}};function Cte(e,t,r,a){var s={key:dr(e),verificationBytes:dr(e)};return r.password&&(s.verifier=tg(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=Tte(r.password)),s}function Ote(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Ete(e):a.Data=kte(e,t),a}function Pte(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?Ote(e,t-2,a):Cte(e,r.biff>=8?t:t-2,r,a),a}var u4=function(){function e(s,i){switch(i.type){case"base64":return t(Oa(s),i);case"binary":return t(s,i);case"buffer":return t(rt&&Buffer.isBuffer(s)?s.toString("binary"):Us(s),i);case"array":return t(Ei(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){var o=i||{},l=o.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(u);){switch(x[0]){case"\\cell":var g=u.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var y={v:g,t:"s"};Array.isArray(l)?l[f][p]=y:l[Be({r:f,c:p})]=y}break}m=h.lastIndex}p>d.e.c&&(d.e.c=p)}),l["!ref"]=Ke(d),l}function r(s,i){return Ws(e(s,i),i)}function a(s){for(var i=["{\\rtf1\\ansi"],o=ht(s["!ref"]),l,c=Array.isArray(s),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var f=Be({r:d,c:u});l=c?(s[d]||[])[u]:s[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(ns(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function Fte(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Qc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Ite(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),i=Math.min(t,r,a),o=s-i;if(o===0)return[0,0,t];var l=0,c=0,d=s+i;switch(c=o/(d>1?2-d:d),s){case t:l=((r-a)/o+6)%6;break;case r:l=(a-t)/o+2;break;case a:l=(t-r)/o+4;break}return[l/6,c,d/2]}function Dte(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=s*l,o[0]+=s,o[1]+=c;break;case 1:c=s*(2-l),o[0]+=c,o[1]+=s;break;case 2:c=s*(l-2),o[1]+=s,o[2]+=c;break;case 3:c=s*(4-l),o[1]+=c,o[2]+=s;break;case 4:c=s*(l-4),o[2]+=s,o[0]+=c;break;case 5:c=s*(6-l),o[2]+=c,o[0]+=s;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function yf(e,t){if(t===0)return e;var r=Ite(Fte(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Qc(Dte(r))}var f4=6,Rte=15,Mte=1,Xr=f4;function ed(e){return Math.floor((e+Math.round(128/Xr)/256)*Xr)}function td(e){return Math.floor((e-5)/Xr*100+.5)/100}function bf(e){return Math.round((e*Xr+5)/Xr*256)/256}function xh(e){return bf(td(ed(e)))}function rg(e){var t=Math.abs(e-xh(e)),r=Xr;if(t>.005)for(Xr=Mte;Xr<Rte;++Xr)Math.abs(e-xh(e))<=t&&(t=Math.abs(e-xh(e)),r=Xr);Xr=r}function Os(e){e.width?(e.wpx=ed(e.width),e.wch=td(e.wpx),e.MDW=Xr):e.wpx?(e.wch=td(e.wpx),e.width=bf(e.wch),e.MDW=Xr):typeof e.wch=="number"&&(e.width=bf(e.wch),e.wpx=ed(e.width),e.MDW=Xr),e.customWidth&&delete e.customWidth}var $te=96,h4=$te;function rd(e){return e*96/h4}function Uo(e){return e*h4/96}var Lte={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Bte(e,t,r,a){t.Borders=[];var s={},i=!1;(e[0].match(ea)||[]).forEach(function(o){var l=Ue(o);switch(In(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},l.diagonalUp&&(s.diagonalUp=$t(l.diagonalUp)),l.diagonalDown&&(s.diagonalDown=$t(l.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in borders")}})}function Ute(e,t,r,a){t.Fills=[];var s={},i=!1;(e[0].match(ea)||[]).forEach(function(o){var l=Ue(o);switch(In(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":l.patternType&&(s.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),l.indexed&&(s.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(s.bgColor.theme=parseInt(l.theme,10)),l.tint&&(s.bgColor.tint=parseFloat(l.tint)),l.rgb&&(s.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),l.theme&&(s.fgColor.theme=parseInt(l.theme,10)),l.tint&&(s.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(s.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fills")}})}function Wte(e,t,r,a){t.Fonts=[];var s={},i=!1;(e[0].match(ea)||[]).forEach(function(o){var l=Ue(o);switch(In(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":l.val&&(s.name=Ct(l.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=l.val?$t(l.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=l.val?$t(l.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(l.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=l.val?$t(l.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=l.val?$t(l.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=l.val?$t(l.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=l.val?$t(l.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=l.val?$t(l.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":l.val&&(s.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(s.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(s.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(s.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=Cp[parseInt(l.val,10)];break;case"<color":if(s.color||(s.color={}),l.auto&&(s.color.auto=$t(l.auto)),l.rgb)s.color.rgb=l.rgb.slice(-6);else if(l.indexed){s.color.index=parseInt(l.indexed,10);var c=hi[s.color.index];s.color.index==81&&(c=hi[1]),c||(c=hi[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(s.color.theme=parseInt(l.theme,10),l.tint&&(s.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=yf(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Hte(e,t,r){t.NumberFmt=[];for(var a=er(Le),s=0;s<a.length;++s)t.NumberFmt[a[s]]=Le[a[s]];var i=e[0].match(ea);if(i)for(s=0;s<i.length;++s){var o=Ue(i[s]);switch(In(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ut(Ct(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Yn(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function zte(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=_e("numFmt",null,{numFmtId:a,formatCode:Et(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=_e("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Zd=["numFmtId","fillId","fontId","borderId","xfId"],Qd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Vte(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(ea)||[]).forEach(function(i){var o=Ue(i),l=0;switch(In(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],l=0;l<Zd.length;++l)a[Zd[l]]&&(a[Zd[l]]=parseInt(a[Zd[l]],10));for(l=0;l<Qd.length;++l)a[Qd[l]]&&(a[Qd[l]]=$t(a[Qd[l]]));if(t.NumberFmt&&a.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[l]){a.numFmtId=l;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=$t(o.wrapText)),a.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Gte(e){var t=[];return t[t.length]=_e("cellXfs",null),e.forEach(function(r){t[t.length]=_e("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=_e("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var qte=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,d){var u={};if(!l)return u;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&Hte(f,u,d),(f=l.match(s))&&Wte(f,u,c,d),(f=l.match(a))&&Ute(f,u,c,d),(f=l.match(i))&&Bte(f,u,c,d),(f=l.match(r))&&Vte(f,u,d),u}}();function m4(e,t){var r=[or,_e("styleSheet",null,{xmlns:Bi[0],"xmlns:vt":vr.vt})],a;return e.SSF&&(a=zte(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=Gte(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Kte(e,t){var r=e.read_shift(2),a=Jr(e);return[r,a]}function Xte(e,t,r){r||(r=de(6+4*t.length)),r.write_shift(2,e),Or(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function Yte(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=OZ(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var l=e.read_shift(1);l>0&&(a.family=l);var c=e.read_shift(1);switch(c>0&&(a.charset=c),e.l++,a.color=CZ(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Jr(e),a}function Jte(e,t){t||(t=de(25+4*32)),t.write_shift(2,e.sz*20),PZ(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),pf(e.color,t);var a=0;return a=2,t.write_shift(1,a),Or(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Zte=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ph,Qte=Zr;function Tw(e,t){t||(t=de(4*3+8*7+16*1)),ph||(ph=N0(Zte));var r=ph[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(pf({auto:1},t),pf({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ere(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}function x4(e,t,r){r||(r=de(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Nl(e,t){return t||(t=de(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var tre=Zr;function rre(e,t){return t||(t=de(51)),t.write_shift(1,0),Nl(null,t),Nl(null,t),Nl(null,t),Nl(null,t),Nl(null,t),t.length>t.l?t.slice(0,t.l):t}function are(e,t){return t||(t=de(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),xf(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function nre(e,t,r){var a=de(2052);return a.write_shift(4,e),xf(t,a),xf(r,a),a.length>a.l?a.slice(0,a.l):a}function sre(e,t,r){var a={};a.NumberFmt=[];for(var s in Le)a.NumberFmt[s]=Le[s];a.CellXf=[],a.Fonts=[];var i=[],o=!1;return ds(e,function(c,d,u){switch(u){case 44:a.NumberFmt[c[0]]=c[1],Yn(c[1],c[0]);break;case 43:a.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=yf(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(u),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(u);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),a}function ire(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&++r}),r!=0&&(ge(e,615,dn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&ge(e,44,Xte(s,t[s]))}),ge(e,616))}}function ore(e){var t=1;ge(e,611,dn(t)),ge(e,43,Jte({sz:12,color:{theme:1},name:"Calibri",family:2})),ge(e,612)}function lre(e){var t=2;ge(e,603,dn(t)),ge(e,45,Tw({patternType:"none"})),ge(e,45,Tw({patternType:"gray125"})),ge(e,604)}function cre(e){var t=1;ge(e,613,dn(t)),ge(e,46,rre()),ge(e,614)}function dre(e){var t=1;ge(e,626,dn(t)),ge(e,47,x4({numFmtId:0},65535)),ge(e,627)}function ure(e,t){ge(e,617,dn(t.length)),t.forEach(function(r){ge(e,47,x4(r,0))}),ge(e,618)}function fre(e){var t=1;ge(e,619,dn(t)),ge(e,48,are({xfId:0,name:"Normal"})),ge(e,620)}function hre(e){var t=0;ge(e,505,dn(t)),ge(e,506)}function mre(e){var t=0;ge(e,508,nre(t,"TableStyleMedium9","PivotStyleMedium4")),ge(e,509)}function xre(e,t){var r=pa();return ge(r,278),ire(r,e.SSF),ore(r),lre(r),cre(r),dre(r),ure(r,t.cellXfs),fre(r),hre(r),mre(r),ge(r,279),r.end()}var pre=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function gre(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ea)||[]).forEach(function(s){var i=Ue(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[pre.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function vre(){}function yre(){}var bre=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,wre=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,jre=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Nre(e,t,r){t.themeElements={};var a;[["clrScheme",bre,gre],["fontScheme",wre,vre],["fmtScheme",jre,yre]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var _re=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function p4(e,t){(!e||e.length===0)&&(e=ag());var r,a={};if(!(r=e.match(_re)))throw new Error("themeElements not found in theme");return Nre(r[0],a,t),a.raw=e,a}function ag(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[or];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Sre(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var o;try{o=lS(i,{type:"array"})}catch{return}var l=ka(o,"theme/theme/theme1.xml",!0);if(l)return p4(l,r)}}function kre(e){return e.read_shift(4)}function Ere(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Are(e,4);break;case 2:t.xclrValue=XS(e);break;case 3:t.xclrValue=kre(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Are(e,t){return Zr(e,t)}function Tre(e,t){return Zr(e,t)}function Cre(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Ere(e);break;case 6:a[1]=Tre(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Ore(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),i=[];s-- >0;)i.push(Cre(e,r-e.l));return{ixfe:a,ext:i}}function Pre(e,t){t.forEach(function(r){switch(r[0]){}})}function Fre(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jr(e)}}function Ire(e){var t=de(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Or(e.name,t),t.slice(0,t.l)}function Dre(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Rre(e){var t=de(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Mre(e,t){var r=de(8+2*t.length);return r.write_shift(4,e),Or(t,r),r.slice(0,r.l)}function $re(e){return e.l+=4,e.read_shift(4)!=0}function Lre(e,t){var r=de(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Bre(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},i=[],o=!1,l=2;return ds(e,function(c,d,u){switch(u){case 335:a.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?a.Cell.push({type:a.Types[f[0]-1].name,index:f[1]}):l==0&&a.Value.push({type:a.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:i.push(u),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),a}function Ure(){var e=pa();return ge(e,332),ge(e,334,dn(1)),ge(e,335,Ire({name:"XLDAPR",version:12e4,flags:3496657072})),ge(e,336),ge(e,339,Mre(1,"XLDAPR")),ge(e,52),ge(e,35,dn(514)),ge(e,4096,dn(0)),ge(e,4097,Wa(1)),ge(e,36),ge(e,53),ge(e,340),ge(e,337,Lre(1)),ge(e,51,Rre([[1,0]])),ge(e,338),ge(e,333),e.end()}function Wre(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,i=2,o;return e.replace(ea,function(l){var c=Ue(l);switch(In(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<a.Types.length;++d)a.Types[d].name==c.name&&(o=a.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[c.t-1].name,index:+c.v}):i==0&&a.Value.push({type:a.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),a}function g4(){var e=[or];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Hre(e){var t=[];if(!e)return t;var r=1;return(e.match(ea)||[]).forEach(function(a){var s=Ue(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function zre(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Be(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function Vre(e,t,r){var a=[];return ds(e,function(i,o,l){switch(l){case 63:a.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),a}function Gre(e,t,r,a){if(!e)return e;var s=a||{},i=!1;ds(e,function(l,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!c.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function qre(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var co=1024;function v4(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[_e("xml",null,{"xmlns:v":ja.v,"xmlns:o":ja.o,"xmlns:x":ja.x,"xmlns:mv":ja.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];co<e*1e3;)co+=1e3;return t.forEach(function(i){var o=Yt(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=_e("v:fill",c,l),u={on:"t",obscured:"t"};++co,s=s.concat(["<v:shape"+Yc({id:"_x0000_s"+co,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,_e("v:shadow",null,u),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ur("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ur("x:AutoFill","False"),Ur("x:Row",String(o.r)),Ur("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Cw(e,t,r,a){var s=Array.isArray(e),i;t.forEach(function(o){var l=Yt(o.ref);if(s?(e[l.r]||(e[l.r]=[]),i=e[l.r][l.c]):i=e[o.ref],!i){i={t:"z"},s?e[l.r][l.c]=i:e[o.ref]=i;var c=ht(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var d=Ke(c);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&a){for(f=0;f<a.length;++f)if(u.a==a[f].id){u.a=a[f].name||u.a;break}}i.c.push(u)})}function Kre(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Ue(l[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=Yt(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&eg(f[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=h.h),a.push(d)}}}}),a}function y4(e){var t=[or,_e("comments",null,{xmlns:Bi[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(s){var i=Et(s.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var s=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(c){c.a&&(s=r.indexOf(Et(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),i.length<=1)t.push(Ur("t",Et(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;t.push(Ur("t",Et(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Xre(e,t){var r=[],a=!1,s={},i=0;return e.replace(ea,function(l,c){var d=Ue(l);switch(In(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=c+l.length;break;case"</text>":s.t=e.slice(i,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return l}),r}function Yre(e,t,r){var a=[or,_e("ThreadedComments",null,{xmlns:vr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var i="";(s[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(_e("threadedComment",Ur("text",o.t||""),c))})}),a.push("</ThreadedComments>"),a.join("")}function Jre(e,t){var r=[],a=!1;return e.replace(ea,function(i){var o=Ue(i);switch(In(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function Zre(e){var t=[or,_e("personList",null,{xmlns:vr.TCMNT,"xmlns:x":Bi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(_e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Qre(e){var t={};t.iauthor=e.read_shift(4);var r=zi(e);return t.rfx=r.s,t.ref=Be(r.s),e.l+=16,t}function eae(e,t){return t==null&&(t=de(36)),t.write_shift(4,e[1].iauthor),il(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var tae=Jr;function rae(e){return Or(e.slice(0,54))}function aae(e,t){var r=[],a=[],s={},i=!1;return ds(e,function(l,c,d){switch(d){case 632:a.push(l);break;case 635:s=l;break;case 637:s.t=l.t,s.h=l.h,s.r=l.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function nae(e){var t=pa(),r=[];return ge(t,628),ge(t,630),e.forEach(function(a){a[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ge(t,632,rae(s.a)))})}),ge(t,631),ge(t,633),e.forEach(function(a){a[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var i={s:Yt(a[0]),e:Yt(a[0])};ge(t,635,eae([i,s])),s.t&&s.t.length>0&&ge(t,637,kZ(s)),ge(t,636),delete s.iauthor})}),ge(t,634),ge(t,629),t.end()}var sae="application/vnd.ms-office.vbaProject";function iae(e){var t=Ie.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ie.utils.cfb_add(t,s,e.FileIndex[a].content)}}),Ie.write(t)}function oae(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ie.utils.cfb_add(e,s,t.FileIndex[a].content)}})}var b4=["xlsb","xlsm","xlam","biff8","xla"];function lae(){return{"!type":"dialog"}}function cae(){return{"!type":"dialog"}}function dae(){return{"!type":"macro"}}function uae(){return{"!type":"macro"}}var po=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return l?u+=t.c:--u,c?d+=t.r:--d,s+(l?"":"$")+Xt(u)+(c?"":"$")+ir(d)}return function(s,i){return t=i,s.replace(e,r)}}(),ng=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sg=function(){return function(t,r){return t.replace(ng,function(a,s,i,o,l,c){var d=Vp(o)-(i?0:r.c),u=zp(c)-(l?0:r.r),f=u==0?"":l?u+1:"["+u+"]",h=d==0?"":i?d+1:"["+d+"]";return s+"R"+f+"C"+h})}}();function w4(e,t){return e.replace(ng,function(r,a,s,i,o,l){return a+(s=="$"?s+i:Xt(Vp(i)+t.c))+(o=="$"?o+l:ir(zp(l)+t.r))})}function fae(e,t,r){var a=va(t),s=a.s,i=Yt(r),o={r:i.r-s.r,c:i.c-s.c};return w4(e,o)}function hae(e){return e.length!=1}function Ow(e){return e.replace(/_xlfn\./g,"")}function lr(e){e.l+=1}function Ps(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function j4(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return N4(e);r.biff==12&&(a=4)}var s=e.read_shift(a),i=e.read_shift(a),o=Ps(e),l=Ps(e);return{s:{r:s,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function N4(e){var t=Ps(e),r=Ps(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function mae(e,t,r){if(r.biff<8)return N4(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),i=Ps(e),o=Ps(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function _4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return xae(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Ps(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function xae(e){var t=Ps(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function pae(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function gae(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return vae(e);var s=e.read_shift(a>=12?4:2),i=e.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;s>524287;)s-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:o,rRel:l}}function vae(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function yae(e,t,r){var a=(e[e.l++]&96)>>5,s=j4(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function bae(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var o=j4(e,i,r);return[a,s,o]}function wae(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function jae(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,s]}function Nae(e,t,r){var a=(e[e.l++]&96)>>5,s=mae(e,t-1,r);return[a,s]}function _ae(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Pw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Sae(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=a;++i)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function kae(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Eae(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Aae(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Tae(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function S4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Cae(e){return e.read_shift(2),S4(e)}function Oae(e){return e.read_shift(2),S4(e)}function Pae(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=_4(e,0,r);return[a,s]}function Fae(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=gae(e,0,r);return[a,s]}function Iae(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=_4(e,0,r);return[a,s,i]}function Dae(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[$ne[s],A4[s],a]}function Rae(e,t,r){var a=e[e.l++],s=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Mae(e);return[s,(i[0]===0?A4:Mne)[i[1]]]}function Mae(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function $ae(e,t,r){e.l+=r&&r.biff==2?3:4}function Lae(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Bae(e){return e.l++,us[e.read_shift(1)]}function Uae(e){return e.l++,e.read_shift(2)}function Wae(e){return e.l++,e.read_shift(1)!==0}function Hae(e){return e.l++,Yr(e)}function zae(e,t,r){return e.l++,Sd(e,t-1,r)}function Vae(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=rr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=us[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Yr(e);break;case 2:r[1]=Vi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Gae(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],i=0;i!=a;++i)s.push((r.biff==12?zi:k0)(e));return s}function qae(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var i=0,o=[];i!=a&&(o[i]=[]);++i)for(var l=0;l!=s;++l)o[i][l]=Vae(e,r.biff);return o}function Kae(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function Xae(e,t,r){if(r.biff==5)return Yae(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),i=e.read_shift(4);return[a,s,i]}function Yae(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function Jae(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Zae(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function Qae(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function ene(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,s]}var tne=Zr,rne=Zr,ane=Zr;function Ed(e,t,r){return e.l+=2,[pae(e)]}function ig(e){return e.l+=6,[]}var nne=Ed,sne=ig,ine=ig,one=Ed;function k4(e){return e.l+=2,[dr(e),e.read_shift(2)&1]}var lne=Ed,cne=k4,dne=ig,une=Ed,fne=Ed,hne=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function mne(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),i=e.read_shift(2),o=hne[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:s,C:i}}function xne(e){return e.l+=2,[e.read_shift(4)]}function pne(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function gne(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function vne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function yne(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function bne(e){return e.l+=4,[0,0]}var Fw={1:{n:"PtgExp",f:Lae},2:{n:"PtgTbl",f:ane},3:{n:"PtgAdd",f:lr},4:{n:"PtgSub",f:lr},5:{n:"PtgMul",f:lr},6:{n:"PtgDiv",f:lr},7:{n:"PtgPower",f:lr},8:{n:"PtgConcat",f:lr},9:{n:"PtgLt",f:lr},10:{n:"PtgLe",f:lr},11:{n:"PtgEq",f:lr},12:{n:"PtgGe",f:lr},13:{n:"PtgGt",f:lr},14:{n:"PtgNe",f:lr},15:{n:"PtgIsect",f:lr},16:{n:"PtgUnion",f:lr},17:{n:"PtgRange",f:lr},18:{n:"PtgUplus",f:lr},19:{n:"PtgUminus",f:lr},20:{n:"PtgPercent",f:lr},21:{n:"PtgParen",f:lr},22:{n:"PtgMissArg",f:lr},23:{n:"PtgStr",f:zae},26:{n:"PtgSheet",f:pne},27:{n:"PtgEndSheet",f:gne},28:{n:"PtgErr",f:Bae},29:{n:"PtgBool",f:Wae},30:{n:"PtgInt",f:Uae},31:{n:"PtgNum",f:Hae},32:{n:"PtgArray",f:_ae},33:{n:"PtgFunc",f:Dae},34:{n:"PtgFuncVar",f:Rae},35:{n:"PtgName",f:Kae},36:{n:"PtgRef",f:Pae},37:{n:"PtgArea",f:yae},38:{n:"PtgMemArea",f:Jae},39:{n:"PtgMemErr",f:tne},40:{n:"PtgMemNoMem",f:rne},41:{n:"PtgMemFunc",f:Zae},42:{n:"PtgRefErr",f:Qae},43:{n:"PtgAreaErr",f:wae},44:{n:"PtgRefN",f:Fae},45:{n:"PtgAreaN",f:Nae},46:{n:"PtgMemAreaN",f:vne},47:{n:"PtgMemNoMemN",f:yne},57:{n:"PtgNameX",f:Xae},58:{n:"PtgRef3d",f:Iae},59:{n:"PtgArea3d",f:bae},60:{n:"PtgRefErr3d",f:ene},61:{n:"PtgAreaErr3d",f:jae},255:{}},wne={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jne={1:{n:"PtgElfLel",f:k4},2:{n:"PtgElfRw",f:une},3:{n:"PtgElfCol",f:nne},6:{n:"PtgElfRwV",f:fne},7:{n:"PtgElfColV",f:one},10:{n:"PtgElfRadical",f:lne},11:{n:"PtgElfRadicalS",f:dne},13:{n:"PtgElfColS",f:sne},15:{n:"PtgElfColSV",f:ine},16:{n:"PtgElfRadicalLel",f:cne},25:{n:"PtgList",f:mne},29:{n:"PtgSxName",f:xne},255:{}},Nne={0:{n:"PtgAttrNoop",f:bne},1:{n:"PtgAttrSemi",f:Tae},2:{n:"PtgAttrIf",f:Eae},4:{n:"PtgAttrChoose",f:Sae},8:{n:"PtgAttrGoto",f:kae},16:{n:"PtgAttrSum",f:$ae},32:{n:"PtgAttrBaxcel",f:Pw},33:{n:"PtgAttrBaxcel",f:Pw},64:{n:"PtgAttrSpace",f:Cae},65:{n:"PtgAttrSpaceSemi",f:Oae},128:{n:"PtgAttrIfError",f:Aae},255:{}};function Ad(e,t,r,a){if(a.biff<8)return Zr(e,t);for(var s=e.l+t,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=qae(e,0,a),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Gae(e,r[o][1],a),i.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=s-e.l,t!==0&&i.push(Zr(e,t)),i}function Td(e,t,r){for(var a=e.l+t,s,i,o=[];a!=e.l;)t=a-e.l,i=e[e.l],s=Fw[i]||Fw[wne[i]],(i===24||i===25)&&(s=(i===24?jne:Nne)[e[e.l+1]]),!s||!s.f?Zr(e,t):o.push([s.n,s.f(e,t,r)]);return o}function _ne(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],i=0;i<a.length;++i){var o=a[i];if(o)switch(o[0]){case 2:s.push('"'+o[1].replace(/"/g,'""')+'"');break;default:s.push(o[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Sne={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function kne(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function E4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function Iw(e,t,r){var a=E4(e,t,r);return a=="#REF"?a:kne(a,r)}function Kr(e,t,r,a,s){var i=s&&s.biff||8,o={s:{c:0,r:0}},l=[],c,d,u,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",y=0,b=e[0].length;y<b;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Zt(" ",e[0][p][1][1]);break;case 1:g=Zt("\r",e[0][p][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}d=d+g,p=-1}l.push(d+Sne[v[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ql(v[1][1],o,s),l.push(Kl(u,i));break;case"PtgRefN":u=r?ql(v[1][1],r,s):v[1][1],l.push(Kl(u,i));break;case"PtgRef3d":f=v[1][1],u=ql(v[1][2],o,s),x=Iw(a,f,s),l.push(x+"!"+Kl(u,i));break;case"PtgFunc":case"PtgFuncVar":var w=v[1][0],j=v[1][1];w||(w=0),w&=127;var N=w==0?[]:l.slice(-w);l.length-=w,j==="User"&&(j=N.shift()),l.push(j+"("+N.join(",")+")");break;case"PtgBool":l.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(v[1]);break;case"PtgNum":l.push(String(v[1]));break;case"PtgStr":l.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(v[1]);break;case"PtgAreaN":m=cw(v[1][1],r?{s:r}:o,s),l.push(fh(m,s));break;case"PtgArea":m=cw(v[1][1],o,s),l.push(fh(m,s));break;case"PtgArea3d":f=v[1][1],m=v[1][2],x=Iw(a,f,s),l.push(x+"!"+fh(m,s));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var _=(a.names||[])[h-1]||(a[0]||[])[h],E=_?_.Name:"SH33TJSNAME"+String(h);E&&E.slice(0,6)=="_xlfn."&&!s.xlfn&&(E=E.slice(6)),l.push(E);break;case"PtgNameX":var S=v[1][1];h=v[1][2];var k;if(s.biff<=5)S<0&&(S=-S),a[S]&&(k=a[S][h]);else{var O="";if(((a[S]||[])[0]||[])[0]==14849||(((a[S]||[])[0]||[])[0]==1025?a[S][h]&&a[S][h].itab>0&&(O=a.SheetNames[a[S][h].itab-1]+"!"):O=a.SheetNames[h-1]+"!"),a[S]&&a[S][h])O+=a[S][h].Name;else if(a[0]&&a[0][h])O+=a[0][h].Name;else{var P=(E4(a,S,s)||"").split(";;");P[h-1]?O=P[h-1]:O+="SH33TJSERRX"}l.push(O);break}k||(k={Name:"SH33TJSERRY"}),l.push(k.Name);break;case"PtgParen":var A="(",R=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:A=Zt(" ",e[0][p][1][1])+A;break;case 3:A=Zt("\r",e[0][p][1][1])+A;break;case 4:R=Zt(" ",e[0][p][1][1])+R;break;case 5:R=Zt("\r",e[0][p][1][1])+R;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}l.push(A+l.pop()+R);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var T={c:r.c,r:r.r};if(a.sharedf[Be(u)]){var F=a.sharedf[Be(u)];l.push(Kr(F,o,T,a,s))}else{var W=!1;for(c=0;c!=a.arrayf.length;++c)if(d=a.arrayf[c],!(u.c<d[0].s.c||u.c>d[0].e.c)&&!(u.r<d[0].s.r||u.r>d[0].e.r)){l.push(Kr(d[1],o,T,a,s)),W=!0;break}W||l.push(v[1])}break;case"PtgArray":l.push("{"+_ne(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&K.indexOf(e[0][y][0])==-1){v=e[0][p];var B=!0;switch(v[1][0]){case 4:B=!1;case 0:g=Zt(" ",v[1][1]);break;case 5:B=!1;case 1:g=Zt("\r",v[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}l.push((B?g:"")+l.pop()+(B?"":g)),p=-1}}if(l.length>1&&s.WTF)throw new Error("bad formula stack");return l[0]}function Ene(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Zr(e,t-2)];var l=Td(e,o,r);return t!==o+s&&(i=Ad(e,t-o-s,l,r)),e.l=a,[l,i]}function Ane(e,t,r){var a=e.l+t,s=r.biff==2?1:2,i,o=e.read_shift(s);if(o==65535)return[[],Zr(e,t-2)];var l=Td(e,o,r);return t!==o+s&&(i=Ad(e,t-o-s,l,r)),e.l=a,[l,i]}function Tne(e,t,r,a){var s=e.l+t,i=Td(e,a,r),o;return s!==e.l&&(o=Ad(e,s-e.l,i,r)),[i,o]}function Cne(e,t,r){var a=e.l+t,s,i=e.read_shift(2),o=Td(e,i,r);return i==65535?[[],Zr(e,t-2)]:(t!==i+2&&(s=Ad(e,a-i-2,o,r)),[o,s])}function One(e){var t;if(Gn(e,e.l+6)!==65535)return[Yr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Pne(e){if(e==null){var t=de(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ai(e);return Ai(0)}function gh(e,t,r){var a=e.l+t,s=Dn(e);r.biff==2&&++e.l;var i=One(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Ane(e,a-e.l,r);return{cell:s,val:i[0],formula:l,shared:o>>3&1,tt:i[1]}}function Fne(e,t,r,a,s){var i=Ci(t,r,s),o=Pne(e.v),l=de(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=de(e.bf.length),u=0;u<e.bf.length;++u)d[u]=e.bf[u];var f=Tr([i,o,l,d]);return f}function E0(e,t,r){var a=e.read_shift(4),s=Td(e,a,r),i=e.read_shift(4),o=i>0?Ad(e,i,s,r):null;return[s,o]}var Ine=E0,A0=E0,Dne=E0,Rne=E0,Mne={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},A4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$ne={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Dw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Lne(e){var t="of:="+e.replace(ng,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function vh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Bne(e){return e.replace(/\./,"!")}var Yl={},go={},Jl=typeof Map<"u";function og(e,t,r){var a=0,s=e.length;if(r){if(Jl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Jl?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<s;++a)if(e[a].t===t)return e.Count++,a;return e[s]={t},e.Count++,e.Unique++,r&&(Jl?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function T0(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Xr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=td(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=bf(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function pi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Hs(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],s=60,i=e.length;if(a==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Yn(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=a=s;break}}for(s=0;s!=i;++s)if(e[s].numFmtId===a)return s;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function T4(e,t,r,a,s,i){try{a.cellNF&&(e.z=Le[t])}catch(l){if(a.WTF)throw l}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Lt(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Le[t]==null&&Yn(MJ[t]||"General",t),e.t==="e")e.w=e.w||us[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Kc(e.v);else if(e.t==="d"){var o=jr(e.v);(o|0)===o?e.w=o.toString(10):e.w=Kc(o)}else{if(e.v===void 0)return"";e.w=ki(e.v,go)}else e.t==="d"?e.w=Ya(t,jr(e.v),go):e.w=Ya(t,e.v,go)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=yf(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=yf(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&i.Fills)throw l}}}function Une(e,t,r){if(e&&e["!ref"]){var a=ht(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Wne(e,t){var r=ht(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ke(r))}var Hne=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,zne=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Vne=/<(?:\w:)?hyperlink [^>]*>/mg,Gne=/"(\w*:\w*)"/,qne=/<(?:\w:)?col\b[^>]*[\/]?>/g,Kne=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Xne=/<(?:\w:)?pageMargins[^>]*\/>/g,C4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Yne=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Jne=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Zne(e,t,r,a,s,i,o){if(!e)return e;a||(a={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",u="",f=e.match(zne);f?(d=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):d=u=e;var h=d.match(C4);h?lg(h[0],l,s,r):(h=d.match(Yne))&&ese(h[0],h[1]||"",l,s,r);var m=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=d.slice(m,m+50).match(Gne);x&&Wne(l,x[1])}var p=d.match(Jne);p&&p[1]&&hse(p[1],s);var g=[];if(t.cellStyles){var y=d.match(qne);y&&lse(g,y)}f&&pse(f[1],l,t,c,i,o);var b=u.match(Kne);b&&(l["!autofilter"]=dse(b[0]));var v=[],w=u.match(Hne);if(w)for(m=0;m!=w.length;++m)v[m]=ht(w[m].slice(w[m].indexOf('"')+1));var j=u.match(Vne);j&&sse(l,j,a);var N=u.match(Xne);if(N&&(l["!margins"]=ise(Ue(N[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Ke(c)),t.sheetRows>0&&l["!ref"]){var _=ht(l["!ref"]);t.sheetRows<=+_.e.r&&(_.e.r=t.sheetRows-1,_.e.r>c.e.r&&(_.e.r=c.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>c.e.c&&(_.e.c=c.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ke(_))}return g.length>0&&(l["!cols"]=g),v.length>0&&(l["!merges"]=v),l}function Qne(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ke(e[r])+'"/>';return t+"</mergeCells>"}function lg(e,t,r,a){var s=Ue(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=ut(Ct(s.codeName)))}function ese(e,t,r,a,s){lg(e.slice(0,e.indexOf(">")),r,a,s)}function tse(e,t,r,a,s){var i=!1,o={},l=null;if(a.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,o.codeName=Nn(Et(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),l=(l||"")+_e("outlinePr",null,d)}!i&&!l||(s[s.length]=_e("sheetPr",l,o))}var rse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ase=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function nse(e){var t={sheet:1};return rse.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),ase.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=tg(e.password).toString(16).toUpperCase()),_e("sheetProtection",null,t)}function sse(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var i=Ue(Ct(t[s]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+ut(i.location))):(i.Target="#"+ut(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var l=ht(i.ref),c=l.s.r;c<=l.e.r;++c)for(var d=l.s.c;d<=l.e.c;++d){var u=Be({c:d,r:c});a?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function ise(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function ose(e){return pi(e),_e("pageMargins",null,e)}function lse(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=Ue(t[a],!0);s.hidden&&(s.hidden=$t(s.hidden));var i=parseInt(s.min,10)-1,o=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,rg(s.width)),Os(s);i<=o;)e[i++]=Bt(s)}}function cse(e,t){for(var r=["<cols>"],a,s=0;s!=t.length;++s)(a=t[s])&&(r[r.length]=_e("col",null,T0(s,a)));return r[r.length]="</cols>",r.join("")}function dse(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function use(e,t,r,a){var s=typeof e.ref=="string"?e.ref:Ke(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=va(s);o.s.r==o.e.r&&(o.e.r=va(t["!ref"]).e.r,s=Ke(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==a){c.Ref="'"+r.SheetNames[a]+"'!"+s;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),_e("autoFilter",null,{ref:s})}var fse=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function hse(e,t){t.Views||(t.Views=[{}]),(e.match(fse)||[]).forEach(function(r,a){var s=Ue(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),$t(s.rightToLeft)&&(t.Views[a].RTL=!0)})}function mse(e,t,r,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,s),{})}function xse(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",i=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=us[e.v];break;case"d":a&&a.cellDates?s=Lt(e.v,-1).toISOString():(e=Bt(e),e.t="n",s=""+(e.v=jr(Lt(e.v)))),typeof e.z>"u"&&(e.z=Le[14]);break;default:s=e.v;break}var l=Ur("v",Et(s)),c={r:t},d=Hs(a.cellXfs,e,a);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){l=Ur("v",""+og(a.Strings,e.v,a.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=_e("f",Et(e.f),u)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),_e("c",l,c)}var pse=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Xc("v"),o=Xc("f");return function(c,d,u,f,h,m){for(var x=0,p="",g=[],y=[],b=0,v=0,w=0,j="",N,_,E=0,S=0,k,O,P=0,A=0,R=Array.isArray(m.CellXf),T,F=[],W=[],K=Array.isArray(d),B=[],L={},ee=!1,M=!!u.sheetStubs,G=c.split(t),V=0,H=G.length;V!=H;++V){p=G[V].trim();var re=p.length;if(re!==0){var me=0;e:for(x=0;x<re;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(u&&u.cellStyles){if(_=Ue(p.slice(me,x),!0),E=_.r!=null?parseInt(_.r,10):E+1,S=-1,u.sheetRows&&u.sheetRows<E)continue;L={},ee=!1,_.ht&&(ee=!0,L.hpt=parseFloat(_.ht),L.hpx=Uo(L.hpt)),_.hidden=="1"&&(ee=!0,L.hidden=!0),_.outlineLevel!=null&&(ee=!0,L.level=+_.outlineLevel),ee&&(B[E-1]=L)}break;case"<":me=x;break}if(me>=x)break;if(_=Ue(p.slice(me,x),!0),E=_.r!=null?parseInt(_.r,10):E+1,S=-1,!(u.sheetRows&&u.sheetRows<E)){f.s.r>E-1&&(f.s.r=E-1),f.e.r<E-1&&(f.e.r=E-1),u&&u.cellStyles&&(L={},ee=!1,_.ht&&(ee=!0,L.hpt=parseFloat(_.ht),L.hpx=Uo(L.hpt)),_.hidden=="1"&&(ee=!0,L.hidden=!0),_.outlineLevel!=null&&(ee=!0,L.level=+_.outlineLevel),ee&&(B[E-1]=L)),g=p.slice(x).split(e);for(var xe=0;xe!=g.length&&g[xe].trim().charAt(0)=="<";++xe);for(g=g.slice(xe),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(y=p.match(r),b=x,v=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(b=0,j=y[1],v=0;v!=j.length&&!((w=j.charCodeAt(v)-64)<1||w>26);++v)b=26*b+w;--b,S=b}else++S;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,_=Ue(p.slice(0,v),!0),_.r||(_.r=Be({r:E-1,c:S})),j=p.slice(v),N={t:""},(y=j.match(i))!=null&&y[1]!==""&&(N.v=ut(y[1])),u.cellFormula){if((y=j.match(o))!=null&&y[1]!==""){if(N.f=ut(Ct(y[1])).replace(/\r\n/g,`
`),u.xlfn||(N.f=Ow(N.f)),y[0].indexOf('t="array"')>-1)N.F=(j.match(s)||[])[1],N.F.indexOf(":")>-1&&F.push([ht(N.F),N.F]);else if(y[0].indexOf('t="shared"')>-1){O=Ue(y[0]);var Z=ut(Ct(y[1]));u.xlfn||(Z=Ow(Z)),W[parseInt(O.si,10)]=[O,Z,_.r]}}else(y=j.match(/<f[^>]*\/>/))&&(O=Ue(y[0]),W[O.si]&&(N.f=fae(W[O.si][1],W[O.si][2],_.r)));var q=Yt(_.r);for(v=0;v<F.length;++v)q.r>=F[v][0].s.r&&q.r<=F[v][0].e.r&&q.c>=F[v][0].s.c&&q.c<=F[v][0].e.c&&(N.F=F[v][1])}if(_.t==null&&N.v===void 0)if(N.f||N.F)N.v=0,N.t="n";else if(M)N.t="z";else continue;else N.t=_.t||"n";switch(f.s.c>S&&(f.s.c=S),f.e.c<S&&(f.e.c=S),N.t){case"n":if(N.v==""||N.v==null){if(!M)continue;N.t="z"}else N.v=parseFloat(N.v);break;case"s":if(typeof N.v>"u"){if(!M)continue;N.t="z"}else k=Yl[parseInt(N.v,10)],N.v=k.t,N.r=k.r,u.cellHTML&&(N.h=k.h);break;case"str":N.t="s",N.v=N.v!=null?Ct(N.v):"",u.cellHTML&&(N.h=Bp(N.v));break;case"inlineStr":y=j.match(a),N.t="s",y!=null&&(k=eg(y[1]))?(N.v=k.t,u.cellHTML&&(N.h=k.h)):N.v="";break;case"b":N.v=$t(N.v);break;case"d":u.cellDates?N.v=Lt(N.v,1):(N.v=jr(Lt(N.v,1)),N.t="n");break;case"e":(!u||u.cellText!==!1)&&(N.w=N.v),N.v=PS[N.v];break}if(P=A=0,T=null,R&&_.s!==void 0&&(T=m.CellXf[_.s],T!=null&&(T.numFmtId!=null&&(P=T.numFmtId),u.cellStyles&&T.fillId!=null&&(A=T.fillId))),T4(N,P,A,u,h,m),u.cellDates&&R&&N.t=="n"&&al(Le[P])&&(N.t="d",N.v=S0(N.v)),_.cm&&u.xlmeta){var ie=(u.xlmeta.Cell||[])[+_.cm-1];ie&&ie.type=="XLDAPR"&&(N.D=!0)}if(K){var I=Yt(_.r);d[I.r]||(d[I.r]=[]),d[I.r][I.c]=N}else d[_.r]=N}}}}B.length>0&&(d["!rows"]=B)}}();function gse(e,t,r,a){var s=[],i=[],o=ht(e["!ref"]),l="",c,d="",u=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:d},g,y=-1;for(h=o.s.c;h<=o.e.c;++h)u[h]=Xt(h);for(f=o.s.r;f<=o.e.r;++f){for(i=[],d=ir(f),h=o.s.c;h<=o.e.c;++h){c=u[h]+d;var b=x?(e[f]||[])[h]:e[c];b!==void 0&&(l=xse(b,c,e,t))!=null&&i.push(l)}(i.length>0||m&&m[f])&&(p={r:d},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=rd(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),s[s.length]=_e("row",i.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=rd(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level),s[s.length]=_e("row","",p));return s.join("")}function O4(e,t,r,a){var s=[or,_e("worksheet",null,{xmlns:Bi[0],"xmlns:r":vr.r})],i=r.SheetNames[e],o=0,l="",c=r.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",u=ht(d);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),d=Ke(u)}a||(a={}),c["!comments"]=[];var f=[];tse(c,r,e,t,s),s[s.length]=_e("dimension",null,{ref:d}),s[s.length]=mse(c,t,e,r),t.sheetFormat&&(s[s.length]=_e("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=cse(c,c["!cols"])),s[o=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=gse(c,t),l.length>0&&(s[s.length]=l)),s.length>o+1&&(s[s.length]="</sheetData>",s[o]=s[o].replace("/>",">")),c["!protect"]&&(s[s.length]=nse(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=use(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Qne(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=kt(a,-1,Et(p[1].Target).replace(/#.*$/,""),nt.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=Et(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=Et(p[1].Tooltip)),s[s.length]=_e("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=ose(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=Ur("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(x=kt(a,-1,"../drawings/drawing"+(e+1)+".xml",nt.DRAW),s[s.length]=_e("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=kt(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",nt.VML),s[s.length]=_e("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function vse(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}function yse(e,t,r){var a=de(145),s=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;s.hpx?i=rd(s.hpx)*20:s.hpt&&(i=s.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var o=0;s.level&&(o|=s.level),s.hidden&&(o|=16),(s.hpx||s.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var l=0,c=a.l;a.l+=4;for(var d={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var f=-1,h=-1,m=u<<10;m<u+1<<10;++m){d.c=m;var x=Array.isArray(r)?(r[d.r]||[])[d.c]:r[Be(d)];x&&(f<0&&(f=m),h=m)}f<0||(++l,a.write_shift(4,f),a.write_shift(4,h))}var p=a.l;return a.l=c,a.write_shift(4,l),a.l=p,a.length>a.l?a.slice(0,a.l):a}function bse(e,t,r,a){var s=yse(a,r,t);(s.length>17||(t["!rows"]||[])[a])&&ge(e,0,s)}var wse=zi,jse=il;function Nse(){}function _se(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=EZ(e),r}function Sse(e,t,r){r==null&&(r=de(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var s=1;s<3;++s)r.write_shift(1,0);return pf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ES(e,r),r.slice(0,r.l)}function kse(e){var t=Za(e);return[t]}function Ese(e,t,r){return r==null&&(r=de(8)),Ui(t,r)}function Ase(e){var t=Wi(e);return[t]}function Tse(e,t,r){return r==null&&(r=de(4)),Hi(t,r)}function Cse(e){var t=Za(e),r=e.read_shift(1);return[t,r,"b"]}function Ose(e,t,r){return r==null&&(r=de(9)),Ui(t,r),r.write_shift(1,e.v?1:0),r}function Pse(e){var t=Wi(e),r=e.read_shift(1);return[t,r,"b"]}function Fse(e,t,r){return r==null&&(r=de(5)),Hi(t,r),r.write_shift(1,e.v?1:0),r}function Ise(e){var t=Za(e),r=e.read_shift(1);return[t,r,"e"]}function Dse(e,t,r){return r==null&&(r=de(9)),Ui(t,r),r.write_shift(1,e.v),r}function Rse(e){var t=Wi(e),r=e.read_shift(1);return[t,r,"e"]}function Mse(e,t,r){return r==null&&(r=de(8)),Hi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function $se(e){var t=Za(e),r=e.read_shift(4);return[t,r,"s"]}function Lse(e,t,r){return r==null&&(r=de(12)),Ui(t,r),r.write_shift(4,t.v),r}function Bse(e){var t=Wi(e),r=e.read_shift(4);return[t,r,"s"]}function Use(e,t,r){return r==null&&(r=de(8)),Hi(t,r),r.write_shift(4,t.v),r}function Wse(e){var t=Za(e),r=Yr(e);return[t,r,"n"]}function Hse(e,t,r){return r==null&&(r=de(16)),Ui(t,r),Ai(e.v,r),r}function P4(e){var t=Wi(e),r=Yr(e);return[t,r,"n"]}function zse(e,t,r){return r==null&&(r=de(12)),Hi(t,r),Ai(e.v,r),r}function Vse(e){var t=Za(e),r=Xp(e);return[t,r,"n"]}function Gse(e,t,r){return r==null&&(r=de(12)),Ui(t,r),AS(e.v,r),r}function qse(e){var t=Wi(e),r=Xp(e);return[t,r,"n"]}function Kse(e,t,r){return r==null&&(r=de(8)),Hi(t,r),AS(e.v,r),r}function Xse(e){var t=Za(e),r=Gp(e);return[t,r,"is"]}function Yse(e){var t=Za(e),r=Jr(e);return[t,r,"str"]}function Jse(e,t,r){return r==null&&(r=de(12+4*e.v.length)),Ui(t,r),Or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Zse(e){var t=Wi(e),r=Jr(e);return[t,r,"str"]}function Qse(e,t,r){return r==null&&(r=de(8+4*e.v.length)),Hi(t,r),Or(e.v,r),r.length>r.l?r.slice(0,r.l):r}function eie(e,t,r){var a=e.l+t,s=Za(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"b"];if(r.cellFormula){e.l+=2;var l=A0(e,a-e.l,r);o[3]=Kr(l,null,s,r.supbooks,r)}else e.l=a;return o}function tie(e,t,r){var a=e.l+t,s=Za(e);s.r=r["!row"];var i=e.read_shift(1),o=[s,i,"e"];if(r.cellFormula){e.l+=2;var l=A0(e,a-e.l,r);o[3]=Kr(l,null,s,r.supbooks,r)}else e.l=a;return o}function rie(e,t,r){var a=e.l+t,s=Za(e);s.r=r["!row"];var i=Yr(e),o=[s,i,"n"];if(r.cellFormula){e.l+=2;var l=A0(e,a-e.l,r);o[3]=Kr(l,null,s,r.supbooks,r)}else e.l=a;return o}function aie(e,t,r){var a=e.l+t,s=Za(e);s.r=r["!row"];var i=Jr(e),o=[s,i,"str"];if(r.cellFormula){e.l+=2;var l=A0(e,a-e.l,r);o[3]=Kr(l,null,s,r.supbooks,r)}else e.l=a;return o}var nie=zi,sie=il;function iie(e,t){return t==null&&(t=de(4)),t.write_shift(4,e),t}function oie(e,t){var r=e.l+t,a=zi(e),s=qp(e),i=Jr(e),o=Jr(e),l=Jr(e);e.l=r;var c={rfx:a,relId:s,loc:i,display:l};return o&&(c.Tooltip=o),c}function lie(e,t){var r=de(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));il({s:Yt(e[0]),e:Yt(e[0])},r),Kp("rId"+t,r);var a=e[1].Target.indexOf("#"),s=a==-1?"":e[1].Target.slice(a+1);return Or(s||"",r),Or(e[1].Tooltip||"",r),Or("",r),r.slice(0,r.l)}function cie(){}function die(e,t,r){var a=e.l+t,s=TS(e),i=e.read_shift(1),o=[s];if(o[2]=i,r.cellFormula){var l=Ine(e,a-e.l,r);o[1]=l}else e.l=a;return o}function uie(e,t,r){var a=e.l+t,s=zi(e),i=[s];if(r.cellFormula){var o=Rne(e,a-e.l,r);i[1]=o,e.l=a}else e.l=a;return i}function fie(e,t,r){r==null&&(r=de(18));var a=T0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var F4=["left","right","top","bottom","header","footer"];function hie(e){var t={};return F4.forEach(function(r){t[r]=Yr(e)}),t}function mie(e,t){return t==null&&(t=de(6*8)),pi(e),F4.forEach(function(r){Ai(e[r],t)}),t}function xie(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function pie(e,t,r){r==null&&(r=de(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function gie(e){var t=de(24);return t.write_shift(4,4),t.write_shift(4,1),il(e,t),t}function vie(e,t){return t==null&&(t=de(16*4+2)),t.write_shift(2,e.password?tg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function yie(){}function bie(){}function wie(e,t,r,a,s,i,o){if(!e)return e;var l=t||{};a||(a={"!id":{}});var c=l.dense?[]:{},d,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,y,b,v,w,j,N=[];l.biff=12,l["!row"]=0;var _=0,E=!1,S=[],k={},O=l.supbooks||s.supbooks||[[]];if(O.sharedf=k,O.arrayf=S,O.SheetNames=s.SheetNames||s.Sheets.map(function(K){return K.name}),!l.supbooks&&(l.supbooks=O,s.Names))for(var P=0;P<s.Names.length;++P)O[0][P+1]=s.Names[P];var A=[],R=[],T=!1;ad[16]={n:"BrtShortReal",f:P4};var F;if(ds(e,function(B,L,ee){if(!h)switch(ee){case 148:d=B;break;case 0:m=B,l.sheetRows&&l.sheetRows<=m.r&&(h=!0),w=ir(g=m.r),l["!row"]=m.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=Uo(B.hpt)),R[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:B[2]},B[2]){case"n":x.v=B[1];break;case"s":v=Yl[B[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!B[1];break;case"e":x.v=B[1],l.cellText!==!1&&(x.w=us[x.v]);break;case"str":x.t="s",x.v=B[1];break;case"is":x.t="s",x.v=B[1].t;break}if((p=o.CellXf[B[0].iStyleRef])&&T4(x,p.numFmtId,null,l,i,o),y=B[0].c==-1?y+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[Xt(y)+w]=x,l.cellFormula){for(E=!1,_=0;_<S.length;++_){var M=S[_];m.r>=M[0].s.r&&m.r<=M[0].e.r&&y>=M[0].s.c&&y<=M[0].e.c&&(x.F=Ke(M[0]),E=!0)}!E&&B.length>3&&(x.f=B[3])}if(u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),l.cellDates&&p&&x.t=="n"&&al(Le[p.numFmtId])){var G=oi(x.v);G&&(x.t="d",x.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}F&&(F.type=="XLDAPR"&&(x.D=!0),F=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;x={t:"z",v:void 0},y=B[0].c==-1?y+1:B[0].c,l.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[Xt(y)+w]=x,u.s.r>m.r&&(u.s.r=m.r),u.s.c>y&&(u.s.c=y),u.e.r<m.r&&(u.e.r=m.r),u.e.c<y&&(u.e.c=y),F&&(F.type=="XLDAPR"&&(x.D=!0),F=void 0);break;case 176:N.push(B);break;case 49:F=((l.xlmeta||{}).Cell||[])[B-1];break;case 494:var V=a["!id"][B.relId];for(V?(B.Target=V.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=V):B.relId==""&&(B.Target="#"+B.loc),g=B.rfx.s.r;g<=B.rfx.e.r;++g)for(y=B.rfx.s.c;y<=B.rfx.e.c;++y)l.dense?(c[g]||(c[g]=[]),c[g][y]||(c[g][y]={t:"z",v:void 0}),c[g][y].l=B):(b=Be({c:y,r:g}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=B);break;case 426:if(!l.cellFormula)break;S.push(B),j=l.dense?c[g][y]:c[Xt(y)+w],j.f=Kr(B[1],u,{r:m.r,c:y},O,l),j.F=Ke(B[0]);break;case 427:if(!l.cellFormula)break;k[Be(B[0].s)]=B[1],j=l.dense?c[g][y]:c[Xt(y)+w],j.f=Kr(B[1],u,{r:m.r,c:y},O,l);break;case 60:if(!l.cellStyles)break;for(;B.e>=B.s;)A[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},T||(T=!0,rg(B.w/256)),Os(A[B.e+1]);break;case 161:c["!autofilter"]={ref:Ke(B)};break;case 476:c["!margins"]=B;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),B.name&&(s.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),B.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!L.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(u.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Ke(d||u)),l.sheetRows&&c["!ref"]){var W=ht(c["!ref"]);l.sheetRows<=+W.e.r&&(W.e.r=l.sheetRows-1,W.e.r>u.e.r&&(W.e.r=u.e.r),W.e.r<W.s.r&&(W.s.r=W.e.r),W.e.c>u.e.c&&(W.e.c=u.e.c),W.e.c<W.s.c&&(W.s.c=W.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ke(W))}return N.length>0&&(c["!merges"]=N),A.length>0&&(c["!cols"]=A),R.length>0&&(c["!rows"]=R),c}function jie(e,t,r,a,s,i,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Bt(t),t.z=t.z||Le[14],t.v=jr(Lt(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:a};switch(c.s=Hs(s.cellXfs,t,s),t.l&&i["!links"].push([Be(c),t.l]),t.c&&i["!comments"].push([Be(c),t.c]),t.t){case"s":case"str":return s.bookSST?(l=og(s.Strings,t.v,s.revStrings),c.t="s",c.v=l,o?ge(e,18,Use(t,c)):ge(e,7,Lse(t,c))):(c.t="str",o?ge(e,17,Qse(t,c)):ge(e,6,Jse(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?ge(e,13,Kse(t,c)):ge(e,2,Gse(t,c)):o?ge(e,16,zse(t,c)):ge(e,5,Hse(t,c)),!0;case"b":return c.t="b",o?ge(e,15,Fse(t,c)):ge(e,4,Ose(t,c)),!0;case"e":return c.t="e",o?ge(e,14,Mse(t,c)):ge(e,3,Dse(t,c)),!0}return o?ge(e,12,Tse(t,c)):ge(e,1,Ese(t,c)),!0}function Nie(e,t,r,a){var s=ht(t["!ref"]||"A1"),i,o="",l=[];ge(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var u=s.s.r;u<=d;++u){o=ir(u),bse(e,t,s,u);var f=!1;if(u<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){u===s.s.r&&(l[h]=Xt(h)),i=l[h]+o;var m=c?(t[u]||[])[h]:t[i];if(!m){f=!1;continue}f=jie(e,m,u,h,a,t,f)}}ge(e,146)}function _ie(e,t){!t||!t["!merges"]||(ge(e,177,iie(t["!merges"].length)),t["!merges"].forEach(function(r){ge(e,176,sie(r))}),ge(e,178))}function Sie(e,t){!t||!t["!cols"]||(ge(e,390),t["!cols"].forEach(function(r,a){r&&ge(e,60,fie(a,r))}),ge(e,391))}function kie(e,t){!t||!t["!ref"]||(ge(e,648),ge(e,649,gie(ht(t["!ref"]))),ge(e,650))}function Eie(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var s=kt(r,-1,a[1].Target.replace(/#.*$/,""),nt.HLINK);ge(e,494,lie(a,s))}}),delete t["!links"]}function Aie(e,t,r,a){if(t["!comments"].length>0){var s=kt(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",nt.VML);ge(e,551,Kp("rId"+s)),t["!legacy"]=s}}function Tie(e,t,r,a){if(t["!autofilter"]){var s=t["!autofilter"],i=typeof s.ref=="string"?s.ref:Ke(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=va(i);l.s.r==l.e.r&&(l.e.r=va(t["!ref"]).e.r,i=Ke(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+r.SheetNames[a]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),ge(e,161,il(ht(i))),ge(e,162)}}function Cie(e,t,r){ge(e,133),ge(e,137,pie(t,r)),ge(e,138),ge(e,134)}function Oie(e,t){t["!protect"]&&ge(e,535,vie(t["!protect"]))}function Pie(e,t,r,a){var s=pa(),i=r.SheetNames[e],o=r.Sheets[i]||{},l=i;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=ht(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ge(s,129),(r.vbaraw||o["!outline"])&&ge(s,147,Sse(l,o["!outline"])),ge(s,148,jse(c)),Cie(s,o,r.Workbook),Sie(s,o),Nie(s,o,e,t),Oie(s,o),Tie(s,o,r,e),_ie(s,o),Eie(s,o,a),o["!margins"]&&ge(s,476,mie(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&kie(s,o),Aie(s,o,e,a),ge(s,130),s.end()}function Fie(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var s=ut((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,s,a]}function Iie(e,t,r,a,s,i){var o=i||{"!type":"chart"};if(!e)return i;var l=0,c=0,d="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Fie(f);u.s.r=u.s.c=0,u.e.c=l,d=Xt(l),h[0].forEach(function(m,x){o[d+ir(x)]={t:"n",v:m,z:h[1]},c=x}),u.e.r<c&&(u.e.r=c),++l}),l>0&&(o["!ref"]=Ke(u)),o}function Die(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(C4);return l&&lg(l[0],i,s,r),(o=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Rie(e,t){e.l+=10;var r=Jr(e);return{name:r}}function Mie(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ds(e,function(c,d,u){switch(u){case 550:i["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var cg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$ie=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Lie=[],Bie=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Rw(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var i=t[s];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=$t(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function Mw(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=$t(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function I4(e){Mw(e.WBProps,cg),Mw(e.CalcPr,Bie),Rw(e.WBView,$ie),Rw(e.Sheets,Lie),go.date1904=$t(e.WBProps.date1904)}function Uie(e){return!e.Workbook||!e.Workbook.WBProps?"false":$t(e.Workbook.WBProps.date1904)?"true":"false"}var Wie="][*?/\\".split("");function D4(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Wie.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Hie(e,t,r){e.forEach(function(a,s){D4(a);for(var i=0;i<s;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[s]&&t[s].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function zie(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Hie(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Une(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Vie=/<\w+:workbook/;function Gie(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",i={},o=0;if(e.replace(ea,function(c,d){var u=Ue(c);switch(In(u[0])){case"<?xml":break;case"<workbook":c.match(Vie)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":cg.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=$t(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Ct(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ut(Ct(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Ct(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),$t(u.hidden||"0")&&(i.Hidden=!0),o=d+c.length;break;case"</definedName>":i.Ref=ut(Ct(e.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),Bi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return I4(r),r}function R4(e){var t=[or];t[t.length]=_e("workbook",null,{xmlns:Bi[0],"xmlns:r":vr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(cg.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(a[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=_e("workbookPr",null,a);var s=e.Workbook&&e.Workbook.Sheets||[],i=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!s[i]||!s[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var o={name:Et(e.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),s[i])switch(s[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=_e("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=_e("definedName",Et(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function qie(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=sx(e),r.name=Jr(e),r}function Kie(e,t){return t||(t=de(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Kp(e.strRelID,t),Or(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Xie(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Jr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Yie(e,t){t||(t=de(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),ES(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Jie(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Zie(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),i=AZ(e),o=Dne(e,0,r),l=qp(e);e.l=a;var c={Name:i,Ptg:o};return s<268435455&&(c.Sheet=s),l&&(c.Comment=l),c}function Qie(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],ad[16]={n:"BrtFRTArchID$",f:Jie},ds(e,function(c,d,u){switch(u){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Kr(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,i.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,c]):o[0]=[u,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(u),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(u),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),I4(r),r.Names=i,r.supbooks=o,r}function eoe(e,t){ge(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ge(e,156,Kie(s))}ge(e,144)}function toe(e,t){t||(t=de(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Or("SheetJS",t),Or(cf.version,t),Or(cf.version,t),Or("7262",t),t.length>t.l?t.slice(0,t.l):t}function roe(e,t){t||(t=de(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function aoe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,s=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&s==-1?s=a:r[a].Hidden==1&&i==-1&&(i=a);i>s||(ge(e,135),ge(e,158,roe(s)),ge(e,136))}}function noe(e,t){var r=pa();return ge(r,131),ge(r,128,toe()),ge(r,153,Yie(e.Workbook&&e.Workbook.WBProps||null)),aoe(r,e),eoe(r,e),ge(r,132),r.end()}function soe(e,t,r){return t.slice(-4)===".bin"?Qie(e,r):Gie(e,r)}function ioe(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?wie(e,a,r,s,i,o,l):Zne(e,a,r,s,i,o,l)}function ooe(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?Mie(e,a,r,s,i):Die(e,a,r,s,i)}function loe(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?dae():uae()}function coe(e,t,r,a,s,i,o,l){return t.slice(-4)===".bin"?lae():cae()}function doe(e,t,r,a){return t.slice(-4)===".bin"?sre(e,r,a):qte(e,r,a)}function uoe(e,t,r){return p4(e,r)}function foe(e,t,r){return t.slice(-4)===".bin"?fte(e,r):cte(e,r)}function hoe(e,t,r){return t.slice(-4)===".bin"?aae(e,r):Kre(e,r)}function moe(e,t,r){return t.slice(-4)===".bin"?Vre(e):Hre(e)}function xoe(e,t,r,a){return r.slice(-4)===".bin"?Gre(e,t,r,a):void 0}function poe(e,t,r){return t.slice(-4)===".bin"?Bre(e,t,r):Wre(e,t,r)}function goe(e,t,r){return(t.slice(-4)===".bin"?noe:R4)(e)}function voe(e,t,r,a,s){return(t.slice(-4)===".bin"?Pie:O4)(e,r,a,s)}function yoe(e,t,r){return(t.slice(-4)===".bin"?xre:m4)(e,r)}function boe(e,t,r){return(t.slice(-4)===".bin"?xte:i4)(e,r)}function woe(e,t,r){return(t.slice(-4)===".bin"?nae:y4)(e)}function joe(e){return(e.slice(-4)===".bin"?Ure:g4)()}var M4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,$4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function en(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(M4),i,o,l,c;if(s)for(c=0;c!=s.length;++c)i=s[c].match($4),(o=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?l="xmlns"+i[1].slice(6):l=i[1].slice(o+1),a[l]=i[2].slice(1,i[2].length-1));return a}function Noe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(M4),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match($4),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),r[o]=s[2].slice(1,s[2].length-1));return r}var Zl;function _oe(e,t){var r=Zl[e]||ut(e);return r==="General"?ki(t):Ya(r,t)}function Soe(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=$t(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=Lt(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ut(t)]=s}function koe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||us[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Kc(e.v):e.w=ki(e.v):e.w=_oe(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Zl[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&al(a)){var s=oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function Eoe(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=Lte[a.Pattern]||a.Pattern)}e[t.ID]=t}function Aoe(e,t,r,a,s,i,o,l,c,d){var u="General",f=a.StyleID,h={};d=d||{};var m=[],x=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&m.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=$t(e);break;case"String":a.t="s",a.r=ew(ut(e)),a.v=e.indexOf("<")>-1?ut(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Lt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=ut(e):a.v<60&&(a.v=a.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=PS[e],d.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=ew(t||e));break}if(koe(a,u,d),d.cellFormula!==!1)if(a.Formula){var p=ut(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=po(p,s),delete a.Formula,a.ArrayRange=="RC"?a.F=po("RC:RC",s):a.ArrayRange&&(a.F=po(a.ArrayRange,s),c.push([ht(a.F),a.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(a.F=c[x][1]);d.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function Toe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function yh(e,t){var r=t||{};nl();var a=Ol(Up(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Ct(a));var s=a.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var o=Bt(r);return o.type="string",Bo.to_workbook(a,o)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(oe){s.indexOf("<"+oe)>=0&&(i=!0)}),i)return mle(a,r);Zl={"General Number":"General","General Date":Le[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Le[15],"Short Date":Le[14],"Long Time":Le[19],"Medium Time":Le[18],"Short Time":Le[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Le[2],Standard:Le[4],Percent:Le[10],Scientific:Le[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],d,u={},f=[],h=r.dense?[]:{},m="",x={},p={},g=en('<Data ss:Type="String">'),y=0,b=0,v=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},N={},_="",E=0,S=[],k={},O={},P=0,A=[],R=[],T={},F=[],W,K=!1,B=[],L=[],ee={},M=0,G=0,V={Sheets:[],WBProps:{date1904:!1}},H={};Jc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var re="";l=Jc.exec(a);)switch(l[3]=(re=l[3]).toLowerCase()){case"data":if(re=="data"){if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Aoe(a.slice(y,l.index),_,g,c[c.length-1][0]=="comment"?T:x,{c:b,r:v},j,F[b],p,B,r):(_="",g=en(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(R.length>0&&(x.c=R),(!r.sheetRows||r.sheetRows>v)&&x.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][b]=x):h[Xt(b)+ir(v)]=x),x.HRef&&(x.l={Target:ut(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(M=b+(parseInt(x.MergeAcross,10)|0),G=v+(parseInt(x.MergeDown,10)|0),S.push({s:{c:b,r:v},e:{c:M,r:G}})),!r.sheetStubs)x.MergeAcross?b=M+1:++b;else if(x.MergeAcross||x.MergeDown){for(var me=b;me<=M;++me)for(var xe=v;xe<=G;++xe)(me>b||xe>v)&&(r.dense?(h[xe]||(h[xe]=[]),h[xe][me]={t:"z"}):h[Xt(me)+ir(xe)]={t:"z"});b=M+1}else++b;else x=Noe(l[0]),x.Index&&(b=+x.Index-1),b<w.s.c&&(w.s.c=b),b>w.e.c&&(w.e.c=b),l[0].slice(-2)==="/>"&&++b,R=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(v<w.s.r&&(w.s.r=v),v>w.e.r&&(w.e.r=v),l[0].slice(-2)==="/>"&&(p=en(l[0]),p.Index&&(v=+p.Index-1)),b=0,++v):(p=en(l[0]),p.Index&&(v=+p.Index-1),ee={},(p.AutoFitHeight=="0"||p.Height)&&(ee.hpx=parseInt(p.Height,10),ee.hpt=rd(ee.hpx),L[v]=ee),p.Hidden=="1"&&(ee.hidden=!0,L[v]=ee));break;case"worksheet":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));f.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=Ke(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=Ke(w))),S.length&&(h["!merges"]=S),F.length>0&&(h["!cols"]=F),L.length>0&&(h["!rows"]=L),u[m]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=b=0,c.push([l[3],!1]),d=en(l[0]),m=ut(d.Name),h=r.dense?[]:{},S=[],B=[],L=[],H={name:m,Hidden:0},V.Sheets.push(H);break;case"table":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),F=[],K=!1}break;case"style":l[1]==="/"?Eoe(j,N,r):N=en(l[0]);break;case"numberformat":N.nf=ut(en(l[0]).Format||"General"),Zl[N.nf]&&(N.nf=Zl[N.nf]);for(var Z=0;Z!=392&&Le[Z]!=N.nf;++Z);if(Z==392){for(Z=57;Z!=392;++Z)if(Le[Z]==null){Yn(N.nf,Z);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(W=en(l[0]),W.Hidden&&(W.hidden=!0,delete W.Hidden),W.Width&&(W.wpx=parseInt(W.Width,10)),!K&&W.wpx>10){K=!0,Xr=f4;for(var q=0;q<F.length;++q)F[q]&&Os(F[q])}K&&Os(W),F[W.Index-1||F.length]=W;for(var ie=0;ie<+W.Span;++ie)F[F.length]=Bt(W);break;case"namedrange":if(l[1]==="/")break;V.Names||(V.Names=[]);var I=Ue(l[0]),ve={Name:I.Name,Ref:po(I.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(ve.Sheet=V.Sheets.length-1),V.Names.push(ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?_+=a.slice(E,l.index):E=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;N.Interior=en(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?QZ(k,re,a.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"));Toe(T),R.push(T)}else c.push([l[3],!1]),d=en(l[0]),T={a:d.Author};break;case"autofilter":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var we=en(l[0]);h["!autofilter"]={ref:po(we.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((d=c.pop())[0]!==l[3])throw new Error("Bad state: "+d.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return Ww(a,r);var Ee=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ee=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ee=!1}break;case"excelworkbook":switch(l[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ee=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:Ee=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(a.slice(P,l.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else P=l.index+l[0].length;break;case"header":h["!margins"]||pi(h["!margins"]={},"xlml"),isNaN(+Ue(l[0]).Margin)||(h["!margins"].header=+Ue(l[0]).Margin);break;case"footer":h["!margins"]||pi(h["!margins"]={},"xlml"),isNaN(+Ue(l[0]).Margin)||(h["!margins"].footer=+Ue(l[0]).Margin);break;case"pagemargins":var ce=Ue(l[0]);h["!margins"]||pi(h["!margins"]={},"xlml"),isNaN(+ce.Top)||(h["!margins"].top=+ce.Top),isNaN(+ce.Left)||(h["!margins"].left=+ce.Left),isNaN(+ce.Right)||(h["!margins"].right=+ce.Right),isNaN(+ce.Bottom)||(h["!margins"].bottom=+ce.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ee=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ee=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ee=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ee=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ee=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ee=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ee=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ee=!1}break;case"smarttags":break;default:Ee=!1;break}if(Ee||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Soe(O,re,A,a.slice(P,l.index)):(A=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var fe={};return!r.bookSheets&&!r.bookProps&&(fe.Sheets=u),fe.SheetNames=f,fe.Workbook=V,fe.SSF=Bt(Le),fe.Props=k,fe.Custprops=O,fe}function fx(e,t){switch(ug(t=t||{}),t.type||"base64"){case"base64":return yh(Oa(e),t);case"binary":case"buffer":case"file":return yh(e,t);case"array":return yh(Us(e),t)}}function Coe(e,t){var r=[];return e.Props&&r.push(eQ(e.Props,t)),e.Custprops&&r.push(tQ(e.Props,e.Custprops)),r.join("")}function Ooe(){return""}function Poe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,s){var i=[];i.push(_e("NumberFormat",null,{"ss:Format":Et(Le[a.numFmtId])}));var o={"ss:ID":"s"+(21+s)};r.push(_e("Style",i.join(""),o))}),_e("Styles",r.join(""))}function L4(e){return _e("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+sg(e.Ref,{r:0,c:0})})}function Foe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var s=t[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(L4(s)))}return _e("Names",r.join(""))}function Ioe(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,i=[],o=0;o<s.length;++o){var l=s[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||i.push(L4(l)))}return i.join("")}function Doe(e,t,r,a){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(_e("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(_e("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(_e("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)s.push(_e("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(Ur("ProtectContents","True")),e["!protect"].objects&&s.push(Ur("ProtectObjects","True")),e["!protect"].scenarios&&s.push(Ur("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(Ur("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(Ur("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&s.push("<"+o[1]+"/>")})),s.length==0?"":_e("WorksheetOptions",s.join(""),{xmlns:ja.x})}function Roe(e){return e.map(function(t){var r=aZ(t.t||""),a=_e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",a,{"ss:Author":t.a})}).join("")}function Moe(e,t,r,a,s,i,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Et(sg(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Yt(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Et(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Et(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],u=0;u!=d.length;++u)d[u].s.c!=o.c||d[u].s.r!=o.r||(d[u].e.c>d[u].s.c&&(l["ss:MergeAcross"]=d[u].e.c-d[u].s.c),d[u].e.r>d[u].s.r&&(l["ss:MergeDown"]=d[u].e.r-d[u].s.r));var f="",h="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=us[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Le[14]);break;case"s":f="String",h=rZ(e.v||"");break}var m=Hs(a.cellXfs,e,a);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=Roe(e.c)),_e("Cell",p,l)}function $oe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Uo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Loe(e,t,r,a){if(!e["!ref"])return"";var s=ht(e["!ref"]),i=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(g,y){Os(g);var b=!!g.width,v=T0(y,g),w={"ss:Index":y+1};b&&(w["ss:Width"]=ed(v.width)),g.hidden&&(w["ss:Hidden"]="1"),l.push(_e("Column",null,w))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var u=[$oe(d,(e["!rows"]||[])[d])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>d)&&!(i[o].e.c<f)&&!(i[o].e.r<d)){(i[o].s.c!=f||i[o].s.r!=d)&&(h=!0);break}if(!h){var m={r:d,c:f},x=Be(m),p=c?(e[d]||[])[f]:e[x];u.push(Moe(p,x,e,t,r,a,m))}}u.push("</Row>"),u.length>2&&l.push(u.join(""))}return l.join("")}function Boe(e,t,r){var a=[],s=r.SheetNames[e],i=r.Sheets[s],o=i?Ioe(i,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=i?Loe(i,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(Doe(i,t,e,r)),a.join("")}function Uoe(e,t){t||(t={}),e.SSF||(e.SSF=Bt(Le)),e.SSF&&(nl(),j0(e.SSF),t.revssf=_0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Hs(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Coe(e,t)),r.push(Ooe()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(_e("Worksheet",Boe(a,t,e),{"ss:Name":Et(e.SheetNames[a])}));return r[2]=Poe(e,t),r[3]=Foe(e),or+_e("Workbook",r.join(""),{xmlns:ja.ss,"xmlns:o":ja.o,"xmlns:x":ja.x,"xmlns:ss":ja.ss,"xmlns:dt":ja.dt,"xmlns:html":ja.html})}function Woe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=FZ(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=IZ(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Hoe=[60,1084,2066,2165,2175];function zoe(e,t,r,a,s){var i=a,o=[],l=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(l)}o.push(l),r.l+=i;for(var c=Gn(r,r.l),d=hx[c],u=0;d!=null&&Hoe.indexOf(c)>-1;)i=Gn(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),l=r.slice(u,r.l+4+i),o.push(l),r.l+=4+i,d=hx[c=Gn(r,r.l)];var f=Tr(o);Lr(f,0);var h=0;f.lens=[];for(var m=0;m<o.length;++m)f.lens.push(h),h+=o[m].length;if(f.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+a;return t.f(f,f.length,s)}function mn(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Le[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||us[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Kc(e.v):e.w=ki(e.v):e.w=Ya(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&al(Le[a]||String(a))){var s=oi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function eu(e,t,r){return{v:e,ixfe:t,t:r}}function Voe(e,t){var r={opts:{}},a={},s=t.dense?[]:{},i={},o={},l=null,c=[],d="",u={},f,h="",m,x,p,g,y={},b=[],v,w,j=[],N=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},S=function(Qe){return Qe<8?hi[Qe]:Qe<64&&N[Qe-8]||hi[Qe]},k=function(Qe,Gt,ua){var tr=Gt.XF.data;if(!(!tr||!tr.patternType||!ua||!ua.cellStyles)){Gt.s={},Gt.s.patternType=tr.patternType;var Rn;(Rn=Qc(S(tr.icvFore)))&&(Gt.s.fgColor={rgb:Rn}),(Rn=Qc(S(tr.icvBack)))&&(Gt.s.bgColor={rgb:Rn})}},O=function(Qe,Gt,ua){if(!(ee>1)&&!(ua.sheetRows&&Qe.r>=ua.sheetRows)){if(ua.cellStyles&&Gt.XF&&Gt.XF.data&&k(Qe,Gt,ua),delete Gt.ixfe,delete Gt.XF,f=Qe,h=Be(Qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<o.s.r&&(o.s.r=Qe.r),Qe.c<o.s.c&&(o.s.c=Qe.c),Qe.r+1>o.e.r&&(o.e.r=Qe.r+1),Qe.c+1>o.e.c&&(o.e.c=Qe.c+1),ua.cellFormula&&Gt.f){for(var tr=0;tr<b.length;++tr)if(!(b[tr][0].s.c>Qe.c||b[tr][0].s.r>Qe.r)&&!(b[tr][0].e.c<Qe.c||b[tr][0].e.r<Qe.r)){Gt.F=Ke(b[tr][0]),(b[tr][0].s.c!=Qe.c||b[tr][0].s.r!=Qe.r)&&delete Gt.f,Gt.f&&(Gt.f=""+Kr(b[tr][1],o,Qe,B,P));break}}ua.dense?(s[Qe.r]||(s[Qe.r]=[]),s[Qe.r][Qe.c]=Gt):s[h]=Gt}},P={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var A,R=[],T=[],F=[],W=[],K=!1,B=[];B.SheetNames=P.snames,B.sharedf=P.sharedf,B.arrayf=P.arrayf,B.names=[],B.XTI=[];var L=0,ee=0,M=0,G=[],V=[],H;P.codepage=1200,on(1200);for(var re=!1;e.l<e.length-1;){var me=e.l,xe=e.read_shift(2);if(xe===0&&L===10)break;var Z=e.l===e.length?0:e.read_shift(2),q=hx[xe];if(q&&q.f){if(t.bookSheets&&L===133&&xe!==133)break;if(L=xe,q.r===2||q.r==12){var ie=e.read_shift(2);if(Z-=2,!P.enc&&ie!==xe&&((ie&255)<<8|ie>>8)!==xe)throw new Error("rt mismatch: "+ie+"!="+xe);q.r==12&&(e.l+=10,Z-=10)}var I={};if(xe===10?I=q.f(e,Z,P):I=zoe(xe,q,e,Z,P),ee==0&&[9,521,1033,2057].indexOf(L)===-1)continue;switch(xe){case 34:r.opts.Date1904=_.WBProps.date1904=I;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=I,!t.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=I;break;case 66:var ve=Number(I);switch(ve){case 21010:ve=1200;break;case 32768:ve=1e4;break;case 32769:ve=1252;break}on(P.codepage=ve),re=!0;break;case 317:P.rrtabid=I;break;case 25:P.winlocked=I;break;case 439:r.opts.RefreshAll=I;break;case 12:r.opts.CalcCount=I;break;case 16:r.opts.CalcDelta=I;break;case 17:r.opts.CalcIter=I;break;case 13:r.opts.CalcMode=I;break;case 14:r.opts.CalcPrecision=I;break;case 95:r.opts.CalcSaveRecalc=I;break;case 15:P.CalcRefMode=I;break;case 2211:r.opts.FullCalc=I;break;case 129:I.fDialog&&(s["!type"]="dialog"),I.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),I.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:j.push(I);break;case 430:B.push([I]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(I);break;case 24:case 536:H={Name:I.Name,Ref:Kr(I.rgce,o,null,B,P)},I.itab>0&&(H.Sheet=I.itab-1),B.names.push(H),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(V[I.itab-1]={ref:Ke(I.rgce[0][0][1][2])});break;case 22:P.ExternCount=I;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(I),B.XTI=B.XTI.concat(I);break;case 2196:if(P.biff<8)break;H!=null&&(H.Comment=I[1]);break;case 18:s["!protect"]=I;break;case 19:I!==0&&P.WTF&&console.error("Password verifier: "+I);break;case 133:i[I.pos]=I,P.snames.push(I.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,s["!ref"]=Ke(o),t.sheetRows&&t.sheetRows<=o.e.r){var we=o.e.r;o.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ke(o),o.e.r=we}o.e.r++,o.e.c++}R.length>0&&(s["!merges"]=R),T.length>0&&(s["!objects"]=T),F.length>0&&(s["!cols"]=F),W.length>0&&(s["!rows"]=W),_.Sheets.push(E)}d===""?u=s:a[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[xe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),P.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(P.biff=5,re=!0,on(P.codepage=28591)),P.biff==8&&I.BIFFVer==0&&I.dt==16&&(P.biff=2),ee++)break;if(s=t.dense?[]:{},P.biff<8&&!re&&(re=!0,on(P.codepage=t.codepage||1252)),P.biff<5||I.BIFFVer==0&&I.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ee={pos:e.l-Z,name:d};i[Ee.pos]=Ee,P.snames.push(d)}else d=(i[me]||{name:""}).name;I.dt==32&&(s["!type"]="chart"),I.dt==64&&(s["!type"]="macro"),R=[],T=[],P.arrayf=b=[],F=[],W=[],K=!1,E={Hidden:(i[me]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[I.r]||[])[I.c]:s[Be({c:I.c,r:I.r})])&&++I.c,v={ixfe:I.ixfe,XF:j[I.ixfe]||{},v:I.val,t:"n"},M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:I.c,r:I.r},v,t);break;case 5:case 517:v={ixfe:I.ixfe,XF:j[I.ixfe],v:I.val,t:I.t},M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:I.c,r:I.r},v,t);break;case 638:v={ixfe:I.ixfe,XF:j[I.ixfe],v:I.rknum,t:"n"},M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:I.c,r:I.r},v,t);break;case 189:for(var ce=I.c;ce<=I.C;++ce){var fe=I.rkrec[ce-I.c][0];v={ixfe:fe,XF:j[fe],v:I.rkrec[ce-I.c][1],t:"n"},M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:ce,r:I.r},v,t)}break;case 6:case 518:case 1030:{if(I.val=="String"){l=I;break}if(v=eu(I.val,I.cell.ixfe,I.tt),v.XF=j[v.ixfe],t.cellFormula){var oe=I.formula;if(oe&&oe[0]&&oe[0][0]&&oe[0][0][0]=="PtgExp"){var qe=oe[0][0][1][0],st=oe[0][0][1][1],lt=Be({r:qe,c:st});y[lt]?v.f=""+Kr(I.formula,o,I.cell,B,P):v.F=((t.dense?(s[qe]||[])[st]:s[lt])||{}).F}else v.f=""+Kr(I.formula,o,I.cell,B,P)}M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O(I.cell,v,t),l=I}break;case 7:case 519:if(l)l.val=I,v=eu(I,l.cell.ixfe,"s"),v.XF=j[v.ixfe],t.cellFormula&&(v.f=""+Kr(l.formula,o,l.cell,B,P)),M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O(l.cell,v,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(I);var Ft=Be(I[0].s);if(m=t.dense?(s[I[0].s.r]||[])[I[0].s.c]:s[Ft],t.cellFormula&&m){if(!l||!Ft||!m)break;m.f=""+Kr(I[1],o,I[0],B,P),m.F=Ke(I[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;y[Be(l.cell)]=I[0],m=t.dense?(s[l.cell.r]||[])[l.cell.c]:s[Be(l.cell)],(m||{}).f=""+Kr(I[0],o,f,B,P)}}break;case 253:v=eu(c[I.isst].t,I.ixfe,"s"),c[I.isst].h&&(v.h=c[I.isst].h),v.XF=j[v.ixfe],M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:I.c,r:I.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:I.ixfe,XF:j[I.ixfe],t:"z"},M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:I.c,r:I.r},v,t));break;case 190:if(t.sheetStubs)for(var Vt=I.c;Vt<=I.C;++Vt){var Jt=I.ixfe[Vt-I.c];v={ixfe:Jt,XF:j[Jt],t:"z"},M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:Vt,r:I.r},v,t)}break;case 214:case 516:case 4:v=eu(I.val,I.ixfe,"s"),v.XF=j[v.ixfe],M>0&&(v.z=G[v.ixfe>>8&63]),mn(v,t,r.opts.Date1904),O({c:I.c,r:I.r},v,t);break;case 0:case 512:ee===1&&(o=I);break;case 252:c=I;break;case 1054:if(P.biff==4){G[M++]=I[1];for(var ra=0;ra<M+163&&Le[ra]!=I[1];++ra);ra>=163&&Yn(I[1],M+163)}else Yn(I[1],I[0]);break;case 30:{G[M++]=I;for(var Dr=0;Dr<M+163&&Le[Dr]!=I;++Dr);Dr>=163&&Yn(I,M+163)}break;case 229:R=R.concat(I);break;case 93:T[I.cmo[0]]=P.lastobj=I;break;case 438:P.lastobj.TxO=I;break;case 127:P.lastobj.ImData=I;break;case 440:for(g=I[0].s.r;g<=I[0].e.r;++g)for(p=I[0].s.c;p<=I[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[Be({c:p,r:g})],m&&(m.l=I[1]);break;case 2048:for(g=I[0].s.r;g<=I[0].e.r;++g)for(p=I[0].s.c;p<=I[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[Be({c:p,r:g})],m&&m.l&&(m.l.Tooltip=I[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;m=t.dense?(s[I[0].r]||[])[I[0].c]:s[Be(I[0])];var zs=T[I[2]];m||(t.dense?(s[I[0].r]||(s[I[0].r]=[]),m=s[I[0].r][I[0].c]={t:"z"}):m=s[Be(I[0])]={t:"z"},o.e.r=Math.max(o.e.r,I[0].r),o.s.r=Math.min(o.s.r,I[0].r),o.e.c=Math.max(o.e.c,I[0].c),o.s.c=Math.min(o.s.c,I[0].c)),m.c||(m.c=[]),x={a:I[1],t:zs.TxO.t},m.c.push(x)}break;case 2173:Pre(j[I.ixfe],I.ext);break;case 125:{if(!P.cellStyles)break;for(;I.e>=I.s;)F[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},K||(K=!0,rg(I.w/256)),Os(F[I.e+1])}break;case 520:{var Rr={};I.level!=null&&(W[I.r]=Rr,Rr.level=I.level),I.hidden&&(W[I.r]=Rr,Rr.hidden=!0),I.hpt&&(W[I.r]=Rr,Rr.hpt=I.hpt,Rr.hpx=Uo(I.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||pi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[xe]]=I;break;case 161:s["!margins"]||pi(s["!margins"]={}),s["!margins"].header=I.header,s["!margins"].footer=I.footer;break;case 574:I.RTL&&(_.Views[0].RTL=!0);break;case 146:N=I;break;case 2198:A=I;break;case 140:w=I;break;case 442:d?E.CodeName=I||E.name:_.WBProps.CodeName=I||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+xe.toString(16)),e.l+=Z}return r.SheetNames=er(i).sort(function(Fa,Qe){return Number(Fa)-Number(Qe)}).map(function(Fa){return i[Fa].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&V.forEach(function(Fa,Qe){r.Sheets[r.SheetNames[Qe]]["!autofilter"]=Fa}),r.Strings=c,r.SSF=Bt(Le),P.enc&&(r.Encryption=P.enc),A&&(r.Themes=A),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),B.names.length>0&&(_.Names=B.names),r.Workbook=_,r}var Ql={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Goe(e,t,r){var a=Ie.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=vw(a,ix,Ql.DSI);for(var i in s)t[i]=s[i]}catch(d){if(r.WTF)throw d}var o=Ie.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=vw(o,ox,Ql.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&($S(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function qoe(e,t){var r=[],a=[],s=[],i=0,o,l=K1(ix,"n"),c=K1(ox,"n");if(e.Props)for(o=er(e.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Props[o[i]]]);if(e.Custprops)for(o=er(e.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?r:Object.prototype.hasOwnProperty.call(c,o[i])?a:s).push([o[i],e.Custprops[o[i]]]);var d=[];for(i=0;i<s.length;++i)VS.indexOf(s[i][0])>-1||MS.indexOf(s[i][0])>-1||s[i][1]!=null&&d.push(s[i]);a.length&&Ie.utils.cfb_add(t,"/SummaryInformation",yw(a,Ql.SI,c,ox)),(r.length||d.length)&&Ie.utils.cfb_add(t,"/DocumentSummaryInformation",yw(r,Ql.DSI,l,ix,d.length?d:null,Ql.UDI))}function B4(e,t){t||(t={}),ug(t),Pp(),t.codepage&&Op(t.codepage);var r,a;if(e.FullPaths){if(Ie.find(e,"/encryption"))throw new Error("File is password-protected");r=Ie.find(e,"!CompObj"),a=Ie.find(e,"/Workbook")||Ie.find(e,"/Book")}else{switch(t.type){case"base64":e=Sa(Oa(e));break;case"binary":e=Sa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Lr(e,0),a={content:e}}var s,i;if(r&&Woe(r),t.bookProps&&!t.bookSheets)s={};else{var o=rt?"buffer":"array";if(a&&a.content)s=Voe(a.content,t);else if((i=Ie.find(e,"PerfectOffice_MAIN"))&&i.content)s=xi.to_workbook(i.content,(t.type=o,t));else if((i=Ie.find(e,"NativeContent_MAIN"))&&i.content)s=xi.to_workbook(i.content,(t.type=o,t));else throw(i=Ie.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ie.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=iae(e))}var l={};return e.FullPaths&&Goe(e,l,t),s.Props=s.Custprops=l,t.bookFiles&&(s.cfb=e),s}function Koe(e,t){var r=t||{},a=Ie.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ie.utils.cfb_add(a,s,U4(e,r)),r.biff==8&&(e.Props||e.Custprops)&&qoe(e,a),r.biff==8&&e.vbaraw&&oae(a,Ie.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var ad={0:{f:vse},1:{f:kse},2:{f:Vse},3:{f:Ise},4:{f:Cse},5:{f:Wse},6:{f:Yse},7:{f:$se},8:{f:aie},9:{f:rie},10:{f:eie},11:{f:tie},12:{f:Ase},13:{f:qse},14:{f:Rse},15:{f:Pse},16:{f:P4},17:{f:Zse},18:{f:Bse},19:{f:Gp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Zie},40:{},42:{},43:{f:Yte},44:{f:Kte},45:{f:Qte},46:{f:tre},47:{f:ere},48:{},49:{f:wZ},50:{},51:{f:Dre},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:r4},62:{f:Xse},63:{f:zre},64:{f:yie},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:xie},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:_se},148:{f:wse,p:16},151:{f:cie},152:{},153:{f:Xie},154:{},155:{},156:{f:qie},157:{},158:{},159:{T:1,f:ute},160:{T:-1},161:{T:1,f:zi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:nie},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Fre},336:{T:-1},337:{f:$re,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:sx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:t4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:die},427:{f:uie},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:hie},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Nse},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:oie},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:sx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:tae},633:{T:1},634:{T:-1},635:{T:1,f:Qre},636:{T:-1},637:{f:SZ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Rie},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:bie},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},hx={6:{f:gh},10:{f:ms},12:{f:dr},13:{f:dr},14:{f:rr},15:{f:rr},16:{f:Yr},17:{f:rr},18:{f:rr},19:{f:dr},20:{f:Sw},21:{f:Sw},23:{f:t4},24:{f:Ew},25:{f:rr},26:{},27:{},28:{f:bee},29:{},34:{f:rr},35:{f:kw},38:{f:Yr},39:{f:Yr},40:{f:Yr},41:{f:Yr},42:{f:rr},43:{f:rr},47:{f:Pte},49:{f:qQ},51:{f:dr},60:{},61:{f:WQ},64:{f:rr},65:{f:GQ},66:{f:dr},77:{},80:{},81:{},82:{},85:{f:dr},89:{},90:{},91:{},92:{f:OQ},93:{f:Nee},94:{},95:{f:rr},96:{},97:{},99:{f:rr},125:{f:r4},128:{f:lee},129:{f:FQ},130:{f:dr},131:{f:rr},132:{f:rr},133:{f:IQ},134:{},140:{f:Oee},141:{f:dr},144:{},146:{f:Iee},151:{},152:{},153:{},154:{},155:{},156:{f:dr},157:{},158:{},160:{f:Uee},161:{f:Mee},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:nee},190:{f:see},193:{f:ms},197:{},198:{},199:{},200:{},201:{},202:{f:rr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:dr},220:{},221:{f:rr},222:{},224:{f:oee},225:{f:CQ},226:{f:ms},227:{},229:{f:wee},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:RQ},253:{f:XQ},255:{f:$Q},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:GS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:rr},353:{f:ms},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:hee},431:{f:rr},432:{},433:{},434:{},437:{},438:{f:kee},439:{f:rr},440:{f:Eee},441:{},442:{f:kd},443:{},444:{f:dr},445:{},446:{},448:{f:ms},449:{f:UQ,r:2},450:{f:ms},512:{f:jw},513:{f:Bee},515:{f:uee},516:{f:JQ},517:{f:_w},519:{f:Wee},520:{f:LQ},523:{},545:{f:Aw},549:{f:ww},566:{},574:{f:zQ},638:{f:aee},659:{},1048:{},1054:{f:QQ},1084:{},1212:{f:gee},2048:{f:Tee},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ms},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Dee,r:12},2173:{f:Ore,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:rr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:pee,r:12},2197:{},2198:{f:Sre,r:12},2199:{},2200:{},2201:{},2202:{f:vee,r:12},2203:{f:ms},2204:{},2205:{},2206:{},2207:{},2211:{f:BQ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:dr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:$ee},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Fee},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:jw},1:{},2:{f:qee},3:{f:Vee},4:{f:zee},5:{f:_w},7:{f:Xee},8:{},9:{f:Jd},11:{},22:{f:dr},30:{f:tee},31:{},32:{},33:{f:Aw},36:{},37:{f:ww},50:{f:Yee},62:{},52:{},67:{},68:{f:dr},69:{},86:{},126:{},127:{f:Hee},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Jee},223:{},234:{},354:{},421:{},518:{f:gh},521:{f:Jd},536:{f:Ew},547:{f:kw},561:{},579:{},1030:{f:gh},1033:{f:Jd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Se(e,t,r,a){var s=t;if(!isNaN(s)){var i=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,s),o.write_shift(2,i),i>0&&Hp(r)&&e.push(r)}}function Xoe(e,t,r,a){var s=(r||[]).length||0;if(s<=8224)return Se(e,t,r,s);var i=t;if(!isNaN(i)){for(var o=r.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var u=e.next(4);for(u.write_shift(2,i),u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(u=e.next(4),u.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;u.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Cd(e,t,r){return e||(e=de(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Yoe(e,t,r,a){var s=de(9);return Cd(s,e,t),qS(r,a||"b",s),s}function Joe(e,t,r){var a=de(8+2*r.length);return Cd(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function Zoe(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?jr(Lt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Se(e,2,Kee(r,a,s)):Se(e,3,Gee(r,a,s));return;case"b":case"e":Se(e,5,Yoe(r,a,t.v,t.t));return;case"s":case"str":Se(e,4,Joe(r,a,(t.v||"").slice(0,255)));return}Se(e,1,Cd(null,r,a))}function Qoe(e,t,r,a){var s=Array.isArray(t),i=ht(t["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Ke(i)}for(var d=i.s.r;d<=i.e.r;++d){l=ir(d);for(var u=i.s.c;u<=i.e.c;++u){d===i.s.r&&(c[u]=Xt(u)),o=c[u]+l;var f=s?(t[d]||[])[u]:t[o];f&&Zoe(e,f,d,u)}}}function ele(e,t){for(var r=t||{},a=pa(),s=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(s=i);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Se(a,r.biff==4?1033:r.biff==3?521:9,Qp(e,16,r)),Qoe(a,e.Sheets[e.SheetNames[s]],s,r),Se(a,10),a.end()}function tle(e,t,r){Se(e,49,KQ({sz:12,name:"Arial"},r))}function rle(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)t[s]!=null&&Se(e,1054,eee(s,t[s],r))})}function ale(e,t){var r=de(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Se(e,2151,r),r=de(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),ZS(ht(t["!ref"]||"A1"),r),r.write_shift(4,4),Se(e,2152,r)}function nle(e,t){for(var r=0;r<16;++r)Se(e,224,Nw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Se(e,224,Nw(a,0,t))})}function sle(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Se(e,440,Aee(a)),a[1].Tooltip&&Se(e,2048,Cee(a))}delete t["!links"]}function ile(e,t){if(t){var r=0;t.forEach(function(a,s){++r<=256&&a&&Se(e,125,Ree(T0(s,a),s))})}}function ole(e,t,r,a,s){var i=16+Hs(s.cellXfs,t,s);if(t.v==null&&!t.bf){Se(e,513,Ci(r,a,i));return}if(t.bf)Se(e,6,Fne(t,r,a,s,i));else switch(t.t){case"d":case"n":var o=t.t=="d"?jr(Lt(t.v)):t.v;Se(e,515,fee(r,a,o,i));break;case"b":case"e":Se(e,517,dee(r,a,t.v,i,s,t.t));break;case"s":case"str":if(s.bookSST){var l=og(s.Strings,t.v,s.revStrings);Se(e,253,YQ(r,a,l,i))}else Se(e,516,ZQ(r,a,(t.v||"").slice(0,255),i,s));break;default:Se(e,513,Ci(r,a,i))}}function lle(e,t,r){var a=pa(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(i),d=t.biff==8,u,f="",h=[],m=ht(i["!ref"]||"A1"),x=d?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}Se(a,2057,Qp(r,16,t)),Se(a,13,Wa(1)),Se(a,12,Wa(100)),Se(a,15,sa(!0)),Se(a,17,sa(!1)),Se(a,16,Ai(.001)),Se(a,95,sa(!0)),Se(a,42,sa(!1)),Se(a,43,sa(!1)),Se(a,130,Wa(1)),Se(a,128,cee()),Se(a,131,sa(!1)),Se(a,132,sa(!1)),d&&ile(a,i["!cols"]),Se(a,512,ree(m,t)),d&&(i["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=ir(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=Xt(g)),u=h[g]+f;var y=c?(i[p]||[])[g]:i[u];y&&(ole(a,y,p,g,t),d&&y.l&&i["!links"].push([u,y.l]))}}var b=l.CodeName||l.name||s;return d&&Se(a,574,VQ((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&Se(a,229,jee(i["!merges"])),d&&sle(a,i),Se(a,442,KS(b)),d&&ale(a,i),Se(a,10),a.end()}function cle(e,t,r){var a=pa(),s=(e||{}).Workbook||{},i=s.Sheets||[],o=s.WBProps||{},l=r.biff==8,c=r.biff==5;if(Se(a,2057,Qp(e,5,r)),r.bookType=="xla"&&Se(a,135),Se(a,225,l?Wa(1200):null),Se(a,193,dQ(2)),c&&Se(a,191),c&&Se(a,192),Se(a,226),Se(a,92,PQ("SheetJS",r)),Se(a,66,Wa(l?1200:1252)),l&&Se(a,353,Wa(0)),l&&Se(a,448),Se(a,317,Lee(e.SheetNames.length)),l&&e.vbaraw&&Se(a,211),l&&e.vbaraw){var d=o.CodeName||"ThisWorkbook";Se(a,442,KS(d))}Se(a,156,Wa(17)),Se(a,25,sa(!1)),Se(a,18,sa(!1)),Se(a,19,Wa(0)),l&&Se(a,431,sa(!1)),l&&Se(a,444,Wa(0)),Se(a,61,HQ()),Se(a,64,sa(!1)),Se(a,141,Wa(0)),Se(a,34,sa(Uie(e)=="true")),Se(a,14,sa(!0)),l&&Se(a,439,sa(!1)),Se(a,218,Wa(0)),tle(a,e,r),rle(a,e.SSF,r),nle(a,r),l&&Se(a,352,sa(!1));var u=a.end(),f=pa();l&&Se(f,140,Pee()),l&&r.Strings&&Xoe(f,252,MQ(r.Strings)),Se(f,10);var h=f.end(),m=pa(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(l?12:11)+(l?2:1)*e.SheetNames[p].length;var g=u.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var y=i[p]||{};Se(m,133,DQ({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var b=m.end();if(x!=b.length)throw new Error("BS8 "+x+" != "+b.length);var v=[];return u.length&&v.push(u),b.length&&v.push(b),h.length&&v.push(h),Tr(v)}function dle(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Bt(Le)),e&&e.SSF&&(nl(),j0(e.SSF),r.revssf=_0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fg(r),r.cellXfs=[],Hs(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)a[a.length]=lle(s,r,e);return a.unshift(cle(e,a,r)),Tr(a)}function U4(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var s=va(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return dle(e,t);case 4:case 3:case 2:return ele(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function $w(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),o=s.index,l=i&&i.index||e.length,c=KJ(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,u=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(o=0;o<c.length;++o){var p=c[o].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var y=p.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var b=y[l].trim();if(b.match(/<t[dh]/i)){for(var v=b,w=0;v.charAt(0)=="<"&&(w=v.indexOf(">"))>-1;)v=v.slice(w+1);for(var j=0;j<x.length;++j){var N=x[j];N.s.c==u&&N.s.r<d&&d<=N.e.r&&(u=N.e.c+1,j=-1)}var _=Ue(b.slice(0,b.indexOf(">")));h=_.colspan?+_.colspan:1,((f=+_.rowspan)>1||h>1)&&x.push({s:{r:d,c:u},e:{r:d+(f||1)-1,c:u+h-1}});var E=_.t||_["data-t"]||"";if(!v.length){u+=h;continue}if(v=uS(v),m.s.r>d&&(m.s.r=d),m.e.r<d&&(m.e.r=d),m.s.c>u&&(m.s.c=u),m.e.c<u&&(m.e.c=u),!v.length){u+=h;continue}var S={t:"s",v};r.raw||!v.trim().length||E=="s"||(v==="TRUE"?S={t:"b",v:!0}:v==="FALSE"?S={t:"b",v:!1}:isNaN(cn(v))?isNaN(Lo(v).getDate())||(S={t:"d",v:Lt(v)},r.cellDates||(S={t:"n",v:jr(S.v)}),S.z=r.dateNF||Le[14]):S={t:"n",v:cn(v)}),r.dense?(a[d]||(a[d]=[]),a[d][u]=S):a[Be({r:d,c:u})]=S,u+=h}}}}return a["!ref"]=Ke(m),x.length&&(a["!merges"]=x),a}function ule(e,t,r,a){for(var s=e["!merges"]||[],i=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>o)&&!(s[d].e.r<r||s[d].e.c<o)){if(s[d].s.r<r||s[d].s.c<o){l=-1;break}l=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(l<0)){var u=Be({r,c:o}),f=a.dense?(e[r]||[])[o]:e[u],h=f&&f.v!=null&&(f.h||Bp(f.w||(ns(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(a.id||"sjs")+"-"+u,i.push(_e("td",h,m))}}var x="<tr>";return x+i.join("")+"</tr>"}var fle='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',hle="</body></html>";function mle(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ws($w(r[0],t),t);var a=xg();return r.forEach(function(s,i){pg(a,$w(s,t),"Sheet"+(i+1))}),a}function xle(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function W4(e,t){var r=t||{},a=r.header!=null?r.header:fle,s=r.footer!=null?r.footer:hle,i=[a],o=va(e["!ref"]);r.dense=Array.isArray(e),i.push(xle(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)i.push(ule(e,o,l,r));return i.push("</table>"+s),i.join("")}function H4(e,t,r){var a=r||{},s=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?Yt(a.origin):a.origin;s=o.r,i=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:s,c:i}};if(e["!ref"]){var u=va(e["!ref"]);d.s.r=Math.min(d.s.r,u.s.r),d.s.c=Math.min(d.s.c,u.s.c),d.e.r=Math.max(d.e.r,u.e.r),d.e.c=Math.max(d.e.c,u.e.c),s==-1&&(d.e.r=s=u.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,y=0,b=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var w=l[x];if(Lw(w)){if(a.display)continue;m[p]={hidden:!0}}var j=w.children;for(g=y=0;g<j.length;++g){var N=j[g];if(!(a.display&&Lw(N))){var _=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):uS(N.innerHTML),E=N.getAttribute("data-z")||N.getAttribute("z");for(h=0;h<f.length;++h){var S=f[h];S.s.c==y+i&&S.s.r<p+s&&p+s<=S.e.r&&(y=S.e.c+1-i,h=-1)}v=+N.getAttribute("colspan")||1,((b=+N.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+s,c:y+i},e:{r:p+s+(b||1)-1,c:y+i+(v||1)-1}});var k={t:"s",v:_},O=N.getAttribute("data-t")||N.getAttribute("t")||"";_!=null&&(_.length==0?k.t=O||"z":a.raw||_.trim().length==0||O=="s"||(_==="TRUE"?k={t:"b",v:!0}:_==="FALSE"?k={t:"b",v:!1}:isNaN(cn(_))?isNaN(Lo(_).getDate())||(k={t:"d",v:Lt(_)},a.cellDates||(k={t:"n",v:jr(k.v)}),k.z=a.dateNF||Le[14]):k={t:"n",v:cn(_)})),k.z===void 0&&E!=null&&(k.z=E);var P="",A=N.getElementsByTagName("A");if(A&&A.length)for(var R=0;R<A.length&&!(A[R].hasAttribute("href")&&(P=A[R].getAttribute("href"),P.charAt(0)!="#"));++R);P&&P.charAt(0)!="#"&&(k.l={Target:P}),a.dense?(e[p+s]||(e[p+s]=[]),e[p+s][y+i]=k):e[Be({c:y+i,r:p+s})]=k,d.e.c<y+i&&(d.e.c=y+i),y+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,p-1+s),e["!ref"]=Ke(d),p>=c&&(e["!fullref"]=Ke((d.e.r=l.length-x+p-1+s,d))),e}function z4(e,t){var r=t||{},a=r.dense?[]:{};return H4(a,e,t)}function ple(e,t){return Ws(z4(e,t),t)}function Lw(e){var t="",r=gle(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function gle(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function vle(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ut(t.replace(/<[^>]*>/g,""));return[r]}var Bw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function V4(e,t){var r=t||{},a=Up(e),s=[],i,o,l={name:""},c="",d=0,u,f,h={},m=[],x=r.dense?[]:{},p,g,y={value:""},b="",v=0,w=[],j=-1,N=-1,_={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,S={},k=[],O={},P=0,A=0,R=[],T=1,F=1,W=[],K={Names:[]},B={},L=["",""],ee=[],M={},G="",V=0,H=!1,re=!1,me=0;for(Jc.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Jc.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(_.e.c>=_.s.c&&_.e.r>=_.s.r?x["!ref"]=Ke(_):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=_.e.r&&(x["!fullref"]=x["!ref"],_.e.r=r.sheetRows-1,x["!ref"]=Ke(_)),k.length&&(x["!merges"]=k),R.length&&(x["!rows"]=R),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),m.push(u.name),h[u.name]=x,re=!1):p[0].charAt(p[0].length-2)!=="/"&&(u=Ue(p[0],!1),j=N=-1,_.s.r=_.s.c=1e7,_.e.r=_.e.c=0,x=r.dense?[]:{},k=[],R=[],re=!0);break;case"table-row-group":p[1]==="/"?--E:++E;break;case"table-row":case"行":if(p[1]==="/"){j+=T,T=1;break}if(f=Ue(p[0],!1),f.行号?j=f.行号-1:j==-1&&(j=0),T=+f["number-rows-repeated"]||1,T<10)for(me=0;me<T;++me)E>0&&(R[j+me]={level:E});N=-1;break;case"covered-table-cell":p[1]!=="/"&&++N,r.sheetStubs&&(r.dense?(x[j]||(x[j]=[]),x[j][N]={t:"z"}):x[Be({r:j,c:N})]={t:"z"}),b="",w=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++N,y=Ue(p[0],!1),F=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=Dw(ut(y.formula))),(y.数据类型||y["value-type"])=="string"&&(g.t="s",g.v=ut(y["string-value"]||""),r.dense?(x[j]||(x[j]=[]),x[j][N]=g):x[Be({r:j,c:N})]=g),N+=F-1;else if(p[1]!=="/"){++N,b="",v=0,w=[],F=1;var xe=T?j+T-1:j;if(N>_.e.c&&(_.e.c=N),N<_.s.c&&(_.s.c=N),j<_.s.r&&(_.s.r=j),xe>_.e.r&&(_.e.r=xe),y=Ue(p[0],!1),ee=[],M={},g={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=ut(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(P=parseInt(y["number-matrix-rows-spanned"],10)||0,A=parseInt(y["number-matrix-columns-spanned"],10)||0,O={s:{r:j,c:N},e:{r:j+P-1,c:N+A-1}},g.F=Ke(O),W.push([O,g.F])),y.formula)g.f=Dw(y.formula);else for(me=0;me<W.length;++me)j>=W[me][0].s.r&&j<=W[me][0].e.r&&N>=W[me][0].s.c&&N<=W[me][0].e.c&&(g.F=W[me][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(P=parseInt(y["number-rows-spanned"],10)||0,A=parseInt(y["number-columns-spanned"],10)||0,O={s:{r:j,c:N},e:{r:j+P-1,c:N+A-1}},k.push(O)),y["number-columns-repeated"]&&(F=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=$t(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=Lt(y["date-value"]),r.cellDates||(g.t="n",g.v=jr(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=VJ(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=S0(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(b=ut(y["string-value"]),w=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(H=!1,g.t==="s"&&(g.v=b||"",w.length&&(g.R=w),H=v==0),B.Target&&(g.l=B),ee.length>0&&(g.c=ee,ee=[]),b&&r.cellText!==!1&&(g.w=b),H&&(g.t="z",delete g.v),(!H||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var Z=0;Z<T;++Z){if(F=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(x[j+Z]||(x[j+Z]=[]),x[j+Z][N]=Z==0?g:Bt(g);--F>0;)x[j+Z][N+F]=Bt(g);else for(x[Be({r:j+Z,c:N})]=g;--F>0;)x[Be({r:j+Z,c:N+F})]=Bt(g);_.e.c<=N&&(_.e.c=N)}F=parseInt(y["number-columns-repeated"]||"1",10),N+=F-1,F=0,g={},b="",w=[]}B={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i;M.t=b,w.length&&(M.R=w),M.a=G,ee.push(M)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);G="",V=0,b="",v=0,w=[];break;case"creator":p[1]==="/"?G=a.slice(V,p.index):V=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);b="",v=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(S[l.name]=c,(i=s.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(c="",l=Ue(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ue(p[0],!1),c+=Bw[p[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":o=Ue(p[0],!1),c+=Bw[p[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=a.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":o=Ue(p[0],!1),L=vh(o["cell-range-address"]);var q={Name:o.name,Ref:L[0]+"!"+L[1]};re&&(q.Sheet=m.length),K.Names.push(q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var ie=vle(a.slice(v,p.index));b=(b.length>0?b+`
`:"")+ie[0]}else Ue(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{L=vh(Ue(p[0])["target-range-address"]),h[L[0]]["!autofilter"]={ref:L[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(B=Ue(p[0],!1),!B.href)break;B.Target=ut(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(L=vh(B.Target.slice(1)),B.Target="#"+L[0]+"!"+L[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var I={Sheets:h,SheetNames:m,Workbook:K};return r.bookSheets&&delete I.Sheets,I}function Uw(e,t){t=t||{},Ua(e,"META-INF/manifest.xml")&&VZ(cr(e,"META-INF/manifest.xml"),t);var r=ka(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=V4(Ct(r),t);return Ua(e,"meta.xml")&&(a.Props=DS(cr(e,"meta.xml"))),a}function Ww(e,t){return V4(e,t)}var yle=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Yc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return or+t}}(),Hw=function(){var e=function(i){return Et(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Et(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,u=0,f=va(i["!ref"]||"A1"),h=i["!merges"]||[],m=0,x=Array.isArray(i);if(i["!cols"])for(u=0;u<=f.e.c;++u)c.push("        <table:table-column"+(i["!cols"][u]?' table:style-name="co'+i["!cols"][u].ods+'"':"")+`></table:table-column>
`);var p="",g=i["!rows"]||[];for(d=0;d<f.s.r;++d)p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;d<=f.e.r;++d){for(p=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+p+`>
`),u=0;u<f.s.c;++u)c.push(t);for(;u<=f.e.c;++u){var y=!1,b={},v="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>u)&&!(h[m].s.r>d)&&!(h[m].e.c<u)&&!(h[m].e.r<d)){(h[m].s.c!=u||h[m].s.r!=d)&&(y=!0),b["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,b["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(y){c.push(r);continue}var w=Be({r:d,c:u}),j=x?(i[d]||[])[u]:i[w];if(j&&j.f&&(b["table:formula"]=Et(Lne(j.f)),j.F&&j.F.slice(0,w.length)==w)){var N=va(j.F);b["table:number-matrix-columns-spanned"]=N.e.c-N.s.c+1,b["table:number-matrix-rows-spanned"]=N.e.r-N.s.r+1}if(!j){c.push(t);continue}switch(j.t){case"b":v=j.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=j.v?"true":"false";break;case"n":v=j.w||String(j.v||0),b["office:value-type"]="float",b["office:value"]=j.v||0;break;case"s":case"str":v=j.v==null?"":j.v,b["office:value-type"]="string";break;case"d":v=j.w||Lt(j.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Lt(j.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var _=e(v);if(j.l&&j.l.Target){var E=j.l.Target;E=E.charAt(0)=="#"?"#"+Bne(E.slice(1)):E,E.charAt(0)!="#"&&!E.match(/^\w+:/)&&(E="../"+E),_=_e("text:a",_,{"xlink:href":E.replace(/&/g,"&amp;")})}c.push("          "+_e("table:table-cell",_e("text:p",_,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var u=0;u<d["!cols"].length;++u)if(d["!cols"][u]){var f=d["!cols"][u];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Os(f),f.ods=l;var h=d["!cols"][u].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var u=0;u<d["!rows"].length;++u)if(d["!rows"][u]){d["!rows"][u].ods=c;var f=d["!rows"][u].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[or],d=Yc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Yc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+u+`>
`),c.push(IS().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(a(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function G4(e,t){if(t.bookType=="fods")return Hw(e,t);var r=Mp(),a="",s=[],i=[];return a="mimetype",Ye(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Ye(r,a,Hw(e,t)),s.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Ye(r,a,yle(e,t)),s.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Ye(r,a,or+IS()),s.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Ye(r,a,KZ(i)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Ye(r,a,GZ(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Oi(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function mx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ct(Us(e))}function ble(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Sa(Nn(e))}function wle(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Fs(e){var t=e.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function zw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function jle(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function Nle(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;s>=1;++i,s/=256)e[t+i]=s&255;e[t+15]|=r>=0?0:128}function nd(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function St(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Qt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xt(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=nd(e,r),i=s&7;s=Math.floor(s/8);var o=0,l;if(s==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=nd(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var d={data:l,type:i};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function Mr(e){var t=[];return e.forEach(function(r,a){r.forEach(function(s){s.data&&(t.push(St(a*8+s.type)),s.type==2&&t.push(St(s.data.length)),t.push(s.data))})}),Fs(t)}function dg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function La(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=nd(e,a),i=xt(e.slice(a[0],a[0]+s));a[0]+=s;var o={id:Qt(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=xt(l.data),d=Qt(c[3][0].data);o.messages.push({meta:c,data:e.slice(a[0],a[0]+d)}),a[0]+=d}),(t=i[3])!=null&&t[0]&&(o.merge=Qt(i[3][0].data)>>>0>0),r.push(o)}return r}function Ji(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:St(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:St(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(o){s.push(o.data),o.meta[3]=[{type:0,data:St(o.data.length)}],a[2].push({data:Mr(o.meta),type:2})});var i=Mr(a);t.push(St(i.length)),t.push(i),s.forEach(function(o){return t.push(o)})}),Fs(t)}function _le(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=nd(t,r),s=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}s.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Fs(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var u=Fs(s);if(u.length!=a)throw new Error("Unexpected length: ".concat(u.length," != ").concat(a));return u}function Ba(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(_le(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Fs(t)}function Zi(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var i=St(a),o=i.length;t.push(i),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,s[0]=0,s[1]=o&255,s[2]=o>>8&255,s[3]=o>>16&255,r+=a}return Fs(t)}function Sle(e,t,r,a){var s=Oi(e),i=s.getUint32(4,!0),o=(a>1?12:8)+zw(i&(a>1?3470:398))*4,l=-1,c=-1,d=NaN,u=new Date(2001,0,1);i&512&&(l=s.getUint32(o,!0),o+=4),o+=zw(i&(a>1?12288:4096))*4,i&16&&(c=s.getUint32(o,!0),o+=4),i&32&&(d=s.getFloat64(o,!0),o+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:d};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(d))f={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function kle(e,t,r){var a=Oi(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);s&1&&(c=jle(e,i),i+=16),s&2&&(d=a.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+a.getFloat64(i,!0)*1e3),i+=8),s&8&&(l=a.getUint32(i,!0),i+=4),s&16&&(o=a.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:d>0};break;case 7:f={t:"n",v:d/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function bh(e,t){var r=new Uint8Array(32),a=Oi(r),s=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,Nle(r,s,e.v),i|=1,s+=16;break;case"b":r[1]=6,a.setFloat64(s,e.v?1:0,!0),i|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,s)}function wh(e,t){var r=new Uint8Array(32),a=Oi(r),s=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(s,e.v,!0),i|=32,s+=8;break;case"b":r[2]=6,a.setFloat64(s,e.v?1:0,!0),i|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(s,t.indexOf(e.v),!0),i|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,s)}function Ele(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Sle(e,t,r,e[0]);case 5:return kle(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function qr(e){var t=xt(e);return nd(t[1][0].data)}function Vw(e,t){var r=xt(t.data),a=Qt(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(o){var l=xt(o.data),c=Qt(l[1][0].data)>>>0;switch(a){case 1:i[c]=mx(l[3][0].data);break;case 8:{var d=e[qr(l[9][0].data)][0],u=xt(d.data),f=e[qr(u[1][0].data)][0],h=Qt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=xt(f.data);i[c]=m[3].map(function(x){return mx(x.data)}).join("")}break}}),i}function Ale(e,t){var r,a,s,i,o,l,c,d,u,f,h,m,x,p,g=xt(e),y=Qt(g[1][0].data)>>>0,b=Qt(g[2][0].data)>>>0,v=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Qt(g[8][0].data)>0||!1,w,j;if((i=(s=g[7])==null?void 0:s[0])!=null&&i.data&&t!=0)w=(l=(o=g[7])==null?void 0:o[0])==null?void 0:l.data,j=(d=(c=g[6])==null?void 0:c[0])==null?void 0:d.data;else if((f=(u=g[4])==null?void 0:u[0])!=null&&f.data&&t!=1)w=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,j=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var N=v?4:1,_=Oi(w),E=[],S=0;S<w.length/2;++S){var k=_.getUint16(S*2,!0);k<65535&&E.push([S,k])}if(E.length!=b)throw"Expected ".concat(b," cells, found ").concat(E.length);var O=[];for(S=0;S<E.length-1;++S)O[E[S][0]]=j.subarray(E[S][1]*N,E[S+1][1]*N);return E.length>=1&&(O[E[E.length-1][0]]=j.subarray(E[E.length-1][1]*N)),{R:y,cells:O}}function Tle(e,t){var r,a=xt(t.data),s=(r=a==null?void 0:a[7])!=null&&r[0]?Qt(a[7][0].data)>>>0>0?1:0:-1,i=dg(a[5],function(o){return Ale(o,s)});return{nrows:Qt(a[4][0].data)>>>0,data:i.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,d){if(o[l.R][d])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(d));o[l.R][d]=c}),o},[])}}function Cle(e,t,r){var a,s=xt(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Qt(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(Qt(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ke(i);var o=xt(s[4][0].data),l=Vw(e,e[qr(o[4][0].data)][0]),c=(a=o[17])!=null&&a[0]?Vw(e,e[qr(o[17][0].data)][0]):[],d=xt(o[3][0].data),u=0;d[1].forEach(function(f){var h=xt(f.data),m=e[qr(h[2][0].data)][0],x=Qt(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=Tle(e,m);p.data.forEach(function(g,y){g.forEach(function(b,v){var w=Be({r:u+y,c:v}),j=Ele(b,l,c);j&&(r[w]=j)})}),u+=p.nrows})}function Ole(e,t){var r=xt(t.data),a={"!ref":"A1"},s=e[qr(r[2][0].data)],i=Qt(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return Cle(e,s[0],a),a}function Ple(e,t){var r,a=xt(t.data),s={name:(r=a[1])!=null&&r[0]?mx(a[1][0].data):"",sheets:[]},i=dg(a[2],qr);return i.forEach(function(o){e[o].forEach(function(l){var c=Qt(l.meta[1][0].data);c==6e3&&s.sheets.push(Ole(e,l))})}),s}function Fle(e,t){var r=xg(),a=xt(t.data),s=dg(a[1],qr);if(s.forEach(function(i){e[i].forEach(function(o){var l=Qt(o.meta[1][0].data);if(l==2){var c=Ple(e,o);c.sheets.forEach(function(d,u){pg(r,d,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function jh(e){var t,r,a,s,i={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=Ba(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var u;try{u=La(d)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((s=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Qt(i[1][0].meta[1][0].data)==1&&i[1][0];if(l||o.forEach(function(c){i[c].forEach(function(d){var u=Qt(d.meta[1][0].data)>>>0;if(u==1)if(!l)l=d;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return Fle(i,l)}function Ile(e,t,r){var a,s,i,o;if(!((a=e[6])!=null&&a[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=e[8])==null?void 0:i[0])==null?void 0:o.data)&&Qt(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=Oi(e[7][0].data),u=0,f=[],h=Oi(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}d.setUint16(p*2,u,!0),h.setUint16(p*2,m,!0);var g,y;switch(typeof t[p]){case"string":g=bh({t:"s",v:t[p]},r),y=wh({t:"s",v:t[p]},r);break;case"number":g=bh({t:"n",v:t[p]},r),y=wh({t:"n",v:t[p]},r);break;case"boolean":g=bh({t:"b",v:t[p]},r),y=wh({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),u+=g.length,x.push(y),m+=y.length,++c}for(e[2][0].data=St(c);p<e[7][0].data.length/2;++p)d.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=Fs(f),e[3][0].data=Fs(x),c}function Dle(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=va(r["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ke(a)));var i=wf(r,{range:a,header:1}),o=["~Sh33tJ5~"];i.forEach(function(G){return G.forEach(function(V){typeof V=="string"&&o.push(V)})});var l={},c=[],d=Ie.read(t.numbers,{type:"base64"});d.FileIndex.map(function(G,V){return[G,d.FullPaths[V]]}).forEach(function(G){var V=G[0],H=G[1];if(V.type==2&&V.name.match(/\.iwa/)){var re=V.content,me=Ba(re),xe=La(me);xe.forEach(function(Z){c.push(Z.id),l[Z.id]={deps:[],location:H,type:Qt(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(G,V){return G-V});var u=c.filter(function(G){return G>1}).map(function(G){return[G,St(G)]});d.FileIndex.map(function(G,V){return[G,d.FullPaths[V]]}).forEach(function(G){var V=G[0];if(G[1],!!V.name.match(/\.iwa/)){var H=La(Ba(V.content));H.forEach(function(re){re.messages.forEach(function(me){u.forEach(function(xe){re.messages.some(function(Z){return Qt(Z.meta[1][0].data)!=11006&&wle(Z.data,xe[1])})&&l[xe[0]].deps.push(re.id)})})})}});for(var f=Ie.find(d,l[1].location),h=La(Ba(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=qr(xt(m.messages[0].data)[1][0].data);for(f=Ie.find(d,l[g].location),h=La(Ba(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=qr(xt(m.messages[0].data)[2][0].data),f=Ie.find(d,l[g].location),h=La(Ba(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=qr(xt(m.messages[0].data)[2][0].data),f=Ie.find(d,l[g].location),h=La(Ba(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var y=xt(m.messages[0].data);{y[6][0].data=St(a.e.r+1),y[7][0].data=St(a.e.c+1);var b=qr(y[46][0].data),v=Ie.find(d,l[b].location),w=La(Ba(v.content));{for(var j=0;j<w.length&&w[j].id!=b;++j);if(w[j].id!=b)throw"Bad ColumnRowUIDMapArchive";var N=xt(w[j].messages[0].data);N[1]=[],N[2]=[],N[3]=[];for(var _=0;_<=a.e.c;++_){var E=[];E[1]=E[2]=[{type:0,data:St(_+420690)}],N[1].push({type:2,data:Mr(E)}),N[2].push({type:0,data:St(_)}),N[3].push({type:0,data:St(_)})}N[4]=[],N[5]=[],N[6]=[];for(var S=0;S<=a.e.r;++S)E=[],E[1]=E[2]=[{type:0,data:St(S+726270)}],N[4].push({type:2,data:Mr(E)}),N[5].push({type:0,data:St(S)}),N[6].push({type:0,data:St(S)});w[j].messages[0].data=Mr(N)}v.content=Zi(Ji(w)),v.size=v.content.length,delete y[46];var k=xt(y[4][0].data);{k[7][0].data=St(a.e.r+1);var O=xt(k[1][0].data),P=qr(O[2][0].data);v=Ie.find(d,l[P].location),w=La(Ba(v.content));{if(w[0].id!=P)throw"Bad HeaderStorageBucket";var A=xt(w[0].messages[0].data);for(S=0;S<i.length;++S){var R=xt(A[2][0].data);R[1][0].data=St(S),R[4][0].data=St(i[S].length),A[2][S]={type:A[2][0].type,data:Mr(R)}}w[0].messages[0].data=Mr(A)}v.content=Zi(Ji(w)),v.size=v.content.length;var T=qr(k[2][0].data);v=Ie.find(d,l[T].location),w=La(Ba(v.content));{if(w[0].id!=T)throw"Bad HeaderStorageBucket";for(A=xt(w[0].messages[0].data),_=0;_<=a.e.c;++_)R=xt(A[2][0].data),R[1][0].data=St(_),R[4][0].data=St(a.e.r+1),A[2][_]={type:A[2][0].type,data:Mr(R)};w[0].messages[0].data=Mr(A)}v.content=Zi(Ji(w)),v.size=v.content.length;var F=qr(k[4][0].data);(function(){for(var G=Ie.find(d,l[F].location),V=La(Ba(G.content)),H,re=0;re<V.length;++re){var me=V[re];me.id==F&&(H=me)}var xe=xt(H.messages[0].data);{xe[3]=[];var Z=[];o.forEach(function(I,ve){Z[1]=[{type:0,data:St(ve)}],Z[2]=[{type:0,data:St(1)}],Z[3]=[{type:2,data:ble(I)}],xe[3].push({type:2,data:Mr(Z)})})}H.messages[0].data=Mr(xe);var q=Ji(V),ie=Zi(q);G.content=ie,G.size=G.content.length})();var W=xt(k[3][0].data);{var K=W[1][0];delete W[2];var B=xt(K.data);{var L=qr(B[2][0].data);(function(){for(var G=Ie.find(d,l[L].location),V=La(Ba(G.content)),H,re=0;re<V.length;++re){var me=V[re];me.id==L&&(H=me)}var xe=xt(H.messages[0].data);{delete xe[6],delete W[7];var Z=new Uint8Array(xe[5][0].data);xe[5]=[];for(var q=0,ie=0;ie<=a.e.r;++ie){var I=xt(Z);q+=Ile(I,i[ie],o),I[1][0].data=St(ie),xe[5].push({data:Mr(I),type:2})}xe[1]=[{type:0,data:St(a.e.c+1)}],xe[2]=[{type:0,data:St(a.e.r+1)}],xe[3]=[{type:0,data:St(q)}],xe[4]=[{type:0,data:St(a.e.r+1)}]}H.messages[0].data=Mr(xe);var ve=Ji(V),we=Zi(ve);G.content=we,G.size=G.content.length})()}K.data=Mr(B)}k[3][0].data=Mr(W)}y[4][0].data=Mr(k)}m.messages[0].data=Mr(y);var ee=Ji(h),M=Zi(ee);return f.content=M,f.size=f.content.length,d}function q4(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function ug(e){q4([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fg(e){q4([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Rle(e){return nt.WS.indexOf(e)>-1?"sheet":e==nt.CS?"chart":e==nt.DS?"dialog":e==nt.MS?"macro":e&&e.length?e:"sheet"}function Mle(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,Rle(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function $le(e,t,r,a,s,i,o,l,c,d,u,f){try{i[a]=Xl(ka(e,r,!0),t);var h=cr(e,t),m;switch(l){case"sheet":m=ioe(h,t,s,c,i[a],d,u,f);break;case"chart":if(m=ooe(h,t,s,c,i[a],d,u,f),!m||!m["!drawel"])break;var x=Fl(m["!drawel"].Target,t),p=Zc(x),g=qre(ka(e,x,!0),Xl(ka(e,p,!0),x)),y=Fl(g,x),b=Zc(y);m=Iie(ka(e,y,!0),y,c,Xl(ka(e,b,!0),y),d,m);break;case"macro":m=loe(h,t,s,c,i[a],d,u,f);break;case"dialog":m=coe(h,t,s,c,i[a],d,u,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[a]=m;var v=[];i&&i[a]&&er(i[a]).forEach(function(w){var j="";if(i[a][w].Type==nt.CMNT){j=Fl(i[a][w].Target,t);var N=hoe(cr(e,j,!0),j,c);if(!N||!N.length)return;Cw(m,N,!1)}i[a][w].Type==nt.TCMNT&&(j=Fl(i[a][w].Target,t),v=v.concat(Xre(cr(e,j,!0),c)))}),v&&v.length&&Cw(m,v,!0,c.people||[])}catch(w){if(c.WTF)throw w}}function Ma(e){return e.charAt(0)=="/"?e.slice(1):e}function Lle(e,t){if(nl(),t=t||{},ug(t),Ua(e,"META-INF/manifest.xml")||Ua(e,"objectdata.xml"))return Uw(e,t);if(Ua(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof jh<"u"){if(e.FileIndex)return jh(e);var r=Ie.utils.cfb_new();return J1(e).forEach(function(R){Ye(r,R,YJ(e,R))}),jh(r)}throw new Error("Unsupported NUMBERS file")}if(!Ua(e,"[Content_Types].xml"))throw Ua(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ua(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=J1(e),s=HZ(ka(e,"[Content_Types].xml")),i=!1,o,l;if(s.workbooks.length===0&&(l="xl/workbook.xml",cr(e,l,!0)&&s.workbooks.push(l)),s.workbooks.length===0){if(l="xl/workbook.bin",!cr(e,l,!0))throw new Error("Could not find workbook");s.workbooks.push(l),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(Yl=[],s.sst)try{Yl=foe(cr(e,Ma(s.sst)),s.sst,t)}catch(R){if(t.WTF)throw R}t.cellStyles&&s.themes.length&&(c=uoe(ka(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=doe(cr(e,Ma(s.style)),s.style,c,t))}s.links.map(function(R){try{var T=Xl(ka(e,Zc(Ma(R))),R);return xoe(cr(e,Ma(R)),T,R,t)}catch{}});var u=soe(cr(e,Ma(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=cr(e,Ma(s.coreprops[0]),!0),h&&(f=DS(h)),s.extprops.length!==0&&(h=cr(e,Ma(s.extprops[0]),!0),h&&YZ(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=ka(e,Ma(s.custprops[0]),!0),h&&(m=ZZ(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(T){return T.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof o<"u"&&(x.SheetNames=o),t.bookSheets?x.SheetNames:t.bookProps))return x;o={};var p={};t.bookDeps&&s.calcchain&&(p=moe(cr(e,Ma(s.calcchain)),s.calcchain));var g=0,y={},b,v;{var w=u.Sheets;f.Worksheets=w.length,f.SheetNames=[];for(var j=0;j!=w.length;++j)f.SheetNames[j]=w[j].name}var N=i?"bin":"xml",_=s.workbooks[0].lastIndexOf("/"),E=(s.workbooks[0].slice(0,_+1)+"_rels/"+s.workbooks[0].slice(_+1)+".rels").replace(/^\//,"");Ua(e,E)||(E="xl/_rels/workbook."+N+".rels");var S=Xl(ka(e,E,!0),E.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=poe(cr(e,Ma(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=Jre(cr(e,Ma(s.people[0])),t)),S&&(S=Mle(S,u.Sheets));var k=cr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var O="sheet";if(S&&S[g]?(b="xl/"+S[g][1].replace(/[\/]?xl\//,""),Ua(e,b)||(b=S[g][1]),Ua(e,b)||(b=E.replace(/_rels\/.*$/,"")+S[g][1]),O=S[g][2]):(b="xl/worksheets/sheet"+(g+1-k)+"."+N,b=b.replace(/sheet0\./,"sheet.")),v=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,A=0;A!=t.sheets.length;++A)typeof t.sheets[A]=="number"&&t.sheets[A]==g&&(P=1),typeof t.sheets[A]=="string"&&t.sheets[A].toLowerCase()==f.SheetNames[g].toLowerCase()&&(P=1);if(!P)continue e}}$le(e,b,v,f.SheetNames[g],g,y,o,O,t,u,c,d)}return x={Directory:s,Workbook:u,Props:f,Custprops:m,Deps:p,Sheets:o,SheetNames:f.SheetNames,Strings:Yl,Styles:d,Themes:c,SSF:Bt(Le)},t&&t.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(R,T){R=R.replace(/^Root Entry[\/]/,""),x.keys.push(R),x.files[R]=e.FileIndex[T]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=cr(e,Ma(s.vba[0]),!0):s.defaults&&s.defaults.bin===sae&&(x.vbaraw=cr(e,"xl/vbaProject.bin",!0))),x}function Ble(e,t){var r=t||{},a="Workbook",s=Ie.find(e,a);try{if(a="/!DataSpaces/Version",s=Ie.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(pte(s.content),a="/!DataSpaces/DataSpaceMap",s=Ie.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=vte(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ie.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=yte(s.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ie.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);wte(s.content)}catch{}if(a="/EncryptionInfo",s=Ie.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var l=jte(s.content);if(a="/EncryptedPackage",s=Ie.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],s.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Ule(e,t){return t.bookType=="ods"?G4(e,t):t.bookType=="numbers"?Dle(e,t):t.bookType=="xlsb"?Wle(e,t):Hle(e,t)}function Wle(e,t){co=1024,e&&!e.SSF&&(e.SSF=Bt(Le)),e&&e.SSF&&(nl(),j0(e.SSF),t.revssf=_0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Jl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=b4.indexOf(t.bookType)>-1,s=Jp();fg(t=t||{});var i=Mp(),o="",l=0;if(t.cellXfs=[],Hs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ye(i,o,RS(e.Props,t)),s.coreprops.push(o),kt(t.rels,2,o,nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Ye(i,o,LS(e.Props)),s.extprops.push(o),kt(t.rels,3,o,nt.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ye(i,o,BS(e.Custprops)),s.custprops.push(o),kt(t.rels,4,o,nt.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var u={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ye(i,o,voe(l-1,o,t,e,u)),s.sheets.push(o),kt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+l+"."+r,Ye(i,p,woe(m,p)),s.comments.push(p),kt(u,-1,"../comments"+l+"."+r,nt.CMNT),x=!0),f["!legacy"]&&x&&Ye(i,"xl/drawings/vmlDrawing"+l+".vml",v4(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}u["!id"].rId1&&Ye(i,Zc(o),xo(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ye(i,o,boe(t.Strings,o,t)),s.strs.push(o),kt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),o="xl/workbook."+r,Ye(i,o,goe(e,o)),s.workbooks.push(o),kt(t.rels,1,o,nt.WB),o="xl/theme/theme1.xml",Ye(i,o,ag(e.Themes,t)),s.themes.push(o),kt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),o="xl/styles."+r,Ye(i,o,yoe(e,o,t)),s.styles.push(o),kt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ye(i,o,e.vbaraw),s.vba.push(o),kt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),o="xl/metadata."+r,Ye(i,o,joe(o)),s.metadata.push(o),kt(t.wbrels,-1,"metadata."+r,nt.XLMETA),Ye(i,"[Content_Types].xml",FS(s,t)),Ye(i,"_rels/.rels",xo(t.rels)),Ye(i,"xl/_rels/workbook."+r+".rels",xo(t.wbrels)),delete t.revssf,delete t.ssf,i}function Hle(e,t){co=1024,e&&!e.SSF&&(e.SSF=Bt(Le)),e&&e.SSF&&(nl(),j0(e.SSF),t.revssf=_0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Jl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=b4.indexOf(t.bookType)>-1,s=Jp();fg(t=t||{});var i=Mp(),o="",l=0;if(t.cellXfs=[],Hs(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Ye(i,o,RS(e.Props,t)),s.coreprops.push(o),kt(t.rels,2,o,nt.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Ye(i,o,LS(e.Props)),s.extprops.push(o),kt(t.rels,3,o,nt.EXT_PROPS),e.Custprops!==e.Props&&er(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Ye(i,o,BS(e.Custprops)),s.custprops.push(o),kt(t.rels,4,o,nt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Ye(i,o,O4(l-1,t,e,f)),s.sheets.push(o),kt(t.wbrels,-1,"worksheets/sheet"+l+"."+r,nt.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var y=!1;x.forEach(function(b){b[1].forEach(function(v){v.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+l+"."+r,Ye(i,g,Yre(x,u,t)),s.threadedcomments.push(g),kt(f,-1,"../threadedComments/threadedComment"+l+"."+r,nt.TCMNT)),g="xl/comments"+l+"."+r,Ye(i,g,y4(x)),s.comments.push(g),kt(f,-1,"../comments"+l+"."+r,nt.CMNT),p=!0}h["!legacy"]&&p&&Ye(i,"xl/drawings/vmlDrawing"+l+".vml",v4(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Ye(i,Zc(o),xo(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Ye(i,o,i4(t.Strings,t)),s.strs.push(o),kt(t.wbrels,-1,"sharedStrings."+r,nt.SST)),o="xl/workbook."+r,Ye(i,o,R4(e)),s.workbooks.push(o),kt(t.rels,1,o,nt.WB),o="xl/theme/theme1.xml",Ye(i,o,ag(e.Themes,t)),s.themes.push(o),kt(t.wbrels,-1,"theme/theme1.xml",nt.THEME),o="xl/styles."+r,Ye(i,o,m4(e,t)),s.styles.push(o),kt(t.wbrels,-1,"styles."+r,nt.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Ye(i,o,e.vbaraw),s.vba.push(o),kt(t.wbrels,-1,"vbaProject.bin",nt.VBA)),o="xl/metadata."+r,Ye(i,o,g4()),s.metadata.push(o),kt(t.wbrels,-1,"metadata."+r,nt.XLMETA),u.length>1&&(o="xl/persons/person.xml",Ye(i,o,Zre(u)),s.people.push(o),kt(t.wbrels,-1,"persons/person.xml",nt.PEOPLE)),Ye(i,"[Content_Types].xml",FS(s,t)),Ye(i,"_rels/.rels",xo(t.rels)),Ye(i,"xl/_rels/workbook."+r+".rels",xo(t.wbrels)),delete t.revssf,delete t.ssf,i}function hg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Oa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function zle(e,t){return Ie.find(e,"EncryptedPackage")?Ble(e,t):B4(e,t)}function Vle(e,t){var r,a=e,s=t||{};return s.type||(s.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r=lS(a,s),Lle(r,s)}function K4(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return fx(e.slice(r),t);default:break e}return Bo.to_workbook(e,t)}function Gle(e,t){var r="",a=hg(e,t);switch(t.type){case"base64":r=Oa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ei(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Ct(r)),t.type="binary",K4(r,t)}function qle(e,t){var r=e;return t.type=="base64"&&(r=Oa(r)),r=Gc.utils.decode(1200,r.slice(2),"str"),t.type="binary",K4(r,t)}function Kle(e){return e.match(/[^\x00-\x7F]/)?Nn(e):e}function Nh(e,t,r,a){return a?(r.type="string",Bo.to_workbook(e,r)):Bo.to_workbook(t,r)}function xx(e,t){Pp();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return xx(new Uint8Array(e),(r=Bt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),go={},r.dateNF&&(go.dateNF=r.dateNF),r.type||(r.type=rt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=rt?"buffer":"binary",a=WJ(e),typeof Uint8Array<"u"&&!rt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=Kle(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=Bt(r),r.type="array",xx(Fp(a),r)}switch((s=hg(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return zle(Ie.read(a,r),r);break;case 9:if(s[1]<=8)return B4(a,r);break;case 60:return fx(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Qee(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return n4.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Vle(a,r):Nh(e,a,r,i);case 239:return s[3]===60?fx(a,r):Nh(e,a,r,i);case 255:if(s[1]===254)return qle(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return xi.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return xi.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return ux.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return u4.to_workbook(a,r);break;case 10:case 13:case 32:return Gle(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Zee.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?ux.to_workbook(a,r):Nh(e,a,r,i)}function X4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Nd(t.file,Ie.write(e,{type:rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ie.write(e,t)}function Xle(e,t){var r=Bt(t||{}),a=Ule(e,r);return Yle(a,r)}function Yle(e,t){var r={},a=rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ie.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(w0(s))}return t.password&&typeof encrypt_agile<"u"?X4(encrypt_agile(s,t.password),t):t.type==="file"?Nd(t.file,s):t.type=="string"?Ct(s):s}function Jle(e,t){var r=t||{},a=Koe(e,r);return X4(a,r)}function gn(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return qc(Nn(a));case"binary":return Nn(a);case"string":return e;case"file":return Nd(t.file,a,"utf8");case"buffer":return rt?cs(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):gn(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Zle(e,t){switch(t.type){case"base64":return qc(e);case"binary":return e;case"string":return e;case"file":return Nd(t.file,e,"binary");case"buffer":return rt?cs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function tu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?qc(r):t.type=="string"?Ct(r):r;case"file":return Nd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Y4(e,t){Pp(),zie(e);var r=Bt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=Y4(e,r);return r.type="array",w0(a)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return gn(Uoe(e,r),r);case"slk":case"sylk":return gn(a4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return gn(W4(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Zle(Z4(e.Sheets[e.SheetNames[s]],r),r);case"csv":return gn(mg(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return gn(n4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return tu(ux.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return gn(Bo.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return gn(u4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return gn(s4.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return gn(G4(e,r),r);case"wk1":return tu(xi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return tu(xi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),tu(U4(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Jle(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Xle(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Qle(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function J4(e,t,r){var a={};return a.type="file",a.file=t,Qle(a),Y4(e,a)}function ece(e,t,r,a,s,i,o,l){var c=ir(r),d=l.defval,u=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=o?e[r][m]:e[a[m]+c];if(x===void 0||x.t===void 0){if(d===void 0)continue;i[m]!=null&&(h[i[m]]=d);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[i[m]]=null;else if(d!==void 0)h[i[m]]=d;else if(u&&p===null)h[i[m]]=null;else continue;else h[i[m]]=u&&(x.t!=="n"||x.t==="n"&&l.rawNumbers!==!1)?p:ns(x,p,l);p!=null&&(f=!1)}}return{row:h,isempty:f}}function wf(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},u=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)?a=3:d.header==null&&(a=0),typeof u){case"string":c=ht(u);break;case"number":c=ht(e["!ref"]),c.s.r=u;break;default:c=u}a>0&&(s=0);var f=ir(c.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),y=c.s.r,b=0,v={};g&&!e[y]&&(e[y]=[]);var w=d.skipHidden&&e["!cols"]||[],j=d.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(w[b]||{}).hidden)switch(h[b]=Xt(b),r=g?e[y][b]:e[h[b]+f],a){case 1:i[b]=b-c.s.c;break;case 2:i[b]=h[b];break;case 3:i[b]=d.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=ns(r,null,d),p=v[o]||0,!p)v[o]=1;else{do l=o+"_"+p++;while(v[l]);v[o]=p,v[l]=1}i[b]=l}for(y=c.s.r+s;y<=c.e.r;++y)if(!(j[y]||{}).hidden){var N=ece(e,c,y,h,a,i,g,d);(N.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows))&&(m[x++]=N.row)}return m.length=x,m}var Gw=/"/g;function tce(e,t,r,a,s,i,o,l){for(var c=!0,d=[],u="",f=ir(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var m=l.dense?(e[r]||[])[h]:e[a[h]+f];if(m==null)u="";else if(m.v!=null){c=!1,u=""+(l.rawNumbers&&m.t=="n"?m.v:ns(m,null,l));for(var x=0,p=0;x!==u.length;++x)if((p=u.charCodeAt(x))===s||p===i||p===34||l.forceQuotes){u='"'+u.replace(Gw,'""')+'"';break}u=="ID"&&(u='"ID"')}else m.f!=null&&!m.F?(c=!1,u="="+m.f,u.indexOf(",")>=0&&(u='"'+u.replace(Gw,'""')+'"')):u="";d.push(u)}return l.blankrows===!1&&c?null:d.join(o)}function mg(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=ht(e["!ref"]),i=a.FS!==void 0?a.FS:",",o=i.charCodeAt(0),l=a.RS!==void 0?a.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],m=a.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(f[x]=Xt(x));for(var p=0,g=s.s.r;g<=s.e.r;++g)(m[g]||{}).hidden||(u=tce(e,s,g,f,o,c,i,a),u!=null&&(a.strip&&(u=u.replace(d,"")),(u||a.blankrows!==!1)&&r.push((p++?l:"")+u)));return delete a.dense,r.join("")}function Z4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=mg(e,t);return r}function rce(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=ht(e["!ref"]),i="",o=[],l,c=[],d=Array.isArray(e);for(l=s.s.c;l<=s.e.c;++l)o[l]=Xt(l);for(var u=s.s.r;u<=s.e.r;++u)for(i=ir(u),l=s.s.c;l<=s.e.c;++l)if(t=o[l]+i,r=d?(e[u]||[])[l]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}c[c.length]=t+"="+a}return c}function Q4(e,t,r){var a=r||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var c=typeof a.origin=="string"?Yt(a.origin):a.origin;o=c.r,l=c.c}var d,u={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var f=ht(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),o==-1&&(o=f.e.r+1,u.e.r=o+t.length-1+s)}else o==-1&&(o=0,u.e.r=t.length-1+s);var h=a.header||[],m=0;t.forEach(function(p,g){er(p).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var b=p[y],v="z",w="",j=Be({c:l+m,r:o+g+s});d=sd(i,j),b&&typeof b=="object"&&!(b instanceof Date)?i[j]=b:(typeof b=="number"?v="n":typeof b=="boolean"?v="b":typeof b=="string"?v="s":b instanceof Date?(v="d",a.cellDates||(v="n",b=jr(b)),w=a.dateNF||Le[14]):b===null&&a.nullError&&(v="e",b=0),d?(d.t=v,d.v=b,delete d.w,delete d.R,w&&(d.z=w)):i[j]=d={t:v,v:b},w&&(d.z=w))})}),u.e.c=Math.max(u.e.c,l+h.length-1);var x=ir(o);if(s)for(m=0;m<h.length;++m)i[Xt(m+l)+x]={t:"s",v:h[m]};return i["!ref"]=Ke(u),i}function ace(e,t){return Q4(null,e,t)}function sd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=Yt(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?sd(e,Be(t)):sd(e,Be({r:t,c:r||0}))}function nce(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function xg(){return{SheetNames:[],Sheets:{}}}function pg(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var o=i&&i[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=o+s)!=-1;++s);}if(D4(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function sce(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=nce(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function ice(e,t){return e.z=t,e}function ek(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function oce(e,t,r){return ek(e,"#"+t,r)}function lce(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function cce(e,t,r,a){for(var s=typeof t!="string"?t:ht(t),i=typeof t=="string"?t:Ke(t),o=s.s.r;o<=s.e.r;++o)for(var l=s.s.c;l<=s.e.c;++l){var c=sd(e,o,l);c.t="n",c.F=i,delete c.v,o==s.s.r&&l==s.s.c&&(c.f=r,a&&(c.D=!0))}return e}var li={encode_col:Xt,encode_row:ir,encode_cell:Be,encode_range:Ke,decode_col:Vp,decode_row:zp,split_cell:bZ,decode_cell:Yt,decode_range:va,format_cell:ns,sheet_add_aoa:kS,sheet_add_json:Q4,sheet_add_dom:H4,aoa_to_sheet:sl,json_to_sheet:ace,table_to_sheet:z4,table_to_book:ple,sheet_to_csv:mg,sheet_to_txt:Z4,sheet_to_json:wf,sheet_to_html:W4,sheet_to_formulae:rce,sheet_to_row_object_array:wf,sheet_get_cell:sd,book_new:xg,book_append_sheet:pg,book_set_sheet_visibility:sce,cell_set_number_format:ice,cell_set_hyperlink:ek,cell_set_internal_link:oce,cell_add_comment:lce,sheet_set_array_formula:cce,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const dce=({isOpen:e,onClose:t,onImport:r,projectIdeas:a})=>{const[s,i]=C.useState("import"),[o,l]=C.useState(!1),[c,d]=C.useState(null),[u,f]=C.useState(null),[h,m]=C.useState([]),x=C.useRef(null);if(!e)return null;const p=b=>{var j;const v=(j=b.target.files)==null?void 0:j[0];if(!v)return;l(!0),d(null),f(null),m([]);const w=new FileReader;w.onload=N=>{var _;try{const E=(_=N.target)==null?void 0:_.result,S=xx(E,{type:"binary"}),k=S.SheetNames[0],O=S.Sheets[k],A=li.sheet_to_json(O).map(R=>{const T=R.objectives?R.objectives.split(",").map(B=>B.trim()):[],F=R.materials?R.materials.split(",").map(B=>B.trim()):[],W=R.steps?R.steps.split(",").map(B=>B.trim()):[],K=R.tags?R.tags.split(",").map(B=>B.trim()):[];return{title:R.title||"",description:R.description||"",category:R.category||"stem",difficulty:R.difficulty||"beginner",duration:R.duration||"",subject:R.subject||"",image:R.image||"",objectives:T,materials:F,steps:W,tags:K}});m(A),f(`تم تحليل ${A.length} فكرة مشروع بنجاح. اضغط على "استيراد" للمتابعة.`)}catch(E){console.error("Error parsing Excel file:",E),d("حدث خطأ أثناء تحليل ملف Excel. تأكد من أن الملف بالتنسيق الصحيح.")}finally{l(!1)}},w.onerror=()=>{d("حدث خطأ أثناء قراءة الملف."),l(!1)},w.readAsBinaryString(v)},g=async()=>{if(h.length===0){d("لا توجد بيانات للاستيراد.");return}l(!0),d(null),f(null);try{await r(h),f(`تم استيراد ${h.length} فكرة مشروع بنجاح.`),m([]),x.current&&(x.current.value="")}catch(b){console.error("Error importing ideas:",b),d(b instanceof Error?b.message:"حدث خطأ أثناء استيراد الأفكار.")}finally{l(!1)}},y=()=>{l(!0),d(null),f(null);try{const b=a.map(j=>{var N,_,E,S;return{title:j.title,description:j.description,category:j.category,difficulty:j.difficulty,duration:j.duration,subject:j.subject,image:j.image,objectives:(N=j.objectives)==null?void 0:N.join(", "),materials:(_=j.materials)==null?void 0:_.join(", "),steps:(E=j.steps)==null?void 0:E.join(", "),tags:(S=j.tags)==null?void 0:S.join(", ")}}),v=li.json_to_sheet(b),w=li.book_new();li.book_append_sheet(w,v,"أفكار المشاريع"),J4(w,"project_ideas.xlsx"),f("تم تصدير أفكار المشاريع بنجاح.")}catch(b){console.error("Error exporting ideas:",b),d("حدث خطأ أثناء تصدير الأفكار.")}finally{l(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-2xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(su,{className:"w-6 h-6 text-blue-600"}),"استيراد وتصدير أفكار المشاريع"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"flex border-b border-gray-200 mb-6",children:[n.jsx("button",{onClick:()=>i("import"),className:`px-4 py-2 font-medium text-sm border-b-2 ${s==="import"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"استيراد من Excel"}),n.jsx("button",{onClick:()=>i("export"),className:`px-4 py-2 font-medium text-sm border-b-2 ${s==="export"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"تصدير إلى Excel"})]}),c&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:c})]}),u&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),s==="import"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Cn,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"تنسيق ملف الاستيراد"}),n.jsxs("p",{className:"text-sm text-blue-700",children:["يجب أن يحتوي ملف Excel على الأعمدة التالية: title, description, category, difficulty, duration, subject, image, objectives, materials, steps, tags.",n.jsx("br",{}),"للحقول التي تحتوي على قائمة (objectives, materials, steps, tags)، يجب فصل العناصر بفاصلة."]})]})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center",children:[n.jsx(su,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"اختر ملف Excel"}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"اسحب وأفلت الملف هنا أو اضغط لاختيار ملف"}),n.jsx("input",{type:"file",ref:x,onChange:p,accept:".xlsx, .xls",className:"hidden"}),n.jsx("button",{type:"button",onClick:()=>{var b;return(b=x.current)==null?void 0:b.click()},disabled:o,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"اختيار ملف"})]}),h.length>0&&n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"ملخص البيانات المستوردة"}),n.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[n.jsxs("p",{className:"text-gray-700",children:["عدد الأفكار: ",h.length]}),n.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto",children:n.jsx("ul",{className:"space-y-1",children:h.map((b,v)=>n.jsx("li",{className:"text-sm text-gray-600",children:b.title},v))})})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"button",onClick:g,disabled:o||h.length===0,className:"px-6 py-3 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري المعالجة..."]}):n.jsxs(n.Fragment,{children:[n.jsx(bi,{className:"w-5 h-5"}),"استيراد"]})})]})]}),s==="export"&&n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Cn,{className:"w-5 h-5 text-blue-500 mt-1"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium text-blue-800 mb-1",children:"معلومات التصدير"}),n.jsxs("p",{className:"text-sm text-blue-700",children:["سيتم تصدير جميع أفكار المشاريع (",a.length," فكرة) إلى ملف Excel.",n.jsx("br",{}),"يمكنك تعديل الملف وإعادة استيراده لتحديث الأفكار."]})]})]}),n.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center",children:[n.jsx(su,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),n.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"تصدير أفكار المشاريع"}),n.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"اضغط على الزر أدناه لتصدير جميع أفكار المشاريع إلى ملف Excel"}),n.jsx("button",{type:"button",onClick:y,disabled:o||a.length===0,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2 mx-auto disabled:opacity-50 disabled:cursor-not-allowed",children:o?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري التصدير..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Cr,{className:"w-5 h-5"}),"تصدير إلى Excel"]})})]}),n.jsx("div",{className:"flex justify-end",children:n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إغلاق"})})]})]})})},uce=()=>{const{projectIdeas:e,loading:t,error:r,fetchProjectIdeas:a,addIdea:s,editIdea:i,removeIdea:o,incrementViews:l,incrementDownloads:c,approveIdea:d,rejectIdea:u}=kx(),[f,h]=C.useState("all"),[m,x]=C.useState("all"),[p,g]=C.useState("all"),[y,b]=C.useState(""),[v,w]=C.useState(!1),[j,N]=C.useState(!1),[_,E]=C.useState(!1),[S,k]=C.useState(!1),[O,P]=C.useState(!1),[A,R]=C.useState(null),[T,F]=C.useState(null),[W,K]=C.useState(null),[B,L]=C.useState(""),[ee,M]=C.useState(!1),[G,V]=C.useState(!1),[H,re]=C.useState(!1),[me,xe]=C.useState(!1),[Z,q]=C.useState(null),[ie,I]=C.useState(null),[ve,we]=C.useState(!1),[Ee,ce]=C.useState(null),[fe,oe]=C.useState(null),qe=[{id:"all",name:"جميع الفئات"},{id:"stem",name:"ستيم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"volunteer",name:"التطوع"},{id:"ethics",name:"الأخلاق"}],st=[{id:"all",name:"جميع المستويات"},{id:"beginner",name:"مبتدئ"},{id:"intermediate",name:"متوسط"},{id:"advanced",name:"متقدم"}],lt=[{id:"all",name:"جميع الحالات",color:"bg-gray-100 text-gray-800"},{id:"pending",name:"قيد المراجعة",color:"bg-yellow-100 text-yellow-800"},{id:"approved",name:"موافق عليها",color:"bg-green-100 text-green-800"},{id:"rejected",name:"مرفوضة",color:"bg-red-100 text-red-800"}],Ft=e.filter(je=>{const hn=f==="all"||je.category===f,fs=m==="all"||je.difficulty===m,Pd=p==="all"||je.status===p,Fd=je.title.toLowerCase().includes(y.toLowerCase())||je.description.toLowerCase().includes(y.toLowerCase());return hn&&fs&&Pd&&Fd}),Vt=async je=>{await s(je)},Jt=async je=>{A&&await i(A.id,je)},ra=async()=>{if(T){M(!0);try{await o(T.id),E(!1)}catch(je){console.error("Error deleting idea:",je)}finally{M(!1),F(null)}}},Dr=async je=>{V(!0);try{await d(je),await a()}catch(hn){console.error("Error approving idea:",hn)}finally{V(!1)}},zs=async()=>{if(!(!W||!B)){re(!0);try{await u(W.id,B),P(!1),await a()}catch(je){console.error("Error rejecting idea:",je)}finally{re(!1),K(null),L("")}}},Rr=async je=>{for(const hn of je)await s(hn)},Fa=async()=>{xe(!0),q(null),I(null);try{const je=await D3();q(`تم حذف ${je} فكرة مكررة بنجاح`),await a()}catch(je){console.error("Error cleaning up duplicates:",je),I("حدث خطأ أثناء حذف الأفكار المكررة")}finally{xe(!1)}},Qe=async()=>{we(!0),ce(null),oe(null);try{const je=e.filter(fs=>fs.status!=="approved");if(je.length===0){ce("لا توجد أفكار في انتظار الموافقة"),we(!1);return}let hn=0;for(const fs of je)await i(fs.id,{status:"approved"}),hn++;await a(),ce(`تمت الموافقة على ${hn} فكرة بنجاح`)}catch(je){console.error("Error approving pending ideas:",je),oe("حدث خطأ أثناء الموافقة على الأفكار")}finally{we(!1)}},Gt=je=>{switch(je){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},ua=je=>{switch(je){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return je}},tr=je=>{switch(je){case"stem":return"ستيم";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return je}},Rn=je=>{switch(je){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Od=je=>{switch(je){case"pending":return"قيد المراجعة";case"approved":return"موافق عليها";case"rejected":return"مرفوضة";default:return je}};return t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ga,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة أفكار المشاريع"}),n.jsx("p",{className:"opacity-90",children:"إضافة وتعديل وحذف أفكار المشاريع"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:()=>k(!0),className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2",children:[n.jsx(su,{className:"w-5 h-5"}),"استيراد / تصدير"]}),n.jsxs("button",{onClick:Fa,disabled:me,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(jj,{className:"w-5 h-5"}),me?"جاري الحذف...":"حذف المكرر"]}),n.jsxs("button",{onClick:Qe,disabled:ve,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(ze,{className:"w-5 h-5"}),ve?"جاري الموافقة...":"الموافقة على الكل"]}),n.jsxs("button",{onClick:()=>{R(null),N(!0)},className:"bg-white text-blue-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),"إضافة فكرة جديدة"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فكرة مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="pending").length}),n.jsx("div",{className:"text-sm opacity-80",children:"قيد المراجعة"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="approved").length}),n.jsx("div",{className:"text-sm opacity-80",children:"موافق عليها"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:e.filter(je=>je.status==="rejected").length}),n.jsx("div",{className:"text-sm opacity-80",children:"مرفوضة"})]})]})]}),Z&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:Z})]}),ie&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(vt,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:ie})]}),Ee&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(ze,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:Ee})]}),fe&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center gap-2",children:[n.jsx(vt,{className:"w-5 h-5 flex-shrink-0"}),n.jsx("p",{children:fe})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في أفكار المشاريع...",value:y,onChange:je=>b(je.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:()=>w(!v),className:"lg:hidden flex items-center gap-2 px-4 py-3 bg-gray-100 rounded-xl hover:bg-gray-200 transition-colors",children:[n.jsx(zo,{className:"w-5 h-5"}),"الفلاتر"]})]}),n.jsxs("div",{className:`space-y-4 ${v?"block":"hidden lg:block"}`,children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"حالة الفكرة"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:lt.map(je=>n.jsx("button",{onClick:()=>g(je.id),className:`px-4 py-2 rounded-xl transition-all ${p===je.id?je.color:"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:qe.map(je=>n.jsx("button",{onClick:()=>h(je.id),className:`px-4 py-2 rounded-xl transition-all ${f===je.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"مستوى الصعوبة"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:st.map(je=>n.jsx("button",{onClick:()=>x(je.id),className:`px-4 py-2 rounded-xl transition-all ${m===je.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:je.name},je.id))})]})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",Ft.length," من أصل ",e.length," فكرة"]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العنوان"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفئة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الصعوبة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشاهدات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"التنزيلات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإنشاء"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Ft.map(je=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-md overflow-hidden",children:n.jsx("img",{src:je.image||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=150",alt:je.title,className:"h-10 w-10 object-cover"})}),n.jsxs("div",{className:"mr-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:je.title}),n.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:je.description})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:tr(je.category)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Gt(je.difficulty)}`,children:ua(je.difficulty)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${Rn(je.status)}`,children:Od(je.status)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.views}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.downloads}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:je.created_at?Ze(je.created_at):"غير محدد"}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[je.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Dr(je.id),disabled:G,className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:"موافقة",children:n.jsx(ze,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{K(je),P(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"رفض",children:n.jsx(Br,{className:"w-5 h-5"})})]}),n.jsx("button",{onClick:()=>{R(je),N(!0)},className:"p-1 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded transition-colors",title:"تعديل",children:n.jsx(Ca,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{F(je),E(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"حذف",children:n.jsx(sr,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>l(je.id),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:"عرض",children:n.jsx(nr,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>c(je.id),className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:"تنزيل",children:n.jsx(Cr,{className:"w-5 h-5"})})]})})]},je.id))})]})})}),Ft.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ga,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد أفكار مشاريع"}),n.jsx("p",{className:"text-gray-600 mb-4",children:e.length===0?"لم يتم إضافة أي أفكار مشاريع بعد":"لم يتم العثور على أفكار مشاريع تطابق معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:()=>{R(null),N(!0)},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors flex items-center gap-2",children:[n.jsx(yt,{className:"w-4 h-4"}),"إضافة فكرة جديدة"]}),e.length>0&&n.jsx("button",{onClick:()=>{h("all"),x("all"),g("all"),b("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]}),n.jsx(Dj,{isOpen:j,onClose:()=>N(!1),onSubmit:A?Jt:Vt,editingIdea:A}),n.jsx(cJ,{isOpen:_,onClose:()=>E(!1),onConfirm:ra,title:(T==null?void 0:T.title)||"",isDeleting:ee}),n.jsx(dce,{isOpen:S,onClose:()=>k(!1),onImport:Rr,projectIdeas:e}),O&&W&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Br,{className:"w-6 h-6 text-red-600"}),"رفض فكرة المشروع"]}),n.jsx("button",{onClick:()=>P(!1),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Br,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"أنت على وشك رفض فكرة المشروع التالية:"}),n.jsxs("p",{className:"font-semibold text-gray-800 mb-4",children:['"',W.title,'"']}),n.jsxs("div",{className:"mb-4",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"سبب الرفض (سيتم إرساله للمستخدم)"}),n.jsx("textarea",{value:B,onChange:je=>L(je.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"اشرح سبب رفض هذه الفكرة...",required:!0})]})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:()=>P(!1),className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:zs,disabled:H||!B.trim(),className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:H?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الرفض..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Br,{className:"w-5 h-5"}),"تأكيد الرفض"]})})]})]})})]})},fce=({isOpen:e,onClose:t,onSubmit:r,editingVideo:a})=>{var w;const[s,i]=C.useState({title:"",description:"",type:"video",category:"",author:"",duration:"",difficulty:"beginner",thumbnail:"",contentUrl:"",videoUrl:"",watchUrl:"",embedUrl:"",tags:[],featured:!1}),[o,l]=C.useState(""),[c,d]=C.useState(!1),[u,f]=C.useState(null),[h,m]=C.useState(null);C.useEffect(()=>{var j;i(a?{...a,tags:(j=a.tags)!=null&&j.length?a.tags:[]}:{title:"",description:"",type:"video",category:"",author:"",duration:"",difficulty:"beginner",thumbnail:"",contentUrl:"",videoUrl:"",watchUrl:"",embedUrl:"",tags:[],featured:!1}),l(""),f(null),m(null)},[a,e]);const x=[{id:"project-management",name:"إدارة المشاريع"},{id:"programming",name:"البرمجة"},{id:"design",name:"التصميم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"stem",name:"ستيم"},{id:"soft-skills",name:"المهارات الناعمة"},{id:"education",name:"التعليم"},{id:"intellectual-property",name:"الملكية الفكرية"}],p=[{id:"beginner",name:"مبتدئ"},{id:"intermediate",name:"متوسط"},{id:"advanced",name:"متقدم"}],g=(j,N)=>{if(i(_=>({..._,[j]:N})),j==="videoUrl"&&N)try{if(N.includes("youtube.com")||N.includes("youtu.be")){if(N.includes("embed")){const _=N.split("/").pop();_&&i(E=>({...E,watchUrl:`https://www.youtube.com/watch?v=${_}`,embedUrl:N}))}else if(N.includes("watch")){const E=new URL(N).searchParams.get("v");E&&i(S=>({...S,watchUrl:N,embedUrl:`https://www.youtube.com/embed/${E}`}))}}}catch(_){console.error("Error parsing video URL:",_)}},y=()=>{o.trim()&&(i(j=>({...j,tags:[...j.tags||[],o.trim()]})),l(""))},b=j=>{i(N=>{var _;return{...N,tags:(_=N.tags)==null?void 0:_.filter((E,S)=>S!==j)}})},v=async j=>{if(j.preventDefault(),!s.title||!s.description||!s.category||!s.author){f("يرجى ملء جميع الحقول المطلوبة");return}if(s.videoUrl&&(!s.watchUrl||!s.embedUrl))try{if(s.videoUrl.includes("youtube.com")||s.videoUrl.includes("youtu.be")){if(s.videoUrl.includes("embed")&&!s.watchUrl){const N=s.videoUrl.split("/").pop();N&&(s.watchUrl=`https://www.youtube.com/watch?v=${N}`)}else if(s.videoUrl.includes("watch")&&!s.embedUrl){const _=new URL(s.videoUrl).searchParams.get("v");_&&(s.embedUrl=`https://www.youtube.com/embed/${_}`)}}}catch(N){console.error("Error deriving video URLs:",N)}d(!0),f(null),m(null);try{await r(s),m("تم حفظ الفيديو بنجاح"),setTimeout(()=>{t()},1500)}catch(N){console.error("Error submitting video:",N),f(N instanceof Error?N.message:"حدث خطأ في حفظ الفيديو")}finally{d(!1)}};return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(wr,{className:"w-6 h-6 text-emerald-600"}),a?"تعديل فيديو تعليمي":"إضافة فيديو تعليمي جديد"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),u&&n.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(vt,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:u})]}),h&&n.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg mb-6 flex items-start gap-2",children:[n.jsx(ze,{className:"w-5 h-5 mt-0.5 flex-shrink-0"}),n.jsx("div",{children:h})]}),n.jsxs("form",{onSubmit:v,className:"space-y-6",children:[n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"عنوان الفيديو *"}),n.jsx("input",{type:"text",value:s.title,onChange:j=>g("title",j.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل عنوان الفيديو",required:!0})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"وصف الفيديو *"}),n.jsx("textarea",{value:s.description,onChange:j=>g("description",j.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اكتب وصفاً شاملاً للفيديو ومحتواه",required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الفئة *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Nt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsxs("select",{value:s.category,onChange:j=>g("category",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",required:!0,children:[n.jsx("option",{value:"",children:"اختر الفئة"}),x.map(j=>n.jsx("option",{value:j.id,children:j.name},j.id))]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المؤلف *"}),n.jsxs("div",{className:"relative",children:[n.jsx(xr,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.author,onChange:j=>g("author",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"اسم المؤلف أو المقدم",required:!0})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"المدة"}),n.jsxs("div",{className:"relative",children:[n.jsx(_t,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:s.duration,onChange:j=>g("duration",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"مثال: 15 دقيقة"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"مستوى الصعوبة"}),n.jsxs("div",{className:"relative",children:[n.jsx(s3,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("select",{value:s.difficulty||"beginner",onChange:j=>g("difficulty",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",children:p.map(j=>n.jsx("option",{value:j.id,children:j.name},j.id))})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الصورة المصغرة"}),n.jsxs("div",{className:"relative",children:[n.jsx(dd,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.thumbnail||"",onChange:j=>g("thumbnail",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل رابط الصورة المصغرة"})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"رابط الفيديو *"}),n.jsxs("div",{className:"relative",children:[n.jsx(cu,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"url",value:s.videoUrl||"",onChange:j=>g("videoUrl",j.target.value),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أدخل رابط الفيديو (مثال: https://www.youtube.com/watch?v=...)",required:!0})]}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"يمكنك إدخال رابط المشاهدة العادي أو رابط التضمين"})]}),n.jsxs("div",{className:"md:col-span-2",children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"الكلمات المفتاحية"}),n.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:(w=s.tags)==null?void 0:w.map((j,N)=>n.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full",children:[n.jsx("span",{children:j}),n.jsx("button",{type:"button",onClick:()=>b(N),className:"w-4 h-4 rounded-full flex items-center justify-center hover:bg-emerald-200",children:n.jsx(Ot,{className:"w-3 h-3"})})]},N))}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(ud,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",value:o,onChange:j=>l(j.target.value),onKeyPress:j=>j.key==="Enter"&&(j.preventDefault(),y()),className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"أضف كلمة مفتاحية"})]}),n.jsx("button",{type:"button",onClick:y,className:"px-4 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors",children:"إضافة"})]})]}),n.jsxs("div",{className:"flex items-center",children:[n.jsx("input",{type:"checkbox",id:"featured",checked:s.featured||!1,onChange:j=>g("featured",j.target.checked),className:"w-4 h-4 text-emerald-600 border-gray-300 rounded focus:ring-emerald-500"}),n.jsx("label",{htmlFor:"featured",className:"ml-2 block text-sm text-gray-900",children:"عرض كفيديو مميز"})]})]}),n.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[n.jsx("button",{type:"button",onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{type:"submit",disabled:c,className:"px-6 py-3 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحفظ..."]}):n.jsxs(n.Fragment,{children:[n.jsx(es,{className:"w-5 h-5"}),a?"حفظ التغييرات":"إضافة الفيديو"]})})]})]})]})}):null},hce=({isOpen:e,onClose:t,onConfirm:r,title:a,isDeleting:s})=>e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(vt,{className:"w-6 h-6 text-red-600"}),"تأكيد الحذف"]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700",children:"هل أنت متأكد من حذف الفيديو التالي؟"}),n.jsxs("p",{className:"font-semibold text-gray-800 mt-2",children:['"',a,'"']}),n.jsx("p",{className:"text-red-600 text-sm mt-4",children:"هذا الإجراء لا يمكن التراجع عنه."})]}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إلغاء"}),n.jsx("button",{onClick:r,disabled:s,className:"px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"جاري الحذف..."]}):n.jsxs(n.Fragment,{children:[n.jsx(sr,{className:"w-5 h-5"}),"تأكيد الحذف"]})})]})]})}):null,mce=()=>{const{resources:e,loading:t,error:r,fetchResources:a,createResource:s,updateResource:i,deleteResource:o,cleanupDuplicateResources:l}=Ex(),[c,d]=C.useState([]),[u,f]=C.useState(""),[h,m]=C.useState("all"),[x,p]=C.useState(!1),[g,y]=C.useState(null),[b,v]=C.useState(!1),[w,j]=C.useState(null),[N,_]=C.useState(!1),[E,S]=C.useState(null),[k,O]=C.useState(!1),[P,A]=C.useState(null),[R,T]=C.useState(null);C.useEffect(()=>{if(e){const H=e.filter(re=>re.type==="video");d(H)}},[e]),C.useEffect(()=>{a("video")},[]);const F=[{id:"all",name:"جميع الفئات"},{id:"project-management",name:"إدارة المشاريع"},{id:"programming",name:"البرمجة"},{id:"design",name:"التصميم"},{id:"entrepreneurship",name:"ريادة الأعمال"},{id:"stem",name:"ستيم"},{id:"soft-skills",name:"المهارات الناعمة"},{id:"education",name:"التعليم"},{id:"intellectual-property",name:"الملكية الفكرية"}],W=c.filter(H=>{const re=h==="all"||H.category===h,me=H.title.toLowerCase().includes(u.toLowerCase())||H.description.toLowerCase().includes(u.toLowerCase())||H.author.toLowerCase().includes(u.toLowerCase());return re&&me}),K=async H=>{try{await s({...H,type:"video"}),S("تم إضافة الفيديو بنجاح"),setTimeout(()=>S(null),3e3);return}catch(re){throw console.error("Error adding video:",re),re}},B=async H=>{if(g)try{await i(g.id,{...H,type:"video"}),S("تم تحديث الفيديو بنجاح"),setTimeout(()=>S(null),3e3);return}catch(re){throw console.error("Error updating video:",re),re}},L=async()=>{if(w){_(!0);try{await o(w.id),v(!1),S("تم حذف الفيديو بنجاح"),setTimeout(()=>S(null),3e3)}catch(H){console.error("Error deleting video:",H)}finally{_(!1),j(null)}}},ee=async()=>{O(!0),A(null),T(null);try{const H=await l();A(`تم حذف ${H} مورد تعليمي مكرر بنجاح`),await a("video")}catch(H){console.error("Error cleaning up duplicates:",H),T("حدث خطأ أثناء حذف الموارد المكررة")}finally{O(!1)}},M=H=>{switch(H){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},G=H=>{switch(H){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return H||"غير محدد"}},V=H=>{const re=F.find(me=>me.id===H);return re?re.name:H};return t&&c.length===0?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-emerald-500"})}):r?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"حدث خطأ"}),n.jsx("p",{className:"text-gray-600",children:r})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(wr,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"إدارة الفيديوهات التعليمية"}),n.jsx("p",{className:"opacity-90",children:"إضافة وتعديل وحذف الفيديوهات التعليمية"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:ee,disabled:k,className:"bg-white bg-opacity-20 text-white px-6 py-3 rounded-xl font-medium hover:bg-opacity-30 transition-all duration-200 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(jj,{className:"w-5 h-5"}),k?"جاري الحذف...":"حذف المكرر"]}),n.jsxs("button",{onClick:()=>{y(null),p(!0)},className:"bg-white text-emerald-600 px-6 py-3 rounded-xl font-medium hover:bg-opacity-90 transition-all duration-200 flex items-center gap-2",children:[n.jsx(yt,{className:"w-5 h-5"}),"إضافة فيديو جديد"]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فيديو تعليمي"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.filter(H=>H.featured).length}),n.jsx("div",{className:"text-sm opacity-80",children:"فيديو مميز"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:c.reduce((H,re)=>H+re.views,0).toLocaleString()}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي المشاهدات"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:F.length-1}),n.jsx("div",{className:"text-sm opacity-80",children:"فئة"})]})]})]}),E&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تمت العملية بنجاح"}),n.jsx("p",{className:"text-green-700",children:E})]})]}),P&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:"تم حذف العناصر المكررة بنجاح"}),n.jsx("p",{className:"text-green-700",children:P})]})]}),R&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(vt,{className:"w-6 h-6 text-red-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-red-800 mb-1",children:"حدث خطأ"}),n.jsx("p",{className:"text-red-700",children:R})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsx("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:"البحث في الفيديوهات...",value:u,onChange:H=>f(H.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent"})]})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-gray-700 mb-3",children:"الفئات"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:F.map(H=>n.jsx("button",{onClick:()=>m(H.id),className:`px-4 py-2 rounded-xl transition-all ${h===H.id?"bg-emerald-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:H.name},H.id))})]})]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("p",{className:"text-gray-600",children:["عرض ",W.length," من أصل ",c.length," فيديو"]})}),n.jsx("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفيديو"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفئة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المؤلف"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المستوى"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشاهدات"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ الإضافة"}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W.map(H=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-16 rounded-md overflow-hidden",children:n.jsx("img",{src:H.thumbnail||"https://images.pexels.com/photos/3183150/pexels-photo-3183150.jpeg?auto=compress&cs=tinysrgb&w=150",alt:H.title,className:"h-10 w-16 object-cover"})}),n.jsxs("div",{className:"mr-4",children:[n.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.title}),n.jsx("div",{className:"text-sm text-gray-500 line-clamp-1",children:H.description})]})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-emerald-100 text-emerald-800",children:V(H.category)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.author}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${M(H.difficulty)}`,children:G(H.difficulty)})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:H.views.toLocaleString()}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ze(H.createdAt)}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>{y(H),p(!0)},className:"p-1 text-indigo-600 hover:text-indigo-900 hover:bg-indigo-50 rounded transition-colors",title:"تعديل",children:n.jsx(Ca,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{j(H),v(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:"حذف",children:n.jsx(sr,{className:"w-5 h-5"})}),n.jsx("a",{href:H.watchUrl||H.contentUrl||"#",target:"_blank",rel:"noopener noreferrer",className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:"عرض",children:n.jsx(wi,{className:"w-5 h-5"})})]})})]},H.id))})]})})}),W.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(wr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لا توجد فيديوهات"}),n.jsx("p",{className:"text-gray-600 mb-4",children:c.length===0?"لم يتم إضافة أي فيديوهات تعليمية بعد":"لم يتم العثور على فيديوهات تطابق معايير البحث"}),n.jsxs("div",{className:"flex justify-center gap-4",children:[n.jsxs("button",{onClick:()=>{y(null),p(!0)},className:"px-6 py-2 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 transition-colors flex items-center gap-2",children:[n.jsx(yt,{className:"w-4 h-4"}),"إضافة فيديو جديد"]}),c.length>0&&n.jsx("button",{onClick:()=>{m("all"),f("")},className:"px-6 py-2 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:"إعادة تعيين الفلاتر"})]})]}),n.jsx(fce,{isOpen:x,onClose:()=>p(!1),onSubmit:g?B:K,editingVideo:g}),n.jsx(hce,{isOpen:b,onClose:()=>v(!1),onConfirm:L,title:(w==null?void 0:w.title)||"",isDeleting:N})]})},xce=({isOpen:e,onClose:t,registration:r})=>{const{t:a}=jt();return!e||!r?null:n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(xr,{className:"w-6 h-6 text-blue-600"}),r.fullName]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.email")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ta,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.email})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.phone")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.phone})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.parentPhone")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Pr,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.parentPhone})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.city")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ef,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.city})]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.idNumber")}),n.jsx("span",{className:"text-gray-800",children:r.idNumber})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.school")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(bn,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.school})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.grade")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.grade})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.enrollmentForm.educationAdministration")}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Sn,{className:"w-5 h-5 text-gray-400"}),n.jsx("span",{className:"text-gray-800",children:r.educationAdministration})]})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:a("summerProgram.admin.table.status")}),n.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.status==="approved"?"bg-green-100 text-green-800":r.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:r.status==="approved"?a("summerProgram.admin.statuses.approved"):r.status==="rejected"?a("summerProgram.admin.statuses.rejected"):a("summerProgram.admin.statuses.pending")})]})]})]}),n.jsxs("div",{className:"space-y-6 mb-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.interests")}),n.jsx("div",{className:"flex flex-wrap gap-2",children:r.interests.map(s=>n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:s},s))})]}),n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.howDidYouHear")}),n.jsx("p",{className:"text-gray-800",children:r.howDidYouHear})]}),r.hasParticipatedBefore&&r.previousProjects&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.previousProjects")}),n.jsx("p",{className:"text-gray-800 whitespace-pre-line",children:r.previousProjects})]}),r.notes&&n.jsxs("div",{children:[n.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a("summerProgram.enrollmentForm.notes")}),n.jsx("p",{className:"text-gray-800 whitespace-pre-line",children:r.notes})]})]}),n.jsx("div",{className:"border-t border-gray-200 pt-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"text-sm text-gray-500",children:[a("summerProgram.admin.table.submittedAt"),": ",Ze(r.createdAt.toString())]}),n.jsx("div",{className:"flex gap-2",children:n.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:a("common.close")})})]})})]})})},_h=({isOpen:e,onClose:t,onConfirm:r,title:a,message:s,confirmText:i,confirmColor:o,icon:l,isProcessing:c})=>{const{t:d}=jt();return e?n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:n.jsxs(te.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white rounded-2xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h3",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[l,a]}),n.jsx("button",{onClick:t,className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:n.jsx(Ot,{className:"w-5 h-5 text-gray-600"})})]}),n.jsx("div",{className:"mb-6",children:n.jsx("p",{className:"text-gray-700",children:s})}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx("button",{onClick:t,className:"px-6 py-3 border border-gray-300 rounded-xl hover:bg-gray-50 transition-colors",children:d("common.cancel")}),n.jsx("button",{onClick:r,disabled:c,className:`px-6 py-3 ${o} text-white rounded-xl hover:opacity-90 transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed`,children:c?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),d("common.loading")]}):n.jsxs(n.Fragment,{children:[l,i]})})]})]})}):null},pce=()=>{const{t:e}=jt(),[t,r]=C.useState([]),[a,s]=C.useState(!0),[i,o]=C.useState(null),[l,c]=C.useState(""),[d,u]=C.useState("all"),[f,h]=C.useState("all"),[m,x]=C.useState("all"),[p,g]=C.useState("all"),[y,b]=C.useState(null),[v,w]=C.useState(!1),[j,N]=C.useState(!1),[_,E]=C.useState(!1),[S,k]=C.useState(!1),[O,P]=C.useState(null),[A,R]=C.useState(!1),[T,F]=C.useState(null),[W,K]=C.useState(null);C.useEffect(()=>{B()},[]);const B=async()=>{try{s(!0),o(null);const q=await L3();r(q)}catch(q){console.error("Error fetching summer program registrations:",q),o(q instanceof Error?q.message:"Failed to load registrations")}finally{s(!1)}},L=["all",...new Set(t.map(q=>q.city))],ee=["all",...new Set(t.map(q=>q.grade))],M=["all",...new Set(t.map(q=>q.educationAdministration))],G=t.filter(q=>{const ie=d==="all"||q.status===d,I=f==="all"||q.city===f,ve=m==="all"||q.grade===m,we=p==="all"||q.educationAdministration===p,Ee=q.fullName.toLowerCase().includes(l.toLowerCase())||q.email.toLowerCase().includes(l.toLowerCase())||q.phone.includes(l)||q.school.toLowerCase().includes(l.toLowerCase());return ie&&I&&ve&&we&&Ee}),V={total:t.length,pending:t.filter(q=>q.status==="pending").length,approved:t.filter(q=>q.status==="approved").length,rejected:t.filter(q=>q.status==="rejected").length},H=q=>{b(q),w(!0)},re=async()=>{if(O){R(!0),K(null);try{await kg(O,{status:"approved"}),await B(),N(!1),F(e("summerProgram.admin.approveSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error approving registration:",q),K(e("summerProgram.admin.approveError"))}finally{R(!1),P(null)}}},me=async()=>{if(O){R(!0),K(null);try{await kg(O,{status:"rejected"}),await B(),E(!1),F(e("summerProgram.admin.rejectSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error rejecting registration:",q),K(e("summerProgram.admin.rejectError"))}finally{R(!1),P(null)}}},xe=async()=>{if(O){R(!0),K(null);try{await U3(O),await B(),k(!1),F(e("summerProgram.admin.deleteSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error deleting registration:",q),K(e("summerProgram.admin.deleteError"))}finally{R(!1),P(null)}}},Z=()=>{try{const q=G.map(ve=>({[e("summerProgram.admin.table.name")]:ve.fullName,[e("summerProgram.admin.table.email")]:ve.email,[e("summerProgram.admin.table.phone")]:ve.phone,[e("summerProgram.enrollmentForm.parentPhone")]:ve.parentPhone,[e("summerProgram.admin.table.city")]:ve.city,[e("summerProgram.enrollmentForm.idNumber")]:ve.idNumber,[e("summerProgram.enrollmentForm.school")]:ve.school,[e("summerProgram.admin.table.grade")]:ve.grade,[e("summerProgram.admin.table.educationAdministration")]:ve.educationAdministration,[e("summerProgram.enrollmentForm.hasParticipatedBefore")]:ve.hasParticipatedBefore?e("summerProgram.enrollmentForm.yes"):e("summerProgram.enrollmentForm.no"),[e("summerProgram.enrollmentForm.previousProjects")]:ve.previousProjects||"",[e("summerProgram.enrollmentForm.interests")]:ve.interests.join(", "),[e("summerProgram.enrollmentForm.howDidYouHear")]:ve.howDidYouHear,[e("summerProgram.enrollmentForm.notes")]:ve.notes||"",[e("summerProgram.admin.table.status")]:ve.status==="approved"?e("summerProgram.admin.statuses.approved"):ve.status==="rejected"?e("summerProgram.admin.statuses.rejected"):e("summerProgram.admin.statuses.pending"),[e("summerProgram.admin.table.submittedAt")]:Ze(ve.createdAt.toString())})),ie=li.json_to_sheet(q),I=li.book_new();li.book_append_sheet(I,ie,"Registrations"),J4(I,"summer_program_registrations.xlsx"),F(e("summerProgram.admin.exportSuccess")),setTimeout(()=>{F(null)},3e3)}catch(q){console.error("Error exporting to Excel:",q),K(e("summerProgram.admin.exportError"))}};return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):i?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(AlertCircle,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:i})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(tt,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:e("summerProgram.admin.title")}),n.jsx("p",{className:"opacity-90",children:e("summerProgram.admin.subtitle")})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:V.total}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.totalRegistrations")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:V.pending}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.pendingReview")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:V.approved}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.approved")})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:V.rejected}),n.jsx("div",{className:"text-sm opacity-80",children:e("summerProgram.admin.stats.rejected")})]})]})]}),T&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(ze,{className:"w-6 h-6 text-green-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-green-800 mb-1",children:e("common.success")}),n.jsx("p",{className:"text-green-700",children:T})]})]}),W&&n.jsxs(te.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(AlertCircle,{className:"w-6 h-6 text-red-500 mt-1 flex-shrink-0"}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-red-800 mb-1",children:e("common.error")}),n.jsx("p",{className:"text-red-700",children:W})]})]}),n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:[n.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-6",children:[n.jsxs("div",{className:"flex-1 relative",children:[n.jsx(ft,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),n.jsx("input",{type:"text",placeholder:e("summerProgram.admin.searchPlaceholder"),value:l,onChange:q=>c(q.target.value),className:"w-full pr-12 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),n.jsxs("button",{onClick:Z,className:"px-6 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors flex items-center gap-2",children:[n.jsx(Cr,{className:"w-5 h-5"}),e("summerProgram.admin.actions.export")]})]}),n.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.status")}),n.jsxs("select",{value:d,onChange:q=>u(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("summerProgram.admin.statuses.all")}),n.jsx("option",{value:"pending",children:e("summerProgram.admin.statuses.pending")}),n.jsx("option",{value:"approved",children:e("summerProgram.admin.statuses.approved")}),n.jsx("option",{value:"rejected",children:e("summerProgram.admin.statuses.rejected")})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.city")}),n.jsxs("select",{value:f,onChange:q=>h(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),L.filter(q=>q!=="all").map(q=>n.jsx("option",{value:q,children:q},q))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.grade")}),n.jsxs("select",{value:m,onChange:q=>x(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),ee.filter(q=>q!=="all").map(q=>n.jsx("option",{value:q,children:q},q))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:e("summerProgram.admin.filters.educationAdministration")}),n.jsxs("select",{value:p,onChange:q=>g(q.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[n.jsx("option",{value:"all",children:e("common.all")}),M.filter(q=>q!=="all").map(q=>n.jsx("option",{value:q,children:q},q))]})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.name")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.email")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.phone")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.city")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.grade")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.educationAdministration")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.status")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.submittedAt")}),n.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:e("summerProgram.admin.table.actions")})]})}),n.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:G.map(q=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:n.jsx(xr,{className:"h-6 w-6 text-blue-600"})}),n.jsx("div",{className:"mr-4",children:n.jsx("div",{className:"text-sm font-medium text-gray-900",children:q.fullName})})]})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.email})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.phone})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.city})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.grade})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("div",{className:"text-sm text-gray-900",children:q.educationAdministration})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:n.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${q.status==="approved"?"bg-green-100 text-green-800":q.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:q.status==="approved"?e("summerProgram.admin.statuses.approved"):q.status==="rejected"?e("summerProgram.admin.statuses.rejected"):e("summerProgram.admin.statuses.pending")})}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:Ze(q.createdAt.toString())}),n.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("button",{onClick:()=>H(q),className:"p-1 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded transition-colors",title:e("summerProgram.admin.actions.view"),children:n.jsx(nr,{className:"w-5 h-5"})}),q.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>{P(q.id),N(!0)},className:"p-1 text-green-600 hover:text-green-900 hover:bg-green-50 rounded transition-colors",title:e("summerProgram.admin.actions.approve"),children:n.jsx(ze,{className:"w-5 h-5"})}),n.jsx("button",{onClick:()=>{P(q.id),E(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:e("summerProgram.admin.actions.reject"),children:n.jsx(Br,{className:"w-5 h-5"})})]}),n.jsx("button",{onClick:()=>{P(q.id),k(!0)},className:"p-1 text-red-600 hover:text-red-900 hover:bg-red-50 rounded transition-colors",title:e("summerProgram.admin.actions.delete"),children:n.jsx(sr,{className:"w-5 h-5"})})]})})]},q.id))})]})})}),G.length===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center py-12 bg-white rounded-2xl shadow-lg",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(yr,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("summerProgram.admin.noRegistrations")}),n.jsx("p",{className:"text-gray-600 mb-4",children:t.length===0?e("summerProgram.admin.noRegistrations"):e("summerProgram.admin.noRegistrationsMatch")}),t.length>0&&n.jsx("button",{onClick:()=>{u("all"),h("all"),x("all"),g("all"),c("")},className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:e("common.resetFilters")})]}),n.jsx(xce,{isOpen:v,onClose:()=>w(!1),registration:y}),n.jsx(_h,{isOpen:j,onClose:()=>N(!1),onConfirm:re,title:e("summerProgram.admin.approveConfirmation"),message:e("summerProgram.admin.approveConfirmation"),confirmText:e("summerProgram.admin.actions.approve"),confirmColor:"bg-green-500 hover:bg-green-600",icon:n.jsx(ze,{className:"w-5 h-5"}),isProcessing:A}),n.jsx(_h,{isOpen:_,onClose:()=>E(!1),onConfirm:me,title:e("summerProgram.admin.rejectConfirmation"),message:e("summerProgram.admin.rejectConfirmation"),confirmText:e("summerProgram.admin.actions.reject"),confirmColor:"bg-red-500 hover:bg-red-600",icon:n.jsx(Br,{className:"w-5 h-5"}),isProcessing:A}),n.jsx(_h,{isOpen:S,onClose:()=>k(!1),onConfirm:xe,title:e("summerProgram.admin.deleteConfirmation"),message:e("summerProgram.admin.deleteConfirmation"),confirmText:e("summerProgram.admin.actions.delete"),confirmColor:"bg-red-500 hover:bg-red-600",icon:n.jsx(sr,{className:"w-5 h-5"}),isProcessing:A})]})},gce=[{id:"all",name:"الكل",icon:ft},{id:"projects",name:"المشاريع",icon:yr},{id:"ideas",name:"أفكار المشاريع",icon:ga},{id:"resources",name:"المصادر التعليمية",icon:Nt},{id:"store",name:"المتجر",icon:Hr},{id:"consultants",name:"المستشارين",icon:dt}],vce=()=>{const{t:e}=jt(),t=bx(),a=new URLSearchParams(t.search).get("q")||"",[s,i]=C.useState("all"),[o,l]=C.useState(!0),[c,d]=C.useState(null),{projects:u}=Ii(),{storeItems:f}=Pf(),{resources:h}=Ex(),{consultants:m}=Ds(),{projectIdeas:x}=kx();C.useEffect(()=>{u&&f&&h&&m&&x&&l(!1)},[u,f,h,m,x]);const p=u.filter(k=>k.title.toLowerCase().includes(a.toLowerCase())||k.description.toLowerCase().includes(a.toLowerCase())),g=x.filter(k=>{var O;return k.title.toLowerCase().includes(a.toLowerCase())||k.description.toLowerCase().includes(a.toLowerCase())||((O=k.tags)==null?void 0:O.some(P=>P.toLowerCase().includes(a.toLowerCase())))}),y=h.filter(k=>k.title.toLowerCase().includes(a.toLowerCase())||k.description.toLowerCase().includes(a.toLowerCase())||k.tags.some(O=>O.toLowerCase().includes(a.toLowerCase()))),b=f.filter(k=>{var O;return k.name.toLowerCase().includes(a.toLowerCase())||k.description.toLowerCase().includes(a.toLowerCase())||((O=k.tags)==null?void 0:O.some(P=>P.toLowerCase().includes(a.toLowerCase())))}),v=m.filter(k=>k.name.toLowerCase().includes(a.toLowerCase())||k.title.toLowerCase().includes(a.toLowerCase())||k.specialties.some(O=>O.toLowerCase().includes(a.toLowerCase()))),j=(()=>{switch(s){case"projects":return{projects:p,ideas:[],resources:[],storeItems:[],consultants:[]};case"ideas":return{projects:[],ideas:g,resources:[],storeItems:[],consultants:[]};case"resources":return{projects:[],ideas:[],resources:y,storeItems:[],consultants:[]};case"store":return{projects:[],ideas:[],resources:[],storeItems:b,consultants:[]};case"consultants":return{projects:[],ideas:[],resources:[],storeItems:[],consultants:v};default:return{projects:p,ideas:g,resources:y,storeItems:b,consultants:v}}})(),N=j.projects.length+j.ideas.length+j.resources.length+j.storeItems.length+j.consultants.length,_=k=>{switch(k){case"stem":return"العلوم والتقنية";case"entrepreneurship":return"ريادة الأعمال";case"volunteer":return"التطوع";case"ethics":return"الأخلاق";default:return k}},E=k=>{switch(k){case"beginner":return"مبتدئ";case"intermediate":return"متوسط";case"advanced":return"متقدم";default:return k}},S=k=>{switch(k){case"beginner":return"bg-green-100 text-green-800";case"intermediate":return"bg-yellow-100 text-yellow-800";case"advanced":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return o?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):c?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(vt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:e("common.error")}),n.jsx("p",{className:"text-gray-600",children:c})]})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-2xl p-6 text-white",children:[n.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:n.jsx(ft,{className:"w-6 h-6"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-3xl font-bold",children:"نتائج البحث"}),n.jsxs("p",{className:"opacity-90",children:['نتائج البحث عن: "',a,'"']})]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:N}),n.jsx("div",{className:"text-sm opacity-80",children:"إجمالي النتائج"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:j.projects.length}),n.jsx("div",{className:"text-sm opacity-80",children:"مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:j.ideas.length}),n.jsx("div",{className:"text-sm opacity-80",children:"فكرة مشروع"})]}),n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:j.resources.length+j.storeItems.length+j.consultants.length}),n.jsx("div",{className:"text-sm opacity-80",children:"نتائج أخرى"})]})]})]}),n.jsx(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"bg-white rounded-2xl p-6 shadow-lg",children:n.jsx("div",{className:"flex flex-wrap gap-2",children:gce.map(k=>n.jsxs("button",{onClick:()=>i(k.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl transition-all ${s===k.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[n.jsx(k.icon,{className:"w-4 h-4"}),k.name]},k.id))})}),n.jsxs("div",{className:"space-y-8",children:[(s==="all"||s==="projects")&&j.projects.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(yr,{className:"w-5 h-5 text-blue-600"}),"المشاريع (",j.projects.length,")"]}),n.jsx(Ae,{to:"/projects",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.projects.slice(0,5).map(k=>n.jsx(Ae,{to:`/projects/${k.id}`,className:"block border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:k.title}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:k.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[n.jsxs("span",{children:["الحالة: ",k.status==="active"?"نشط":k.status==="completed"?"مكتمل":k.status==="draft"?"مسودة":"مؤرشف"]}),n.jsxs("span",{children:["التقدم: ",k.progress,"/10"]}),k.due_date&&n.jsxs("span",{children:["تاريخ الاستحقاق: ",Ze(k.due_date)]})]})]}),n.jsx("div",{className:"flex flex-col items-end",children:n.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:"مشروع"})})]})},k.id)),j.projects.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ae,{to:`/projects?search=${encodeURIComponent(a)}`,className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المشاريع (",j.projects.length-5,")"]})})]})]}),(s==="all"||s==="ideas")&&j.ideas.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.3},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(ga,{className:"w-5 h-5 text-yellow-600"}),"أفكار المشاريع (",j.ideas.length,")"]}),n.jsx(Ae,{to:"/project-ideas",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.ideas.slice(0,5).map(k=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:k.title}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:k.description}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[n.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-lg",children:_(k.category)}),n.jsx("span",{className:`px-2 py-1 text-xs rounded-lg ${S(k.difficulty)}`,children:E(k.difficulty)}),k.tags&&k.tags.slice(0,2).map((O,P)=>n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["#",O]},P))]})]}),n.jsx("div",{className:"flex flex-col items-end",children:n.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:"فكرة مشروع"})})]})},k.id)),j.ideas.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ae,{to:"/project-ideas",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من أفكار المشاريع (",j.ideas.length-5,")"]})})]})]}),(s==="all"||s==="resources")&&j.resources.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Nt,{className:"w-5 h-5 text-emerald-600"}),"المصادر التعليمية (",j.resources.length,")"]}),n.jsx(Ae,{to:"/resources",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.resources.slice(0,5).map(k=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:k.thumbnail||"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=150",alt:k.title,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:k.title}),n.jsx("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-xs font-medium",children:k.type==="video"?"فيديو":k.type==="article"?"مقالة":k.type==="course"?"دورة":k.type==="template"?"قالب":k.type==="podcast"?"بودكاست":"مصدر تعليمي"})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:k.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-3 h-3 text-yellow-400 fill-current"}),n.jsx("span",{children:k.rating})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(nr,{className:"w-3 h-3"}),n.jsxs("span",{children:[k.views," مشاهدة"]})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(_t,{className:"w-3 h-3"}),n.jsx("span",{children:k.duration||"15 دقيقة"})]})]})]})]})},k.id)),j.resources.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ae,{to:"/resources",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المصادر التعليمية (",j.resources.length-5,")"]})})]})]}),(s==="all"||s==="store")&&j.storeItems.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.5},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(Hr,{className:"w-5 h-5 text-purple-600"}),"المتجر (",j.storeItems.length,")"]}),n.jsx(Ae,{to:"/store",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.storeItems.slice(0,5).map(k=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:k.image,alt:k.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:k.name}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xl font-bold text-purple-600",children:[k.price," ر.س"]}),k.originalPrice&&n.jsxs("span",{className:"text-sm text-gray-400 line-through",children:[k.originalPrice," ر.س"]})]})]}),n.jsx("p",{className:"text-gray-600 line-clamp-2",children:k.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-3 h-3 text-yellow-400 fill-current"}),n.jsxs("span",{children:[k.rating," (",k.reviews," تقييم)"]})]}),n.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${k.inStock?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:k.inStock?"متوفر":"غير متوفر"})]})]})]})},k.id)),j.storeItems.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ae,{to:"/store",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المنتجات (",j.storeItems.length-5,")"]})})]})]}),(s==="all"||s==="consultants")&&j.consultants.length>0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.6},className:"bg-white rounded-2xl shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[n.jsx(dt,{className:"w-5 h-5 text-emerald-600"}),"المستشارين (",j.consultants.length,")"]}),n.jsx(Ae,{to:"/search",className:"text-blue-600 hover:text-blue-800 text-sm",children:"عرض الكل"})]}),n.jsxs("div",{className:"space-y-4",children:[j.consultants.slice(0,5).map(k=>n.jsx("div",{className:"border border-gray-200 rounded-xl p-4 hover:shadow-md transition-all",children:n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full overflow-hidden flex-shrink-0",children:n.jsx("img",{src:k.avatar,alt:k.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx("h3",{className:"text-lg font-bold text-gray-800",children:k.name}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(at,{className:"w-4 h-4 text-yellow-400 fill-current"}),n.jsxs("span",{children:[k.rating," (",k.reviews," تقييم)"]})]})]}),n.jsx("p",{className:"text-gray-600",children:k.title}),n.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[k.specialties.slice(0,3).map((O,P)=>n.jsx("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-800 text-xs rounded-lg",children:O},P)),k.specialties.length>3&&n.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["+",k.specialties.length-3]})]})]})]})},k.id)),j.consultants.length>5&&n.jsx("div",{className:"text-center mt-4",children:n.jsxs(Ae,{to:"/search",className:"text-blue-600 hover:text-blue-800 font-medium",children:["عرض المزيد من المستشارين (",j.consultants.length-5,")"]})})]})]}),N===0&&n.jsxs(te.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-2xl shadow-lg p-8 text-center",children:[n.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx(ft,{className:"w-12 h-12 text-gray-400"})}),n.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"لم يتم العثور على نتائج"}),n.jsxs("p",{className:"text-gray-600 mb-4",children:['لم يتم العثور على نتائج تطابق "',a,'"']}),n.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"حاول تغيير كلمات البحث أو البحث في فئة محددة"}),n.jsx("div",{className:"flex justify-center gap-4",children:n.jsx(Ae,{to:"/",className:"px-6 py-2 bg-blue-500 text-white rounded-xl hover:bg-blue-600 transition-colors",children:"العودة للرئيسية"})})]})]}),!1]})},mt=({children:e,allowedRoles:t=[]})=>{const{user:r,loading:a}=wt();return a?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):r?r.status==="pending"?n.jsx(Qs,{to:"/pending-activation"}):t.length>0&&!t.includes(r.role)?n.jsx(Qs,{to:"/"}):n.jsx(c6,{children:e}):n.jsx(Qs,{to:"/login"})},yce=()=>{const{user:e}=wt();return n.jsxs(Tk,{children:[n.jsx(ct,{path:"/login",element:e?n.jsx(Qs,{to:"/"}):n.jsx(d6,{})}),n.jsx(ct,{path:"/register",element:e?n.jsx(Qs,{to:"/"}):n.jsx(u6,{})}),n.jsx(ct,{path:"/pending-activation",element:e?e.status!=="pending"?n.jsx(Qs,{to:"/"}):n.jsx(h6,{}):n.jsx(Qs,{to:"/login"})}),n.jsx(ct,{path:"/summer-program-enrollment",element:n.jsx(m6,{})}),n.jsx(ct,{path:"/",element:n.jsx(mt,{children:n.jsx(f6,{})})}),n.jsx(ct,{path:"/search-results",element:n.jsx(mt,{children:n.jsx(vce,{})})}),n.jsx(ct,{path:"/project-ideas",element:n.jsx(mt,{children:n.jsx(P6,{})})}),n.jsx(ct,{path:"/projects",element:n.jsx(mt,{children:n.jsx(j6,{})})}),n.jsx(ct,{path:"/projects/:id",element:n.jsx(mt,{children:n.jsx(T6,{})})}),n.jsx(ct,{path:"/projects/new",element:n.jsx(mt,{children:n.jsx(C6,{})})}),n.jsx(ct,{path:"/projects/:id/edit",element:n.jsx(mt,{children:n.jsx(O6,{})})}),n.jsx(ct,{path:"/gallery",element:n.jsx(mt,{children:n.jsx(R6,{})})}),n.jsx(ct,{path:"/store",element:n.jsx(mt,{children:n.jsx(B6,{})})}),n.jsx(ct,{path:"/cart",element:n.jsx(mt,{children:n.jsx(U6,{})})}),n.jsx(ct,{path:"/checkout",element:n.jsx(mt,{children:n.jsx(W6,{})})}),n.jsx(ct,{path:"/ai-assistant",element:n.jsx(mt,{children:n.jsx(G6,{})})}),n.jsx(ct,{path:"/resources",element:n.jsx(mt,{children:n.jsx(q6,{})})}),n.jsx(ct,{path:"/intellectual-property",element:n.jsx(mt,{children:n.jsx(X6,{})})}),n.jsx(ct,{path:"/consultations",element:n.jsx(mt,{children:n.jsx(v6,{})})}),n.jsx(ct,{path:"/my-consultations",element:n.jsx(mt,{children:n.jsx(y6,{})})}),n.jsx(ct,{path:"/create-consultation-request",element:n.jsx(mt,{children:n.jsx(b6,{})})}),n.jsx(ct,{path:"/consultant-dashboard",element:n.jsx(mt,{allowedRoles:["consultant"],children:n.jsx(aJ,{})})}),n.jsx(ct,{path:"/consultation-requests",element:n.jsx(mt,{allowedRoles:["consultant"],children:n.jsx(nJ,{})})}),n.jsx(ct,{path:"/consultant-schedule",element:n.jsx(mt,{allowedRoles:["consultant"],children:n.jsx(sJ,{})})}),n.jsx(ct,{path:"/consultant-profile",element:n.jsx(mt,{allowedRoles:["consultant"],children:n.jsx(iJ,{})})}),n.jsx(ct,{path:"/reviews",element:n.jsx(mt,{allowedRoles:["consultant"],children:n.jsx(oJ,{})})}),n.jsx(ct,{path:"/search",element:n.jsx(mt,{children:n.jsx(eJ,{})})}),n.jsx(ct,{path:"/favorites",element:n.jsx(mt,{children:n.jsx(rJ,{})})}),n.jsx(ct,{path:"/students",element:n.jsx(mt,{allowedRoles:["teacher","school","admin"],children:n.jsx(Fg,{})})}),n.jsx(ct,{path:"/reports",element:n.jsx(mt,{allowedRoles:["teacher","school","admin"],children:n.jsx(QY,{})})}),n.jsx(ct,{path:"/admin-dashboard",element:n.jsx(mt,{allowedRoles:["admin"],children:n.jsx(lJ,{})})}),n.jsx(ct,{path:"/admin/manage-project-ideas",element:n.jsx(mt,{allowedRoles:["admin"],children:n.jsx(uce,{})})}),n.jsx(ct,{path:"/admin/manage-videos",element:n.jsx(mt,{allowedRoles:["admin"],children:n.jsx(mce,{})})}),n.jsx(ct,{path:"/admin/summer-program-registrations",element:n.jsx(mt,{allowedRoles:["admin"],children:n.jsx(pce,{})})}),n.jsx(ct,{path:"/users",element:n.jsx(mt,{allowedRoles:["admin","school"],children:n.jsx(Fg,{})})}),n.jsx(ct,{path:"/settings",element:n.jsx(mt,{children:n.jsx(w6,{})})})]})};function bce(){const{i18n:e}=jt();return C.useEffect(()=>{document.documentElement.dir=e.language==="ar"?"rtl":"ltr",document.documentElement.lang=e.language},[e.language]),n.jsx(W3,{children:n.jsx(H3,{children:n.jsx(Ak,{children:n.jsx("div",{className:"min-h-screen bg-gray-50",children:n.jsx(yce,{})})})})})}const He=e=>typeof e=="string",_l=()=>{let e,t;const r=new Promise((a,s)=>{e=a,t=s});return r.resolve=e,r.reject=t,r},qw=e=>e==null?"":""+e,wce=(e,t,r)=>{e.forEach(a=>{t[a]&&(r[a]=t[a])})},jce=/###/g,Kw=e=>e&&e.indexOf("###")>-1?e.replace(jce,"."):e,Xw=e=>!e||He(e),ec=(e,t,r)=>{const a=He(t)?t.split("."):t;let s=0;for(;s<a.length-1;){if(Xw(e))return{};const i=Kw(a[s]);!e[i]&&r&&(e[i]=new r),Object.prototype.hasOwnProperty.call(e,i)?e=e[i]:e={},++s}return Xw(e)?{}:{obj:e,k:Kw(a[s])}},Yw=(e,t,r)=>{const{obj:a,k:s}=ec(e,t,Object);if(a!==void 0||t.length===1){a[s]=r;return}let i=t[t.length-1],o=t.slice(0,t.length-1),l=ec(e,o,Object);for(;l.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),l=ec(e,o,Object),l&&l.obj&&typeof l.obj[`${l.k}.${i}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${i}`]=r},Nce=(e,t,r,a)=>{const{obj:s,k:i}=ec(e,t,Object);s[i]=s[i]||[],s[i].push(r)},jf=(e,t)=>{const{obj:r,k:a}=ec(e,t);if(r)return r[a]},_ce=(e,t,r)=>{const a=jf(e,r);return a!==void 0?a:jf(t,r)},tk=(e,t,r)=>{for(const a in t)a!=="__proto__"&&a!=="constructor"&&(a in e?He(e[a])||e[a]instanceof String||He(t[a])||t[a]instanceof String?r&&(e[a]=t[a]):tk(e[a],t[a],r):e[a]=t[a]);return e},Qi=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Sce={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const kce=e=>He(e)?e.replace(/[&<>"'\/]/g,t=>Sce[t]):e;class Ece{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const a=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,a),this.regExpQueue.push(t),a}}const Ace=[" ",",","?","!",";"],Tce=new Ece(20),Cce=(e,t,r)=>{t=t||"",r=r||"";const a=Ace.filter(o=>t.indexOf(o)<0&&r.indexOf(o)<0);if(a.length===0)return!0;const s=Tce.getRegExp(`(${a.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!s.test(e);if(!i){const o=e.indexOf(r);o>0&&!s.test(e.substring(0,o))&&(i=!0)}return i},px=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];const a=t.split(r);let s=e;for(let i=0;i<a.length;){if(!s||typeof s!="object")return;let o,l="";for(let c=i;c<a.length;++c)if(c!==i&&(l+=r),l+=a[c],o=s[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&c<a.length-1)continue;i+=c-i+1;break}s=o}return s},Nf=e=>e&&e.replace("_","-"),Oce={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class _f{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||Oce,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,a,s){return s&&!this.debug?null:(He(t[0])&&(t[0]=`${a}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new _f(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new _f(this.logger,t)}}var _n=new _f;class C0{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(a=>{this.observers[a]||(this.observers[a]=new Map);const s=this.observers[a].get(r)||0;this.observers[a].set(r,s+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(o=>{let[l,c]=o;for(let d=0;d<c;d++)l(...a)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[l,c]=o;for(let d=0;d<c;d++)l.apply(l,[t,...a])})}}class Jw extends C0{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,o=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,r],a&&(Array.isArray(a)?l.push(...a):He(a)&&i?l.push(...a.split(i)):l.push(a)));const c=jf(this.data,l);return!c&&!r&&!a&&t.indexOf(".")>-1&&(t=l[0],r=l[1],a=l.slice(2).join(".")),c||!o||!He(a)?c:px(this.data&&this.data[t]&&this.data[t][r],a,i)}addResource(t,r,a,s){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let l=[t,r];a&&(l=l.concat(o?a.split(o):a)),t.indexOf(".")>-1&&(l=t.split("."),s=r,r=l[1]),this.addNamespaces(r),Yw(this.data,l,s),i.silent||this.emit("added",t,r,a,s)}addResources(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in a)(He(a[i])||Array.isArray(a[i]))&&this.addResource(t,r,i,a[i],{silent:!0});s.silent||this.emit("added",t,r,a)}addResourceBundle(t,r,a,s,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},l=[t,r];t.indexOf(".")>-1&&(l=t.split("."),s=a,a=r,r=l[1]),this.addNamespaces(r);let c=jf(this.data,l)||{};o.skipCopy||(a=JSON.parse(JSON.stringify(a))),s?tk(c,a,i):c={...c,...a},Yw(this.data,l,c),o.silent||this.emit("added",t,r,a)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,r)}:this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(s=>r[s]&&Object.keys(r[s]).length>0)}toJSON(){return this.data}}var rk={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,a,s){return e.forEach(i=>{this.processors[i]&&(t=this.processors[i].process(t,r,a,s))}),t}};const Zw={};class Sf extends C0{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),wce(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=_n.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;const a=this.resolve(t,r);return a&&a.res!==void 0}extractFromKey(t,r){let a=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;a===void 0&&(a=":");const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let i=r.ns||this.options.defaultNS||[];const o=a&&t.indexOf(a)>-1,l=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!Cce(t,a,s);if(o&&!l){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:He(i)?[i]:i};const d=t.split(a);(a!==s||a===s&&this.options.ns.indexOf(d[0])>-1)&&(i=d.shift()),t=d.join(s)}return{key:t,namespaces:He(i)?[i]:i}}translate(t,r,a){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const s=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,i=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:o,namespaces:l}=this.extractFromKey(t[t.length-1],r),c=l[l.length-1],d=r.lng||this.language,u=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&d.toLowerCase()==="cimode"){if(u){const w=r.nsSeparator||this.options.nsSeparator;return s?{res:`${c}${w}${o}`,usedKey:o,exactUsedKey:o,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:`${c}${w}${o}`}return s?{res:o,usedKey:o,exactUsedKey:o,usedLng:d,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:o}const f=this.resolve(t,r);let h=f&&f.res;const m=f&&f.usedKey||o,x=f&&f.exactUsedKey||o,p=Object.prototype.toString.apply(h),g=["[object Number]","[object Function]","[object RegExp]"],y=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,b=!this.i18nFormat||this.i18nFormat.handleAsObject,v=!He(h)&&typeof h!="boolean"&&typeof h!="number";if(b&&h&&v&&g.indexOf(p)<0&&!(He(y)&&Array.isArray(h))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const w=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,h,{...r,ns:l}):`key '${o} (${this.language})' returned an object instead of string.`;return s?(f.res=w,f.usedParams=this.getUsedParamsDetails(r),f):w}if(i){const w=Array.isArray(h),j=w?[]:{},N=w?x:m;for(const _ in h)if(Object.prototype.hasOwnProperty.call(h,_)){const E=`${N}${i}${_}`;j[_]=this.translate(E,{...r,joinArrays:!1,ns:l}),j[_]===E&&(j[_]=h[_])}h=j}}else if(b&&He(y)&&Array.isArray(h))h=h.join(y),h&&(h=this.extendTranslation(h,t,r,a));else{let w=!1,j=!1;const N=r.count!==void 0&&!He(r.count),_=Sf.hasDefaultValue(r),E=N?this.pluralResolver.getSuffix(d,r.count,r):"",S=r.ordinal&&N?this.pluralResolver.getSuffix(d,r.count,{ordinal:!1}):"",k=N&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),O=k&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${E}`]||r[`defaultValue${S}`]||r.defaultValue;!this.isValidLookup(h)&&_&&(w=!0,h=O),this.isValidLookup(h)||(j=!0,h=o);const A=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&j?void 0:h,R=_&&O!==h&&this.options.updateMissing;if(j||w||R){if(this.logger.log(R?"updateKey":"missingKey",d,c,o,R?O:h),i){const K=this.resolve(o,{...r,keySeparator:!1});K&&K.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let T=[];const F=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&F&&F[0])for(let K=0;K<F.length;K++)T.push(F[K]);else this.options.saveMissingTo==="all"?T=this.languageUtils.toResolveHierarchy(r.lng||this.language):T.push(r.lng||this.language);const W=(K,B,L)=>{const ee=_&&L!==h?L:A;this.options.missingKeyHandler?this.options.missingKeyHandler(K,c,B,ee,R,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(K,c,B,ee,R,r),this.emit("missingKey",K,c,B,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&N?T.forEach(K=>{const B=this.pluralResolver.getSuffixes(K,r);k&&r[`defaultValue${this.options.pluralSeparator}zero`]&&B.indexOf(`${this.options.pluralSeparator}zero`)<0&&B.push(`${this.options.pluralSeparator}zero`),B.forEach(L=>{W([K],o+L,r[`defaultValue${L}`]||O)})}):W(T,o,O))}h=this.extendTranslation(h,t,r,f,a),j&&h===o&&this.options.appendNamespaceToMissingKey&&(h=`${c}:${o}`),(j||w)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${o}`:o,w?h:void 0):h=this.options.parseMissingKeyHandler(h))}return s?(f.res=h,f.usedParams=this.getUsedParamsDetails(r),f):h}extendTranslation(t,r,a,s,i){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...a},a.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!a.skipInterpolation){a.interpolation&&this.interpolator.init({...a,interpolation:{...this.options.interpolation,...a.interpolation}});const d=He(t)&&(a&&a.interpolation&&a.interpolation.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let u;if(d){const h=t.match(this.interpolator.nestingRegexp);u=h&&h.length}let f=a.replace&&!He(a.replace)?a.replace:a;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),t=this.interpolator.interpolate(t,f,a.lng||this.language||s.usedLng,a),d){const h=t.match(this.interpolator.nestingRegexp),m=h&&h.length;u<m&&(a.nest=!1)}!a.lng&&this.options.compatibilityAPI!=="v1"&&s&&s.res&&(a.lng=this.language||s.usedLng),a.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var h=arguments.length,m=new Array(h),x=0;x<h;x++)m[x]=arguments[x];return i&&i[0]===m[0]&&!a.context?(o.logger.warn(`It seems you are nesting recursively key: ${m[0]} in key: ${r[0]}`),null):o.translate(...m,r)},a)),a.interpolation&&this.interpolator.reset()}const l=a.postProcess||this.options.postProcess,c=He(l)?[l]:l;return t!=null&&c&&c.length&&a.applyPostProcessor!==!1&&(t=rk.handle(c,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(a)},...a}:a,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a,s,i,o,l;return He(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(a))return;const d=this.extractFromKey(c,r),u=d.key;s=u;let f=d.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const h=r.count!==void 0&&!He(r.count),m=h&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),x=r.context!==void 0&&(He(r.context)||typeof r.context=="number")&&r.context!=="",p=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);f.forEach(g=>{this.isValidLookup(a)||(l=g,!Zw[`${p[0]}-${g}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(l)&&(Zw[`${p[0]}-${g}`]=!0,this.logger.warn(`key "${s}" for languages "${p.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach(y=>{if(this.isValidLookup(a))return;o=y;const b=[u];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(b,u,y,g,r);else{let w;h&&(w=this.pluralResolver.getSuffix(y,r.count,r));const j=`${this.options.pluralSeparator}zero`,N=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(b.push(u+w),r.ordinal&&w.indexOf(N)===0&&b.push(u+w.replace(N,this.options.pluralSeparator)),m&&b.push(u+j)),x){const _=`${u}${this.options.contextSeparator}${r.context}`;b.push(_),h&&(b.push(_+w),r.ordinal&&w.indexOf(N)===0&&b.push(_+w.replace(N,this.options.pluralSeparator)),m&&b.push(_+j))}}let v;for(;v=b.pop();)this.isValidLookup(a)||(i=v,a=this.getResource(y,g,v,r))}))})}),{res:a,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:l}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,r,a,s):this.resourceStore.getResource(t,r,a,s)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],a=t.replace&&!He(t.replace);let s=a?t.replace:t;if(a&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!a){s={...s};for(const i of r)delete s[i]}return s}static hasDefaultValue(t){const r="defaultValue";for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&r===a.substring(0,r.length)&&t[a]!==void 0)return!0;return!1}}const Sh=e=>e.charAt(0).toUpperCase()+e.slice(1);class Qw{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=_n.create("languageUtils")}getScriptPartFromCode(t){if(t=Nf(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=Nf(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(He(t)&&t.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let s=Intl.getCanonicalLocales(t)[0];if(s&&this.options.lowerCaseLng&&(s=s.toLowerCase()),s)return s}catch{}const r=["hans","hant","latn","cyrl","cans","mong","arab"];let a=t.split("-");return this.options.lowerCaseLng?a=a.map(s=>s.toLowerCase()):a.length===2?(a[0]=a[0].toLowerCase(),a[1]=a[1].toUpperCase(),r.indexOf(a[1].toLowerCase())>-1&&(a[1]=Sh(a[1].toLowerCase()))):a.length===3&&(a[0]=a[0].toLowerCase(),a[1].length===2&&(a[1]=a[1].toUpperCase()),a[0]!=="sgn"&&a[2].length===2&&(a[2]=a[2].toUpperCase()),r.indexOf(a[1].toLowerCase())>-1&&(a[1]=Sh(a[1].toLowerCase())),r.indexOf(a[2].toLowerCase())>-1&&(a[2]=Sh(a[2].toLowerCase()))),a.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(a=>{if(r)return;const s=this.formatLanguageCode(a);(!this.options.supportedLngs||this.isSupportedCode(s))&&(r=s)}),!r&&this.options.supportedLngs&&t.forEach(a=>{if(r)return;const s=this.getLanguagePartFromCode(a);if(this.isSupportedCode(s))return r=s;r=this.options.supportedLngs.find(i=>{if(i===s)return i;if(!(i.indexOf("-")<0&&s.indexOf("-")<0)&&(i.indexOf("-")>0&&s.indexOf("-")<0&&i.substring(0,i.indexOf("-"))===s||i.indexOf(s)===0&&s.length>1))return i})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),He(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let a=t[r];return a||(a=t[this.getScriptPartFromCode(r)]),a||(a=t[this.formatLanguageCode(r)]),a||(a=t[this.getLanguagePartFromCode(r)]),a||(a=t.default),a||[]}toResolveHierarchy(t,r){const a=this.getFallbackCodes(r||this.options.fallbackLng||[],t),s=[],i=o=>{o&&(this.isSupportedCode(o)?s.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return He(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(t))):He(t)&&i(this.formatLanguageCode(t)),a.forEach(o=>{s.indexOf(o)<0&&i(this.formatLanguageCode(o))}),s}}let Pce=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Fce={1:e=>+(e>1),2:e=>+(e!=1),3:e=>0,4:e=>e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,5:e=>e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5,6:e=>e==1?0:e>=2&&e<=4?1:2,7:e=>e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,8:e=>e==1?0:e==2?1:e!=8&&e!=11?2:3,9:e=>+(e>=2),10:e=>e==1?0:e==2?1:e<7?2:e<11?3:4,11:e=>e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3,12:e=>+(e%10!=1||e%100==11),13:e=>+(e!==0),14:e=>e==1?0:e==2?1:e==3?2:3,15:e=>e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2,16:e=>e%10==1&&e%100!=11?0:e!==0?1:2,17:e=>e==1||e%10==1&&e%100!=11?0:1,18:e=>e==0?0:e==1?1:2,19:e=>e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3,20:e=>e==1?0:e==0||e%100>0&&e%100<20?1:2,21:e=>e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0,22:e=>e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3};const Ice=["v1","v2","v3"],Dce=["v4"],ej={zero:0,one:1,two:2,few:3,many:4,other:5},Rce=()=>{const e={};return Pce.forEach(t=>{t.lngs.forEach(r=>{e[r]={numbers:t.nr,plurals:Fce[t.fc]}})}),e};class Mce{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=_n.create("pluralResolver"),(!this.options.compatibilityJSON||Dce.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Rce(),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const a=Nf(t==="dev"?"en":t),s=r.ordinal?"ordinal":"cardinal",i=JSON.stringify({cleanedCode:a,type:s});if(i in this.pluralRulesCache)return this.pluralRulesCache[i];let o;try{o=new Intl.PluralRules(a,{type:s})}catch{if(!t.match(/-|_/))return;const c=this.languageUtils.getLanguagePartFromCode(t);o=this.getRule(c,r)}return this.pluralRulesCache[i]=o,o}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=this.getRule(t,r);return this.shouldUseIntlApi()?a&&a.resolvedOptions().pluralCategories.length>1:a&&a.numbers.length>1}getPluralFormsOfKey(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,a).map(s=>`${r}${s}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=this.getRule(t,r);return a?this.shouldUseIntlApi()?a.resolvedOptions().pluralCategories.sort((s,i)=>ej[s]-ej[i]).map(s=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s}`):a.numbers.map(s=>this.getSuffix(t,s,r)):[]}getSuffix(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.getRule(t,a);return s?this.shouldUseIntlApi()?`${this.options.prepend}${a.ordinal?`ordinal${this.options.prepend}`:""}${s.select(r)}`:this.getSuffixRetroCompatible(s,r):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,r){const a=t.noAbs?t.plurals(r):t.plurals(Math.abs(r));let s=t.numbers[a];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(s===2?s="plural":s===1&&(s=""));const i=()=>this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString();return this.options.compatibilityJSON==="v1"?s===1?"":typeof s=="number"?`_plural_${s.toString()}`:i():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?i():this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString()}shouldUseIntlApi(){return!Ice.includes(this.options.compatibilityJSON)}}const tj=function(e,t,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=_ce(e,t,r);return!i&&s&&He(r)&&(i=px(e,r,a),i===void 0&&(i=px(t,r,a))),i},kh=e=>e.replace(/\$/g,"$$$$");class $ce{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=_n.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:a,useRawValueToEscape:s,prefix:i,prefixEscaped:o,suffix:l,suffixEscaped:c,formatSeparator:d,unescapeSuffix:u,unescapePrefix:f,nestingPrefix:h,nestingPrefixEscaped:m,nestingSuffix:x,nestingSuffixEscaped:p,nestingOptionsSeparator:g,maxReplaces:y,alwaysFormat:b}=t.interpolation;this.escape=r!==void 0?r:kce,this.escapeValue=a!==void 0?a:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=i?Qi(i):o||"{{",this.suffix=l?Qi(l):c||"}}",this.formatSeparator=d||",",this.unescapePrefix=u?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=h?Qi(h):m||Qi("$t("),this.nestingSuffix=x?Qi(x):p||Qi(")"),this.nestingOptionsSeparator=g||",",this.maxReplaces=y||1e3,this.alwaysFormat=b!==void 0?b:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,a)=>r&&r.source===a?(r.lastIndex=0,r):new RegExp(a,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,r,a,s){let i,o,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=m=>{if(m.indexOf(this.formatSeparator)<0){const y=tj(r,c,m,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(y,void 0,a,{...s,...r,interpolationkey:m}):y}const x=m.split(this.formatSeparator),p=x.shift().trim(),g=x.join(this.formatSeparator).trim();return this.format(tj(r,c,p,this.options.keySeparator,this.options.ignoreJSONStructure),g,a,{...s,...r,interpolationkey:p})};this.resetRegExp();const u=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,f=s&&s.interpolation&&s.interpolation.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:m=>kh(m)},{regex:this.regexp,safeValue:m=>this.escapeValue?kh(this.escape(m)):kh(m)}].forEach(m=>{for(l=0;i=m.regex.exec(t);){const x=i[1].trim();if(o=d(x),o===void 0)if(typeof u=="function"){const g=u(t,i,s);o=He(g)?g:""}else if(s&&Object.prototype.hasOwnProperty.call(s,x))o="";else if(f){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${x} for interpolating ${t}`),o="";else!He(o)&&!this.useRawValueToEscape&&(o=qw(o));const p=m.safeValue(o);if(t=t.replace(i[0],p),f?(m.regex.lastIndex+=o.length,m.regex.lastIndex-=i[0].length):m.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),t}nest(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,i,o;const l=(c,d)=>{const u=this.nestingOptionsSeparator;if(c.indexOf(u)<0)return c;const f=c.split(new RegExp(`${u}[ ]*{`));let h=`{${f[1]}`;c=f[0],h=this.interpolate(h,o);const m=h.match(/'/g),x=h.match(/"/g);(m&&m.length%2===0&&!x||x.length%2!==0)&&(h=h.replace(/'/g,'"'));try{o=JSON.parse(h),d&&(o={...d,...o})}catch(p){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,p),`${c}${u}${h}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,c};for(;s=this.nestingRegexp.exec(t);){let c=[];o={...a},o=o.replace&&!He(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let d=!1;if(s[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(s[1])){const u=s[1].split(this.formatSeparator).map(f=>f.trim());s[1]=u.shift(),c=u,d=!0}if(i=r(l.call(this,s[1].trim(),o),o),i&&s[0]===t&&!He(i))return i;He(i)||(i=qw(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),i=""),d&&(i=c.reduce((u,f)=>this.format(u,f,a.lng,{...a,interpolationkey:s[1].trim()}),i.trim())),t=t.replace(s[0],i),this.regexp.lastIndex=0}return t}}const Lce=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const a=e.split("(");t=a[0].toLowerCase().trim();const s=a[1].substring(0,a[1].length-1);t==="currency"&&s.indexOf(":")<0?r.currency||(r.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?r.range||(r.range=s.trim()):s.split(";").forEach(o=>{if(o){const[l,...c]=o.split(":"),d=c.join(":").trim().replace(/^'+|'+$/g,""),u=l.trim();r[u]||(r[u]=d),d==="false"&&(r[u]=!1),d==="true"&&(r[u]=!0),isNaN(d)||(r[u]=parseInt(d,10))}})}return{formatName:t,formatOptions:r}},eo=e=>{const t={};return(r,a,s)=>{let i=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(i={...i,[s.interpolationkey]:void 0});const o=a+JSON.stringify(i);let l=t[o];return l||(l=e(Nf(a),s),t[o]=l),l(r)}};class Bce{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=_n.create("formatter"),this.options=t,this.formats={number:eo((r,a)=>{const s=new Intl.NumberFormat(r,{...a});return i=>s.format(i)}),currency:eo((r,a)=>{const s=new Intl.NumberFormat(r,{...a,style:"currency"});return i=>s.format(i)}),datetime:eo((r,a)=>{const s=new Intl.DateTimeFormat(r,{...a});return i=>s.format(i)}),relativetime:eo((r,a)=>{const s=new Intl.RelativeTimeFormat(r,{...a});return i=>s.format(i,a.range||"day")}),list:eo((r,a)=>{const s=new Intl.ListFormat(r,{...a});return i=>s.format(i)})},this.init(t)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=r.interpolation.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=eo(r)}format(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=r.split(this.formatSeparator);if(i.length>1&&i[0].indexOf("(")>1&&i[0].indexOf(")")<0&&i.find(l=>l.indexOf(")")>-1)){const l=i.findIndex(c=>c.indexOf(")")>-1);i[0]=[i[0],...i.splice(1,l)].join(this.formatSeparator)}return i.reduce((l,c)=>{const{formatName:d,formatOptions:u}=Lce(c);if(this.formats[d]){let f=l;try{const h=s&&s.formatParams&&s.formatParams[s.interpolationkey]||{},m=h.locale||h.lng||s.locale||s.lng||a;f=this.formats[d](l,m,{...u,...s,...h})}catch(h){this.logger.warn(h)}return f}else this.logger.warn(`there was no format function for ${d}`);return l},t)}}const Uce=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class Wce extends C0{constructor(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=a,this.languageUtils=a.languageUtils,this.options=s,this.logger=_n.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(a,s.backend,s)}queueLoad(t,r,a,s){const i={},o={},l={},c={};return t.forEach(d=>{let u=!0;r.forEach(f=>{const h=`${d}|${f}`;!a.reload&&this.store.hasResourceBundle(d,f)?this.state[h]=2:this.state[h]<0||(this.state[h]===1?o[h]===void 0&&(o[h]=!0):(this.state[h]=1,u=!1,o[h]===void 0&&(o[h]=!0),i[h]===void 0&&(i[h]=!0),c[f]===void 0&&(c[f]=!0)))}),u||(l[d]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(t,r,a){const s=t.split("|"),i=s[0],o=s[1];r&&this.emit("failedLoading",i,o,r),!r&&a&&this.store.addResourceBundle(i,o,a,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&a&&(this.state[t]=0);const l={};this.queue.forEach(c=>{Nce(c.loaded,[i],o),Uce(c,t),r&&c.errors.push(r),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(d=>{l[d]||(l[d]={});const u=c.loaded[d];u.length&&u.forEach(f=>{l[d][f]===void 0&&(l[d][f]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(t,r,a){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!t.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:a,tried:s,wait:i,callback:o});return}this.readingCalls++;const l=(d,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(d&&u&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,a,s+1,i*2,o)},i);return}o(d,u)},c=this.backend[a].bind(this.backend);if(c.length===2){try{const d=c(t,r);d&&typeof d.then=="function"?d.then(u=>l(null,u)).catch(l):l(null,d)}catch(d){l(d)}return}return c(t,r,l)}prepareLoading(t,r){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();He(t)&&(t=this.languageUtils.toResolveHierarchy(t)),He(r)&&(r=[r]);const i=this.queueLoad(t,r,a,s);if(!i.toLoad.length)return i.pending.length||s(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(t,r,a){this.prepareLoading(t,r,{},a)}reload(t,r,a){this.prepareLoading(t,r,{reload:!0},a)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const a=t.split("|"),s=a[0],i=a[1];this.read(s,i,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${r}loading namespace ${i} for language ${s} failed`,o),!o&&l&&this.logger.log(`${r}loaded namespace ${i} for language ${s}`,l),this.loaded(t,o,l)})}saveMissing(t,r,a,s,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${a}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(a==null||a==="")){if(this.backend&&this.backend.create){const c={...o,isUpdate:i},d=this.backend.create.bind(this.backend);if(d.length<6)try{let u;d.length===5?u=d(t,r,a,s,c):u=d(t,r,a,s),u&&typeof u.then=="function"?u.then(f=>l(null,f)).catch(l):l(null,u)}catch(u){l(u)}else d(t,r,a,s,l,c)}!t||!t[0]||this.store.addResource(t[0],r,a,s)}}}const rj=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),He(e[1])&&(t.defaultValue=e[1]),He(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(a=>{t[a]=r[a]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),aj=e=>(He(e.ns)&&(e.ns=[e.ns]),He(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),He(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),ru=()=>{},Hce=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};class id extends C0{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=aj(t),this.services={},this.logger=_n,this.modules={external:[]},Hce(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof r=="function"&&(a=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(He(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const s=rj();this.options={...s,...this.options,...aj(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...s.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);const i=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?_n.init(i(this.modules.logger),this.options):_n.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:typeof Intl<"u"&&(u=Bce);const f=new Qw(this.options);this.store=new Jw(this.options.resources,this.options);const h=this.services;h.logger=_n,h.resourceStore=this.store,h.languageUtils=f,h.pluralResolver=new Mce(f,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(h.formatter=i(u),h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new $ce(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new Wce(i(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",function(m){for(var x=arguments.length,p=new Array(x>1?x-1:0),g=1;g<x;g++)p[g-1]=arguments[g];t.emit(m,...p)}),this.modules.languageDetector&&(h.languageDetector=i(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=i(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new Sf(this.services,this.options),this.translator.on("*",function(m){for(var x=arguments.length,p=new Array(x>1?x-1:0),g=1;g<x;g++)p[g-1]=arguments[g];t.emit(m,...p)}),this.modules.external.forEach(m=>{m.init&&m.init(this)})}if(this.format=this.options.interpolation.format,a||(a=ru),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=function(){return t.store[u](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=function(){return t.store[u](...arguments),t}});const c=_l(),d=()=>{const u=(f,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(h),a(f,h)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initImmediate?d():setTimeout(d,0),c}loadResources(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ru;const s=He(t)?t:this.language;if(typeof t=="function"&&(a=t),!this.options.resources||this.options.partialBundledLanguages){if(s&&s.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return a();const i=[],o=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(d=>{d!=="cimode"&&i.indexOf(d)<0&&i.push(d)})};s?o(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>o(c)),this.options.preload&&this.options.preload.forEach(l=>o(l)),this.services.backendConnector.load(i,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),a(l)})}else a(null)}reloadResources(t,r,a){const s=_l();return typeof t=="function"&&(a=t,t=void 0),typeof r=="function"&&(a=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),a||(a=ru),this.services.backendConnector.reload(t,r,i=>{s.resolve(),a(i)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&rk.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){const a=this.languages[r];if(!(["cimode","dev"].indexOf(a)>-1)&&this.store.hasLanguageSomeTranslations(a)){this.resolvedLanguage=a;break}}}changeLanguage(t,r){var a=this;this.isLanguageChangingTo=t;const s=_l();this.emit("languageChanging",t);const i=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},o=(c,d)=>{d?(i(d),this.translator.changeLanguage(d),this.isLanguageChangingTo=void 0,this.emit("languageChanged",d),this.logger.log("languageChanged",d)):this.isLanguageChangingTo=void 0,s.resolve(function(){return a.t(...arguments)}),r&&r(c,function(){return a.t(...arguments)})},l=c=>{!t&&!c&&this.services.languageDetector&&(c=[]);const d=He(c)?c:this.services.languageUtils.getBestMatchFromCodes(c);d&&(this.language||i(d),this.translator.language||this.translator.changeLanguage(d),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(d)),this.loadResources(d,u=>{o(u,d)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(t),s}getFixedT(t,r,a){var s=this;const i=function(o,l){let c;if(typeof l!="object"){for(var d=arguments.length,u=new Array(d>2?d-2:0),f=2;f<d;f++)u[f-2]=arguments[f];c=s.options.overloadTranslationOptionHandler([o,l].concat(u))}else c={...l};c.lng=c.lng||i.lng,c.lngs=c.lngs||i.lngs,c.ns=c.ns||i.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||a||i.keyPrefix);const h=s.options.keySeparator||".";let m;return c.keyPrefix&&Array.isArray(o)?m=o.map(x=>`${c.keyPrefix}${h}${x}`):m=c.keyPrefix?`${c.keyPrefix}${h}${o}`:o,s.t(m,c)};return He(t)?i.lng=t:i.lngs=t,i.ns=r,i.keyPrefix=a,i}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const a=r.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(a.toLowerCase()==="cimode")return!0;const o=(l,c)=>{const d=this.services.backendConnector.state[`${l}|${c}`];return d===-1||d===0||d===2};if(r.precheck){const l=r.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(a,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(a,t)&&(!s||o(i,t)))}loadNamespaces(t,r){const a=_l();return this.options.ns?(He(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{a.resolve(),r&&r(s)}),a):(r&&r(),Promise.resolve())}loadLanguages(t,r){const a=_l();He(t)&&(t=[t]);const s=this.options.preload||[],i=t.filter(o=>s.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return i.length?(this.options.preload=s.concat(i),this.loadResources(o=>{a.resolve(),r&&r(o)}),a):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],a=this.services&&this.services.languageUtils||new Qw(rj());return r.indexOf(a.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new id(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ru;const a=t.forkResourceStore;a&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},i=new id(s);return(t.debug!==void 0||t.prefix!==void 0)&&(i.logger=i.logger.clone(t)),["store","services","language"].forEach(l=>{i[l]=this[l]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},a&&(i.store=new Jw(this.store.data,s),i.services.resourceStore=i.store),i.translator=new Sf(i.services,s),i.translator.on("*",function(l){for(var c=arguments.length,d=new Array(c>1?c-1:0),u=1;u<c;u++)d[u-1]=arguments[u];i.emit(l,...d)}),i.init(s,r),i.translator.options=s,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ta=id.createInstance();ta.createInstance=id.createInstance;ta.createInstance;ta.dir;ta.init;ta.loadResources;ta.reloadResources;ta.use;ta.changeLanguage;ta.getFixedT;ta.t;ta.exists;ta.setDefaultNamespace;ta.hasLoadedNamespace;ta.loadNamespaces;ta.loadLanguages;function gx(e){"@babel/helpers - typeof";return gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gx(e)}function ak(){return typeof XMLHttpRequest=="function"||(typeof XMLHttpRequest>"u"?"undefined":gx(XMLHttpRequest))==="object"}function zce(e){return!!e&&typeof e.then=="function"}function Vce(e){return zce(e)?e:Promise.resolve(e)}function Gce(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var vx={exports:{}},au={exports:{}},nj;function qce(){return nj||(nj=1,function(e,t){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Bn<"u"&&Bn,a=function(){function i(){this.fetch=!1,this.DOMException=r.DOMException}return i.prototype=r,new i}();(function(i){(function(o){var l=typeof i<"u"&&i||typeof self<"u"&&self||typeof l<"u"&&l,c={searchParams:"URLSearchParams"in l,iterable:"Symbol"in l&&"iterator"in Symbol,blob:"FileReader"in l&&"Blob"in l&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in l,arrayBuffer:"ArrayBuffer"in l};function d(T){return T&&DataView.prototype.isPrototypeOf(T)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(T){return T&&u.indexOf(Object.prototype.toString.call(T))>-1};function h(T){if(typeof T!="string"&&(T=String(T)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(T)||T==="")throw new TypeError('Invalid character in header field name: "'+T+'"');return T.toLowerCase()}function m(T){return typeof T!="string"&&(T=String(T)),T}function x(T){var F={next:function(){var W=T.shift();return{done:W===void 0,value:W}}};return c.iterable&&(F[Symbol.iterator]=function(){return F}),F}function p(T){this.map={},T instanceof p?T.forEach(function(F,W){this.append(W,F)},this):Array.isArray(T)?T.forEach(function(F){this.append(F[0],F[1])},this):T&&Object.getOwnPropertyNames(T).forEach(function(F){this.append(F,T[F])},this)}p.prototype.append=function(T,F){T=h(T),F=m(F);var W=this.map[T];this.map[T]=W?W+", "+F:F},p.prototype.delete=function(T){delete this.map[h(T)]},p.prototype.get=function(T){return T=h(T),this.has(T)?this.map[T]:null},p.prototype.has=function(T){return this.map.hasOwnProperty(h(T))},p.prototype.set=function(T,F){this.map[h(T)]=m(F)},p.prototype.forEach=function(T,F){for(var W in this.map)this.map.hasOwnProperty(W)&&T.call(F,this.map[W],W,this)},p.prototype.keys=function(){var T=[];return this.forEach(function(F,W){T.push(W)}),x(T)},p.prototype.values=function(){var T=[];return this.forEach(function(F){T.push(F)}),x(T)},p.prototype.entries=function(){var T=[];return this.forEach(function(F,W){T.push([W,F])}),x(T)},c.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function g(T){if(T.bodyUsed)return Promise.reject(new TypeError("Already read"));T.bodyUsed=!0}function y(T){return new Promise(function(F,W){T.onload=function(){F(T.result)},T.onerror=function(){W(T.error)}})}function b(T){var F=new FileReader,W=y(F);return F.readAsArrayBuffer(T),W}function v(T){var F=new FileReader,W=y(F);return F.readAsText(T),W}function w(T){for(var F=new Uint8Array(T),W=new Array(F.length),K=0;K<F.length;K++)W[K]=String.fromCharCode(F[K]);return W.join("")}function j(T){if(T.slice)return T.slice(0);var F=new Uint8Array(T.byteLength);return F.set(new Uint8Array(T)),F.buffer}function N(){return this.bodyUsed=!1,this._initBody=function(T){this.bodyUsed=this.bodyUsed,this._bodyInit=T,T?typeof T=="string"?this._bodyText=T:c.blob&&Blob.prototype.isPrototypeOf(T)?this._bodyBlob=T:c.formData&&FormData.prototype.isPrototypeOf(T)?this._bodyFormData=T:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(T)?this._bodyText=T.toString():c.arrayBuffer&&c.blob&&d(T)?(this._bodyArrayBuffer=j(T.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(T)||f(T))?this._bodyArrayBuffer=j(T):this._bodyText=T=Object.prototype.toString.call(T):this._bodyText="",this.headers.get("content-type")||(typeof T=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(T)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var T=g(this);if(T)return T;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var T=g(this);return T||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else return this.blob().then(b)}),this.text=function(){var T=g(this);if(T)return T;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(w(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function E(T){var F=T.toUpperCase();return _.indexOf(F)>-1?F:T}function S(T,F){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');F=F||{};var W=F.body;if(T instanceof S){if(T.bodyUsed)throw new TypeError("Already read");this.url=T.url,this.credentials=T.credentials,F.headers||(this.headers=new p(T.headers)),this.method=T.method,this.mode=T.mode,this.signal=T.signal,!W&&T._bodyInit!=null&&(W=T._bodyInit,T.bodyUsed=!0)}else this.url=String(T);if(this.credentials=F.credentials||this.credentials||"same-origin",(F.headers||!this.headers)&&(this.headers=new p(F.headers)),this.method=E(F.method||this.method||"GET"),this.mode=F.mode||this.mode||null,this.signal=F.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&W)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(W),(this.method==="GET"||this.method==="HEAD")&&(F.cache==="no-store"||F.cache==="no-cache")){var K=/([?&])_=[^&]*/;if(K.test(this.url))this.url=this.url.replace(K,"$1_="+new Date().getTime());else{var B=/\?/;this.url+=(B.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function k(T){var F=new FormData;return T.trim().split("&").forEach(function(W){if(W){var K=W.split("="),B=K.shift().replace(/\+/g," "),L=K.join("=").replace(/\+/g," ");F.append(decodeURIComponent(B),decodeURIComponent(L))}}),F}function O(T){var F=new p,W=T.replace(/\r?\n[\t ]+/g," ");return W.split("\r").map(function(K){return K.indexOf(`
`)===0?K.substr(1,K.length):K}).forEach(function(K){var B=K.split(":"),L=B.shift().trim();if(L){var ee=B.join(":").trim();F.append(L,ee)}}),F}N.call(S.prototype);function P(T,F){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');F||(F={}),this.type="default",this.status=F.status===void 0?200:F.status,this.ok=this.status>=200&&this.status<300,this.statusText=F.statusText===void 0?"":""+F.statusText,this.headers=new p(F.headers),this.url=F.url||"",this._initBody(T)}N.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},P.error=function(){var T=new P(null,{status:0,statusText:""});return T.type="error",T};var A=[301,302,303,307,308];P.redirect=function(T,F){if(A.indexOf(F)===-1)throw new RangeError("Invalid status code");return new P(null,{status:F,headers:{location:T}})},o.DOMException=l.DOMException;try{new o.DOMException}catch{o.DOMException=function(F,W){this.message=F,this.name=W;var K=Error(F);this.stack=K.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function R(T,F){return new Promise(function(W,K){var B=new S(T,F);if(B.signal&&B.signal.aborted)return K(new o.DOMException("Aborted","AbortError"));var L=new XMLHttpRequest;function ee(){L.abort()}L.onload=function(){var G={status:L.status,statusText:L.statusText,headers:O(L.getAllResponseHeaders()||"")};G.url="responseURL"in L?L.responseURL:G.headers.get("X-Request-URL");var V="response"in L?L.response:L.responseText;setTimeout(function(){W(new P(V,G))},0)},L.onerror=function(){setTimeout(function(){K(new TypeError("Network request failed"))},0)},L.ontimeout=function(){setTimeout(function(){K(new TypeError("Network request failed"))},0)},L.onabort=function(){setTimeout(function(){K(new o.DOMException("Aborted","AbortError"))},0)};function M(G){try{return G===""&&l.location.href?l.location.href:G}catch{return G}}L.open(B.method,M(B.url),!0),B.credentials==="include"?L.withCredentials=!0:B.credentials==="omit"&&(L.withCredentials=!1),"responseType"in L&&(c.blob?L.responseType="blob":c.arrayBuffer&&B.headers.get("Content-Type")&&B.headers.get("Content-Type").indexOf("application/octet-stream")!==-1&&(L.responseType="arraybuffer")),F&&typeof F.headers=="object"&&!(F.headers instanceof p)?Object.getOwnPropertyNames(F.headers).forEach(function(G){L.setRequestHeader(G,m(F.headers[G]))}):B.headers.forEach(function(G,V){L.setRequestHeader(V,G)}),B.signal&&(B.signal.addEventListener("abort",ee),L.onreadystatechange=function(){L.readyState===4&&B.signal.removeEventListener("abort",ee)}),L.send(typeof B._bodyInit>"u"?null:B._bodyInit)})}return R.polyfill=!0,l.fetch||(l.fetch=R,l.Headers=p,l.Request=S,l.Response=P),o.Headers=p,o.Request=S,o.Response=P,o.fetch=R,o})({})})(a),a.fetch.ponyfill=!0,delete a.fetch.polyfill;var s=r.fetch?r:a;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t}(au,au.exports)),au.exports}(function(e,t){var r=typeof fetch=="function"?fetch:void 0;if(typeof Bn<"u"&&Bn.fetch?r=Bn.fetch:typeof window<"u"&&window.fetch&&(r=window.fetch),typeof Gce<"u"&&typeof window>"u"){var a=r||qce();a.default&&(a=a.default),t.default=a,e.exports=t.default}})(vx,vx.exports);var nk=vx.exports;const sk=bt(nk),sj=i3({__proto__:null,default:sk},[nk]);function ij(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function oj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ij(Object(r),!0).forEach(function(a){Kce(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ij(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Kce(e,t,r){return(t=Xce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xce(e){var t=Yce(e,"string");return Pi(t)=="symbol"?t:t+""}function Yce(e,t){if(Pi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Pi(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pi(e){"@babel/helpers - typeof";return Pi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pi(e)}var Is=typeof fetch=="function"?fetch:void 0;typeof global<"u"&&global.fetch?Is=global.fetch:typeof window<"u"&&window.fetch&&(Is=window.fetch);var od;ak()&&(typeof global<"u"&&global.XMLHttpRequest?od=global.XMLHttpRequest:typeof window<"u"&&window.XMLHttpRequest&&(od=window.XMLHttpRequest));var kf;typeof ActiveXObject=="function"&&(typeof global<"u"&&global.ActiveXObject?kf=global.ActiveXObject:typeof window<"u"&&window.ActiveXObject&&(kf=window.ActiveXObject));!Is&&sj&&!od&&!kf&&(Is=sk||sj);typeof Is!="function"&&(Is=void 0);var yx=function(t,r){if(r&&Pi(r)==="object"){var a="";for(var s in r)a+="&"+encodeURIComponent(s)+"="+encodeURIComponent(r[s]);if(!a)return t;t=t+(t.indexOf("?")!==-1?"&":"?")+a.slice(1)}return t},lj=function(t,r,a,s){var i=function(c){if(!c.ok)return a(c.statusText||"Error",{status:c.status});c.text().then(function(d){a(null,{status:c.status,data:d})}).catch(a)};if(s){var o=s(t,r);if(o instanceof Promise){o.then(i).catch(a);return}}typeof fetch=="function"?fetch(t,r).then(i).catch(a):Is(t,r).then(i).catch(a)},cj=!1,Jce=function(t,r,a,s){t.queryStringParams&&(r=yx(r,t.queryStringParams));var i=oj({},typeof t.customHeaders=="function"?t.customHeaders():t.customHeaders);typeof window>"u"&&typeof global<"u"&&typeof global.process<"u"&&global.process.versions&&global.process.versions.node&&(i["User-Agent"]="i18next-http-backend (node/".concat(global.process.version,"; ").concat(global.process.platform," ").concat(global.process.arch,")")),a&&(i["Content-Type"]="application/json");var o=typeof t.requestOptions=="function"?t.requestOptions(a):t.requestOptions,l=oj({method:a?"POST":"GET",body:a?t.stringify(a):void 0,headers:i},cj?{}:o),c=typeof t.alternateFetch=="function"&&t.alternateFetch.length>=1?t.alternateFetch:void 0;try{lj(r,l,s,c)}catch(d){if(!o||Object.keys(o).length===0||!d.message||d.message.indexOf("not implemented")<0)return s(d);try{Object.keys(o).forEach(function(u){delete l[u]}),lj(r,l,s,c),cj=!0}catch(u){s(u)}}},Zce=function(t,r,a,s){a&&Pi(a)==="object"&&(a=yx("",a).slice(1)),t.queryStringParams&&(r=yx(r,t.queryStringParams));try{var i;od?i=new od:i=new kf("MSXML2.XMLHTTP.3.0"),i.open(a?"POST":"GET",r,1),t.crossDomain||i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.withCredentials=!!t.withCredentials,a&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.overrideMimeType&&i.overrideMimeType("application/json");var o=t.customHeaders;if(o=typeof o=="function"?o():o,o)for(var l in o)i.setRequestHeader(l,o[l]);i.onreadystatechange=function(){i.readyState>3&&s(i.status>=400?i.statusText:null,{status:i.status,data:i.responseText})},i.send(a)}catch(c){console&&console.log(c)}},Qce=function(t,r,a,s){if(typeof a=="function"&&(s=a,a=void 0),s=s||function(){},Is&&r.indexOf("file:")!==0)return Jce(t,r,a,s);if(ak()||typeof ActiveXObject=="function")return Zce(t,r,a,s);s(new Error("No fetch and no xhr implementation found!"))};function Wo(e){"@babel/helpers - typeof";return Wo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wo(e)}function dj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function Eh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dj(Object(r),!0).forEach(function(a){ik(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dj(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ede(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tde(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,ok(a.key),a)}}function rde(e,t,r){return t&&tde(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ik(e,t,r){return(t=ok(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ok(e){var t=ade(e,"string");return Wo(t)=="symbol"?t:t+""}function ade(e,t){if(Wo(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(Wo(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var nde=function(){return{loadPath:"/locales/{{lng}}/{{ns}}.json",addPath:"/locales/add/{{lng}}/{{ns}}",parse:function(r){return JSON.parse(r)},stringify:JSON.stringify,parsePayload:function(r,a,s){return ik({},a,s||"")},parseLoadPayload:function(r,a){},request:Qce,reloadInterval:typeof window<"u"?!1:60*60*1e3,customHeaders:{},queryStringParams:{},crossDomain:!1,withCredentials:!1,overrideMimeType:!1,requestOptions:{mode:"cors",credentials:"same-origin",cache:"default"}}},lk=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};ede(this,e),this.services=t,this.options=r,this.allOptions=a,this.type="backend",this.init(t,r,a)}return rde(e,[{key:"init",value:function(r){var a=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.services=r,this.options=Eh(Eh(Eh({},nde()),this.options||{}),s),this.allOptions=i,this.services&&this.options.reloadInterval){var o=setInterval(function(){return a.reload()},this.options.reloadInterval);Wo(o)==="object"&&typeof o.unref=="function"&&o.unref()}}},{key:"readMulti",value:function(r,a,s){this._readAny(r,r,a,a,s)}},{key:"read",value:function(r,a,s){this._readAny([r],r,[a],a,s)}},{key:"_readAny",value:function(r,a,s,i,o){var l=this,c=this.options.loadPath;typeof this.options.loadPath=="function"&&(c=this.options.loadPath(r,s)),c=Vce(c),c.then(function(d){if(!d)return o(null,{});var u=l.services.interpolator.interpolate(d,{lng:r.join("+"),ns:s.join("+")});l.loadUrl(u,o,a,i)})}},{key:"loadUrl",value:function(r,a,s,i){var o=this,l=typeof s=="string"?[s]:s,c=typeof i=="string"?[i]:i,d=this.options.parseLoadPayload(l,c);this.options.request(this.options,r,d,function(u,f){if(f&&(f.status>=500&&f.status<600||!f.status))return a("failed loading "+r+"; status code: "+f.status,!0);if(f&&f.status>=400&&f.status<500)return a("failed loading "+r+"; status code: "+f.status,!1);if(!f&&u&&u.message){var h=u.message.toLowerCase(),m=["failed","fetch","network","load"].find(function(g){return h.indexOf(g)>-1});if(m)return a("failed loading "+r+": "+u.message,!0)}if(u)return a(u,!1);var x,p;try{typeof f.data=="string"?x=o.options.parse(f.data,s,i):x=f.data}catch{p="failed parsing "+r+" to json"}if(p)return a(p,!1);a(null,x)})}},{key:"create",value:function(r,a,s,i,o){var l=this;if(this.options.addPath){typeof r=="string"&&(r=[r]);var c=this.options.parsePayload(a,s,i),d=0,u=[],f=[];r.forEach(function(h){var m=l.options.addPath;typeof l.options.addPath=="function"&&(m=l.options.addPath(h,a));var x=l.services.interpolator.interpolate(m,{lng:h,ns:a});l.options.request(l.options,x,c,function(p,g){d+=1,u.push(p),f.push(g),d===r.length&&typeof o=="function"&&o(u,f)})})}}},{key:"reload",value:function(){var r=this,a=this.services,s=a.backendConnector,i=a.languageUtils,o=a.logger,l=s.language;if(!(l&&l.toLowerCase()==="cimode")){var c=[],d=function(f){var h=i.toResolveHierarchy(f);h.forEach(function(m){c.indexOf(m)<0&&c.push(m)})};d(l),this.allOptions.preload&&this.allOptions.preload.forEach(function(u){return d(u)}),c.forEach(function(u){r.allOptions.ns.forEach(function(f){s.read(u,f,"read",null,null,function(h,m){h&&o.warn("loading namespace ".concat(f," for language ").concat(u," failed"),h),!h&&m&&o.log("loaded namespace ".concat(f," for language ").concat(u),m),s.loaded("".concat(u,"|").concat(f),h,m)})})})}}}])}();lk.type="backend";function sde(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ld(e){"@babel/helpers - typeof";return ld=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ld(e)}function ide(e,t){if(ld(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(ld(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function ode(e){var t=ide(e,"string");return ld(t)=="symbol"?t:t+""}function lde(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,ode(a.key),a)}}function cde(e,t,r){return t&&lde(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var ck=[],dde=ck.forEach,ude=ck.slice;function fde(e){return dde.call(ude.call(arguments,1),function(t){if(t)for(var r in t)e[r]===void 0&&(e[r]=t[r])}),e}var uj=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,hde=function(t,r,a){var s=a||{};s.path=s.path||"/";var i=encodeURIComponent(r),o="".concat(t,"=").concat(i);if(s.maxAge>0){var l=s.maxAge-0;if(Number.isNaN(l))throw new Error("maxAge should be a Number");o+="; Max-Age=".concat(Math.floor(l))}if(s.domain){if(!uj.test(s.domain))throw new TypeError("option domain is invalid");o+="; Domain=".concat(s.domain)}if(s.path){if(!uj.test(s.path))throw new TypeError("option path is invalid");o+="; Path=".concat(s.path)}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");o+="; Expires=".concat(s.expires.toUTCString())}if(s.httpOnly&&(o+="; HttpOnly"),s.secure&&(o+="; Secure"),s.sameSite){var c=typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite;switch(c){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return o},fj={create:function(t,r,a,s){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};a&&(i.expires=new Date,i.expires.setTime(i.expires.getTime()+a*60*1e3)),s&&(i.domain=s),document.cookie=hde(t,encodeURIComponent(r),i)},read:function(t){for(var r="".concat(t,"="),a=document.cookie.split(";"),s=0;s<a.length;s++){for(var i=a[s];i.charAt(0)===" ";)i=i.substring(1,i.length);if(i.indexOf(r)===0)return i.substring(r.length,i.length)}return null},remove:function(t){this.create(t,"",-1)}},mde={name:"cookie",lookup:function(t){var r;if(t.lookupCookie&&typeof document<"u"){var a=fj.read(t.lookupCookie);a&&(r=a)}return r},cacheUserLanguage:function(t,r){r.lookupCookie&&typeof document<"u"&&fj.create(r.lookupCookie,t,r.cookieMinutes,r.cookieDomain,r.cookieOptions)}},xde={name:"querystring",lookup:function(t){var r;if(typeof window<"u"){var a=window.location.search;!window.location.search&&window.location.hash&&window.location.hash.indexOf("?")>-1&&(a=window.location.hash.substring(window.location.hash.indexOf("?")));for(var s=a.substring(1),i=s.split("&"),o=0;o<i.length;o++){var l=i[o].indexOf("=");if(l>0){var c=i[o].substring(0,l);c===t.lookupQuerystring&&(r=i[o].substring(l+1))}}}return r}},Sl=null,hj=function(){if(Sl!==null)return Sl;try{Sl=window!=="undefined"&&window.localStorage!==null;var t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Sl=!1}return Sl},pde={name:"localStorage",lookup:function(t){var r;if(t.lookupLocalStorage&&hj()){var a=window.localStorage.getItem(t.lookupLocalStorage);a&&(r=a)}return r},cacheUserLanguage:function(t,r){r.lookupLocalStorage&&hj()&&window.localStorage.setItem(r.lookupLocalStorage,t)}},kl=null,mj=function(){if(kl!==null)return kl;try{kl=window!=="undefined"&&window.sessionStorage!==null;var t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{kl=!1}return kl},gde={name:"sessionStorage",lookup:function(t){var r;if(t.lookupSessionStorage&&mj()){var a=window.sessionStorage.getItem(t.lookupSessionStorage);a&&(r=a)}return r},cacheUserLanguage:function(t,r){r.lookupSessionStorage&&mj()&&window.sessionStorage.setItem(r.lookupSessionStorage,t)}},vde={name:"navigator",lookup:function(t){var r=[];if(typeof navigator<"u"){if(navigator.languages)for(var a=0;a<navigator.languages.length;a++)r.push(navigator.languages[a]);navigator.userLanguage&&r.push(navigator.userLanguage),navigator.language&&r.push(navigator.language)}return r.length>0?r:void 0}},yde={name:"htmlTag",lookup:function(t){var r,a=t.htmlTag||(typeof document<"u"?document.documentElement:null);return a&&typeof a.getAttribute=="function"&&(r=a.getAttribute("lang")),r}},bde={name:"path",lookup:function(t){var r;if(typeof window<"u"){var a=window.location.pathname.match(/\/([a-zA-Z-]*)/g);if(a instanceof Array)if(typeof t.lookupFromPathIndex=="number"){if(typeof a[t.lookupFromPathIndex]!="string")return;r=a[t.lookupFromPathIndex].replace("/","")}else r=a[0].replace("/","")}return r}},wde={name:"subdomain",lookup:function(t){var r=typeof t.lookupFromSubdomainIndex=="number"?t.lookupFromSubdomainIndex+1:1,a=typeof window<"u"&&window.location&&window.location.hostname&&window.location.hostname.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(a)return a[r]}},dk=!1;try{document.cookie,dk=!0}catch{}var uk=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];dk||uk.splice(1,1);function jde(){return{order:uk,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:function(t){return t}}}var fk=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};sde(this,e),this.type="languageDetector",this.detectors={},this.init(t,r)}return cde(e,[{key:"init",value:function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=r||{languageUtils:{}},this.options=fde(a,this.options||{},jde()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=function(i){return i.replace("-","_")}),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=s,this.addDetector(mde),this.addDetector(xde),this.addDetector(pde),this.addDetector(gde),this.addDetector(vde),this.addDetector(yde),this.addDetector(bde),this.addDetector(wde)}},{key:"addDetector",value:function(r){return this.detectors[r.name]=r,this}},{key:"detect",value:function(r){var a=this;r||(r=this.options.order);var s=[];return r.forEach(function(i){if(a.detectors[i]){var o=a.detectors[i].lookup(a.options);o&&typeof o=="string"&&(o=[o]),o&&(s=s.concat(o))}}),s=s.map(function(i){return a.options.convertDetectedLanguage(i)}),this.services.languageUtils.getBestMatchFromCodes?s:s.length>0?s[0]:null}},{key:"cacheUserLanguage",value:function(r,a){var s=this;a||(a=this.options.caches),a&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(r)>-1||a.forEach(function(i){s.detectors[i]&&s.detectors[i].cacheUserLanguage(r,s.options)}))}}])}();fk.type="languageDetector";ta.use(lk).use(fk).use(r6).init({fallbackLng:"ar",supportedLngs:["ar","en"],debug:!1,interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]},backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"},ns:["translation"],defaultNS:"translation",react:{useSuspense:!1,wait:!0,bindI18n:"languageChanged loaded"}});Sj(document.getElementById("root")).render(n.jsx(C.StrictMode,{children:n.jsx(bce,{})}));
